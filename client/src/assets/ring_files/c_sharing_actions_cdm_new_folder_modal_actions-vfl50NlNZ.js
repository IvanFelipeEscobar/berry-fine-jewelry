define(["exports","./c_tslib","./e_ui_page_files_router","./c_sharing_ui_util","./c_deprecated_ajax_ajax_form_extract_errors","./c_core_i18n"],(function(e,o,n,t,a,s){"use strict";e.createTSDPlus1NsfFolder=function({user:e,pathName:r,folderName:l,autoTeamGroupAccessLevel:i,autoTeamGroupId:c,showFileSystemWarningsModal:d,onPending:u,onComplete:_,onCancel:m,shouldLaunchAutomationModal:f}){const h=e.id,A=new n.FolderShareApiClient({userId:h,isNonUserRelativeContext:!1}),C=t.getNewFolderPathFromContentName(l,r);u(),new a.SharingApi(e).validate_new_sf_path(l,C,(()=>{!function({userId:e,fqPath:a,autoTeamGroupAccessLevel:r,folderApiClient:l,autoTeamGroupId:i,showFileSystemWarningsModal:c,onComplete:d,onCancel:u}){const _=r===n.ACCESS_LEVEL.READER;(function(e){var{folderApiClient:n,showFileSystemWarningsModal:t,onCancel:a}=e,r=o.__rest(e,["folderApiClient","showFileSystemWarningsModal","onCancel"]);return t?n.shareWithFsws(Object.assign(Object.assign({},r),{folderPolicy:null})).then((({metadata:e,fsws:o})=>o?new Promise(((e,l)=>{t({fsws:o,onFinalAccept:()=>{n.share(Object.assign(Object.assign({},r),{folderPolicy:null})).then(e,l)},confirmText:s.intl.formatMessage({id:"5Z9j+l",defaultMessage:"Create folder"}),onAbortAction:a})})):Promise.resolve(e))):n.shareWithoutFsws(Object.assign(Object.assign({},r),{folderPolicy:null})).then((({metadata:e})=>Promise.resolve(e)))})({folderApiClient:l,showFileSystemWarningsModal:c,fqPath:a,confidential:_,onCancel:u}).then((function(o){const t=o.shared_folder_id;return _?(n.WebUserActionLog.log(e,n.WebUserActionLogEvent.CONF_BY_CREATE_CONFIDENTIAL_FOLDER,{ns_id:t,who_has_access:n.WebUserActionLogExtraValue.EVERYONE_GROUP_VIEW_ACCESS,location:n.WebUserActionLogExtraValue.BROWSE}),l.addMembers({contentId:t,members:[new n.UnionScalar("dropbox_id",i)],accessLevel:n.ACCESS_LEVEL.READER})):Promise.resolve()})).then(d).catch(n.catchApiError((e=>{const o=e&&e.message;u(t.convertIfHTML(o))})))}({userId:h,fqPath:C,autoTeamGroupAccessLevel:i,folderApiClient:A,autoTeamGroupId:c,showFileSystemWarningsModal:d,onComplete:()=>{_({user:e,folderName:l,fqPath:C,shouldLaunchAutomationModal:f})},onCancel:m})}),(e=>{const o=a.extractErrors(e.responseText);m(o.folder_name&&o.folder_name.message_text)}))}}));
//# sourceMappingURL=c_sharing_actions_cdm_new_folder_modal_actions.js-vflfHH1Io.map
