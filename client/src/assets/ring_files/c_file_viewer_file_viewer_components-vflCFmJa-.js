define(["require","exports","./c_tslib","./e_ui_page_files_router","./e_edison","./c_core_data_utils","./c_core_logging_constants","./c_core_types_preview_type","./c_core_data_preview_key","./c_lodash-es_lodash","./c_file_viewer_logging_performance","./c_core_i18n","./c_file_viewer_file_extension_extension_constants","./c_src_simple-action-bar_action_bar_types","./c_api_v2_redux_files","./c_file_viewer_toolbar","./c_truncate_index","./c_breadcrumb_index"],(function(e,t,i,r,n,a,o,s,l,c,d,u,p,v,g,_,w,f){"use strict";const m=/\.\w+$/;function y(e){if(!e)return"";const t=e.toLowerCase().match(m);return t?t[0]:""}const b=1048576,h=30*b,E=32*b,x=40*b,S=48*b,P=100*b,O=160*b,I=200*b,T=256*b,R=288*b,F=512*b,C=1024*b,j={other_size_limits:{".3fr":I,".ai":T,".arw":I,".azw4":h,".binder":I,".bmp":I,".cr2":I,".cr3":I,".crw":I,".csv":x,".dcr":I,".dcs":I,".djvu":h,".dng":I,".doc":O,".docm":O,".docx":O,".dot":O,".dotx":O,".dwg":P,".eps":T,".epub":h,".erf":I,".gdoc":O,".gif":I,".glsides":R,".gsheet":x,".heic":P,".jpeg":I,".jpg":I,".kdc":I,".key":C,".kth":C,".mef":I,".mobi":h,".mos":I,".mrw":I,".nef":I,".nrw":I,".numbers":C,".odg":O,".odp":O,".ods":x,".odt":O,".orf":I,".otf":E,".pages":C,".paper":I,".papert":I,".pdf":524288e3,".pef":I,".png":I,".ppm":I,".pps":R,".ppsm":R,".ppsx":R,".ppt":R,".pptm":R,".pptx":R,".ps":T,".psd":C,".r3d":I,".raf":I,".rtf":O,".rw2":I,".rwl":I,".sketch":C,".sr2":I,".svg":S,".svgz":S,".tif":I,".tiff":I,".ttf":E,".vtt":P,".webp":I,".wpd":O,".x3f":I,".xd":C},archive_size_limit:F,text_size_limit:8388608,linkfile_size_limit:10485760,excel_size_limit:x,annotations:!1,enable_excel_headers:!0,enable_fullscreen:!1,excel_support:{support:"unsupported",embed_support:"unsupported"},file_flipping:!1,force_no_toolbar:!1,img_size_optimization:!1,keyboard_shortcuts:!0,preview_content_only:!1,show_cloud_doc_preview:!0,show_titlebar:!0,titlebar_logo_config:{show_logo:!1,base_url:""},mobile_web:!1,transparent_background:!1,log_views_to_pass:!0,preview_types:{[s.PreviewType.SsrDoc]:{scaleToFit:"width_and_height"}},fvsdk_excel_ms_embed_phase:"OFF",tags_section_variant:"OFF",enable_assigned_tasks_plugin:!1,initial_video_bandwidth:null,fvsdk_slow_connection_banner:!1,enable_video_editing:!1,replay_previews_permanent_entrypoint:"OFF",campaigns_download_sisu:!1,google_one_tap_variant:"OFF",publish_previews_permanent_entrypoint:"OFF",capture_sdk_integration_voice_overs:!1,capture_sdk_integration_voice_overs_variant:"OFF",capture_sdk_integration_voice_overs_view_button:"OFF",previews_exp_video_buffer_length:null,previews_exp_video_buffer_more_before_play:!1,previews_exp_video_edit_flip:!1,video_edit_async:!1,previews_exp_multi_audio_track:"OFF",previews_exp_ui_redesign:"OFF",previews_exp_enable_vhs_buffer_based_abr:!1,previews_exp_video_edit_trim_optimization:!1,previews_activation_hub:"OFF",previews_disable_campaigns_toolkit:!1,enable_multi_video_editor:!1,publish_share_dropdown_entrypoint:"OFF",previews_exp_prefetch_optimization:"OFF",previews_exp_enable_mux_data:!1,is_unified_susi:!1,previews_exp_audio_transcription:!1,has_seen_preview_tooltip_tour:!0,enable_preview_tooltip_tour:!1},k={download_button:void 0,cloud_open_with_buttons:[],enable_print:!1,enable_open_button:!1,enable_restore_button:!1,enable_view_on_dropbox_button:!1,canEdit:!1};function D(e,t,i){const r=y(e),n=i.other_size_limits[r];if(n)return n;switch(t){case s.PreviewType.Archive:return i.archive_size_limit;case s.PreviewType.HTML:case s.PreviewType.Text:return i.text_size_limit;case s.PreviewType.Linkfile:return i.linkfile_size_limit;case s.PreviewType.Excel:return i.excel_size_limit}return 0}var V,A,L,M;t.DrawerTypes=void 0,(V=t.DrawerTypes||(t.DrawerTypes={})).Comments="comments",V.Copy="copy",V.Main="main",V.Rename="rename",V.Search="search",V.Transfer="transfer",V.Workflows="workflows",t.HubEntryPointType=void 0,(A=t.HubEntryPointType||(t.HubEntryPointType={})).Download="download",A.Generic="generic",A.Search="search",A.Rename="rename",t.GuidedTours=void 0,(L=t.GuidedTours||(t.GuidedTours={})).Search="search",L.Rename="rename",L.Workflows="workflows",t.TooltipTourUpdateType=void 0,(M=t.TooltipTourUpdateType||(t.TooltipTourUpdateType={})).Increment="Increment",M.Reset="Reset";var N;t.ActivationHubTriggerSource=void 0,(N=t.ActivationHubTriggerSource||(t.ActivationHubTriggerSource={})).HelpIcon="help_icon",N.CardClick="card_click",N.GenericEntryPoint="generic_entry_point",N.RenameEntryPoint="rename_entry_point",N.SearchEntryPoint="search_entry_point",N.WorkflowsEntryPoint="workflows_entry_point";var U;t.HCEvents=void 0,(U=t.HCEvents||(t.HCEvents={})).ACTIVATE_GUIDED_TOUR="activate_guided_tour",U.LOG_TOUR_STEP="log_tour_step",U.OPEN_DRAWER="open_drawer",U.SELECT_DRAWER="select_drawer",U.STATE_CHANGE="state_change",U.SET_ENTRY_POINT="set_entry_point",U.UPDATE_TOUR_STEP="update_tour_step";const K=new class{constructor(){this._listeners=[]}hasEventListener(e,t){return this._listeners.some((i=>i.type===e&&i.listener===t))}addEventListener(e,t){return this.hasEventListener(e,t)||this._listeners.push({type:e,listener:t}),this}removeEventListener(e,t){const i=this._listeners.findIndex((i=>i.type===e&&i.listener===t));return i>=0&&this._listeners.splice(i,1),this}removeEventListeners(){return this._listeners=[],this}dispatch(e,t){return this._listeners.filter((t=>t.type===e)).forEach((e=>{const{listener:i}=e;i.call(this,t)})),this}on(e,t){const i=t;return this.addEventListener(e,i),()=>{this.removeEventListener(e,i)}}},z=(e,i,r)=>{K.dispatch(t.HCEvents.UPDATE_TOUR_STEP,{updateType:e,selectedTour:i,distinctStep:r})},$=(e,i,r)=>{K.dispatch(t.HCEvents.LOG_TOUR_STEP,{selectedTour:e,distinctStep:i,totalSteps:r})},B=p.PHOTO_EXTS.concat([".xd"]),W=p.PDF_EXTS.concat(p.DOCUMENT_EXTS,p.PRESENTATION_EXTS,p.WORDPROC_EXTS),H=new Set(p.LOGGING_ALLOWED_EXTS);function q(e){return e=e.toLowerCase(),p.MSOFFICE_EXCEL_EXTS.includes(e)?s.PreviewType.Excel:W.includes(e)?s.PreviewType.SsrDoc:B.includes(e)?s.PreviewType.Image:p.TRANSCODE_VIDEO_EXTS.includes(e)?s.PreviewType.Video:p.AUDIO_EXTS.includes(e)?s.PreviewType.Audio:p.LINK_FILE_EXTS.includes(e)?s.PreviewType.Linkfile:p.HTMLIFIED_PREVIEW_EXTS.includes(e)?s.PreviewType.HTML:p.CLOUD_DOC_EXTS.includes(e)?s.PreviewType.CloudDoc:p.ARCHIVE_EXTS.includes(e)?s.PreviewType.Archive:s.PreviewType.Other}function G(e){return H.has(e)?e:p.LOGGING_UNALLOWED_EXT_PLACEHOLDER}function Z(e,t){if(!e||!e.content)return t?q(y(t)):s.PreviewType.Error;switch(e.content[".tag"]){case"archive":return s.PreviewType.Archive;case"audio":return s.PreviewType.Audio;case"cloud_doc":return s.PreviewType.CloudDoc;case"excel":return s.PreviewType.Excel;case"html":return s.PreviewType.HTML;case"image":return s.PreviewType.Image;case"linkfile":return s.PreviewType.Linkfile;case"raw_html":return s.PreviewType.RawHTML;case"restricted":return s.PreviewType.Restricted;case"ssr_doc":return s.PreviewType.SsrDoc;case"video":return s.PreviewType.Video;default:return s.PreviewType.Other}}const X=[s.PreviewType.CloudDoc,s.PreviewType.Image,s.PreviewType.SsrDoc,s.PreviewType.Video,s.PreviewType.Audio,s.PreviewType.Archive,s.PreviewType.Excel,s.PreviewType.HTML,s.PreviewType.RawHTML,s.PreviewType.Linkfile];function Y(e,t){return new Promise(((i,r)=>{const n=Date.now(),a=new Image;a.onload=()=>{i({started:n,completed:Date.now()})},a.onerror=()=>{r({started:n,failed:Date.now()})},t&&(t.srcset&&(a.srcset=t.srcset),t.sizes&&(a.sizes=t.sizes)),a.src=e}))}const Q={top:20,bottom:120,bottomNoToolbar:20,horizontal:72};function J(e,t,i,r=1){const n=e.width*r,a=e.height*r;let o=0,s=0;return n<t.width&&(o=(t.width-n)/2),a<t.height&&(s=(t.height-a-i.bottom+i.top)/2),{width:n,height:a,translateX:o,translateY:s}}function ee(e){return e/window.innerWidth*100/window.devicePixelRatio}function te(e,t){const i=function(e,t,i){return Math.min((t.width-i.horizontal)/e.width,(t.height-i.top-i.bottom)/e.height)}(e,t,Q),{width:r,height:n,translateX:a,translateY:o}=J(e,t,Q,i);return{width:r,height:n,translateX:a,translateY:o,sizeScale:ee(r)}}function ie(e){return!!e&&"rightRailUI"in e}function re(e){return e&&function(e){return!!e&&"commentUI"in e}(e)?e:void 0}function ne(e){return"actionDefinitions"in e}function ae(e){return!!e&&"fullscreenLayer"in e}function oe(e){return"isSnackbarVisible"in e}function se(e){return e&&function(e){return"sidebarUI"in e}(e)?e:void 0}const le=e=>({actionType:v.ActionBarActionTypes.CUSTOM_ACTION,id:e.id,text:u.defineMessage({id:"C2s323",defaultMessage:"Blank"}),icon:n.React$1.createElement("div",null),isEnabled:!0,renderButton:e.renderButton,overflowItem:e.overflowItem,placement:e.placement}),ce=(e,t)=>{const{alwaysAtTopLevel:i,atTopLevelIfSpace:r,alwaysInOverflow:n}=t,a=(e=[],t=[])=>[...e,...t];return{alwaysAtTopLevel:a(e.alwaysAtTopLevel,null==i?void 0:i.map(le)),atTopLevelIfSpace:a(e.atTopLevelIfSpace,null==r?void 0:r.map(le)),alwaysInOverflow:((e=[],t=[])=>{var i,r;const n=[];for(let a=0;a<e.length||a<t.length;a++)n[a]=[...null!==(i=e[a])&&void 0!==i?i:[],...null!==(r=t[a])&&void 0!==r?r:[]];return n})(e.alwaysInOverflow,null==n?void 0:n.map((e=>e.map(le))))}},de=(e,t)=>Object.assign(Object.assign({},e),{[t.identifier]:t.toolbarUI}),ue={workflows:u.defineMessage({id:"6BWuNX",defaultMessage:"Workflows"})},pe={workflows:r.MemberTransferLine},ve=({category:e,children:t,hideIcons:i})=>{const a=u.useIntl(),o=ue[e],s=pe[e],l=n.reactExports.useCallback((e=>{null==e||e.handler()}),[]);return n.React$1.createElement(r.Menu.Wrapper,{onSelection:l},(({getTriggerProps:l,getContentProps:c})=>n.React$1.createElement(n.React$1.Fragment,null,n.React$1.createElement(r.Button$1,Object.assign({},l(),{variant:"opacity",withIconLeft:i?null:n.React$1.createElement(r.UIIcon,{src:s}),withDropdownIcon:!0,className:e+"-menu-button","data-testid":e+"-menu-button"}),a.formatMessage(o)),n.React$1.createElement(r.Menu.Content,Object.assign({},c()),n.React$1.createElement(r.Menu.Segment,null,t)))))};ve.displayName="CategoryButton";const ge=({category:e,children:t})=>{const i=u.useIntl(),a=ue[e],o=pe[e];return n.React$1.createElement(r.Menu.Submenu,{withTriggerContent:i.formatMessage(a),withLeftAccessory:n.React$1.createElement(r.UIIcon,{src:o})},n.React$1.createElement(r.Menu.Segment,null,t))};ge.displayName="CategorySubmenu";const _e=(e,t,i)=>{var r,a,o,s;const l=[];if(e.workflows&&e.workflows.length>0){const t=((e,t)=>{const i=t.map((e=>e.overflowItem?n.React$1.createElement(n.React$1.Fragment,{key:e.id},e.overflowItem):null)).filter((e=>null!==e));if(0===i.length)return;const r=n.React$1.createElement(ge,{category:e},i);return le({id:"GENERIC_CATEGORY_PLUGIN_ID",renderButton:t=>n.React$1.createElement(ve,{category:e,hideIcons:t},i),overflowItem:r})})("workflows",e.workflows);void 0!==t&&l.push(t)}const c=t.map(le),d=null!==(r=i.atTopLevelIfSpace)&&void 0!==r?r:[],u=new Set(d.map((e=>e.actionType===v.ActionBarActionTypes.CUSTOM_ACTION&&e.id?e.id:void 0)).filter(Boolean)),p=null!==(s=null===(o=null!==(a=i.alwaysInOverflow)&&void 0!==a?a:[])||void 0===o?void 0:o[0])&&void 0!==s?s:[],g=p.filter((e=>e.actionType===v.ActionBarActionTypes.CUSTOM_ACTION&&u.has(e.id))),_=p.filter((e=>e.actionType!==v.ActionBarActionTypes.CUSTOM_ACTION||!u.has(e.id))),w=[...g,...c,...l,..._],f=[],m=[],y=[...i.atTopLevelIfSpace||[],...c];for(const e of y)"RightOfCategoryButtons"===e.placement?f.push(e):m.push(e);const b=[...m,...l,...f];return Object.assign(Object.assign({},i),{atTopLevelIfSpace:b,alwaysInOverflow:[w]})};function we(e,t){const i=Z(e),r=e.content;if(!r)return Promise.resolve();if(i===s.PreviewType.Image&&"image"===r[".tag"]){if(!r.default_src)return Promise.resolve();if(r.src_set&&e.dimensions&&t){const{sizeScale:i}=te(e.dimensions,t);return Y(r.default_src,{srcset:r.src_set,sizes:`${i}vw`})}return Y(r.default_src,{srcset:r.src_set})}return Promise.resolve()}const fe=e=>{var t,i;const r=null==e?void 0:e.previewType;if((r===s.PreviewType.SsrDoc||r===s.PreviewType.CloudDoc)&&"cloud_doc"===(null===(t=null==e?void 0:e.content)||void 0===t?void 0:t[".tag"])&&(null===(i=null==e?void 0:e.content)||void 0===i?void 0:i.exit_url))return e.content.exit_url};var me;function ye(e){return{payload:e,type:me.Rename}}function be(e){return{payload:e,type:me.SetToolbarRenameActive}}function he(e){return{payload:e,type:me.SetDeleteFileModalOpen}}function Ee(e){return{payload:e,type:me.FetchPageDataWithMetadata}}function xe(e){return{type:me.FetchPageDataWithMetadataResult,payload:e}}function Se(e){return{type:me.UpdateDocCurrentPageIndex,payload:e}}function Pe(e){return{type:me.PageNavigation,payload:e}}function Oe(e){return{type:me.ZoomIn,payload:e}}function Ie(e){return{type:me.ZoomOut,payload:e}}function Te(e){return{type:me.ZoomToggleOriginalOrFit,payload:e}}function Re(e){return{type:me.InitializeFilePreviewSession,payload:e}}function Fe(e){return{type:me.OpenDocSidebar,payload:e}}function Ce(e){return{type:me.CloseDocSidebar,payload:e}}function je(e){return{type:me.SetUiShown,payload:e}}function ke(e){return{type:me.SetUiHidden,payload:e}}function De(e){return{type:me.Print,payload:e}}function Ve(e){return{type:me.EnterFullScreen,payload:e}}function Ae(e){return{type:me.ExitFullScreen,payload:e}}function Le(e){return{type:me.OpenRightRail,payload:e}}function Me(e){return{type:me.CloseRightRail,payload:e}}function Ne(e){return{type:me.OpenUrl,payload:e}}function Ue(e){return{type:me.FlipToNextFile,payload:e}}function Ke(e){return{type:me.FlipToPreviousFile,payload:e}}function ze(e){return{type:me.SetPreviewMetadata,payload:e}}function $e(e){return{type:me.SetRivieraData,payload:e}}function Be(e){return{type:me.CloseViewer,payload:e}}function We(e){return{type:me.SetBootstrappedFile,payload:e}}function He(e){return{type:me.SetActiveRightRailPlugin,payload:e}}function qe(e){return{type:me.SetActiveEditPlugin,payload:e}}function Ge(e){return{type:me.SetLeftSidebarPlugin,payload:e}}function Ze(e){return{type:me.SetRightSidebarPlugin,payload:e}}function Xe(e){return{payload:e,type:me.UpdateArchiveFileCurrentPath}}function Ye(e){return{type:me.OverrideFloatingToolbar,payload:e}}function Qe(e){return{type:me.SetVolume,payload:e}}function Je(e){return{type:me.SetMuted,payload:e}}function et(e){return{type:me.ReportException,payload:e}}function tt(e){return{type:me.SetPreviewLoadingAction,payload:e}}!function(e){e.CloseDocSidebar="@@previews/fileViewerUi/closeDocSidebar",e.CopyToDropbox="@@previews/fileSystem/copyToDropbox",e.DownloadFile="@@previews/fileSystem/downloadFile",e.FetchPageDataWithMetadata="@@previews/fetchPageDataWithMetadata",e.FetchPageDataWithMetadataResult="@@previews/fetchPageDataWithMetadataResult",e.FlipToNextFile="@@previews/navigation/flipToNextFile",e.FlipToPreviousFile="@@previews/navigation/flipToPreviousFile",e.InitializeFilePreview="@@previews/initializeFilePreview",e.InitializeNestedArchiveFilePreview="@@previews/initializeNestedArchiveFilePreview",e.OpenDocSidebar="@@previews/fileViewerUi/openDocSidebar",e.PageDown="@@previews/pageDown",e.PageUp="@@previews/pageUp",e.Print="@@previews/print",e.RefreshBlob="@@previews/refreshBlob",e.RefreshBlobSuccess="@@previews/refreshBlobSuccess",e.UpdateDocCurrentPageIndex="@@previews/updateDocCurrentPageIndex",e.PageNavigation="@@previews/pageNavigation",e.ResolvePageNavigation="@@previews/resolvePageNavigation",e.UpdateFitScaleFactor="@@previews/updateFitScaleFactor",e.UpdateFitToWidthScaleFactor="@@previews/updateFitToWidthScaleFactor",e.UpdateZoomScaleFactor="@@previews/updateZoomScaleFactor",e.ZoomIn="@@previews/zoomIn",e.ZoomToggleOriginalOrFit="@@previews/zoomToggleOriginalOrFit",e.ZoomOut="@@previews/zoomOut",e.UpdateDimensions="@@previews/updateDimensions",e.OpenRightRail="@@previews/openRightRail",e.CloseRightRail="@@previews/closeRightRail",e.Restore="@@previews/restore",e.Share="@@previews/share",e.OpenWith="@@previews/openWith",e.OpenWebPreview="@@previews/openWebPreview",e.OpenVersionHistory="@@previews/openVersionHistory",e.OpenUrl="@@previews/openUrl",e.FetchNativeApps="@@previews/fetchNativeApps",e.InitializeFilePreviewSession="@@previews/initializeFilePreviewSession",e.InitializeFileViewer="@@previews/initializeFileViewer",e.SetFileMetadata="@@previews/setFileMetadata",e.SetPreviewMetadata="@@previews/setPreviewMetadata",e.SetRivieraData="@@previews/setRivieraData",e.SetArchiveFiles="@@previews/setArchiveFiles",e.CloseViewer="@@previews/closeViewer",e.OpenFullscreenPreview="@@previews/openFullscreenPreview",e.SetBootstrappedFile="@@previews/setBootstrappedFile",e.SetErroredFile="@@previews/setErroredFile",e.SetActiveRightRailPlugin="@@previews/plugins/setActiveRightRailPlugin",e.SetActiveEditPlugin="@@previews/plugins/setActiveEditPlugin",e.HideContentPane="@@previews/plugins/hideContentPane",e.SetLeftSidebarPlugin="@@previews/plugins/setLeftSidebarPlugin",e.SetRightSidebarPlugin="@@previews/plugins/setRightSidebarPlugin",e.FetchExcelSheetLayoutData="@@previews/fetchExcelSheetLayoutData",e.FetchExcelSheetLayoutDataResult="@@previews/fetchExcelSheetLayoutDataResult",e.SwitchWorkbookTab="@@previews/switchWorkbookTab",e.SetSharedLinkInfo="@@previews/setSharedLinkInfo",e.ExcelSheetRenderFailed="@@previews/excelSheetRenderFailed",e.ExcelSheetRenderSucceeded="@@previews/excelSheetRenderSucceeded",e.EnterFullScreen="@@previews/enterFullscreen",e.ExitFullScreen="@@previews/exitFullscreen",e.ClickDropboxLogo="@@previews/clickDropboxLogo",e.UpdateArchiveFileCurrentPath="@@previews/updateArchiveFileCurrentPath",e.UpdateAudioVideoPlaybackState="@@previews/updateAudioVideoPlaybackState",e.UpdateFiles="@@previews/updateFiles",e.RequestVideoSeek="@@previews/requestVideoSeek",e.RequestVideoSeekRelative="@@previews/requestVideoSeekRelative",e.RequestVideoPause="@@previews/requestVideoPause",e.ClearVideoRequests="@@previews/clearVideoRequests",e.ToggleVideoFrameSteppers="@@previews/toggleVideoFrameSteppers",e.SetupGetPlayDurationSeconds="@@previews/setupGetPlayDurationSeconds",e.ShowAuthModal="@@previews/showAuthModal",e.OpenFileURL="@@previews/openFileURL",e.Redirect="@@previews/redirect",e.FetchTranscriptData="@@previews/fetchTranscriptData",e.FetchTranscriptDataResult="@@previews/fetchTranscriptDataResult",e.StartTranscriptGenerating="@@previews/startTranscriptGenerating",e.SetOptInToVideoTranscript="@@previews/setOptInToVideoTranscript",e.SetTranscriptError="@@previews/setTranscriptError",e.OverrideFloatingToolbar="@@previews/overrideFloatingToolbar",e.TriggerDynamicRoutingModalCheck="@@previews/triggerDynamicRoutingModalCheck",e.SetVolume="@@previews/setVolume",e.SetMuted="@@previews/setMuted",e.ReportException="@@previews/reportException",e.SetPreviewLoadingAction="@@previews/setPreviewLoadedAction",e.SetBrandingInfo="@@previews/setBrandingInfo",e.Rename="@@previews/rename",e.Delete="@@previews/delete",e.SetDeleteFileModalOpen="@@previews/setDeleteFileModalOpen",e.EditVideo="@@previews/editVideo",e.CancelEditingVideo="@@previews/cancelEditingVideo",e.SaveVideoEdit="@@previews/saveVideoEdit",e.SetToolbarRenameActive="@@previews/toolbarRenameActive",e.SetTitleBarRenameActive="@@previews/titleBarRenameActive",e.SetIsClosedCaptionShowing="@@previews/setIsClosedCaptionShowing",e.SetIsTranscriptShowing="@@previews/setIsTranscriptShowing",e.SetIsDefaultAudioTrackSelected="@@previews/fileViewerUi/setIsDefaultAudioTrackSelected",e.SetAreVideoControlsHidden="@@previews/fileViewerUi/setAreVideoControlsHidden",e.SetUiShown="@@previews/fileViewerUi/setUiShown",e.SetUiHidden="@@previews/fileViewerUi/setUiHidden"}(me||(me={}));r.injectInternalStyle("js/file_viewer/app.module.out.css",(e=>"._container_1q5wf_1{align-items:stretch;background:var(--color__faint__background);display:flex;flex:1;font-family:AtlasGrotesk,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:var(--type__body__standard--fontsize);justify-content:flex-end;min-height:0;position:relative;width:100%}._container_1q5wf_1 *,._container_1q5wf_1 :after,._container_1q5wf_1 :before{box-sizing:border-box}._container_1q5wf_1 aside{background:var(--color__standard__background)}._containerV2_1q5wf_26{flex-direction:column;justify-content:flex-start}._contentContainer_1q5wf_31{display:flex;flex:1}@media (max-width:600px){._container_1q5wf_1{width:100%!important}}._editPluginFullscreenContainer_1q5wf_41{background:var(--color__standard__background);height:100%}._transparentBackground_1q5wf_46{background:transparent}._file-viewer-area_1q5wf_50{display:flex;flex-direction:column;height:100%;width:100%}._renderer-row_1q5wf_57{display:flex;flex:1;flex-direction:row;min-height:0;width:100%}._footer-row_1q5wf_65{width:100%}._center-section_1q5wf_69{display:flex;flex-direction:column;height:100%;width:100%}._titleBarWrapper_1q5wf_76{opacity:1;transition:opacity var(--duration__micro) var(--easing__transition)}._titleBarWrapper_1q5wf_76._hidden_1q5wf_81{opacity:0}._titleBarWrapper_1q5wf_76._isVideo_1q5wf_85._isFullScreen_1q5wf_85{position:absolute;top:0;width:100%;z-index:1}"));var it,rt;t.FVErrorCode=void 0,(it=t.FVErrorCode||(t.FVErrorCode={})).PreviewsDataApiFailure="previews_data_api_failure",it.MalformedPreviewsDataApiResponse="malformed_previews_data_api_response",it.RivieraDataFetchFailure="riviera_data_fetch_failure",it.MalformedRivieraData="malformed_riviera_data",it.FileTooLarge="file_too_large",it.UnsupportedPreviewType="unsupported_preview_type",it.NoExtension="no_extension",it.PasswordProtected="password_protected",it.FileUploading="file_uploading",it.Unknown="unknown",it.FileSwitched="file_switched",it.InvalidFileInfo="invalid_file_info",it.InvalidLoggingOrder="invalid_logging_order",it.InvalidLoggingSession="invalid_logging_session",it.UserOffline="user_offline",it.MissingContentMetadata="missing_content_metadata",it.NestedFiletypeNotSupported="nested_file_type_not_supported",it.PasswordProtectedArchivesNotSupported="password_protected_archives_not_supported",t.ErrorLifecycle=void 0,(rt=t.ErrorLifecycle||(t.ErrorLifecycle={})).Support="support",rt.Download="download",rt.Render="render",rt.Unknown="unkown";class nt extends Error{constructor(e,t,i){super(i),Object.setPrototypeOf(this,nt.prototype),this.type=e,this.lifecycle=t}}const at=(e,t)=>{const r=n.React$1.lazy((()=>i.__awaiter(void 0,void 0,void 0,(function*(){return{default:(yield t())[e]}})))),a=e=>n.React$1.createElement(n.React$1.Suspense,{fallback:null},n.React$1.createElement(r,Object.assign({},e)));return a.displayName=`Async${e}`,a};var ot;function st(e){return{type:ot.LogSessionEvent,payload:e}}function lt(e){return{type:ot.Log,payload:e}}function ct(e){return{type:ot.LogUserAction,payload:e}}function dt(e){return{type:ot.UpdateSession,payload:e}}function ut(e){return{type:ot.LogDuration,payload:e}}function pt({page:e=0,imageUrlTmpl:t},i){const r=new URL(t);return r.searchParams.set("page",e.toString()),i&&"scalePercent"in i&&i.scalePercent&&r.searchParams.set("scale_percent",i.scalePercent.toString()),i&&"width"in i&&null!=i.width&&r.searchParams.set("width",i.width.toString()),r.toString()}!function(e){e.UpdateSession="@@previews/updateSession",e.Log="@@previews/log",e.LogDuration="@@previews/logDuration",e.LogUserAction="@@previews/LogUserAction",e.LogBackgroundEvent="@@previews/LogBackgroundEvent",e.LogSessionEvent="@@previews/logSessionEvent",e.LogTTI="@@previews/logTTI",e.LogVideoEvent="@@previews/logVideoEvent",e.LogVideoEventQuantity="@@previews/logVideoEventQuantity",e.LogVideoEventDuration="@@previews/logVideoEventDuration",e.UpdateFitScaleFactor="UpdateFitScaleFactor"}(ot||(ot={}));const vt=e=>({state:"errored",error:e}),gt=e=>({state:"loaded",data:e}),_t=()=>({state:"pending"}),wt=1<<18,ft=1,mt=64;function yt(e,t,i){return i&&i[0]?pt({imageUrlTmpl:e,page:t},{width:i[0]}):pt({imageUrlTmpl:e,page:t})}function bt(e){const{text:t}=e;if(!t||!t.pages)return[];const{links:i,pages:r}=t,n=(t.fonts||[]).reduce(((e,t)=>(e[t.f]=function(e){const t=e.n.lastIndexOf(",");return{fontFamily:`"${t>-1?e.n.substr(0,t):e.n}", ${e.f&ft?"monospace":"serif"}`,isBold:(e.f&wt)>0,isItalic:(e.f&mt)>0}}(t),e)),{});return Object.keys(r).map((e=>({pageIndex:+e,textboxes:(r[e]||[]).map((e=>Object.assign(Object.assign({},e),{font:n[e.f]}))),links:i&&i[e]||[]})))}function ht(e,t=[],i,r,n,a){const o=function(e,t=[],i,r,n){const a=t.reduce(((e,[t,i,r])=>{for(let n=0;n<r;n++)e.push([t,i]);return e}),[]);return[...Array(i)].map(((t,i)=>({pageIndex:i,dimension:a[i],thumbnailUrl:yt(e,i,n),imgUrls:{"1x":pt({imageUrlTmpl:e,page:i},{scalePercent:100}),"4x":pt({imageUrlTmpl:e,page:i},{scalePercent:400}),imageUrlTmpl:e},textboxes:r?r[i].textboxes:[],links:[]})))}(e,t,i,n,a);return bt(r).forEach((e=>{const{pageIndex:t}=e;t<o.length&&(o[t]=Object.assign(Object.assign({},o[t]),e))})),o}function Et(e){return gt({name:e.workbook_name,sheetOverview:e.sheets.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.idx]:{hidden:t.hidden,name:t.name}})),{})})}const xt=(e,t="")=>{var i,r,n,a;const o="/"===e.name?"":e.name,s="/"===e.name?"":`${t}/${e.name}`,l=null!==(r=null===(i=e.children)||void 0===i?void 0:i.reduce(((e,t)=>Object.assign(Object.assign({},e),xt(t,s))),{}))&&void 0!==r?r:void 0,c=e.isDir?{isDir:!0,children:null!==(a=null===(n=e.children)||void 0===n?void 0:n.map((e=>e.name)))&&void 0!==a?a:[],name:o,size:void 0}:{isDir:!1,size:e.size?Number(e.size):0,name:o,children:void 0};return Object.assign(Object.assign({},l),{[s]:c})};var St;t.RivieraStatus=void 0,(St=t.RivieraStatus||(t.RivieraStatus={}))[St.Unknown=0]="Unknown",St[St.OK=1]="OK",St[St.ConversionFailure=2]="ConversionFailure",St[St.TemporaryFailure=3]="TemporaryFailure",St[St.InternalFailure=4]="InternalFailure",St[St.UnsupportedFormat=5]="UnsupportedFormat",St[St.Timeout=6]="Timeout",St[St.TooBig=7]="TooBig",St[St.InvalidMetadata=8]="InvalidMetadata",St[St.SourceCorrupt=9]="SourceCorrupt",St[St.TimeBudgetExceeded=10]="TimeBudgetExceeded",St[St.NotFound=11]="NotFound",St[St.PasswordProtected=12]="PasswordProtected",St[St.InvalidRequest=13]="InvalidRequest",St[St.VirusDetected=14]="VirusDetected",St[St.BlockMissing=15]="BlockMissing",St[St.FeatureDisabled=16]="FeatureDisabled";class Pt extends Error{constructor(e,i=t.RivieraStatus.Unknown){super(e),this.statusCode=i}}class Ot extends Pt{constructor(e="error_unknown",i=t.RivieraStatus.Unknown){super(e),this.statusCode=i,this.transcriptError=e}}const It=e=>i.__awaiter(void 0,void 0,void 0,(function*(){return new Promise(((i,r)=>{const n=new Image;n.onload=()=>{i(e)},n.onerror=()=>{r(new Pt(`Failed to load image ${e}`,t.RivieraStatus.Unknown))},n.src=e}))}));function Tt(e,i,r){return 401===e&&r?new Pt("Password required",t.RivieraStatus.PasswordProtected):new Pt("Load Error",i.rivieraStatusCode)}const Rt=e=>i.__awaiter(void 0,void 0,void 0,(function*(){return null==e?void 0:e.json()})),Ft=(...e)=>i.__awaiter(void 0,void 0,void 0,(function*(){return Ct(Rt,e)})),Ct=(e,t)=>i.__awaiter(void 0,void 0,void 0,(function*(){var i,r,n,a;let o;try{o=yield fetch(...t)}catch(e){o=void 0}const s=null!==(i=null==o?void 0:o.ok)&&void 0!==i&&i,l=null!==(r=null==o?void 0:o.status)&&void 0!==r?r:400,c=(e=>{let t={};try{e&&(t=JSON.parse(e))}catch(e){}return t})(null!==(n=null==o?void 0:o.headers.get("x-dropbox-metadata"))&&void 0!==n?n:void 0),d=null!==(a=null==o?void 0:o.headers.get("x-dropbox-pdf-password-needed"))&&void 0!==a?a:void 0;let u;try{u=yield e(o)}catch(e){u=void 0}if(s&&u)return{data:u};return{error:Tt(l,c,"1"===d)}})),jt={refreshDocBlob:(e,t)=>Ft(e,{headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({password:t||""}),credentials:"include",method:"POST"}),fetchDocMetadata:(e,t=!1,i=0,r=50,n=!1)=>Ft(function(e,t,i=0,r=50,n=!1){const a=new URL(e);return t&&a.searchParams.set("metadata","1"),void 0!==i&&(a.searchParams.set("text","1"),a.searchParams.set("page_start",i.toString()),a.searchParams.set("page_end",r.toString())),n&&a.searchParams.set("canned_file_name","spdf/audi.pdf.json"),a.toString()}(e,t,i,r,n),{headers:{"content-type":"application/json"},credentials:"include"}),fetchExcelWorkbookLayoutData:(e,t)=>Ft(function(e,t){if(void 0===t)return e;{const i=new URL(e);return i.searchParams.set("sheet",t+""),i.toString()}}(e,t),{headers:{"content-type":"application/json"},credentials:"include",method:"POST"}),fetchMediaMetadata:e=>Ft(e,{credentials:"include"}),fetchWaveformData:e=>Ft(e,{credentials:"include"}),fetchTranscriptData(e,r){var n,a;return i.__awaiter(this,void 0,void 0,(function*(){const i=yield Ft(e,{credentials:"include",cache:"no-cache"});let o=i.error;return(null==o?void 0:o.statusCode)===t.RivieraStatus.NotFound?r&&"ineligible"!==(null==r?void 0:r[".tag"])||(o=new Ot("insufficient_permissions",t.RivieraStatus.Unknown)):o||0!==(null===(a=null===(n=i.data)||void 0===n?void 0:n.segments)||void 0===a?void 0:a.length)||(o=new Ot("no_speech",t.RivieraStatus.Unknown)),o?{error:o}:i}))},fetchLinkfileData:(e,t)=>Ft(e,{credentials:t?"include":"omit",headers:{"content-type":"application/json"},method:"POST"}),fetchArchiveTopLevelData:e=>Ft(e,{headers:{"content-type":"application/json"},credentials:"include",method:"POST"}),fetchPageDataWithMetadata(e,r,n,a){return i.__awaiter(this,void 0,void 0,(function*(){const{textUrlTmpl:i,imageUrlTmpl:o,supportedWidths:s}=e,{metadata:l,pages:c}=a&&"metadata"in a&&!a.isPasswordProtected?a:{metadata:void 0,pages:void 0},d=yield jt.fetchDocMetadata(i,!l,r,n);if(d.error&&d.error.statusCode===t.RivieraStatus.PasswordProtected)return{data:{isPasswordProtected:!0,needsPassword:!0,pages:[],metadata:{page_count:0,dimensions:[]}}};if(d.error)return d;const u=null!=l?l:d.data.metadata;if(!u)return{error:new Pt("Response from riviera ssr_doc has no metadata and we also have no existing metadata",t.RivieraStatus.InvalidRequest)};const p=u.page_count;return{data:{metadata:u,pages:ht(o,u.dimensions,p,d.data,c,s),isPasswordProtected:!1,needsPassword:!1}}}))},fetchDocImage:({imageUrlTmpl:e,width:t,scalePercent:i,page:r})=>{const n=pt({page:r,imageUrlTmpl:e},i?{scalePercent:i}:{width:t});return It(n).then((()=>({data:n})))},fetchImage:e=>It(e).then((()=>({data:e})))},kt=e=>"video"===(null==e?void 0:e[".tag"])||"audio"===(null==e?void 0:e[".tag"])?e.transcript_permission:{".tag":"ineligible"},Dt=(e,t)=>"opted_in"===(null==e?void 0:e[".tag"])&&(e=>!!e&&"pending"!==e.state&&"loaded"!==e.state&&!Vt(e))(t),Vt=e=>"errored"===(null==e?void 0:e.state)&&e.error.statusCode!==t.RivieraStatus.NotFound,At=e=>{var t;return e&&"loaded"===e.state&&(null===(t=e.data)||void 0===t?void 0:t.segments)&&e.data.segments.length>0};function Lt(e){return e instanceof nt}function Mt(e){switch(e[".tag"]){case"unsupported_file_error":return t.FVErrorCode.UnsupportedPreviewType;case"content_not_uploaded":return t.FVErrorCode.FileUploading;default:return t.FVErrorCode.PreviewsDataApiFailure}}function Nt(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}function Ut(e){let t=50*Math.floor(e/50);t+50-e<15&&(t+=50);return[t,t+50]}const Kt=e=>({data:e}),zt=e=>({error:e}),$t=(e,l,c,u)=>{var p;const v=r.useDispatch(),[g,_]=n.React$1.useState(!1),w=c(a.usePreviewKeySelector(a.getRivieraData,l)),f=a.usePreviewKeySelector(a.getPreviewMetadata,l),m=null===(p=a.useFileViewerSelector(a.getFilePreviewSession,e))||void 0===p?void 0:p.file_preview_session_id;return n.React$1.useEffect((()=>{if(f){const r=f.content,n={fileViewerId:e,previewSessionId:m,extra:{preview_type:f.previewType}};i.__awaiter(void 0,void 0,void 0,(function*(){v(st(Object.assign({event:o.SessionEventType.FilePreviewDownloadAttempted},n))),d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_GET_RIVIERA_DATA_START_START);const e=w?Kt(w):yield u(r,f.preview_url);if(d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_GET_RIVIERA_DATA),e.error){const i=Lt(e.error)?e.error:new nt(t.FVErrorCode.RivieraDataFetchFailure,t.ErrorLifecycle.Download,e.error.message);v(ze({previewKey:l,previewType:s.PreviewType.Error,error:i}))}else v(st(Object.assign({event:o.SessionEventType.FilePreviewDownloadSucceeded},n))),v($e({previewKey:l,data:e.data}));_(!0)}))}}),[l,null==f?void 0:f.content,null==f?void 0:f.preview_url]),g?w:void 0},Bt=(e,r)=>$t(e,r,a.filterArchivePreviewRivieraData,((e,n)=>i.__awaiter(void 0,void 0,void 0,(function*(){if(l.isNestedArchiveFilePreviewKey(r))return zt(new nt(t.FVErrorCode.NestedFiletypeNotSupported,t.ErrorLifecycle.Download));if(!n)return zt(new nt(t.FVErrorCode.MissingContentMetadata,t.ErrorLifecycle.Download,"Content metadata is not present"));const e=yield jt.fetchArchiveTopLevelData(n);return e.error?e:Kt((i=e.data,{entries:xt(i),isPasswordProtected:!!i.isEncrypted}));var i})))),Wt=e=>r=>i.__awaiter(void 0,void 0,void 0,(function*(){return l.isNestedArchiveFilePreviewKey(e)?zt(new nt(t.FVErrorCode.NestedFiletypeNotSupported,t.ErrorLifecycle.Download)):"video"===(null==r?void 0:r[".tag"])&&r.metadata_url?(n=r.metadata_url,a=r.transcript_url,o=kt(r),i.__awaiter(void 0,void 0,void 0,(function*(){var e;const[t,i]=yield Promise.all([jt.fetchMediaMetadata(n),a?jt.fetchTranscriptData(a,o):void 0]);return t.error?t:Kt({isTruncated:t.data.is_truncated,transcript:(null==i?void 0:i.data)?gt(Object.assign({segments:null!==(e=i.data.segments)&&void 0!==e?e:[]},i.data)):(null==i?void 0:i.error)?vt(i.error):void 0,waveformData:void 0})}))):"audio"===(null==r?void 0:r[".tag"])&&r.waveform_url?((e,t,r)=>i.__awaiter(void 0,void 0,void 0,(function*(){var i;const[n,a]=yield Promise.all([jt.fetchWaveformData(e),t?jt.fetchTranscriptData(t,r):void 0]);if(n.error)return n;const o=(null==a?void 0:a.data)?gt(Object.assign({segments:null!==(i=a.data.segments)&&void 0!==i?i:[]},a.data)):(null==a?void 0:a.error)?vt(a.error):void 0;return Kt({waveformData:n.data.waveformHeights,isTruncated:void 0,transcript:o})})))(r.waveform_url,r.transcript_url,kt(r)):zt(new nt(t.FVErrorCode.MissingContentMetadata,t.ErrorLifecycle.Download,"Content metadata is not present"));var n,a,o})),Ht=(e,t)=>{var i;const s=r.useDispatch(),l=a.usePreviewKeySelector(a.getPreviewMetadata,t),c=null===(i=a.useFileViewerSelector(a.getFilePreviewSession,e))||void 0===i?void 0:i.file_preview_session_id;return n.React$1.useMemo((()=>{if(null==l?void 0:l.previewType){d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_GET_RIVIERA_DATA_START_START);const t={fileViewerId:e,previewSessionId:c,extra:{preview_type:l.previewType}};return s(st(Object.assign({event:o.SessionEventType.FilePreviewDownloadAttempted},t))),s(st(Object.assign({event:o.SessionEventType.FilePreviewDownloadSucceeded},t))),d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_GET_RIVIERA_DATA),{}}}),[null==l?void 0:l.previewType,e,s,c])},qt=at("PreviewArchive",(()=>new Promise((function(t,i){e(["./c_file_viewer_preview_archive"],t,i)})))),Gt=e=>{const{fileViewerId:t,previewKey:i}=e,r=Bt(t,i);return n.React$1.createElement(qt,Object.assign({},e,{rivieraData:r}))};Gt.displayName="AsyncPreviewArchiveWithRivieraFetch";const Zt=at("PreviewDoc",(()=>new Promise((function(t,i){e(["./c_file_viewer_preview_doc"],t,i)})))),Xt=e=>{const{fileViewerId:r,previewKey:o}=e,s=((e,r)=>$t(e,r,a.filterDocPreviewRivieraData,(e=>i.__awaiter(void 0,void 0,void 0,(function*(){if(!e||"cloud_doc"!==e[".tag"]&&"ssr_doc"!==e[".tag"]||!e.image_url_tmpl||!e.text_url_tmpl)return zt(new nt(t.FVErrorCode.MissingContentMetadata,t.ErrorLifecycle.Download,"Content metadata is not present"));const[i,r]=Ut(0);return yield jt.fetchPageDataWithMetadata({textUrlTmpl:e.text_url_tmpl,imageUrlTmpl:e.image_url_tmpl,supportedWidths:"supported_widths"in e?e.supported_widths:void 0},i,r,void 0)})))))(r,o);return n.React$1.createElement(Zt,Object.assign({},e,{rivieraData:s}))};Xt.displayName="AsyncPreviewDocWithRiviera";const Yt=at("PreviewImage",(()=>new Promise((function(t,i){e(["./c_file_viewer_preview_image"],t,i)})))),Qt=e=>{const{fileViewerId:t,previewKey:i}=e,r=Ht(t,i);return n.React$1.createElement(Yt,Object.assign({},e,{rivieraData:r}))},Jt=at("PreviewAudioVideo",(()=>new Promise((function(t,i){e(["./c_file_viewer_preview_audio_video_preview_video"],t,i)})).then((function(e){return e.preview_video_esnext})))),ei=e=>{const{fileViewerId:o,previewKey:c}=e,d=(e=>{var o;const c=r.useDispatch(),d=null===(o=a.usePreviewKeySelector(a.getPreviewMetadata,e))||void 0===o?void 0:o.content,u=a.filterAudioVideoRivieraData(a.usePreviewKeySelector(a.getRivieraData,e));return n.React$1.useEffect((()=>{i.__awaiter(void 0,void 0,void 0,(function*(){const i=l.isNestedArchiveFilePreviewKey(e)?{error:new nt(t.FVErrorCode.NestedFiletypeNotSupported,t.ErrorLifecycle.Render)}:u?{data:u}:yield Wt(e)(d);i.data?c($e({previewKey:e,data:i.data})):c(ze({previewKey:e,previewType:s.PreviewType.Error,error:Lt(i.error)?i.error:new nt(t.FVErrorCode.RivieraDataFetchFailure,t.ErrorLifecycle.Render,i.error.message)}))}))}),[e,d,c,u]),u})(c),u=Ht(o,c);return n.React$1.createElement(Jt,Object.assign({},e,{rivieraData:u?d:void 0}))};ei.displayName="AsyncPreviewAudioVideoWithRivieraFetch";const ti=at("PreviewLinkfile",(()=>new Promise((function(t,i){e(["./c_file_viewer_preview_linkfile"],t,i)})))),ii=e=>{const{fileViewerId:t,previewKey:r}=e,o=((e,t)=>$t(e,t,a.filterLinkfileRivieraData,(e=>i.__awaiter(void 0,void 0,void 0,(function*(){if("linkfile"!==(null==e?void 0:e[".tag"])||!e.url)return Kt({uri:void 0});const{url:t,authenticated:i}=e,r=yield jt.fetchLinkfileData(t,!!i);return r.error?r:Kt({uri:r.data.uri})})))))(t,r);return n.React$1.createElement(ti,Object.assign({},e,{rivieraData:o}))};ii.displayName="AsyncPreviewLinkfileWithRivieraFetch";const ri=at("PreviewExcel",(()=>new Promise((function(t,i){e(["./c_file_viewer_preview_excel_renderer"],t,i)})))),ni=e=>{const{fileViewerId:r,previewKey:o}=e,s=((e,r)=>$t(e,r,a.filterExcelRivieraData,(e=>i.__awaiter(void 0,void 0,void 0,(function*(){if("excel"!==(null==e?void 0:e[".tag"])||!e.workbook_data_url_tmpl)return zt(new nt(t.FVErrorCode.MissingContentMetadata,t.ErrorLifecycle.Download,"Content metadata is not present"));const i=yield jt.fetchExcelWorkbookLayoutData(e.workbook_data_url_tmpl,0);return i.error?i:Kt({sheets:{0:gt(i.data.sheets[0])},workbook:Et(i.data)})})))))(r,o);return n.React$1.createElement(ri,Object.assign({},e,{rivieraData:s}))};ni.displayName="AsyncPreviewExcelWithRivieraFetch";const ai=at("PreviewExcelViewOnlyEmbed",(()=>new Promise((function(t,i){e(["./c_preview_excel_ms_embed_view_only_embed"],t,i)})))),oi=at("PreviewHTML",(()=>new Promise((function(t,i){e(["./c_file_viewer_preview_html"],t,i)})))),si=e=>{const{fileViewerId:t,previewKey:i}=e,r=Ht(t,i);return n.React$1.createElement(oi,Object.assign({},e,{rivieraData:r}))};si.displayName="AsyncPreviewHTMLWithRivieraFetch";const li=at("PreviewCloudDoc",(()=>new Promise((function(t,i){e(["./c_file_viewer_preview_cloud_doc"],t,i)})))),ci=e=>{const{fileViewerId:t,previewKey:i}=e,r=Ht(t,i);return n.React$1.createElement(li,Object.assign({},e,{rivieraData:r}))};ci.displayName="AsyncPreviewCloudDocWithRivieraFetch";const di=at("PreviewError",(()=>new Promise((function(t,i){e(["./c_file_viewer_preview_error"],t,i)})))),ui=e=>{const{children:t,className:i}=e,{nodeRef:o,contentRect:s}=a.useContentRect();return n.reactExports.createElement("div",{className:r.cx("_container_1q5wf_1",i),ref:o,id:"fvsdk-container"},s&&(null==t?void 0:t(s)))};ui.displayName="Preview";const pi=e=>{var i;const{pluginProps:r,previewKey:o}=e,l=a.usePreviewKeySelector(a.getFileMetadata,o),c=a.usePreviewKeySelector(a.getPreviewMetadata,o),d=null==c?void 0:c.previewType;switch(d){case s.PreviewType.Image:return n.reactExports.createElement(Qt,Object.assign({},e,{pluginProps:r,key:o.serialized}));case s.PreviewType.SsrDoc:case s.PreviewType.CloudDoc:return fe(c)?n.reactExports.createElement(ci,Object.assign({},e,{pluginProps:r,key:o.serialized})):(null===(i=null==l?void 0:l.file_name)||void 0===i?void 0:i.endsWith(".gsheet"))?n.reactExports.createElement(si,Object.assign({},e,{pluginProps:r,isRawHtml:!0,key:o.serialized})):n.reactExports.createElement(Xt,Object.assign({},e,{pluginProps:r,key:o.serialized}));case s.PreviewType.Video:case s.PreviewType.Audio:return n.reactExports.createElement(ei,Object.assign({},e,{isAudio:d===s.PreviewType.Audio,pluginProps:r,key:o.serialized}));case s.PreviewType.Excel:if("ms_view_embed"===e.config.excel_support.embed_support)return n.reactExports.createElement(ai,Object.assign({},e,{pluginProps:r,key:o.serialized}));if("excel1"===e.config.excel_support.support)return n.reactExports.createElement(si,Object.assign({},e,{pluginProps:r,isRawHtml:!1,key:o.serialized}));if("excel2"===e.config.excel_support.support)return n.reactExports.createElement(ni,Object.assign({},e,{pluginProps:r,key:o.serialized}));break;case s.PreviewType.HTML:case s.PreviewType.RawHTML:return n.reactExports.createElement(si,Object.assign({},e,{pluginProps:r,isRawHtml:d===s.PreviewType.RawHTML,key:o.serialized}));case s.PreviewType.Archive:return n.reactExports.createElement(Gt,Object.assign({},e,{pluginProps:r,key:o.serialized}));case s.PreviewType.Linkfile:return n.reactExports.createElement(ii,Object.assign({},e,{pluginProps:r,key:o.serialized}));case s.PreviewType.Error:return n.reactExports.createElement(di,Object.assign({error:(null==c?void 0:c.error)||new nt(t.FVErrorCode.Unknown,t.ErrorLifecycle.Render)},e))}return n.reactExports.createElement(di,Object.assign({error:new nt(t.FVErrorCode.UnsupportedPreviewType,t.ErrorLifecycle.Render)},e))};function vi(e,t){var i;return null===(i=gi(e,t))||void 0===i?void 0:i.activeRightRailPluginId}function gi(e,t){return e.plugins[t]||null}function _i(e,t){return!!function(e,t){var i;return null===(i=gi(e,t))||void 0===i?void 0:i.activeEditPluginId}(e,t)}function wi(e,t){var i;return null===(i=gi(e,t))||void 0===i?void 0:i.hideContentPanePluginId}function fi(e,t){var i;const r=null===(i=a.getFileViewerUi(e,t))||void 0===i?void 0:i.toolbar;if(null==r?void 0:r.override){if("fvsdk"===r.overridePluginId)return r.override;const i=vi(e,t);if(r.overridePluginId===i)return r.override}}function mi(e,t){var i;return!!(null===(i=a.getFileViewerUi(e,t))||void 0===i?void 0:i.isToolbarRenameActive)}function yi(e,t){return{isRightRailVisible:!!a.isRightRailOpen(e,t)}}function bi(e,t){const i=a.getRootPreviewUI(e,t);if(null==i)return null;const r=a.filterZoomableFilePreviewUi(i);if(null==r)return null;return{scaleFactor:a.getScaleFactorFromFilePreviewUi(r)}}function hi(e,t){var i,r,n;const o=yi(e,t);if(null==o)return null;const s=bi(e,t);if(null==s)return null;const l=a.getRootPreviewUI(e,t);if(null==l)return null;const c=null!==(r=null===(i=a.filterDocFilePreviewUiState(l))||void 0===i?void 0:i.currentPageIndex)&&void 0!==r?r:null;if(null==c)return null;const d=!!(null===(n=a.getFileViewerUi(e,t))||void 0===n?void 0:n.isDocSidebarOpen);return Object.assign(Object.assign(Object.assign({},o),s),{currentPageIndex:c,isNavBarVisible:d})}function Ei(e,t){const i=yi(e,t);if(null==i)return null;const r=bi(e,t);return null==r?null:Object.assign(Object.assign({},i),r)}function xi(e,t){return{isRightRailVisible:!!a.isRightRailOpen(e,t)}}function Si(e,t,i){const r=function(e,t){const i=yi(e,t);if(null==i)return null;const r=a.getRootPreviewUI(e,t);if(null==r)return null;const n=a.filterAudioVideoFilePreviewUiState(r);if(null==n)return null;const{currentTimestamp:o,isPlaying:s,isDefaultAudioTrackSelected:l}=n;return Object.assign(Object.assign({},i),{currentTimestamp:o,isPlaying:s,isDefaultAudioTrackSelected:l})}(t,e);return null!=i.file&&null!=r?Object.assign(Object.assign({},i),{file:i.file,ui:r}):null}function Pi(e,t,i){const r=function(e,t){return yi(e,t)}(t,e);return null!=i.file&&null!=r?Object.assign(Object.assign({},i),{file:i.file,ui:r}):null}function Oi(e,t,i){if(!i)return null;switch(i.previewType){case s.PreviewType.CloudDoc:case s.PreviewType.SsrDoc:return function(e,t,i){const r=hi(t,e);return null!=i.file&&null!=r?Object.assign(Object.assign({},i),{file:i.file,ui:r}):null}(t,e,i);case s.PreviewType.Image:return function(e,t,i){const r=Ei(t,e);return null!=i.file&&null!=r?Object.assign(Object.assign({},i),{file:i.file,ui:r}):null}(t,e,i);case s.PreviewType.Audio:case s.PreviewType.Video:return Si(t,e,i);case s.PreviewType.Archive:return Pi(t,e,i);default:return function(e,t,i){const r=yi(t,e);return null!=i.file?Object.assign(Object.assign({},i),{file:i.file,ui:r}):null}(t,e,i)}}function Ii(e,t,i){if(!i)return;const r=function(e,t,i){switch(i){case s.PreviewType.SsrDoc:case s.PreviewType.CloudDoc:{const i=hi(e,t);return null!=i?i:xi(e,t)}case s.PreviewType.Image:{const i=Ei(e,t);return null!=i?i:xi(e,t)}default:{const i=yi(e,t);return null!=i?i:xi(e,t)}}}(e,t,i.previewType);return Object.assign(Object.assign({},i),{ui:r})}pi.displayName="PreviewRenderer",pi.displayName="PreviewRenderer";const Ti=(e,t)=>{const i=a.getRootFile(e,t);if(null==i)return null;const{file_id:r,ns_id:n,sj_id:o,url:s}=i;if(null==r||null==n||null==o)return null;const l=a.getFileMetadata(e,i.previewKey);if(null==l)return null;const{file_name:c,file_path:d,file_last_modified_date:u,size:p}=l;return{fileId:r,lastModifiedDate:u,name:c,nsId:n,fqPath:d,sjId:o,url:s,size:p,previewKey:i.previewKey}},Ri=(e,t,i)=>{var r;const n=a.getPreviewMetadata(e,t.previewKey),o=null===(r=a.getFileContentMetadata(e,t.previewKey))||void 0===r?void 0:r.metadata,s="image"===(null==o?void 0:o[".tag"])?o:null,l=a.filterDimensionsFilePreviewUiState(a.getFilePreviewUi(e,i,t.previewKey));return Object.assign(Object.assign({},t),{dimensions:(null==n?void 0:n.dimensions)||(null==l?void 0:l.dimensions),contentMetadata:s})},Fi=(e,t)=>{var i;const r=a.filterDocPreviewRivieraData(a.getRivieraData(e,t.previewKey));if(null==r||0===Object.getOwnPropertyNames(r).length)return null;const n=null===(i=a.getFileContentMetadata(e,t.previewKey))||void 0===i?void 0:i.metadata,o="ms_office"===(null==n?void 0:n[".tag"])||"pdf"===(null==n?void 0:n[".tag"])?n:null;return Object.assign(Object.assign({},t),{pages:r.pages.map((({dimension:[e,t],pageIndex:i})=>({pageIndex:i,dimensions:{width:e,height:t}}))),contentMetadata:o,isPasswordProtected:r.isPasswordProtected})},Ci=(e,t)=>{var i;const r=null===(i=a.getFileContentMetadata(e,t.previewKey))||void 0===i?void 0:i.metadata,n="audio"===(null==r?void 0:r[".tag"])||"video"===(null==r?void 0:r[".tag"])?r:null,o=a.getVideoTranscriptData(e,t.previewKey);return Object.assign(Object.assign({},t),{contentMetadata:n,transcript:o})},ji=(e,t)=>Object.assign(Object.assign({},t),{contentMetadata:null}),ki=e=>Object.assign(Object.assign({},e),{contentMetadata:null}),Di=e=>Object.assign(Object.assign({},e),{contentMetadata:null}),Vi=(e,t)=>{const i=a.getRootFile(e,t);if(null!=i)return i.previewKey};function Ai(e,t){const{fileViewerId:i,navigation:r}=t,n=a.getRootFile(e,i),o=a.getPreviewMetadata(e,null==n?void 0:n.previewKey),l={navigation:r,sharedLinkInfo:a.getSharedLinkInfo(e,i),previewData:o},c=Ti(e,i);if(!c)return Object.assign({previewType:s.PreviewType.Loading,file:null},l);const d=Di(c);if(!o)return Object.assign({previewType:s.PreviewType.Loading,file:d},l);const u=o.previewType;switch(u){case s.PreviewType.Image:const t=Ri(e,c,i);if(t)return Object.assign({previewType:u,file:t},l);break;case s.PreviewType.SsrDoc:case s.PreviewType.CloudDoc:const r=Fi(e,c);if(r)return Object.assign({previewType:u,file:r},l);break;case s.PreviewType.Audio:case s.PreviewType.Video:const n=Ci(e,c);if(n)return Object.assign({previewType:u,file:n},l);break;case s.PreviewType.Archive:const a=ji(e,c);if(a)return Object.assign({previewType:u,file:a},l);break;case s.PreviewType.HTML:return Object.assign({previewType:u,file:ki(c)},l);case s.PreviewType.Error:case s.PreviewType.Loading:default:return Object.assign({previewType:u,file:d},l)}return Object.assign({previewType:s.PreviewType.Other,file:d},l)}r.injectInternalStyle("js/file_viewer/right_rail/right_rail.module.out.css",(e=>"._rightRailContainer_4jer5_1{border-left:1px solid var(--color__standard__border);box-sizing:unset}._skeletonCollapsed_4jer5_7,._skeletonExpanded_4jer5_8{background-color:var(--color__standard__background);border-left:1px solid var(--color__standard__border);box-sizing:border-box;height:100%}._skeletonCollapsed_4jer5_7{width:56px}._skeletonExpanded_4jer5_8{width:328px}._previewRightRailWrapper_4jer5_23{height:100%;position:relative}._editPluginContainer_4jer5_28{background-color:var(--color__inverse__standard__background);height:100%;width:328px}@media (max-width:833px){._previewRightRailWrapper_4jer5_23 ._rightRailContainer_4jer5_1{display:none}}._overlay_4jer5_41{height:100%;left:0;pointer-events:all;position:absolute;top:0;width:100%;z-index:999}._overlay_4jer5_41._transparent_4jer5_51{pointer-events:none}"));const Li="_previewRightRailWrapper_4jer5_23",Mi=({Sidebar:e,fileViewerId:t,pluginNavigation:i})=>{const a=r.useSelector((e=>Ai(e,{fileViewerId:t,navigation:i}))),o=r.useSelector((e=>Oi(e,t,a)));return o?n.React$1.createElement("div",{className:"_editPluginContainer_4jer5_28"},n.React$1.createElement(e,Object.assign({},o))):null};Mi.displayName="EditPluginSidebar";r.injectInternalStyle("js/file_viewer/ui/ui.module.out.css",(e=>":root{--abovePreviewZIndex:10;--overlay_start:transparent;--overlay:var(--color__utility__overlay)}._close_5e2zk_11{position:absolute;right:0;top:0;z-index:var(--abovePreviewZIndex)}._overlay_5e2zk_18{background-color:var(--overlay_start);transition:background-color var(--duration__333) var(--easing__linear)}._overlay_5e2zk_18._active_5e2zk_23{background-color:var(--overlay)}@media (prefers-reduced-motion:reduce){._overlay_5e2zk_18,._slideTransition_5e2zk_28{transition:none}}._snackbar_5e2zk_34{bottom:10px;display:flex;justify-content:center;min-width:600px;position:fixed;z-index:500}"));const Ni=({active:e,className:t,style:i,children:a})=>n.React$1.createElement("div",{className:r.cx(t,"_overlay_5e2zk_18",{_active_5e2zk_23:e}),style:i},a);Ni.displayName="OverlayTransition";const Ui=({active:e,children:t,className:i,direction:a,start:o=0,end:s,offScreenElement:l=!0})=>{const c=n.React$1.useMemo((()=>({transitions:[{property:a,value:s},{property:"opacity",value:l?1:0}],duration:333,easing:l?"enter":"leave"})),[a,s,l]),d=n.React$1.useMemo((()=>({transitions:[{property:a,value:o},{property:"opacity",value:l?0:1}],duration:333,easing:l?"leave":"enter"})),[a,o,l]);return n.React$1.createElement(r.Motion,{in:e,transitionIn:c,transitionOut:d},(({style:e})=>n.React$1.createElement("div",{style:e,className:r.cx("_slideTransition_5e2zk_28",i)},t)))};Ui.displayName="SlideTransition";const Ki=()=>{},zi=n.React$1.memo((({fileViewerId:e,fileName:t,pluginInstances:i,pluginNavigation:s,defaultRightRailPlugin:l})=>{const c=r.useDispatch();d.useMarkTimingEventOnMount(d.PreviewsTimingEvents.FVSDK_RIGHT_RAIL_MOUNT);const u=a.useFileViewerSelector(a.isRightRailOpen,e),p=r.useSelector((t=>s&&Ai(t,{fileViewerId:e,navigation:s}))),v=r.useSelector((t=>Oi(t,e,p))),_=r.useSelector((t=>Ii(t,e,p))),w=a.useFileViewerSelector(a.getIsEditingVideo,e),f=r.useSelector((t=>{var r;if(!i)return;const n=vi(t,e);if(Object.entries(i).find((e=>e[0]===n)))return n;const a=Object.entries(i).find((e=>e[0]===l))||(null===(r=Object.entries(i))||void 0===r?void 0:r[0]);return a?(c(He({fileViewerId:e,sourceContext:o.UserActionContext.Default,pluginId:a[0]})),a[0]):void 0})),m=n.React$1.useCallback((t=>{t===f&&u||(t!==f&&c(He({pluginId:t,fileViewerId:e,sourceContext:o.UserActionContext.RightRail})),c(Le({fileViewerId:e,sourceContext:o.UserActionContext.RightRail})))}),[c,e,f,u]),y=n.React$1.useCallback((()=>{const t={fileViewerId:e,sourceContext:o.UserActionContext.RightRail};c(Le(t))}),[c,e]),b=n.reactExports.useCallback((()=>{c(Me({fileViewerId:e,sourceContext:o.UserActionContext.RightRail}))}),[c,e]),h=n.React$1.useCallback((e=>{m(e),y()}),[m,y]);if(void 0===u)return null;if(void 0===i||null===v||void 0===_||void 0===f)return n.React$1.createElement("div",{className:Li},n.React$1.createElement("div",{className:u?"_skeletonExpanded_4jer5_8":"_skeletonCollapsed_4jer5_7"}));const E=Object.entries(i).map((([e,{rightRailUI:{Sidebar:t}}])=>n.React$1.createElement(t,Object.assign({},v,{key:`plugin-sidebar-${e}`})))),x=Object.entries(i).map((([e,{rightRailUI:{Control:t}}])=>n.React$1.createElement(t,Object.assign({},_,{isSelectedPlugin:e===f,onClick:Ki,key:`plugin-control-${e}`}))));return n.React$1.createElement("div",{className:Li,"data-testid":"fv-sdk-right-rail"},n.React$1.createElement(g.RightRail.RightRailWrapper,{isExpanded:u,withTitle:t,onCollapse:b,expandedBlade:f,className:"_rightRailContainer_4jer5_1",onExpandBlade:u?m:h,onExpand:y,expandedChildren:E,collapsedChildren:x}),n.React$1.createElement(Ni,{active:w,className:r.cx("_overlay_4jer5_41",{_transparent_4jer5_51:!w})}))}));zi.displayName="PreviewRightRail",zi.displayName="PreviewRightRail";r.injectInternalStyle("js/file_viewer/preview_core.module.out.css",(e=>"._app_m8kvz_5{align-items:flex-end;display:flex;flex-grow:1;height:100%;justify-content:center;position:relative;width:100%}._app_m8kvz_5 ._toolbar_m8kvz_16{bottom:16px;opacity:0;position:absolute;transition:opacity .3s,.3s;z-index:-1}._app_m8kvz_5 ._toolbar_m8kvz_16:focus-within,._app_m8kvz_5:hover ._toolbar_m8kvz_16{opacity:1;transition:opacity .3s .01s;z-index:1}._is-full-screen_m8kvz_35{background-color:var(--dig-color__secondary__base)}@media (max-width:600px){._app_m8kvz_5{width:100%!important}}"));const $i="_is-full-screen_m8kvz_35";r.injectInternalStyle("js/file_viewer/preview_content/preview_content.module.out.css",(e=>"._loadingContent_9oi8y_1{align-items:center;display:flex;flex:1;justify-content:center}._previewContent_9oi8y_8{align-items:stretch;display:flex;flex:1;flex-direction:column;max-height:100%;max-width:100%;position:relative;width:100%}._editMode_9oi8y_19{background-color:var(--color__inverse__standard__background)}._previewContentWrapper_9oi8y_23{display:flex;height:100%;position:relative;width:100%}._hidden_9oi8y_30{display:none}@media (max-width:600px){._loadingContent_9oi8y_1{width:100%!important}}"));const Bi="_hidden_9oi8y_30";r.injectInternalStyle("js/file_viewer/preview_doc/preview_doc.module.out.css",(e=>":root{--page-margin:16px;--page-margin-top:24px;--page-margin-left:24px;--page-ppt-margin-bottom:100px}._textbox_1titd_17{fill:transparent;cursor:text;opacity:.4;pointer-events:auto;-webkit-user-select:text;user-select:text}._textLayer_1titd_22{left:0;mix-blend-mode:multiply;pointer-events:none;position:absolute;top:0;transform-origin:top left}._textLayer_1titd_22 ::selection{background:var(--color__inverse__attention__background)}._textLayer_1titd_22 text::selection{color:transparent}._linksLayer_1titd_42{bottom:0;height:0;left:0;position:absolute;transform-origin:top left;width:0}._linksLayer_1titd_42 ._internalLink_1titd_52,._linksLayer_1titd_42 a{cursor:pointer;display:block}._linksLayer_1titd_42 ._internalLink_1titd_52:focus,._linksLayer_1titd_42 a:focus,._textbox_1titd_17 a:focus{outline:auto}._imgLayer_1titd_63{height:100%;overflow:hidden;position:relative;width:100%}._imgLayer_1titd_63>img{background:#fff;display:block;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges;image-rendering:optimizeQuality;max-width:100%;pointer-events:auto;-webkit-user-select:none;user-select:none}.sc-annotation-conductor-layer ._imgLayer_1titd_63>img{pointer-events:auto}._snackbar_1titd_90{bottom:0;left:0;margin:auto;position:absolute;right:0;width:100%;z-index:1}._page_1titd_100{margin:var(--page-margin)}._pdfViewport_1titd_104 ._page_1titd_100{margin:0;position:absolute;top:0}._pptViewport_1titd_110 ._page_1titd_100{background-color:#fff;box-sizing:border-box;flex-shrink:0;margin:auto;position:relative}._pptViewport_1titd_110{-ms-overflow-style:-ms-autohiding-scrollbar;height:100%;overflow:auto;position:relative}._pptSizer_1titd_128,._pptViewport_1titd_110{display:flex;width:100%}._pptSizer_1titd_128{height:calc(100% - var(--page-ppt-margin-bottom))}._pptFullSizer_1titd_134{height:100%}._pdfViewport_1titd_104{height:100%;overflow:auto;width:100%}._container_1titd_144{align-items:stretch;display:flex;height:100%;justify-content:flex-start;overflow:hidden;width:100%}._container_1titd_144 ol{list-style:none}._pdfViewport_1titd_104 ol,._pptViewport_1titd_110 ol{padding:0}._pdfViewport_1titd_104 li{margin:var(--spacing__unit--2) 0;position:absolute;top:0}._pdfViewport_1titd_104 ol{align-items:center;display:flex;flex-direction:column;overflow:hidden;position:relative}._close_1titd_176{right:16px}"));r.injectInternalStyle("js/file_viewer/preview_doc/renderer/doc_sidebar.module.out.css",(e=>":root{--thumbnailWidth:112px;--imgZIndex:1;--sidebar-width:168px}._container_4llxd_13{flex-shrink:0;font-size:var(--type__body__standard--fontsize);height:100%;outline:none;overflow:auto;transition:width 40ms;width:0;will-change:width}._container_4llxd_13._open_4llxd_24{width:var(--sidebar-width)}._container_4llxd_13._open_4llxd_24._containerBorder_4llxd_28{border-right:1px solid var(--color__standard__border)}._container_4llxd_13 ol{border:none;box-sizing:border-box;height:100%;list-style:none;margin:0;overflow:hidden;padding:var(--spacing__unit--3) 0 0 0;position:relative}._container_4llxd_13 li{position:absolute;top:0;transform:translateX(-50%)}._container_4llxd_13 li a:any-link{align-items:flex-start;box-sizing:border-box;color:var(--color__standard__text);display:flex;flex-direction:column;justify-content:flex-start;margin-bottom:16px;outline:none;padding:0 0 0 28px;position:relative;text-decoration:none}._container_4llxd_13._isEditMode_4llxd_70 li a:any-link{color:var(--color__inverse__standard__text)}._thumbnail_4llxd_74{border:4px solid transparent;font-size:0;line-height:0;margin:0 0 4px -4px;position:relative;width:var(--thumbnailWidth)}._thumbnail_4llxd_74 img{position:absolute;width:100%;z-index:var(--imgZIndex)}._thumbnail_4llxd_74 ._loader_4llxd_91{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}._thumbnail_4llxd_74._selected_4llxd_100{border-color:var(--color__standard__border)}._container_4llxd_13._focused_4llxd_104 ._thumbnail_4llxd_74._selected_4llxd_100{border-color:var(--color__core__accent)}._thumbnail_4llxd_74._isUnfocusedInEditMode_4llxd_108._selected_4llxd_100{border-color:var(--color__inverse__standard__border)}"));const Wi="168px",Hi=parseInt("16px",10),qi=parseInt("24px",10),Gi=parseInt("100px",10),Zi=parseInt("24px",10),Xi=parseInt(Wi,10),Yi=Xi+600,Qi=[...p.PDF_EXTS,...p.WORDPROC_EXTS];function Ji(e){return p.PRESENTATION_EXTS.includes(y(e))}function er(e,t){return e>=Yi&&(t===s.PreviewType.SsrDoc||t===s.PreviewType.CloudDoc)}function tr(e){const{width:t,height:i,dimensions:r,isDocSidebarVisible:n,scaleToFit:a,toolbarShown:o,fileName:s,maxWidth:l}=e;if(0===r.length)return 1;const c=Math.max(0,t-Hi-Zi-(n?Xi:0)-30),d=Ji(s)&&!o?Math.max(0,i-qi-Gi):Math.max(0,i-qi),u=null!=l?Math.min(c,l):c,p=d,v=Qi.includes(y(s)),g="width_and_height"===a&&!v,_=r.reduce(((e,[t,i])=>Math.min(e,u/t,g?p/i:Number.POSITIVE_INFINITY)),Number.POSITIVE_INFINITY);return Math.min(_,g?Number.POSITIVE_INFINITY:1.75)}const ir={docSidebar:!1,fileFlipping:!1,fullscreen:!1,pageNavigation:!1,print:!1,zooming:!1,findInDocument:!1},rr=e=>{switch(e){case s.PreviewType.SsrDoc:case s.PreviewType.CloudDoc:return{docSidebar:!0,fullscreen:!1,pageNavigation:!0,print:!1,zooming:!0,fileFlipping:!1,findInDocument:!1};case s.PreviewType.Image:return{docSidebar:!1,fullscreen:!1,pageNavigation:!1,print:!1,zooming:!0,fileFlipping:!1,findInDocument:!1};default:return{docSidebar:!1,fullscreen:!1,pageNavigation:!1,print:!1,zooming:!1,fileFlipping:!1,findInDocument:!1}}},nr=(e,t,i)=>{const r=((e,t)=>({docSidebar:!e.preview_content_only,fileFlipping:e.file_flipping,fullscreen:e.enable_fullscreen,print:t.enable_print||!1}))(t,i),n=(e=>{switch(e){case s.PreviewType.SsrDoc:return{docSidebar:!0,fullscreen:!0,pageNavigation:!0,print:!0,zooming:!0,findInDocument:!0};case s.PreviewType.CloudDoc:return{docSidebar:!0,fullscreen:!0,pageNavigation:!0,print:!0,zooming:!0,findInDocument:!1};case s.PreviewType.Image:return{docSidebar:!1,fullscreen:!0,pageNavigation:!1,print:!0,zooming:!0,findInDocument:!1};case s.PreviewType.HTML:return{docSidebar:!1,fullscreen:!0,print:!0,findInDocument:!1};case s.PreviewType.RawHTML:return{docSidebar:!1,fullscreen:!0,print:!1,findInDocument:!1};case s.PreviewType.Excel:return{docSidebar:!1,fullscreen:!0,print:!0,zooming:!0,pageNavigation:!1,findInDocument:!1};default:return{docSidebar:!1,fullscreen:!1,pageNavigation:!1,print:!1,findInDocument:!1}}})(e);let a=ir;for(const e in ir){const t=e;t in r&&t in n?a=Object.assign(Object.assign({},a),{[t]:r[t]&&n[t]}):t in r&&!(t in n)?a=Object.assign(Object.assign({},a),{[t]:r[t]}):t in n&&!(t in r)&&(a=Object.assign(Object.assign({},a),{[t]:n[t]}))}return a},ar=(e,t)=>e===v.ResponsiveSize.MOBILE||t.mobile_web||t.force_no_toolbar,or=e=>{const t=n.reactExports.useRef(e);t.current=e;return n.reactExports.useRef(((...e)=>(0,t.current)(...e))).current},sr=e=>void 0!==e&&e.parent_files_count>=0?e:void 0,lr=({isShown:e,fileCollectionContext:t,flipperCallbacks:i})=>{const s=r.useDispatch(),l=u.useIntl(),{fileViewerId:c,previewKey:d,showInverse:p}=a.useToolbarControlsConfig(),v={fileViewerId:c,previewKey:d,sourceContext:o.UserActionContext.Toolbar},g=or((()=>{s(Ue(v))})),w=or((()=>{s(Ke(v))})),f=l.formatMessage({id:"5h/4QP",defaultMessage:"Next"}),m=l.formatMessage({id:"XlDsZ8",defaultMessage:"Previous"}),y=sr(t);if(void 0===y)return null;const b=0===y.file_index,h=y.file_index===y.parent_files_count-1;return n.React$1.createElement(n.React$1.Fragment,null,n.React$1.createElement(cr,{tooltip:m,onClick:w,className:r.cx(_.toolbarFlipperLeft,{[_.hidden]:!e,[_.isFullScreen]:!p}),icon:r.ChevronLeftLine,isDisabled:b,showInverse:!p,isShown:e,flipperCallbacks:i}),n.React$1.createElement(cr,{tooltip:f,onClick:g,className:r.cx(_.toolbarFlipperRight,{[_.hidden]:!e,[_.isFullScreen]:!p,[_.windowsScrollBar]:window.navigator.platform.match(/win/gi)}),icon:r.ChevronRightLine,isDisabled:h,showInverse:!p,isShown:e,flipperCallbacks:i}))};lr.displayName="FlipButtons",lr.displayName="FlipButtons";const cr=({className:e,tooltip:t,onClick:i,icon:a,isDisabled:o,showInverse:s,isShown:l,flipperCallbacks:c})=>n.React$1.createElement("div",{className:r.cx(_.toolbarFlipper,e,{[_.hidden]:!l})},n.React$1.createElement(r.Tooltip,{title:t,openDelay:500,shouldCloseOnClick:!0,inverse:!s},n.React$1.createElement(r.IconButton,Object.assign({variant:"filled",size:"large",onClick:i,"aria-label":t,disabled:o},c),n.React$1.createElement(r.UIIcon,{src:a}))));cr.displayName="FlipButton",cr.displayName="FlipButton";const dr=n.React$1.createContext({setFindInDocCallback:()=>{},setPrintCallback:()=>{},setSelectVideoQualityCallback:()=>{},setVideoPlayer:()=>{},setGetPageForSelection:()=>{}});function ur(e){return t=>e((()=>t))}const pr=e=>{const[t,i]=n.reactExports.useState(void 0),[r,a]=n.reactExports.useState(void 0),[o,s]=n.reactExports.useState(void 0),[l,c]=n.reactExports.useState(void 0),[d,u]=n.reactExports.useState(void 0),p=n.React$1.useMemo((()=>({videoPlayer:t,onFindInDoc:r,onPrint:o,onSelectVideoQuality:l,getPageForSelection:d,setFindInDocCallback:ur(a),setPrintCallback:ur(s),setSelectVideoQualityCallback:ur(c),setVideoPlayer:i,setGetPageForSelection:ur(u)})),[t,r,o,l,d]);return n.React$1.createElement(dr.Provider,{value:p},e.children)};pr.displayName="PreviewControlProvider";const vr=e=>{const{onFindInDoc:t,onPrint:i,onSelectVideoQuality:r,videoPlayer:a,getPageForSelection:o}=e,{setFindInDocCallback:s,setPrintCallback:l,setSelectVideoQualityCallback:c,setVideoPlayer:d,setGetPageForSelection:u}=n.reactExports.useContext(dr);return n.React$1.useEffect((()=>(t&&s(t),i&&l(i),r&&c(r),a&&d(a),o&&u(o),()=>{t&&(null==s||s(void 0)),i&&(null==l||l(void 0)),r&&(null==c||c(void 0)),a&&(null==d||d(void 0)),o&&u(void 0)})),[t,i,r,a]),n.React$1.createElement(n.React$1.Fragment,null,e.children)};vr.displayName="PreviewControlWrapper";const gr=()=>n.reactExports.useContext(dr),_r=({tooltipText:e,onClick:t,icon:i,disabled:o,closeTooltipOnClick:s=!1})=>{const{showInverse:l}=a.useToolbarControlsConfig(),c=n.reactExports.createElement(r.IconButton,{variant:"transparent","aria-label":e,disabled:o,onClick:t,style:o?{pointerEvents:"all"}:{},inverse:l},n.reactExports.createElement(r.UIIcon,{src:i}));return e?n.reactExports.createElement(r.Tooltip,{placement:"top",title:e,inverse:!l,shouldCloseOnClick:s},c):c};_r.displayName="ToolbarButton",_r.displayName="ToolbarButton";const wr=({scaleFactor:e})=>{const t=r.useDispatch(),i=u.useIntl(),{fileViewerId:s,previewKey:l}=a.useToolbarControlsConfig(),c=n.reactExports.useCallback((()=>t(Ie({fileViewerId:s,previewKey:l,sourceContext:o.UserActionContext.Toolbar}))),[s,l,t]);return n.reactExports.createElement(_r,{tooltipText:i.formatMessage({id:"QCtVKy",defaultMessage:"Zoom out"}),disabled:e<=.1,onClick:c,icon:r.ZoomOutLine})};wr.displayName="ZoomOutButton",wr.displayName="ZoomOutButton";const fr=({scaleFactor:e})=>{const t=r.useDispatch(),i=u.useIntl(),{fileViewerId:s,previewKey:l}=a.useToolbarControlsConfig(),c=or((()=>{t(Oe({fileViewerId:s,previewKey:l,sourceContext:o.UserActionContext.Toolbar}))}));return n.reactExports.createElement(_r,{tooltipText:i.formatMessage({id:"sMy5PN",defaultMessage:"Zoom in"}),disabled:e>=10,onClick:c,icon:r.ZoomInLine})};fr.displayName="ZoomInButton",fr.displayName="ZoomInButton";const mr=({scaleFactor:e,fittedScaleFactor:t})=>{const i=r.useDispatch(),s=u.useIntl(),{fileViewerId:l,previewKey:c,showInverse:d}=a.useToolbarControlsConfig(),p=or((()=>{i(Te({fileViewerId:l,previewKey:c,sourceContext:o.UserActionContext.Toolbar}))})),v=t&&e===t?s.formatMessage({id:"0AbCS6",defaultMessage:"View actual size"}):s.formatMessage({id:"OgNBqT",defaultMessage:"Zoom to fit"});return n.reactExports.createElement(r.Tooltip,{placement:"top",title:v,inverse:!d},n.reactExports.createElement(r.Button$1,{variant:"transparent","aria-label":v,className:_.toolbarZoomToFit,onClick:p,hasNoUnderline:!0,inverse:d},n.reactExports.createElement(r.Text,{color:d?"faint":"standard",inverse:d},e?s.formatNumber(e,{style:"percent",maximumFractionDigits:0}):"")))};mr.displayName="ZoomToFitButton",mr.displayName="ZoomToFitButton";const yr=({disabled:e=!1})=>{const t=r.useDispatch(),i=u.useIntl(),{fileViewerId:s,previewKey:l,isFullScreen:c}=a.useToolbarControlsConfig(),d=or((()=>{const e={fileViewerId:s,previewKey:l,sourceContext:o.UserActionContext.Toolbar};t(c?Ae(e):Ve(e))}));return n.reactExports.createElement(_r,{tooltipText:c?i.formatMessage({id:"1pq/ot",defaultMessage:"Exit fullscreen"}):i.formatMessage({id:"lQfB6H",defaultMessage:"Fullscreen"}),closeTooltipOnClick:!0,onClick:d,icon:c?r.FullscreenExitLine:r.FullscreenLine,disabled:e})};yr.displayName="FullScreenButton",yr.displayName="FullScreenButton";const br=({fileRivieraData:e,filePreviewUi:t})=>{var i,s,l,c;const d=r.useDispatch(),p=u.useIntl(),{fileViewerId:v,previewKey:g,showInverse:w}=a.useToolbarControlsConfig(),f={fileViewerId:v,previewKey:g,sourceContext:o.UserActionContext.Toolbar},m=null!==(s=null===(i=a.filterDocFilePreviewUiState(t))||void 0===i?void 0:i.currentPageIndex)&&void 0!==s?s:0,y=or((()=>{d(Pe(Object.assign({pageIndex:m-1},f)))})),b=or((()=>{d(Pe(Object.assign({pageIndex:m+1},f)))})),h=null===(c=null===(l=a.filterDocPreviewRivieraData(e))||void 0===l?void 0:l.metadata)||void 0===c?void 0:c.page_count;if(null==m||null==h)return null;const E=m+1,x="".padEnd((""+h).length-(""+E).length,"0");return n.reactExports.createElement(n.reactExports.Fragment,null,n.reactExports.createElement(_r,{disabled:m<1,onClick:y,tooltipText:p.formatMessage({id:"sago3n",defaultMessage:"Page up"}),icon:r.ChevronUpLine}),n.reactExports.createElement(r.Text,{color:w?"faint":"standard",className:_.pageDisplay,inverse:w},n.reactExports.createElement("span",{className:_.pageDisplayPadding},x),p.formatMessage({id:"t6aTtx",defaultMessage:"{currentPage, number} of {totalPages, number}"},{currentPage:E,totalPages:h})),n.reactExports.createElement(_r,{disabled:m>=h-1,onClick:b,tooltipText:p.formatMessage({id:"5Nekbe",defaultMessage:"Page down"}),icon:r.ChevronDownLine}))};br.displayName="PageNavigationControls",br.displayName="PageNavigationControls";const hr=({isSidebarOpen:e,disabled:t,isInMenu:i})=>{const s=r.useDispatch(),l=u.useIntl(),{fileViewerId:c}=a.useToolbarControlsConfig(),d=or((()=>{s(e?Ce({fileViewerId:c,sourceContext:o.UserActionContext.Toolbar}):Fe({fileViewerId:c,sourceContext:o.UserActionContext.Toolbar}))})),p=e?l.formatMessage({id:"ttmV3r",defaultMessage:"Hide sidebar"}):l.formatMessage({id:"NIm51y",defaultMessage:"Show sidebar"}),v=e?r.SidebarHideLine:r.SidebarShowLine;return i?n.reactExports.createElement(r.Menu.ActionItem,{onClick:d,disabled:t,preferComposition:!0},n.reactExports.createElement(r.Menu.RowAccessory,null,n.reactExports.createElement(r.UIIcon,{src:v})),n.reactExports.createElement(r.Menu.RowTitle,null,p)):n.reactExports.createElement(_r,{key:`sidebar-${e}`,tooltipText:p,onClick:d,icon:v,disabled:t})};hr.displayName="SidebarToggleButton",hr.displayName="SidebarToggleButton";const Er=({isMenuItem:e})=>{const t=r.useDispatch(),i=u.useIntl(),{fileViewerId:s,previewKey:l,previewType:c}=a.useToolbarControlsConfig(),{onPrint:d}=gr(),p=or((()=>{null==d||d(),t(De({fileViewerId:s,previewKey:l,previewType:c,sourceContext:o.UserActionContext.Toolbar}))})),v=i.formatMessage({id:"tBZioS",defaultMessage:"Print"});return e?n.reactExports.createElement(r.Menu.ActionItem,{onClick:p,preferComposition:!0},n.reactExports.createElement(r.Menu.RowAccessory,null,n.reactExports.createElement(r.UIIcon,{src:r.PrintLine})),n.reactExports.createElement(r.Menu.RowTitle,null,v)):n.reactExports.createElement(_r,{tooltipText:v,onClick:p,disabled:!1,icon:r.PrintLine})};Er.displayName="PrintButton",Er.displayName="PrintButton";const xr=({isMenuItem:e})=>{const t=u.useIntl(),{onFindInDoc:i}=gr(),a=or((()=>{null==i||i()})),o=t.formatMessage({id:"M/F/hG",defaultMessage:"Find in document"});return e?n.reactExports.createElement(r.Menu.ActionItem,{onClick:a,preferComposition:!0},n.reactExports.createElement(r.Menu.RowAccessory,null,n.reactExports.createElement(r.UIIcon,{src:r.SearchLine})),n.reactExports.createElement(r.Menu.RowTitle,null,o)):n.reactExports.createElement("div",{"data-tooltip":"toolbar-search-button"},n.reactExports.createElement(_r,{tooltipText:o,onClick:a,disabled:!1,icon:r.SearchLine,closeTooltipOnClick:!0}))};xr.displayName="FindInDocumentButton",xr.displayName="FindInDocument";const Sr=({intl:e,children:t})=>n.reactExports.createElement(r.Menu.Wrapper,{closeOnSelection:!1},(({getContentProps:i,getTriggerProps:a})=>{const o=e.formatMessage({id:"En+hlM",defaultMessage:"More actions"});return n.reactExports.createElement("div",null,n.reactExports.createElement(r.Tooltip,{placement:"top",title:o},n.reactExports.createElement("span",null,n.reactExports.createElement(r.IconButton,Object.assign({variant:"transparent"},a(),{inverse:!0}),n.reactExports.createElement(r.UIIcon,{src:r.MoreHorizontalLine})))),n.reactExports.createElement(r.Menu.Content,Object.assign({},i()),n.reactExports.createElement(r.Menu.Segment,null,t)))}));Sr.displayName="OverflowMenu";const Pr=u.defineMessage({id:"nomoau",defaultMessage:"{file_number} of {file_count}"}),Or=u.defineMessage({id:"LI56s4",defaultMessage:"{file_number} of many"}),Ir=({fileCollectionContext:e})=>{const t=u.useIntl(),i=sr(e);if(void 0===i||i.parent_files_count>99999)return null;const r=i.file_index+1,a=i.parent_files_count,o=i.parent_files_count<1e3?t.formatMessage(Pr,{file_number:r,file_count:a}):t.formatMessage(Or,{file_number:r});return n.reactExports.createElement("span",null,o)};Ir.displayName="ToolbarFileCounter";const Tr=n.reactExports.createContext(null);Tr.displayName="FileViewerRenderContext";const Rr=()=>n.reactExports.useContext(Tr),Fr=Tr.Provider;const Cr=function(e=navigator.userAgent){const t=function(e){const t=e.toLowerCase(),i=/(ipad)/.exec(t)||/(edge)[ \/]([\w.]+)/.exec(t)||/(edg)[ \/]([\w.]+)/.exec(t)||/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||/(trident).*? rv:([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[],r=t.match(/version\/([\d.]+)/i);let n=null!=r?i[1]:null;return"webkit"===n&&(n=null!=r?r[1]:null),{browser:i[1]||"",version:n||i[2]||"0",userAgent:e}}(e);return"trident"===t.browser&&(t.browser="msie"),t}(),jr=Boolean(/(ipod)/.exec(navigator.userAgent.toLowerCase())),kr="ipad"===Cr.browser||void 0,Dr=!("webkit"!==Cr.browser&&!Boolean(kr))||void 0;"edge"===Cr.browser||Cr.browser,Cr.browser;const Vr=Boolean(/(iphone)/.exec(navigator.userAgent.toLowerCase()));function Ar(e=navigator.userAgent){const t=(e||"").toLowerCase();return jr||Vr||-1!==t.indexOf("tizen")||-1!==t.indexOf("android")&&-1!==t.indexOf("mobile")||-1!==t.indexOf("bb10")||-1!==t.indexOf("netfront")||/windows phone|opera mini|blackberry|nokia/.test(t)||-1!==t.indexOf("firefox")&&-1!==t.indexOf("mobile")||-1!==t.indexOf("googlebot-mobile")||-1!==t.indexOf("iemobile")||-1!==t.indexOf("opera mobi")||/ucweb|ucbrowser/.test(t)||-1!==t.indexOf("microsoft office mobile")}function Lr(e=navigator.userAgent){const t=(e||"").toLowerCase();return-1!==t.indexOf("android")||-1!==t.indexOf("silk")}function Mr(e=navigator.userAgent){return Ar(e)||function(e=navigator.userAgent){return kr||Lr(e)&&!Ar(e)}(e)}/win(16|nt|dows)/.test(navigator.userAgent.toLowerCase());const Nr=Boolean(/(macintosh)/.exec(navigator.userAgent.toLowerCase()));r.injectInternalStyle("js/file_viewer/preview_archive/preview_archive.module.out.css",(e=>"._emptyFolder_1xop8_1{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center}._folderTable_1xop8_9{background:var(--color__standard__background);overflow-y:auto;padding-bottom:calc(var(--toolbar-vertical-padding) + var(--toolbar-row-height) + var(--toolbar-vertical-padding))}._archiveFileBreadcrumb_1xop8_20{flex-grow:1;height:100%;justify-content:center}._extractAllButtonBar_1xop8_26{margin:20px}._titlebarV2Breadcrumbs_1xop8_30 ._archiveFileBreadcrumb_1xop8_20 ._breadCrumbText_1xop8_30{font-family:var(--type__body__standard--fontfamily);font-size:14px}._titlebarV2Breadcrumbs_1xop8_30 ._archiveFileBreadcrumb_1xop8_20 ._breadCrumbText_1xop8_30._inverse_1xop8_35{color:var(--color__inverse__faint__text)}._titlebarV2Breadcrumbs_1xop8_30 ._archiveFileBreadcrumb_1xop8_20 ._breadCrumbText_1xop8_30._normal_1xop8_39{color:var(--color__standard__text)}._titlebarV2Breadcrumbs_1xop8_30{min-width:0}._truncateText_1xop8_48{overflow:hidden;text-decoration:none;text-overflow:ellipsis;white-space:nowrap}"));function Ur(e,t,i,r){return()=>{i&&r(Xe({currentPath:e,fileViewerId:t,previewKey:i,isDir:!0}))}}const Kr=n.reactExports.memo((e=>{const{archiveName:t,currentPath:i,fileViewerId:a,previewKey:o,dispatch:s,isMobile:l,showInverse:c=!1}=e,d=n.reactExports.useCallback(Ur([],a,o,s),[a,null==o?void 0:o.serialized]),u=r.cx("_truncateText_1xop8_48",{_breadCrumbText_1xop8_30:!l,_normal_1xop8_39:!c,_inverse_1xop8_35:c});return n.reactExports.createElement(f.Breadcrumb,{isRootOverflow:!1,alwaysShowRoot:!0,size:l?"small":"standard",className:"_archiveFileBreadcrumb_1xop8_20"},n.reactExports.createElement(f.Breadcrumb.Link,{href:d,isCurrentPath:0===i.length},n.reactExports.createElement("div",{className:u},t)),i.map(((e,t)=>{const r=Ur(i.slice(0,t+1),a,o,s);return n.reactExports.createElement(f.Breadcrumb.Link,{href:r,isCurrentPath:t===i.length-1,key:`${t}-${e}`},n.reactExports.createElement("div",{className:u},e))})))}));Kr.displayName="ArchiveFileBreadcrumbs";const zr=({intl:e,allowRename:i,fileViewerId:s,previewKey:l,showInverse:c,isEditingFilename:d})=>{var u,p,v;const g=r.useDispatch(),f=a.useFileViewerSelector(a.getRootPreviewKey,s),m=null===(u=a.useParameterizedSelector(a.getFilePreviewUi,s,f))||void 0===u?void 0:u.currentPath,y=null!==(v=null===(p=a.usePreviewKeySelector(a.getFileMetadata,f))||void 0===p?void 0:p.file_name)&&void 0!==v?v:"",b=n.React$1.useRef(null),[h,E]=n.React$1.useState(y);n.React$1.useEffect((()=>{window.requestAnimationFrame((()=>{if(!b.current)return;b.current.focus();const e=null!=y?y:"";let t=e.lastIndexOf(".");t<0&&(t=e.length),b.current.setSelectionRange(0,t)}))}),[y,d]),n.React$1.useEffect((()=>()=>{g(be({isActive:!1,isRenameInitiatedFromOverflow:!1,fileViewerId:s}))}),[g,s]);const x=r.useSelector((e=>function(e,t){var i;return!!(null===(i=a.getFileViewerUi(e,t))||void 0===i?void 0:i.isRenameInitiatedFromOverflow)}(e,s))),S=e=>{y!==(null!=e?e:h)?g(ye({fileViewerId:s,previewKey:l,sourceContext:o.UserActionContext.Toolbar,isRenameFromOverflowMenu:x,newFilename:null!=e?e:h})):E(null!=y?y:""),g(be({isActive:!1,isRenameInitiatedFromOverflow:!1,fileViewerId:s}))},P=n.React$1.useRef(null),[O,I]=n.React$1.useState();return y?void 0!==m?n.React$1.createElement("div",{className:"_titlebarV2Breadcrumbs_1xop8_30"},n.React$1.createElement(r.Text,{color:c?"standard":"faint",isBold:!0,inverse:c},n.React$1.createElement(Kr,{archiveName:y,currentPath:m,fileViewerId:s,previewKey:f,dispatch:g,showInverse:c}))):d?n.React$1.createElement(r.ClickOutside,{isClickThroughPortaled:!1,shouldPropagateMouseEvents:!0,isActive:!0,onClickOutside:()=>{var e;return S(null===(e=null==b?void 0:b.current)||void 0===e?void 0:e.value)}},n.React$1.createElement("div",{style:O,"data-tooltip":"file-name-rename-active"},n.React$1.createElement(r.TextInput,{className:_.toolbarFilename,ref:b,"aria-label":e.formatMessage({id:"XlFxo+",defaultMessage:"filename"}),isTransparent:!0,value:h,onChange:e=>E(e.currentTarget.value),inverse:c,onKeyDown:e=>{e.key===r.Key_enum.Key.Enter?(e.stopPropagation(),S()):e.key===r.Key_enum.Key.Escape&&(e.stopPropagation(),E(y),g(be({isActive:!1,isRenameInitiatedFromOverflow:!1,fileViewerId:s})))}}))):n.React$1.createElement("div",{ref:P,className:_.toolbarFilenameSectionTitle,"data-tooltip":"file-name-display"},n.React$1.createElement(w.Truncate,{className:r.cx("fvsdk__toolbar-filename",_.toolbarFilename),location:Dr?1:.5,tooltipControlProps:{placement:"top"},onDoubleClick:i?()=>{P.current&&I({minWidth:P.current.offsetWidth}),E(y),g(be({isActive:!0,isRenameInitiatedFromOverflow:!1,fileViewerId:s})),g(ct({userAction:o.UserAction.Rename,fileViewerId:s,actionContext:o.UserActionContext.Toolbar})),z(t.TooltipTourUpdateType.Increment,t.GuidedTours.Rename),$(t.GuidedTours.Rename,1,2)}:void 0,title:y},y)):n.React$1.createElement(n.React$1.Fragment,null)};zr.displayName="FileNameDisplay";const $r=n.React$1.lazy((()=>i.__awaiter(void 0,void 0,void 0,(function*(){const{VideoControlToolbar:t}=yield new Promise((function(t,i){e(["./c_file_viewer_video_controls_video_controls_toolbar"],t,i)})).then((function(e){return e.video_controls_toolbar_esnext}));return{default:t}})))),Br=e=>n.React$1.createElement(n.React$1.Suspense,{fallback:n.React$1.createElement(Hr,null)},n.React$1.createElement($r,Object.assign({},e)));Br.displayName="VideoControlRow";const Wr=({className:e,children:t})=>n.React$1.createElement("div",{className:r.cx(_.toolbarSection,e)},t);Wr.displayName="ToolbarSection";const Hr=({className:e,children:t})=>n.React$1.createElement("div",{className:r.cx(_.toolbarRow,e)},t);Hr.displayName="ToolbarRow";const qr=({intl:e,allowRename:t,fileMetadata:i,showInverse:a,fileViewerId:o,previewKey:s,hasFileCounter:l,plugins:c,isEditingFilename:d})=>{let u=null;const p=null==c?void 0:c.star;u=n.React$1.createElement(zr,{intl:e,allowRename:t,fileViewerId:o,previewKey:s,showInverse:a,isEditingFilename:d});const v=n.React$1.createElement(n.React$1.Fragment,null,u,p&&n.React$1.createElement(p,{className:_.toolbarStar}));return n.React$1.createElement(Hr,{className:_.toolbarFilenameRow},l?n.React$1.createElement(n.React$1.Fragment,null,n.React$1.createElement(Wr,{className:r.cx(_.toolbarFilenameSection,{[_.toolbarFilenameSectionTitle]:!d})},v),n.React$1.createElement(Wr,{className:_.toolbarCounterSection},n.React$1.createElement(Ir,{fileCollectionContext:null==i?void 0:i.file_collection_context}))):v)};qr.displayName="FileInfoRow";const Gr=({intl:e,toolbarConfig:t,filePreviewUi:i,fileRivieraData:r,scaleFactor:o,rendererWidth:s,previewType:l,useOverflowMenu:c,isDocSidebarOpen:d,plugins:u,fittedScaleFactor:p,isSidebarEnable:v,fileViewerId:g})=>{const _=t.zooming,w=t.fullscreen,f=t.pageNavigation,m=t.findInDocument,y=t.print,b=!!s&&!er(s,l),h=a.useFileViewerSelector(a.getIsPreviewLoading,g),E=null==u?void 0:u.imageCropRotate,x=v?n.React$1.createElement(hr,{isSidebarOpen:d,disabled:b,isInMenu:c}):null,S=n.React$1.createElement(n.React$1.Fragment,null,m&&n.React$1.createElement(xr,{isMenuItem:c}),y&&n.React$1.createElement(Er,{isMenuItem:c}));return h?n.React$1.createElement(Hr,null):n.React$1.createElement(Hr,null,n.React$1.createElement(Wr,null,_&&null!=o&&n.React$1.createElement(n.React$1.Fragment,null,n.React$1.createElement(wr,{scaleFactor:o}),n.React$1.createElement(mr,{scaleFactor:o,fittedScaleFactor:p}),n.React$1.createElement(fr,{scaleFactor:o})),w&&n.React$1.createElement(yr,null)),E&&n.React$1.createElement(Wr,null,n.React$1.createElement(E,null)),n.React$1.createElement(Wr,null,f&&n.React$1.createElement(br,{filePreviewUi:i,fileRivieraData:r}),c?n.React$1.createElement(Sr,{intl:e},x,S):x),!c&&n.React$1.createElement(Wr,null,S))};Gr.displayName="ControlsRow";const Zr=({previewType:e,fileRivieraData:t,filePreviewUi:i,fileViewerUi:o,fileConfig:l,showDocSidebar:d,activeCommentPlugin:p,plugins:v,snackbarManagerPluginInstance:g,forceHideControlRow:w=!1})=>{var f,m,y,b;const h=u.useIntl(),{featureConfig:E,fileViewerId:x}=a.useFileViewerContext(),{rendererWidth:S}=Rr(),P=null===(f=a.useRootFileInfo(x))||void 0===f?void 0:f.previewKey,O=a.useFileMetadata(P),{videoPlayer:I}=gr(),{isShown:T,elementProps:R}=function(e){const[t,i]=n.reactExports.useState(!1),[r,a]=n.reactExports.useState(!0),o=n.reactExports.useRef(),s=or((e=>{const t=e.currentTarget.getBoundingClientRect();0===t.left&&0===t.top||i(!0)})),l=or((()=>{i(!1)})),d=or((()=>{t?u():(o.current=void 0,a(!1))})),u=or((()=>{o.current&&window.clearTimeout(o.current),o.current=window.setTimeout(d,3e3)}));return n.reactExports.useEffect((()=>{const e=c.throttle((()=>{a(!0),u()}),1e3,{leading:!0,trailing:!1});return u(),window.addEventListener("mousemove",e),window.addEventListener("focusin",e),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("focusin",e)}}),[u]),n.reactExports.useEffect((()=>{a(!0),u()}),[e]),n.reactExports.useEffect((()=>()=>{o.current&&(window.clearTimeout(o.current),o.current=void 0)}),[]),{elementProps:{onMouseEnter:s,onMouseLeave:l,onFocus:s,onBlur:l},isShown:r}}(P),F=a.useFileViewerSelector(_i,x),C=(e=>{const[t,i]=n.reactExports.useState(e);return n.reactExports.useEffect((()=>{const e=()=>{i(!0)},t=()=>{i(!1)};return document.addEventListener("snackbar_shown",e),document.addEventListener("snackbar_hidden",t),()=>{document.removeEventListener("snackbar_shown",e),document.removeEventListener("snackbar_hidden",t)}}),[]),t})(!!(null==g?void 0:g.isSnackbarVisible())),j=a.useFileViewerSelector(mi,x),k=a.useFileViewerSelector(fi,x),D=a.useFileViewerSelector(a.getIsPreviewLoading,x),V=e===s.PreviewType.Video||e===s.PreviewType.Audio,A=!!(null==o?void 0:o.isFullScreen),L="hidden"===k,M=(T||"shown"===k||j||V&&!A)&&!C,N=!!(null==o?void 0:o.isDocSidebarOpen),U=i&&((null===(m=a.filterZoomableFilePreviewUi(i))||void 0===m?void 0:m.zoomScaleFactor)||(null===(y=a.filterZoomableFilePreviewUi(i))||void 0===y?void 0:y.fitScaleFactor))||void 0,K=i&&(null===(b=a.filterZoomableFilePreviewUi(i))||void 0===b?void 0:b.fitScaleFactor)||void 0,z=F?rr(e):nr(e,E,l),$=!A&&z.docSidebar,B=$||z.fullscreen||z.pageNavigation||z.print||z.zooming&&null!=U,W=S<=450&&$&&z.fullscreen&&z.pageNavigation&&z.print&&z.zooming&&null!=U,H=a.isToolbarInverse(A,e),q=N&&$&&!!d,G=(B||D)&&!w;return n.React$1.createElement(n.React$1.Fragment,null,z.fileFlipping&&n.React$1.createElement(lr,{isShown:!L&&T,fileCollectionContext:null==O?void 0:O.file_collection_context,flipperCallbacks:R}),n.React$1.createElement("div",{className:r.cx(_.toolbarHolder,{[_.withSidebar]:q}),"data-testid":"fvsdk_floating_toolbar"},n.React$1.createElement(Ui,{active:L,direction:"down",end:150,offScreenElement:!1},n.React$1.createElement("div",Object.assign({className:r.cx(_.toolbar,{[_.hidden]:!M,[_.toolbarAudioVideo]:V,[_.normal]:!H}),role:"toolbar","aria-hidden":L},R),n.React$1.createElement(qr,{intl:h,allowRename:!!(null==O?void 0:O.file_path),fileMetadata:O,showInverse:H,fileViewerId:x,previewKey:P,hasFileCounter:z.fileFlipping,plugins:v,isEditingFilename:j}),V&&I?n.React$1.createElement(Br,{player:I,fileViewerId:x,isVideo:e===s.PreviewType.Video,previewKey:P,fileRivieraData:t,activeCommentPlugin:p,showInverse:H,featureConfig:E,isRedesignEnabled:!1}):G&&n.React$1.createElement(Gr,{filePreviewUi:i,previewType:e,isDocSidebarOpen:N,fileRivieraData:t,toolbarConfig:z,scaleFactor:U,fittedScaleFactor:K,plugins:v,useOverflowMenu:W,rendererWidth:S,isFullScreen:A,isSidebarEnable:$,intl:h,fileViewerId:x})))))};Zr.displayName="ConfigurableToolbar";const Xr=({url:e,width:t,height:i,onImgLoad:r,sizeScale:a})=>n.React$1.createElement("div",{className:"skeleton-page-container",style:{margin:"auto",width:`${t}px`,height:`${i}px`}},n.React$1.createElement("img",{className:"skeleton-image",src:e,style:{width:`${t}px`,height:`${i}px`,opacity:"60%"},alt:"",onLoad:r,sizes:a?`${a}vw`:void 0}));Xr.displayName="SkeletonPage";const Yr=({viewportWidth:e,viewportHeight:t,docSidebarCollapsed:r,docContent:a,docMetadata:o,fileName:l,metricsReporter:c})=>{const[d,u]=n.React$1.useState(0),[p,v]=n.React$1.useState(0),[g,_]=n.React$1.useState(0),w=!r&&er(e,s.PreviewType.SsrDoc)?Xi:0,f=Ji(l);n.React$1.useEffect((()=>{const i=i=>{const n=tr({width:e,height:t,dimensions:i.dimensions,isDocSidebarVisible:!r,fileName:l,scaleToFit:"width_and_height",toolbarShown:!0}),a=i.dimensions[0][0],o=i.dimensions[0][1],s=100*(a*n)/window.innerWidth/window.devicePixelRatio;u(a*n),v(o*n),_(2*s)};if(0!==(null==o?void 0:o.page_count))if(null==o?void 0:o.dimensions.length)i(o);else if(null==a?void 0:a.text_url_tmpl){const[e,t]=Ut(0);jt.fetchDocMetadata(a.text_url_tmpl,!0,e,t).then((({data:e})=>{const t=null==e?void 0:e.metadata;if(!t)return;i(t);const r=document.getElementById("fvsdk-container");null==c||c.createStats({ns:"web_previews",name:"skeleton_doc_fetch_success"}).record(r?0:1)}))}}),[l,a,o,r,t,e,c]);const[m,y]=n.React$1.useState();return n.reactExports.useEffect((()=>{var e;(e=a,i.__awaiter(void 0,void 0,void 0,(function*(){return e.image_url_tmpl?jt.fetchDocImage({imageUrlTmpl:e.image_url_tmpl}):Promise.resolve({data:void 0})}))).then((({data:e})=>y(e)))}),[a]),n.React$1.createElement("div",{className:"skeleton-doc-viewport-wrapper",style:{width:`${e}px`,height:"100%",display:"flex",overflow:"hidden"}},w>0&&n.React$1.createElement("div",{className:"skeleton-doc-sidebar",style:{width:`${w}px`,height:"100%",boxSizing:"border-box",borderRight:"1px solid rgba(166,158,146,0.6)",flexShrink:0}}),m&&n.React$1.createElement("div",{className:"skeleton-doc-viewport",style:{display:"flex",width:"100%"}},f?n.React$1.createElement("div",{className:"skeleton-ppt-viewport",style:{width:"100%"}},n.React$1.createElement("div",{className:"skeleton-ppt-sizer",style:{height:`calc(100% - ${Gi}px)`,width:"100%",display:"flex"}},n.React$1.createElement(Xr,{width:d,height:p,url:m,sizeScale:g}))):n.React$1.createElement("ol",{style:{width:e-w+"px",height:`${p}px`,padding:0,listStyle:"none",display:"flex",flexDirection:"column",alignItems:"center",overflow:"hidden"}},n.React$1.createElement("li",{style:{transform:"translateY(16px)",margin:"16px 0"}},n.React$1.createElement(Xr,{width:d,height:p,url:m,sizeScale:g})))))};Yr.displayName="SkeletonViewportDoc";const Qr=({viewport:e,imageContent:t,dimensions:i})=>{const[r,a]=n.React$1.useState();n.React$1.useEffect((()=>{(e=>{const t=e.default_src;return t?jt.fetchImage(t):Promise.resolve({data:void 0})})(t).then((({data:e})=>a(e)))}),[t]);const[o,s]=n.React$1.useState(),[l,c]=n.React$1.useState(!!i),d=n.React$1.useMemo((()=>{const t=(null==i?void 0:i.width)||(null==o?void 0:o.width)||0,r=(null==i?void 0:i.height)||(null==o?void 0:o.height)||0;return t&&r&&c(!0),t>e.width||r>e.height}),[null==i?void 0:i.height,null==i?void 0:i.width,null==o?void 0:o.height,null==o?void 0:o.width,e.height,e.width]),u=n.React$1.useCallback((({currentTarget:{naturalWidth:e,naturalHeight:t}})=>{e&&t&&s({height:t,width:e})}),[]);return n.React$1.createElement("div",{style:l?{height:"100%",width:"100%"}:{height:0,width:0,overflow:"hidden"}},n.React$1.createElement("img",{src:r,onLoad:u,style:{height:"100%",width:"100%",boxSizing:"border-box",objectFit:d?"contain":"scale-down",paddingTop:Q.top,paddingBottom:Q.bottom,paddingLeft:Q.horizontal/2,paddingRight:Q.horizontal/2},alt:""}))};Qr.displayName="SkeletonViewportImage";const Jr=({width:e,height:t,fileContent:i,docSidebarCollapsed:r,docMetadata:a,fileName:o,metricsReporter:l})=>{const c=null==i?void 0:i.content,d=null==c?void 0:c[".tag"],u={width:e,height:t};return n.React$1.createElement("div",{className:"skeleton-viewport",style:u},d===s.PreviewType.Image&&n.React$1.createElement(Qr,{viewport:u,imageContent:c,dimensions:null==i?void 0:i.dimensions}),d===s.PreviewType.SsrDoc&&n.React$1.createElement(Yr,{viewportWidth:e,viewportHeight:t,docSidebarCollapsed:r,docContent:c,docMetadata:a,fileName:o,metricsReporter:l}),d===s.PreviewType.CloudDoc&&n.React$1.createElement(Yr,{viewportWidth:e,viewportHeight:t,docSidebarCollapsed:r,docContent:c,docMetadata:a,fileName:o,metricsReporter:l}))};Jr.displayName="SkeletonViewportComponent";const en=n.React$1.memo(Jr);en.displayName="SkeletonViewport";const tn=()=>document.documentElement.clientWidth,rn=()=>{const[e,t]=n.React$1.useState(tn());return n.React$1.useEffect((()=>{const e=c.lodash.throttle((()=>t(tn())),50);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(e=>Mr()?e>1026?v.ResponsiveSize.DESKTOP:e<=736?v.ResponsiveSize.MOBILE:v.ResponsiveSize.TABLET:e>736?v.ResponsiveSize.DESKTOP:e<=428?v.ResponsiveSize.MOBILE:v.ResponsiveSize.TABLET)(e)};var nn;t.FileViewerBreakpoint=void 0,(nn=t.FileViewerBreakpoint||(t.FileViewerBreakpoint={})).SM="small",nn.MD="medium",nn.LG="large";const an=e=>{const[t,i]=n.React$1.useState(!0),r=n.React$1.useRef(void 0),a=n.React$1.useMemo((()=>c.throttle((()=>{const t=()=>{r.current&&window.clearTimeout(r.current)};return i(!0),t(),r.current=window.setTimeout((()=>{i(!1)}),e),t}))),[e]);n.React$1.useEffect((()=>(window.addEventListener("mousemove",a),()=>window.removeEventListener("mousemove",a))));return{isUserInteractingWithElement:t,handleFocus:n.React$1.useCallback((()=>{i(!0)}),[]),handleBlur:n.React$1.useCallback((()=>{i(!1)}),[])}},on=({fileViewerId:e,previewKey:t,isOpaque:i})=>{const s=r.useDispatch(),l=u.useIntl(),{isFullScreen:c}=a.useToolbarControlsConfig(),d=or((()=>{const i={fileViewerId:e,previewKey:t,sourceContext:o.UserActionContext.Toolbar};s(c?Ae(i):Ve(i))})),p=c?l.formatMessage({id:"Md0K/4",defaultMessage:"Exit fullscreen"}):l.formatMessage({id:"p/cnyO",defaultMessage:"Fullscreen"});return n.reactExports.createElement(a.ToolbarIcon,{label:p,onClick:d,icon:c?r.FullscreenExitLine:r.FullscreenLine,disabled:!1,isOpaque:i})};on.displayName="FullscreenButton";r.injectInternalStyle("js/file_viewer/ui/fullscreen_right_section.module.out.css",(e=>":root{--abovePreviewZIndex:10}._fullscreenRightSection_1hxzr_5{display:flex;gap:var(--spacing__unit--1);padding:var(--spacing__unit--2);position:absolute;right:0;top:0;transition:opacity var(--easing__transition) var(--duration__micro);z-index:var(--abovePreviewZIndex)}._hidden_1hxzr_16{opacity:0}"));const sn=({fileViewerId:e})=>{const t=u.useIntl(),i=r.useDispatch(),s=a.useFileViewerSelector(a.getFileViewerUi,e),l=null==s?void 0:s.isUiHidden.fullscreen,c=l?r.ShowLine:r.HideLine,d=l?t.formatMessage({id:"qJIBhE",defaultMessage:"Show toolbar"}):t.formatMessage({id:"Pwe/D+",defaultMessage:"Hide toolbar"}),p=or((()=>{const t={fileViewerId:e,isFullscreen:!0,sourceContext:o.UserActionContext.TitleBarMain};i(l?je(t):ke(t))}));return n.React$1.createElement(r.Button$1,{variant:"opacity",withIconLeft:n.React$1.createElement(r.UIIcon,{src:c}),onClick:p,inverse:!0},d)};sn.displayName="HideToolbarButton";const ln=({fileViewerId:e,previewType:t,previewKey:i})=>{const{isUserInteractingWithElement:a,handleBlur:o,handleFocus:l}=an(5e3);return n.React$1.createElement("div",{className:r.cx("_fullscreenRightSection_1hxzr_5",{_hidden_1hxzr_16:!a}),onBlur:o,onFocus:l},n.React$1.createElement(sn,{fileViewerId:e}),t!==s.PreviewType.Video&&t!==s.PreviewType.Audio&&n.React$1.createElement(on,{fileViewerId:e,previewKey:i,isOpaque:!0}))};ln.displayName="FullscreenRightSection";r.injectInternalStyle("js/file_viewer/ui/show_tools_button.module.out.css",(e=>":root{--abovePreviewZIndex:10}._showTools_8zey6_5{padding:var(--spacing__unit--2);position:absolute;right:0;top:0;transition:opacity var(--easing__transition) var(--duration__micro);z-index:var(--abovePreviewZIndex)}._hidden_8zey6_14{opacity:0}"));const cn=({fileViewerId:e})=>{const t=u.useIntl(),i=r.useDispatch(),{isUserInteractingWithElement:a,handleBlur:s,handleFocus:l}=an(5e3),c=or((()=>{const t={fileViewerId:e,isFullscreen:!1,sourceContext:o.UserActionContext.TitleBarMain};i(je(t))}));return n.React$1.createElement("div",{className:r.cx("_showTools_8zey6_5",{_hidden_8zey6_14:!a}),onFocus:l,onBlur:s},n.React$1.createElement(r.Button$1,{variant:"opacity",withIconLeft:n.React$1.createElement(r.UIIcon,{src:r.ShowLine}),onClick:c},t.formatMessage({id:"vQPZmq",defaultMessage:"Show tools"})))};cn.displayName="ShowToolsButton";const dn=({activeCommentPlugin:e,plugins:t,snackbarManagerPluginInstance:i,fileConfig:c,activeEditOverlayPlugin:d,children:p,width:v})=>{var g;const _=u.useIntl(),w=rn(),{rendererWidth:f,rendererHeight:m}=Rr(),{fileViewerId:y,featureConfig:b}=a.useFileViewerContext(),h=a.useFileViewerSelector(a.getCurrentPreviewKey,y),E=a.useFileViewerSelector(a.getFileViewerUi,y),x=a.useFileViewerSelector(a.getIsFullScreen,y),S=a.useFileViewerSelector(a.getAreToolsHidden,y),P=a.useFileViewerSelector(a.getHasBeenFlipped,y),O=a.useFileViewerSelector(a.getIsPreviewLoading,y),I=a.usePreviewKeySelector(a.getPreviewMetadata,h),T=a.useParameterizedSelector(a.getFilePreviewUi,y,h),R=a.usePreviewKeySelector(a.getFileMetadata,h),F=a.usePreviewKeySelector(a.getRivieraData,h),C=null!==(g=null==R?void 0:R.file_name)&&void 0!==g?g:"",j=((e,t,i)=>{var r,n;const a=null!==(r=null==e?void 0:e.previewType)&&void 0!==r?r:s.PreviewType.Error;switch(a){case s.PreviewType.SsrDoc:case s.PreviewType.CloudDoc:return(null===(n=null==i?void 0:i.file_name)||void 0===n?void 0:n.endsWith(".gsheet"))?s.PreviewType.RawHTML:a;case s.PreviewType.Excel:return"excel1"===t.excel_support.support?s.PreviewType.HTML:"ms_view_embed"===t.excel_support.embed_support?s.PreviewType.RawHTML:a;default:return a}})(I,b,R),k=!!a.useFileViewerSelector(wi,y),D=b.preview_content_only,V=!!d,A=j===s.PreviewType.Audio||j===s.PreviewType.Video,L=j===s.PreviewType.Error,M=!!fe(I),N=j===s.PreviewType.Linkfile,U=!V&&!Ar()&&function(e){if(!e)return!1;const t=e[".tag"];return t===s.PreviewType.Image||t===s.PreviewType.SsrDoc||t===s.PreviewType.CloudDoc}(null==I?void 0:I.content)&&!P,K=!(D&&A||ar(w,b)),z=M||N||L,$=er(v,j)&&(null==E?void 0:E.isDocSidebarOpen),B=j===s.PreviewType.SsrDoc||j===s.PreviewType.CloudDoc,W=l.isRedesign2023Enabled(b),H=n.React$1.createElement(r.Spinner,{"aria-label":_.formatMessage({id:"zqXonC",defaultMessage:"Your preview is loading"}),inverse:x||V}),q=U&&F&&n.React$1.createElement(en,{width:f,height:m,fileContent:I,docSidebarCollapsed:!$,docMetadata:B?F.metadata:void 0,fileName:C}),{handleTouchStart:G,handleTouchEnd:Z}=((e,t)=>{const i=r.useDispatch(),a=n.reactExports.useRef(0),s=n.reactExports.useRef(0),l=n.reactExports.useRef(0),c=n.reactExports.useRef(!1);return{handleTouchStart:n.reactExports.useCallback((e=>{const t=e.changedTouches[0];a.current=Date.now(),s.current=t.pageX,l.current=t.pageY,e.touches.length>1&&(c.current=!0)}),[a,s,l,c]),handleTouchEnd:n.reactExports.useCallback((r=>{const n=r.changedTouches[0];if(c.current)return void(0===r.touches.length&&(c.current=!1));if(Math.abs(n.pageY-l.current)>200)return;if(Date.now()-a.current>500)return;const d=n.pageX-s.current;d<=-100?i(Ue({fileViewerId:e,previewKey:t,sourceContext:o.UserActionContext.SurfaceGesture})):d>=100&&i(Ke({fileViewerId:e,previewKey:t,sourceContext:o.UserActionContext.SurfaceGesture}))}),[e,t,a,s,l,c,i])}})(y,h);return n.React$1.createElement("div",{className:r.cx("_previewContentWrapper_9oi8y_23",{_editMode_9oi8y_19:V}),onTouchStart:G,onTouchEnd:Z},n.React$1.createElement("div",{className:r.cx("_loadingContent_9oi8y_1",{[Bi]:!O&&!k,[$i]:x})},O?U?q:H:null),n.React$1.createElement("div",{className:r.cx("_previewContent_9oi8y_8",{[Bi]:O||k})},W&&S?x?n.React$1.createElement(ln,{fileViewerId:y,previewKey:h,previewType:j}):n.React$1.createElement(cn,{fileViewerId:y}):null,p),n.React$1.createElement("div",{className:r.cx({[Bi]:k})},K&&n.React$1.createElement(Zr,{previewType:j,fileRivieraData:F,filePreviewUi:T,fileViewerUi:E,activeCommentPlugin:e,previewMetadata:I,plugins:t,snackbarManagerPluginInstance:i,forceHideControlRow:z,fileConfig:c})))};dn.displayName="PreviewContent";class un extends n.React$1.PureComponent{componentDidCatch(e){this.props.onError(e)}render(){return this.props.children}}un.displayName="UnconnectedErrorBoundary";const pn=({previewKey:e,children:i})=>{var o;const l=a.usePreviewKeySelector(a.getPreviewMetadata,e),c=null===(o=a.useFileViewerContext().batteries.optionalIOClients.reportExceptionClient)||void 0===o?void 0:o.reportException,d=r.useDispatch(),u=or((i=>{var r;null==c||c(i,(null===(r=null==l?void 0:l.content)||void 0===r?void 0:r[".tag"])||"other",!0),e&&d(ze({previewKey:e,previewType:s.PreviewType.Error,error:Lt(i)?i:new nt(t.FVErrorCode.Unknown,t.ErrorLifecycle.Render,i.message)}))}));return n.React$1.createElement(un,{onError:u},i)};pn.displayName="ErrorBoundary";const vn=(e,t)=>qe({fileViewerId:e,pluginId:t,sourceContext:o.UserActionContext.Toolbar}),gn=n.React$1.memo((({icon:e,label:t,pluginId:i,fileViewerId:a,callback:o})=>{const s=r.useDispatch(),l=n.reactExports.useCallback((()=>{s(vn(a,i)),null==o||o()}),[a,i,s]);return n.React$1.createElement(r.Menu.ActionItem,{value:{nodeType:"dropdown",actionType:v.ActionBarActionTypes.CUSTOM_ACTION,id:i,menuItem:{handler:l}},withLeftAccessory:e,disabled:!1},t)}));gn.displayName="EditFullscreenOverflowItem";const _n=n.React$1.memo((({icon:e,label:t,pluginId:i,fileViewerId:a,hideIcons:o,callback:s})=>{const l=r.useDispatch(),c=n.reactExports.useCallback((()=>{l(vn(a,i)),null==s||s()}),[a,i,l]);return n.React$1.createElement(r.Button$1,{variant:"opacity",onClick:c,withIconLeft:o?null:e,disabled:!1,"data-campaigns-element-id":"action-bar-edit-button","data-tooltip":"action-bar-edit-button","data-testid":"edit-document-button"},t)}));_n.displayName="EditFullscreenRenderButton";const wn=r.defaultMemoize(((e,t)=>(({editFullscreenPlugins:e,fileViewerId:t})=>Object.entries(e).map((([e,i])=>{const a=n.React$1.createElement(r.UIIcon,{src:i.buttonIcon});return{overflowItem:n.React$1.createElement(gn,{icon:a,label:i.buttonText,pluginId:e,fileViewerId:t,callback:i.onActivate}),renderButton:r=>n.React$1.createElement(_n,{hideIcons:r,icon:a,label:i.buttonText,pluginId:e,fileViewerId:t,callback:i.onActivate}),id:"FULLSCREEN_ACTION"}})))({editFullscreenPlugins:Object.entries(e).reduce(((e,[t,i])=>t===a.PDF_EDITOR_PLUGIN_ID?e:ae(i)?Object.assign(Object.assign({},e),{[t]:i}):e),{}),fileViewerId:t})));function fn(e,i=t.FVErrorCode.Unknown,r,n){if(!e){let e;throw e=new nt(i,r,void 0===n?"An error occurred for unknown reason":n),e.framesToPop=1,e}return e}const mn=(()=>{let e,t;const i=[];for(e=0,t=e;e<=255;e++,t=e)i.push((t+256).toString(16).substr(1));return i})();function yn(e){return e.map((e=>mn[e])).join("")}function bn(){const e=function(){const e=new Uint8Array(16);return window.crypto.getRandomValues(e),e}();e[6]=15&e[6]|64,e[8]=63&e[8]|128;const t=Array.prototype.slice.call(e);return[t.slice(0,4),t.slice(4,6),t.slice(6,8),t.slice(8,10),t.slice(10,16)].map(yn).join("-")}function hn(e){const{file_viewer_session_id:t=bn(),file_preview_session_id:i=bn(),file_id:r="",sj_id:n,ns_id:a,file_extension:s=G(""),device_type:l=o.DeviceType.desktop,extra:c={}}=e||{};return{file_viewer_session_id:t,file_preview_session_id:i,file_id:r,sj_id:n,ns_id:a,file_extension:s,device_type:l,extra:Object.assign(Object.assign({},c),{source_action:c.source_action||o.SourceAction.Visit,source_context:c.source_context||o.SourceContext.FileViewer,was_flipped:c.was_flipped||!1,redesign2023Variant:c.redesign2023Variant||"OFF",file_preview_timeline:{}})}}function En(e){return Object.keys(e).reduce(((t,i)=>{const r=e[i];return"string"==typeof r||"number"==typeof r?t[i]=String(r):"boolean"==typeof r?t[i]=String(+r):"object"==typeof r&&r&&(t[i]=JSON.stringify(r)),t}),{})}function xn(e){return Object.assign(Object.assign({},e),{file_extension:G(e.file_extension||""),extra:En(e.extra)})}const Sn=(e,t,i)=>{const{videoFormat:r,videoDuration:n,videoTruncated:a,extra:o}=e;return{file_viewer_session_id:t.file_viewer_session_id,file_preview_session_id:t.file_preview_session_id,video_format:r,video_duration_seconds:n,video_truncated:a,source_context:t.source_context,ns_id:t.ns_id,sj_id:t.sj_id,device_type:t.device_type,preview_type:i,redesign2023Variant:t.redesign2023Variant,extra:o}},Pn={[me.ZoomIn]:o.UserAction.ZoomIn,[me.ZoomOut]:o.UserAction.ZoomOut,[me.CloseDocSidebar]:o.UserAction.CloseDocSidebar,[me.OpenDocSidebar]:o.UserAction.OpenDocSidebar,[me.ZoomToggleOriginalOrFit]:o.UserAction.ZoomToggleOriginalOrFit,[me.UpdateDocCurrentPageIndex]:o.UserAction.PageJump,[me.PageDown]:o.UserAction.PageDown,[me.PageUp]:o.UserAction.PageUp,[me.Share]:o.UserAction.Share,[me.Restore]:o.UserAction.Restore,[me.OpenWith]:o.UserAction.OpenWith,[me.OpenWebPreview]:o.UserAction.OpenWebPreview,[me.FlipToNextFile]:o.UserAction.FlipNext,[me.FlipToPreviousFile]:o.UserAction.FlipPrevious,[me.CloseViewer]:o.UserAction.CloseViewer,[me.OpenFullscreenPreview]:o.UserAction.OpenFullscreenPreview,[me.OpenVersionHistory]:o.UserAction.OpenVersionHistory,[me.OpenRightRail]:o.UserAction.ToggleSidebarOn,[me.CloseRightRail]:o.UserAction.ToggleSidebarOff,[me.SetLeftSidebarPlugin]:o.UserAction.ToggleSidebarOn,[me.SetRightSidebarPlugin]:o.UserAction.ToggleSidebarOn,[me.HideContentPane]:o.UserAction.ToggleSidebarOff,[me.SwitchWorkbookTab]:o.UserAction.SwitchWorkbookTab,[me.CopyToDropbox]:o.UserAction.SaveToDropbox,[me.DownloadFile]:o.UserAction.DownloadSuccess,[me.Print]:o.UserAction.Print,[me.EnterFullScreen]:o.UserAction.ToggleFullscreenOn,[me.ExitFullScreen]:o.UserAction.ToggleFullscreenOff,[me.ClickDropboxLogo]:o.UserAction.ClickDropboxLogo,[me.SetActiveRightRailPlugin]:o.UserAction.SidebarPaneSelected,[me.SetMuted]:o.UserAction.SetMuted},On=c.lodash(Pn);let In;const Tn=(e,i,r)=>{const{payload:{event:n,fileViewerId:a,previewSessionId:s,extra:l}}=r;let c=i.loggingSession[a];if(!c)return r;return s!==c.file_preview_session_id&&s||(c=function(e,i,r){const{extra:{last_event:n}}=e;switch(fn(n!==i,t.FVErrorCode.InvalidLoggingOrder,t.ErrorLifecycle.Unknown,`Cannot log duplicate event ${i}`),i){case o.SessionEventType.FilePreviewSupportConfirmed:case o.SessionEventType.FilePreviewSupportDenied:fn(n===o.SessionEventType.FilePreviewAttemptStarted,t.FVErrorCode.InvalidLoggingOrder,t.ErrorLifecycle.Unknown,`Event ${i} out of order, expect \`last_event\` to be '${o.SessionEventType.FilePreviewAttemptStarted}' but was '${n}'`);break;case o.SessionEventType.FilePreviewDownloadAttempted:fn(n===o.SessionEventType.FilePreviewSupportConfirmed,t.FVErrorCode.InvalidLoggingOrder,t.ErrorLifecycle.Unknown,`Event ${i} out of order, expect \`last_event\` to be '${o.SessionEventType.FilePreviewSupportConfirmed}' but was '${n}'`);break;case o.SessionEventType.FilePreviewDownloadFailed:case o.SessionEventType.FilePreviewDownloadSucceeded:fn(n===o.SessionEventType.FilePreviewDownloadAttempted,t.FVErrorCode.InvalidLoggingOrder,t.ErrorLifecycle.Unknown,`Event ${i} out of order, expect \`last_event\` to be '${o.SessionEventType.FilePreviewDownloadAttempted}' but was '${n}'`);break;case o.SessionEventType.FilePreviewRenderSucceeded:case o.SessionEventType.FilePreviewRenderFailed:fn(n===o.SessionEventType.FilePreviewDownloadSucceeded,t.FVErrorCode.InvalidLoggingOrder,t.ErrorLifecycle.Unknown,`Event ${i} out of order, expect \`last_event\` to be '${o.SessionEventType.FilePreviewDownloadSucceeded}' but was '${n}'`)}return Object.assign(Object.assign({},e),{extra:Object.assign(Object.assign(Object.assign({},e.extra),{file_preview_timeline:Object.assign(Object.assign({},e.extra.file_preview_timeline),{[i]:Date.now()})}),r||{})})}(c,n,l),e.log(n,xn(c)),c=function(e,t){return Object.assign(Object.assign({},e),{extra:Object.assign(Object.assign({},e.extra),{last_event:t})})}(c,n)),dt(c)},Rn=(e,t,i)=>{const{payload:r}=i,{event:n,fileViewerId:a}=r,o=t.loggingSession[a];return o?(e.log(n,xn(Object.assign(Object.assign({},o),{extra:Object.assign(Object.assign({},(null==o?void 0:o.extra.source_context)&&{source_context:o.extra.source_context}),r.extra)}))),dt(o)):i},Fn=(e,i)=>{var r;const{payload:n}=i,{eventName:a,videoSession:o}=n;if(!o)return;const l=o.preview_type;if(l!==s.PreviewType.Video&&l!==s.PreviewType.Audio)throw new nt(t.FVErrorCode.InvalidLoggingSession,t.ErrorLifecycle.Unknown,"Can't log video events for non-audio/video previews.");null===(r=e.logVideoEvent)||void 0===r||r.call(e,a,Sn(n,o,l))},Cn=(e,i)=>{var r;const{payload:n}=i,{eventName:a,videoSession:o}=n;if(!o)return;const l=o.preview_type;if(l!==s.PreviewType.Video&&l!==s.PreviewType.Audio)throw new nt(t.FVErrorCode.InvalidLoggingSession,t.ErrorLifecycle.Unknown,"Can't log video events for non-audio/video previews.");null===(r=e.logVideoEventQuantity)||void 0===r||r.call(e,a,n.quantity,Sn(n,o,l))},jn=(e,i)=>{var r;const{payload:n}=i,{eventName:a,videoSession:o}=n;if(!o)return;const l=o.preview_type;if(l!==s.PreviewType.Video&&l!==s.PreviewType.Audio)throw new nt(t.FVErrorCode.InvalidLoggingSession,t.ErrorLifecycle.Unknown,"Can't log video events for non-audio/video previews.");null===(r=e.logVideoEventDuration)||void 0===r||r.call(e,a,n.durationInMs,Sn(n,o,l))},kn=(e,t,i)=>{const r=t.loggingSession[i.payload];return r?(e.logTTI(),dt(r)):i},Dn=(e,t,i)=>{var r,n,s,l;const{fileViewerId:c,sourceContext:d}=i.payload,{loggingSession:u}=t,p=u[c],v=a.isRightRailOpen(t,c);let g={context:d,action:Pn[i.type],right_sidebar_state:v?"opened":"collapsed"};if(i.type===me.SwitchWorkbookTab)g.tab_index=i.payload.tabIndex;else if(i.type===me.SetActiveRightRailPlugin)g.selected_pane=i.payload.pluginId,performance.mark(o.PreviewsTimer.SidebarContentsMount);else if(i.type===me.SetRightSidebarPlugin)i.payload.pluginId?g.selected_pane=i.payload.pluginId:g.previous_selected_pane=null===(n=null===(r=t.plugins[c])||void 0===r?void 0:r.sidebarPlugins)||void 0===n?void 0:n.right;else if(i.type===me.OpenRightRail)g.selected_pane=null===(s=t.plugins[c])||void 0===s?void 0:s.activeRightRailPluginId;else if(i.type===me.CloseViewer){const e=a.getCurrentFilePreviewUI(t,c);if(e&&a.filterAudioVideoFilePreviewUiState(e)&&In){const e=In();g=Object.assign(Object.assign({},g),e)}const i=a.filterAudioVideoRivieraData(a.getRootRivieraData(t,c));"loaded"===(null===(l=null==i?void 0:i.transcript)||void 0===l?void 0:l.state)&&(g.transcript_locale=i.transcript.data.transcriptLocale)}return p&&e.log(o.EventType.UserAction,xn(Object.assign(Object.assign({},p),{extra:En(g)}))),i.type!==me.OpenRightRail&&i.type!==me.SetLeftSidebarPlugin&&i.type!==me.SetRightSidebarPlugin||performance.mark(o.PreviewsTimer.SidebarContentsMount),i},Vn=(e,t,i)=>{const{payload:r}=i,{userAction:n,actionContext:a,fileViewerId:s}=r,l=t.loggingSession[s];return n in On?console.warn(`WARNING: ${n} is automatically logged when it's in USER_ACTION_MAP. No need to call logUserAction for it.`):l&&e.log(o.EventType.UserAction,xn(Object.assign(Object.assign({},l),{extra:Object.assign(Object.assign(Object.assign({},(null==l?void 0:l.extra.source_context)&&{source_context:l.extra.source_context}),r.extra),{action:n,context:a})}))),i},An=(e,t,i)=>{const{payload:r}=i,{event:n,fileViewerId:a}=r,s=t.loggingSession[a];return s&&e.log(o.EventType.Background,xn(Object.assign(Object.assign({},s),{extra:Object.assign(Object.assign(Object.assign({},(null==s?void 0:s.extra.source_context)&&{source_context:s.extra.source_context}),r.extra),{event:n})}))),i},Ln=(e,t,i)=>{const{fileViewerId:r,sheetIndex:n}=i.payload,a=t.loggingSession[r];if(!a)return i;const s=xn(Object.assign(Object.assign({},a),{extra:En({tab_index:n,ts:Date.now()})}));switch(i.type){case me.FetchExcelSheetLayoutData:e.log(o.EventType.ExcelSheetDownloadAttempted,s);break;case me.FetchExcelSheetLayoutDataResult:null!=i.error?e.log(o.EventType.ExcelSheetDownloadFailed,s):e.log(o.EventType.ExcelSheetDownloadSucceeded,s);break;case me.ExcelSheetRenderFailed:e.log(o.EventType.ExcelSheetRenderFailed,s);break;case me.ExcelSheetRenderSucceeded:e.log(o.EventType.ExcelSheetRenderSucceeded,s)}return i},Mn=(e,t,i)=>{const{fileViewerId:r,currentPath:n,isDir:a}=i.payload,s=t.loggingSession[r];if(void 0!==a&&s){const t=xn(Object.assign(Object.assign({},s),{extra:En({action:o.UserAction.ArchiveNavigation,context:o.UserActionContext.PreviewContentMain,isDir:String(a),extension:a?"":G(y(n[n.length-1]))})}));e.log(o.EventType.UserAction,t)}return i},Nn=(e,t,i)=>{var r;const{eventName:n,duration:a,fileViewerId:o,tags:s,shouldLogToHive:l}=i.payload,c=t.loggingSession[o];return c&&(null===(r=e.logDuration)||void 0===r||r.call(e,{eventName:n,durationInMs:a,session:c?xn(c):void 0,tags:s,shouldLogToHive:l})),i};function Un(e){return({getState:i,dispatch:r})=>n=>a=>{var o,s;try{switch(a.type){case ot.LogSessionEvent:return n(Tn(e,i(),a));case ot.Log:return n(Rn(e,i(),a));case ot.LogVideoEvent:return Fn(e,a),n(a);case ot.LogVideoEventQuantity:return Cn(e,a),n(a);case ot.LogVideoEventDuration:return jn(e,a),n(a);case ot.LogUserAction:return n(Vn(e,i(),a));case ot.LogBackgroundEvent:return n(An(e,i(),a));case ot.LogTTI:return n(kn(e,i(),a));case me.ExcelSheetRenderFailed:case me.ExcelSheetRenderSucceeded:case me.FetchExcelSheetLayoutData:case me.FetchExcelSheetLayoutDataResult:return n(Ln(e,i(),a));case me.UpdateArchiveFileCurrentPath:return n(Mn(e,i(),a));case ot.LogDuration:return n(Nn(e,i(),a));case me.SetupGetPlayDurationSeconds:return void(In=a.payload.getPlayDurationSeconds)}if(a.type in Pn&&!a.payload.skipLogging)return n(Dn(e,i(),a))}catch(e){if(e instanceof Error){const n=("object"==typeof a.payload&&"fileViewerId"in a.payload?null===(o=i().loggingSession[a.payload.fileViewerId])||void 0===o?void 0:o.extra.preview_type:"other")||"other";r(et({error:e,fileType:n,isCritical:(s=e,!Lt(s)||s.type!==t.FVErrorCode.InvalidLoggingOrder&&s.type!==t.FVErrorCode.InvalidLoggingSession)})),console.warn(e.message)}}return n(a)}}const Kn=new Set([d.PreviewsTimingEvents.CONTAINER_MOUNT,d.PreviewsTimingEvents.COLLECTION_VIEWER_MOUNT,d.PreviewsTimingEvents.SDK_FILE_VIEWER_CODE_START,d.PreviewsTimingEvents.FVSDK_CONSTRUCTOR,d.PreviewsTimingEvents.FVSDK_INITIALIZE_START,d.PreviewsTimingEvents.FVSDK_PLUGINS_INITIALIZED,d.PreviewsTimingEvents.FVSDK_GET_RIVIERA_DATA_START_START,d.PreviewsTimingEvents.FVSDK_GET_PREVIEW_METADATA,d.PreviewsTimingEvents.FVSDK_GET_RIVIERA_DATA,d.PreviewsTimingEvents.FVSDK_INITIALIZE_COMPLETE,d.PreviewsTimingEvents.FVSDK_TITLE_BAR_MOUNT,d.PreviewsTimingEvents.FVSDK_APP_MOUNT,d.PreviewsTimingEvents.FVSDK_MARK_TTVC,d.PreviewsTimingEvents.FVSDK_IMAGE_CONTAINER_MOUNT,d.PreviewsTimingEvents.FVSDK_IMAGE_ON_LOAD,d.PreviewsTimingEvents.FVSDK_VIDEO_CONTAINER_MOUNT,d.PreviewsTimingEvents.FVSDK_VIDEO_PLAYER_READY,d.PreviewsTimingEvents.FVSDK_DOC_CONTAINER_MOUNT,d.PreviewsTimingEvents.FVSDK_FIRST_DOC_PAGE_ON_LOAD]),zn=new Set([...Kn,d.PreviewsTimingEvents.FVSDK_MARK_TTI]),$n=(e,t,i)=>{const o=r.useSelector((t=>t.loggingSession[e])),{batteries:s}=a.useFileViewerContext(),l=n.React$1.useRef(!1);return{onLogTimeline:n.React$1.useCallback((()=>{var e,r;const n=d.PreviewsEventLogger.getStartEntry();if(n&&!l.current){const a=d.PreviewsEventLogger.getEventTimeline();Object.entries(a).forEach((([e,r])=>{var n,a;i.has(e)&&(null===(a=null===(n=null==s?void 0:s.logger)||void 0===n?void 0:n.logDuration)||void 0===a||a.call(n,{eventName:t,durationInMs:r,tags:{event:e},session:o?xn(o):void 0}))})),null===(r=null===(e=null==s?void 0:s.logger)||void 0===e?void 0:e.logDuration)||void 0===r||r.call(e,{eventName:t,durationInMs:n.startTime,tags:{event:"session_start_since_load"},session:o?xn(o):void 0}),l.current=!0}}),[null==s?void 0:s.logger,t,o,i])}},Bn=(e,t)=>{const i=r.useDispatch(),o=r.useSelector((t=>t.loggingSession[e])),{batteries:s}=a.useFileViewerContext(),{onLogTimeline:l}=$n(e,"preview_timeline",zn),{onLogTimeline:c}=$n(e,`preview_timeline_ttvc_${t}`,Kn),u=n.React$1.useCallback((()=>{var t;d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_MARK_TTI),i((t=e,{type:ot.LogTTI,payload:t})),l()}),[e,i,l]),p=n.React$1.useCallback((e=>{var t,i,r;(null===(t=e.detail)||void 0===t?void 0:t.value)&&(null===(r=null===(i=null==s?void 0:s.logger)||void 0===i?void 0:i.logDuration)||void 0===r||r.call(i,{eventName:"TTI",durationInMs:e.detail.value,shouldLogToHive:!0,tags:{navigation_type:e.detail.isAjax?"ajax":"page_load"},session:o?xn(o):void 0}))}),[s,o]),v=n.React$1.useCallback((e=>{var t,i,r,n;d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_MARK_TTVC),(null===(t=e.detail)||void 0===t?void 0:t.value)&&(null===(r=null===(i=null==s?void 0:s.logger)||void 0===i?void 0:i.logDuration)||void 0===r||r.call(i,{eventName:"visually_complete",durationInMs:e.detail.value,tags:{navigation_type:null!==(n=e.detail.navigation_type)&&void 0!==n?n:"unknown",file_flip:String(!!(null==o?void 0:o.extra.was_flipped))},shouldLogToHive:!0,session:o?xn(o):void 0})),c()}),[null==s?void 0:s.logger,c,o]),g=n.React$1.useCallback((e=>{var t,i,r;d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_MARK_LCP),(null===(t=e.detail)||void 0===t?void 0:t.value)&&(null===(r=null===(i=null==s?void 0:s.logger)||void 0===i?void 0:i.logDuration)||void 0===r||r.call(i,{eventName:"largest_contentful_paint",durationInMs:e.detail.value,shouldLogToHive:!0,session:o?xn(o):void 0}))}),[s,o]);return n.React$1.useEffect((()=>(window.addEventListener("time_to_interactive",p),window.addEventListener("visually_complete",v),window.addEventListener("largest_contentful_paint",g),()=>{window.removeEventListener("time_to_interactive",p),window.removeEventListener("visually_complete",v),window.removeEventListener("largest_contentful_paint",g)})),[p,v,g]),{onLogTTI:u}};function Wn(e){return null!=e&&null!=e.preventDefault}function Hn(e){return function(t){e(),Wn(t)&&t.preventDefault()}}function qn({dispatch:e,fileViewerId:t,previewKey:i,requireCommandKey:n,fileIndex:a}){if(0===a)return[];const s=Hn((()=>{e(Ke({fileViewerId:t,previewKey:i,sourceContext:o.UserActionContext.Keyboard}))})),l={keyboardEventCriteria:{key:r.Key_enum.Key.ArrowLeft,osModifierKey:!0},callback:s};return n?[l]:[{keyboardEventCriteria:{key:r.Key_enum.Key.ArrowLeft},callback:s},l]}function Gn({dispatch:e,fileViewerId:t,previewKey:i,requireCommandKey:n,fileIndex:a,collectionFileCount:s}){if(a===s-1)return[];const l=Hn((()=>{e(Ue({fileViewerId:t,previewKey:i,sourceContext:o.UserActionContext.Keyboard}))})),c={keyboardEventCriteria:{key:r.Key_enum.Key.ArrowRight,osModifierKey:!0},callback:l};return n?[c]:[{keyboardEventCriteria:{key:r.Key_enum.Key.ArrowRight},callback:l},c]}function Zn(e){return{keyboardEventCriteria:{key:r.Key_enum.Key.PageDown},callback:Hn(e)}}function Xn(e){return{keyboardEventCriteria:{key:r.Key_enum.Key.ArrowDown},callback:Hn(e)}}function Yn(e){return[{keyboardEventCriteria:{key:"-",osModifierKey:!0},callback:Hn(e)}]}function Qn(e){return{keyboardEventCriteria:{key:r.Key_enum.Key.End},callback:Hn(e)}}function Jn({key:e,callback:t,shift:i,osModifierKey:r}){return{keyboardEventCriteria:{key:e,shiftKey:i||!1,osModifierKey:r||!1},callback:t}}const ea=()=>{},ta=n.reactExports.createContext({registerKeyBindings:ea,unregisterKeyBindings:ea});ta.displayName="KeyboardBindingContext";const ia=e=>{const{keyboardBindings:t,name:i,scope:r}=e,a=n.reactExports.useRef(i),o=n.reactExports.useRef(r||!1),s=n.reactExports.useContext(ta);return n.reactExports.useEffect((()=>(s.registerKeyBindings(t,a.current,o.current),()=>{s.unregisterKeyBindings(a.current,o.current)})),[t]),null};ia.displayName="KeyboardBindingConnector";const ra={altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,key:r.Key_enum.Key.Unidentified},na=Object.keys(ra);function aa(e){return na.map((t=>`${t}:${e[t]}`)).join("")}function oa(e,t){return function(e,t){return e.reduce(((e,{keyboardEventCriteria:i,callback:r})=>(e[t(i)]=r,e)),{})}(e,(e=>function(e,t){const i=function(e,t){return{altKey:!0===e.altKey,shiftKey:!0===e.shiftKey,key:e.key,ctrlKey:!1,metaKey:!1,[t]:!0===e.osModifierKey}}(e,t);return aa(i)}(e,t)))}class sa{constructor(e,t){this.bindingDict={},this.bindingDict=oa(e,t)}getCallbackForEvent(e){const t=function(e){return{altKey:!0===e.altKey,ctrlKey:!0===e.ctrlKey,metaKey:!0===e.metaKey,shiftKey:!0===e.shiftKey,key:e.key}}(e);return this.bindingDict[aa(t)]}}const la="default",ca=e=>{const{disableBindings:t,children:i,osModifierKey:r}=e,a=n.reactExports.useRef({}),o=n.reactExports.useRef(la),s=n.reactExports.useRef(null),l=n.reactExports.useCallback(((e,t,i)=>{if(a.current[i]||(a.current[i]={}),e){if(a.current[i][t])throw new Error(`Keybindings for name ${t} registered twice`);a.current[i][t]=e}else delete a.current[i][t];const n=a.current[o.current];s.current=new sa((e=>c.flatten(Object.values(e)))(n),r)}),[]),d=n.reactExports.useCallback(((e,t,i)=>{i&&t!==o.current&&(o.current=t),l(e,t,i?t:la)}),[]),u=n.reactExports.useCallback(((e,t)=>{t&&o.current===e&&(o.current=la),l(void 0,e,t?e:la)}),[]),p=n.reactExports.useCallback((e=>{var t;if(!function(e){const t=e.target||e.srcElement;if(!t)return!0;const i=t.tagName,r="INPUT"===i||"SELECT"===i||"TEXTAREA"===i,n=t instanceof HTMLInputElement&&("submit"===t.type||"button"==t.type);return!(t.hasAttribute&&t.hasAttribute("contenteditable")&&"false"!==t.getAttribute("contenteditable").toLowerCase())&&(!r||n)}(e))return;const i=null===(t=s.current)||void 0===t?void 0:t.getCallbackForEvent(e);i&&i(e)}),[]);n.reactExports.useEffect((()=>{if(!0!==t){const e=c.throttle(p,0);return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}}),[p]);const v=n.reactExports.useMemo((()=>({registerKeyBindings:d,unregisterKeyBindings:u,updateKeyBindings:l})),[]);return n.reactExports.createElement(ta.Provider,{value:v},i)};ca.displayName="KeyboardBindingProvider";const da=(e,t)=>{const{batteries:i}=a.useFileViewerContext(),r=or((e=>{var t;e instanceof Error&&(null===(t=i.optionalIOClients.reportExceptionClient)||void 0===t||t.reportException(e,s.PreviewType.Other,!0))}));n.reactExports.useEffect((()=>{var i,n;if(e){try{null===(n=null===(i=e.lifecycle)||void 0===i?void 0:i.pluginDidActivate)||void 0===n||n.call(i,t)}catch(e){r(e)}return()=>{var t,i;try{null===(i=null===(t=e.lifecycle)||void 0===t?void 0:t.pluginDidDeactivate)||void 0===i||i.call(t)}catch(e){r(e)}}}}),[e])};r.injectInternalStyle("js/file_viewer/ui/drawer_wrapper.module.out.css",(e=>"._drawer-wrapper_l6zsn_1{flex:1;min-width:0}._inline-drawer_l6zsn_6{box-sizing:border-box;width:329px}"));const ua="_drawer-wrapper_l6zsn_1",pa="_inline-drawer_l6zsn_6";class va extends n.React$1.PureComponent{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){this.props.onException(e)}render(){const{fallback:e,children:t}=this.props;return this.state.hasError?e:t}}va.displayName="_ErrorBoundary";const ga=({children:e,fallback:t,previewKey:i,onError:o})=>{const s=r.useDispatch(),l=r.useSelector((e=>i?a.getPreviewMetadata(e,i):void 0)),c=n.React$1.useCallback((e=>{var t;null==o||o(e),s(et({error:e,fileType:(null===(t=null==l?void 0:l.content)||void 0===t?void 0:t[".tag"])||"unknown",isCritical:!0}))}),[l]);return n.React$1.createElement(va,{fallback:t,children:e,onException:c})};ga.displayName="ErrorBoundary";const _a=()=>{},wa=n.reactExports.createContext({add:_a,update:_a,remove:_a,shouldOpen:!1}),fa={numberOfDrawers:0},ma=(e,t)=>{const{numberOfDrawers:i,drawer:r}=e;switch(t.kind){case"add":if(i>0)throw new Error("Drawer Wrapper already contains a Drawer, and will not function accurately. Have you considered using multiple Drawer Wrappers?");return{numberOfDrawers:i+1,drawer:r};case"update":const{drawer:e}=t;return{numberOfDrawers:i,drawer:Object.assign({},e)};case"remove":return{numberOfDrawers:i-1,drawer:r}}return e};r.injectInternalStyle("typescript/component_libraries/files_components/src/inline-drawer/wrapper.module.out.css",(e=>"._inlineDrawer-wrapper_g41bj_9{height:100%;overflow:hidden;position:relative}._inlineDrawer-wrapper-body_g41bj_15{height:100%}._inlineDrawer-wrapper-body--shouldAnimate_g41bj_23{transition-duration:var(--duration__surface);transition-property:margin,height;transition-timing-function:var(--easing__leave)}._inlineDrawer-wrapper-body--shouldAnimate_g41bj_23._inlineDrawer-wrapper-body--isOpen_g41bj_29{transition-timing-function:var(--easing__enter)}"));const ya="_inlineDrawer-wrapper_g41bj_9",ba="_inlineDrawer-wrapper-body_g41bj_15",ha="_inlineDrawer-wrapper-body--shouldAnimate_g41bj_23",Ea="_inlineDrawer-wrapper-body--isOpen_g41bj_29",xa=e=>{var{children:t,className:a,drawer:o}=e,s=i.__rest(e,["children","className","drawer"]);const{state:l,add:c,update:d,remove:u}=(()=>{const[e,t]=n.reactExports.useReducer(ma,fa);return{state:e,update:n.reactExports.useCallback((e=>{t({kind:"update",drawer:e})}),[t]),add:n.reactExports.useCallback((()=>{t({kind:"add"})}),[t]),remove:n.reactExports.useCallback((()=>{t({kind:"remove"})}),[t])}})(),{drawer:p}=l,v=(e=>{if(!e||e&&!e.isOpen)return null;const{alignment:t,dimension:i}=e;let r="";switch(t){case"bottom":r="marginBottom";break;case"left":r="marginLeft";break;case"right":r="marginRight"}if(!r||!i)return null;const n={[r]:`${i}px`};return"bottom"===t&&(n.height=`calc(100% - ${i}px)`),n})(p),g=!!p&&p.isOpen;return n.React$1.createElement(wa.Provider,{value:{add:c,update:d,remove:u,shouldOpen:g}},n.React$1.createElement("div",Object.assign({className:r.cx(ya,a)},s),n.React$1.createElement("div",{className:r.cx(ba,{[ha]:null!==p,[Ea]:g}),style:v||{}},t),o))};xa.displayName="InlineDrawerWrapper",xa.displayName="InlineDrawerWrapper";r.injectInternalStyle("typescript/component_libraries/files_components/src/inline-drawer/inline_drawer.module.out.css",(e=>"._drawer_1l8q0_1{background-color:var(--dig-color__background__base);border:0 solid var(--dig-color__border__subtle);display:flex;flex-direction:column;position:absolute}._drawer--shouldAnimate_1l8q0_11{transition:transform var(--duration__surface) var(--easing__leave)}._drawer--horizontal_1l8q0_15{bottom:0;max-width:100%;top:0}._drawer--vertical_1l8q0_21{left:0;max-height:100%;right:0}._drawer--leftAlign_1l8q0_27{border-right-width:1px;left:0;transform:translateX(-100%)}._drawer--rightAlign_1l8q0_33{border-left-width:1px;right:0;transform:translateX(100%)}._drawer--bottomAlign_1l8q0_39{border-top-width:1px;bottom:0;transform:translateY(100%)}._drawer--isOpen_1l8q0_45{transform:translate(0)}._drawer--isOpen_1l8q0_45._drawer--shouldAnimate_1l8q0_11{transition-timing-function:var(--easing__enter)}"));const Sa="_drawer_1l8q0_1",Pa="_drawer--shouldAnimate_1l8q0_11",Oa="_drawer--horizontal_1l8q0_15",Ia="_drawer--vertical_1l8q0_21",Ta="_drawer--leftAlign_1l8q0_27",Ra="_drawer--rightAlign_1l8q0_33",Fa="_drawer--bottomAlign_1l8q0_39",Ca="_drawer--isOpen_1l8q0_45",ja=e=>{var{alignment:t,isOpen:a,className:o,children:s,onWillOpen:l,onDidOpen:c,onWillClose:d,onDidClose:u}=e,p=i.__rest(e,["alignment","isOpen","className","children","onWillOpen","onDidOpen","onWillClose","onDidClose"]);const{add:v,update:g,remove:_,shouldOpen:w}=n.reactExports.useContext(wa),[f,m]=n.reactExports.useState(w===a),[y,b]=n.reactExports.useState(0);n.reactExports.useEffect((()=>{f||w!==a||m(!0)}),[f,w,a]);const h=n.reactExports.useRef(null);return n.reactExports.useEffect((()=>{g({isOpen:a,alignment:t,dimension:y}),h.current&&b("bottom"===t?h.current.clientHeight:h.current.clientWidth)}),[g,t,y,a]),n.reactExports.useEffect((()=>{if(a!==w)return;let e=l,t=c;w&&(e=d,t=u),e&&e(),setTimeout((()=>{t&&t()}),333)}),[a,w,d,l,u,c]),n.reactExports.useEffect((()=>(v(),()=>{_()})),[v,_]),n.React$1.createElement("div",Object.assign({className:r.cx(Sa,o,{[Oa]:"left"===t||"right"===t,[Ia]:"bottom"===t,[Ca]:w,[Pa]:f,[Ta]:"left"===t,[Ra]:"right"===t,[Fa]:"bottom"===t})},p,{ref:h}),s)};ja.displayName="InlineDrawer",ja.displayName="InlineDrawer";const ka=Object.assign(ja,{Wrapper:xa}),Da=({leftSidebarContent:e,rightSidebarContent:t,children:i,previewKey:r})=>n.React$1.createElement(ka.Wrapper,{drawer:n.React$1.createElement(Va,{sidebarContent:t,alignment:"right",previewKey:r}),className:ua},n.React$1.createElement(ka.Wrapper,{drawer:n.React$1.createElement(Va,{sidebarContent:e,alignment:"left",previewKey:r})},i));Da.displayName="DrawerWrapper";const Va=n.React$1.memo((({sidebarContent:e,alignment:t,previewKey:i})=>{const r=function(e){const t=n.reactExports.useRef();return n.reactExports.useEffect((()=>{t.current=e}),[e]),t.current}(e);return n.React$1.createElement(ga,{previewKey:i,fallback:null},n.React$1.createElement(ka,{alignment:t,isOpen:!!e,className:pa},null!=e?e:r))}));Va.displayName="SidebarDrawer";const Aa=(e,t,i,r)=>{const n=r&&gi(e,t);if(!n)return{activeOverlayEditPlugin:void 0,activeFullscreenEditPlugin:void 0,activeRightRailPlugin:void 0,activeCommentPlugin:void 0,editPluginActivationParams:void 0,rightRailPluginActivationParams:void 0,activeLeftSidebarPlugin:void 0,activeRightSidebarPlugin:void 0,activeLeftSidebarPluginId:void 0,activeRightSidebarPluginId:void 0};const{activeEditPluginId:o,activeRightRailPluginId:s,editPluginActivationParams:l,rightRailPluginActivationParams:c,sidebarPlugins:d}=n,u=s?(p=null==r?void 0:r[s])&&ie(p)?p:void 0:void 0;var p;const v=re(i?null==r?void 0:r[a.COMMENTS_PLUGIN_ID]:u),g=o?function(e){return e&&function(e){return!!e&&"editUI"in e}(e)?e:void 0}(null==r?void 0:r[o]):void 0,_=o?function(e){return e&&ae(e)?e:void 0}(null==r?void 0:r[o]):void 0,w=null==d?void 0:d.left,f=null==d?void 0:d.right;return{activeOverlayEditPlugin:g,activeFullscreenEditPlugin:_,activeRightRailPlugin:u,activeCommentPlugin:v,editPluginActivationParams:l,rightRailPluginActivationParams:c,activeLeftSidebarPlugin:w?se(null==r?void 0:r[w]):void 0,activeRightSidebarPlugin:f?se(null==r?void 0:r[f]):void 0,activeLeftSidebarPluginId:w,activeRightSidebarPluginId:f}},La=n.reactExports.memo((e=>{const{id:t,previewKey:i,isDeleteEnabled:s,isFileFlippingEnabled:l,isPreviewZoomed:c,enableFullscreen:d,dispatch:u,fileIndex:p,collectionFileCount:v}=e,g=a.useFileViewerSelector(a.getIsDeleteFileModalOpen,t),_=a.useFileViewerSelector(_i,t),w=d&&!_?Jn({callback:()=>u(Ve({previewKey:i,fileViewerId:t,sourceContext:o.UserActionContext.Keyboard})),key:"f"}):null,f=Jn({key:r.Key_enum.Key.Escape,callback:()=>{u(Be({previewKey:i,fileViewerId:t,sourceContext:o.UserActionContext.Keyboard}))}}),m=i&&function(e){const t=Jn({key:r.Key_enum.Key.Delete,callback:()=>{e(r.Key_enum.Key.Delete)}}),i=Jn({key:r.Key_enum.Key.Backspace,callback:()=>{e(r.Key_enum.Key.Backspace)}});return Nr?[t,i]:[t]}((e=>{u({payload:{previewKey:i,fileViewerId:t,sourceContext:o.UserActionContext.Keyboard,key:e===r.Key_enum.Key.Delete?"delete":"backspace"},type:me.Delete})})),y=[...Gn(b={dispatch:u,previewKey:i,fileViewerId:t,requireCommandKey:c,fileIndex:p,collectionFileCount:v}),...qn(b)];var b;const h=[];return w&&h.push(w),l&&!g&&(h.push(...y),h.push(f)),s&&!g&&m&&h.push(...m),n.reactExports.createElement(ia,{name:"app",keyboardBindings:h})}));La.displayName="AppKeyboardBindings";const Ma=e=>{var t,i,c,u,p,v,g;const{activeRightRailPlugin:_,activeCommentPlugin:w,activeOverlayEditPlugin:f,activeFullscreenEditPlugin:m,editPluginActivationParams:y,rightRailPluginActivationParams:b,activeLeftSidebarPlugin:h,activeRightSidebarPlugin:E,activeLeftSidebarPluginId:x,activeRightSidebarPluginId:S,config:P,dispatch:O,fileInfo:I,fileMetadata:T,fileConfig:R,id:F,previewType:C,shouldShowRightRail:j,shouldShowTitlebar:k,shouldShowTools:D,pluginProps:V,rightRailPluginInstances:A,pluginNavigation:L,isFullScreen:M,isPreviewZoomed:N,pluginInstances:U,onMount:K,onDestroy:z,callbacks:$,enabledEditPluginFullscreenActionDefinitions:B,components:W,isEditingVideo:H,defaultRightRailPlugin:q}=e,G=a.useFileViewerSelector(a.getFilePreviewSessionId,F),Z=!!r.useSelector((e=>wi(e,F))),X=n.reactExports.useCallback((()=>O(tt({isPreviewLoading:!1,fileViewerId:F}))),[O,F]),Y=((e,t,i=[])=>{const r=n.reactExports.useRef(null),a=()=>{r.current&&(window.clearTimeout(r.current),r.current=null)};return n.reactExports.useEffect((()=>a),[...i,t]),()=>{a(),r.current=window.setTimeout(e,t)}})((()=>{O(lt({event:o.EventType.UserEngaged3SecondsAfterRenderSucceeded,fileViewerId:F}))}),3e3,[F,G]),Q=or((()=>{G&&(O(st({event:o.SessionEventType.FilePreviewRenderSucceeded,fileViewerId:F,previewSessionId:G})),Y()),X(),(null==$?void 0:$.onRenderSucceeded)&&$.onRenderSucceeded()})),{onLogTTI:J}=Bn(F,C);d.useMarkTimingEventOnMount(d.PreviewsTimingEvents.FVSDK_APP_MOUNT),n.reactExports.useEffect((()=>{K&&K();const e=document.getSelection();return e&&e.removeAllRanges(),()=>{z&&z()}}),[z,K]);const ee=rn(),te=n.reactExports.useCallback((()=>{L.setActiveEditPlugin(a.PDF_EDITOR_PLUGIN_ID,o.UserActionContext.PostDownloadEditModal)}),[L]);n.reactExports.useEffect((()=>{const e=()=>{"#edit"===window.location.hash&&te()};return window.addEventListener("hashchange",e,!1),()=>{window.removeEventListener("hashchange",e)}}),[te]);const ie=a.useFileViewerSelector(a.getCurrentFilePreviewUI,F),re=M||H,ae=P.mobile_web,se=null!==(t=null==T?void 0:T.file_name)&&void 0!==t?t:"",le=P.transparent_background,ue=P.preview_content_only,{toolbarPlugins:pe,actionDefinitions:ve,snackbarManagerPluginInstance:ge}=n.reactExports.useMemo((()=>{const e=U&&Object.values(U),t=e&&function(e){return e.filter((e=>"toolbarUI"in e)).reduce(de,{})}(e),i=e&&function(e){return e.find(oe)}(e),r=e&&function(e){return e.filter((e=>ne(e))).map((e=>e.actionDefinitions()))}(e),n=r&&function(e,t){const i=e.reduce(ce,{}),r=e.reduce(((e,t)=>((e,t)=>{var i,r;const n=e;let a;for(a in t){const o=null!==(i=e[a])&&void 0!==i?i:[],s=null!==(r=t[a])&&void 0!==r?r:[];n[a]=[...o,...s]}return n})(e,t.categories||{})),{});return _e(r,t,i)}(r,B);return{toolbarPlugins:t,snackbarManagerPluginInstance:i,actionDefinitions:n}}),[null==I?void 0:I.previewKey,U,B]);da(f,y),da(_,b),da(m,y),da(h,y),da(_,y);const we=null!==(i=null==W?void 0:W.activationHub)&&void 0!==i?i:null,{titleBarActionSetters:fe,titleBarActionGetters:me}=function(){const e=r.useDispatch(),{fileViewerId:t}=a.useFileViewerContext(),i=a.useFileViewerSelector(a.getCurrentPreviewKey,t),s=n.reactExports.useCallback((()=>{e(qe({sourceContext:o.UserActionContext.TitleBarMain,fileViewerId:t,pluginId:void 0}))}),[e,t]),l=n.reactExports.useCallback((()=>{e(Be({sourceContext:o.UserActionContext.TitleBarMain,fileViewerId:t,previewKey:i}))}),[e,t,i]),c=r.useSelector((e=>_i(e,t))),[d,u]=n.reactExports.useState(!1),[p,v]=n.reactExports.useState(!1),[g,_]=n.reactExports.useState(!1),[w,f]=n.reactExports.useState(),[m,y]=n.reactExports.useState(),[b,h]=n.reactExports.useState((()=>s)),[E,x]=n.reactExports.useState((()=>l)),S=n.reactExports.useCallback((()=>{u(!1),v(!1),_(!1),f(void 0),y(void 0),h((()=>s))}),[s]);return n.reactExports.useEffect((()=>{c||S()}),[c,S]),{titleBarActionSetters:{setIsEditorReady:u,setHasEditorChanges:v,setEditorCanSave:_,setOnCancel:h,setOnSaveReplace:f,setOnSaveCopy:y,setOnClose:x},titleBarActionGetters:{isEditorReady:d,hasEditorChanges:p,editorCanSave:g,onCancel:b,onSaveReplace:w,onSaveCopy:m,onClose:E}}}(),ye=null==W?void 0:W.previewOverlay,be=null!==(c=null==W?void 0:W.banner)&&void 0!==c?c:null,he=D&&!me.isEditorReady?null==W?void 0:W.toolbar:void 0;if(m){if(V){const e=m.fullscreenLayer;return n.reactExports.createElement("div",{className:"_editPluginFullscreenContainer_1q5wf_41"},n.reactExports.createElement(e,Object.assign({},V,{titleBarActionSetters:fe})))}return null}const Ee=C===s.PreviewType.Video,xe=null===(u=null==W?void 0:W.titlebar)||void 0===u?void 0:u.component,Se=k&&(ae?null==W?void 0:W.mobileHeader:xe&&n.reactExports.createElement(xe,Object.assign({actions:ve},null==W?void 0:W.titlebar,{titleBarActionGetters:me,commentIconWithUnreadCount:null==w?void 0:w.commentUI.CommentIconWithUnreadCount}))),Pe=null===(p=null==f?void 0:f.editUI)||void 0===p?void 0:p.Sidebar;let Oe,Ie,Te;const Re=null===(v=null==W?void 0:W.sidebarContent)||void 0===v?void 0:v.component,Fe=!M&&D&&!f&&!H;j&&(Oe=Pe?n.reactExports.createElement(Mi,{fileViewerId:F,pluginNavigation:L,Sidebar:Pe}):Re?void 0:n.reactExports.createElement(zi,{fileName:se,fileViewerId:F,pluginInstances:A,pluginNavigation:L,defaultRightRailPlugin:q}),Re&&V&&Fe&&(Ie=x&&h&&n.reactExports.createElement(Re,{sidebarPluginId:x,sidebarPlugin:h,navigation:L,pluginProps:V}),Te=S&&E&&n.reactExports.createElement(Re,{sidebarPluginId:S,sidebarPlugin:E,navigation:L,pluginProps:V})));const Ce=a.filterAudioVideoFilePreviewUiState(ie),je=null!==(g=null==Ce?void 0:Ce.areControlsHidden)&&void 0!==g&&g;return n.reactExports.createElement("div",{className:"_file-viewer-area_1q5wf_50"},n.reactExports.createElement("div",{className:r.cx("_titleBarWrapper_1q5wf_76",{_isVideo_1q5wf_85:Ee,_isFullScreen_1q5wf_85:M,_hidden_1q5wf_81:je}),style:M&&!l.isRedesign2023Enabled(P)?{display:"none"}:{}},Se),n.reactExports.createElement("div",{className:"_renderer-row_1q5wf_57"},n.reactExports.createElement(Da,{leftSidebarContent:Ie,rightSidebarContent:Te,previewKey:null==I?void 0:I.previewKey},n.reactExports.createElement("div",{className:"_center-section_1q5wf_69"},!he||Ee&&M?void 0:n.reactExports.createElement(he,null),Fe&&be,n.reactExports.createElement(ui,{className:r.cx("_containerV2_1q5wf_26",{_transparentBackground_1q5wf_46:le})},(({width:e,height:t})=>{var i,r;const a={fileViewerId:F,width:e,height:t,onRenderSucceeded:Q,onInteractive:J,config:P,activeRightRailPlugin:_,activeCommentPlugin:w,activeOverlayEditPlugin:f,pluginProps:V,fileConfig:R,responsiveSize:ee,header:null==W?void 0:W.header,fileSaver:null==W?void 0:W.fileSaver,onSetPreviewLoaded:X,titleBarActionSetters:fe,pluginActivationParams:y},o=(()=>{switch(null==I?void 0:I.bootstrap.state){default:case"initializing":return null;case"ready":return n.reactExports.createElement(pi,Object.assign({},a,{previewKey:I.previewKey}))}})();return n.reactExports.createElement(Fr,{value:{rendererWidth:e,rendererHeight:t}},n.reactExports.createElement(dn,{width:e,activeCommentPlugin:w,plugins:pe,snackbarManagerPluginInstance:ge,fileConfig:R,activeEditOverlayPlugin:f},n.reactExports.createElement(pn,{previewKey:null==I?void 0:I.previewKey},o)),n.reactExports.createElement(La,{id:F,previewKey:null==I?void 0:I.previewKey,enableFullscreen:P.enable_fullscreen,isDeleteEnabled:!f&&!Z,isFileFlippingEnabled:null!=T&&!!T.file_collection_context&&!f&&!Z,isPreviewZoomed:N,dispatch:O,fileIndex:(null===(i=null==T?void 0:T.file_collection_context)||void 0===i?void 0:i.file_index)||0,collectionFileCount:(null===(r=null==T?void 0:T.file_collection_context)||void 0===r?void 0:r.parent_files_count)||0}),null!=ye?ye:null)})))),we,n.reactExports.createElement("div",{style:re?{display:"none"}:{}},Oe)),n.reactExports.createElement("div",{className:"_footer-row_1q5wf_65",style:M?{display:"none"}:{}},!ue&&ae?null==W?void 0:W.mobileFooter:null))};Ma.displayName="App";const Na=r.connect((function(e,t){const{config:i,id:r,pluginNavigation:n}=t,o=a.getRootFile(e,r),s=null==o?void 0:o.previewKey,c=a.getPreviewType(e,s),d=Oi(e,r,Ai(e,{fileViewerId:r,navigation:n})),{activeRightRailPlugin:u,activeCommentPlugin:p,activeFullscreenEditPlugin:v,activeOverlayEditPlugin:g,editPluginActivationParams:_,rightRailPluginActivationParams:w,activeLeftSidebarPlugin:f,activeRightSidebarPlugin:m,activeLeftSidebarPluginId:y,activeRightSidebarPluginId:b}=Aa(e,r,l.isRedesign2023Enabled(i),t.pluginInstances),h=a.getIsFullScreen(e,r),E=a.getIsEditingVideo(e,r),x=!i.preview_content_only&&!i.mobile_web,S=a.getAreToolsHidden(e,r),P=i.show_titlebar&&(!g||!!(null==g?void 0:g.allowTitleBar))&&!i.preview_content_only&&!S,O=t.pluginInstances?wn(t.pluginInstances,r):[];return{activeRightRailPlugin:u,activeCommentPlugin:p,activeFullscreenEditPlugin:v,activeOverlayEditPlugin:g,editPluginActivationParams:_,rightRailPluginActivationParams:w,activeLeftSidebarPlugin:f,activeRightSidebarPlugin:m,activeLeftSidebarPluginId:y,activeRightSidebarPluginId:b,fileViewerUiData:e.fileViewerUi[r],fileInfo:o,fileMetadata:a.getFileMetadata(e,s),isPreviewZoomed:a.isPreviewZoomed(e,r),pluginProps:d,previewType:c,shouldShowRightRail:x,shouldShowTitlebar:P,shouldShowTools:!S,isFullScreen:h,enabledEditPluginFullscreenActionDefinitions:O,isEditingVideo:E}}),(function(e){return{dispatch:e}}))(Ma),Ua=e=>{const{store:t,intl:o,batteries:s,platformConfig:l,pluginContext:c,isLoggedIn:d}=e,p=i.__rest(e,["store","intl","batteries","platformConfig","pluginContext","isLoggedIn"]),{id:v,config:g,canCloseViewer:_,pluginNavigation:w}=e,f=n.reactExports.useMemo((()=>({batteries:s,fileViewerId:v,featureConfig:g,platformConfig:l,pluginContext:c,canCloseViewer:_,pluginNavigation:w,isLoggedIn:d})),[s,v,g,l,c,_,w,d]);return n.reactExports.createElement(r.Provider,{store:t},n.reactExports.createElement(u.Provider,{value:o},n.reactExports.createElement(a.FileViewerContextProvider,{value:f},n.reactExports.createElement(pr,null,n.reactExports.createElement(ca,{disableBindings:!g.keyboard_shortcuts||g.preview_content_only,osModifierKey:l.osModifierKey},n.reactExports.createElement(r.LayerContext.Provider,{value:{zIndex:501}},n.reactExports.createElement(Na,Object.assign({intl:o},p))))))))};Ua.displayName="AppWithProvider";const Ka="@@apiv2_redux/previews/get_archive_files",za="@@apiv2_redux/previews/get_archive_files_result",$a="@@apiv2_redux/previews/get_preview_data_batch",Ba="@@apiv2_redux/previews/get_preview_data_batch_result",Wa="@@apiv2_redux/previews/get_preview_data_by_file_ids_batch",Ha="@@apiv2_redux/previews/get_preview_data_by_file_ids_batch_result",qa="@@apiv2_redux/previews/get_preview_data_by_specs_batch",Ga="@@apiv2_redux/previews/get_preview_data_by_specs_batch_result",Za="@@apiv2_redux/previews/logged_out/get_archive_files",Xa="@@apiv2_redux/previews/logged_out/get_archive_files_result",Ya=g._createAction(Ka),Qa=g._createAction(za),Ja=g._createAction($a),eo=g._createAction(Ba),to=g._createAction(Ha),io=g._createAction(Ga),ro=g._createAction(Za),no=g._createAction(Xa),ao={[Ka]:{endpoint:"get_archive_files",action:Qa},[$a]:{endpoint:"get_preview_data_batch",action:eo},[Wa]:{endpoint:"get_preview_data_by_file_ids_batch",action:to},[qa]:{endpoint:"get_preview_data_by_specs_batch",action:io},[Za]:{endpoint:"logged_out/get_archive_files",action:no}},oo=g._createMiddleware(ao),so="@@apiv2_redux/cloud_docs/add_image_preview_to_shortcut",lo="@@apiv2_redux/cloud_docs/add_image_preview_to_shortcut_result",co="@@apiv2_redux/cloud_docs/admin_settings/get",uo="@@apiv2_redux/cloud_docs/admin_settings/get_result",po="@@apiv2_redux/cloud_docs/admin_settings/set",vo="@@apiv2_redux/cloud_docs/admin_settings/set_result",go="@@apiv2_redux/cloud_docs/alpha/dropin_move",_o="@@apiv2_redux/cloud_docs/alpha/dropin_move_result",wo="@@apiv2_redux/cloud_docs/authorize",fo="@@apiv2_redux/cloud_docs/authorize_result",mo="@@apiv2_redux/cloud_docs/convert_gdd_to_ms_office_file",yo="@@apiv2_redux/cloud_docs/convert_gdd_to_ms_office_file_result",bo="@@apiv2_redux/cloud_docs/convert_to_web_shortcut",ho="@@apiv2_redux/cloud_docs/convert_to_web_shortcut_result",Eo="@@apiv2_redux/cloud_docs/create",xo="@@apiv2_redux/cloud_docs/create_result",So="@@apiv2_redux/cloud_docs/create_shortcut",Po="@@apiv2_redux/cloud_docs/create_shortcut_result",Oo="@@apiv2_redux/cloud_docs/create_web_shortcut_to_external_file",Io="@@apiv2_redux/cloud_docs/create_web_shortcut_to_external_file_result",To="@@apiv2_redux/cloud_docs/get_cloud_editor_url",Ro="@@apiv2_redux/cloud_docs/get_cloud_editor_url_result",Fo="@@apiv2_redux/cloud_docs/get_default_folder_id",Co="@@apiv2_redux/cloud_docs/get_default_folder_id_result",jo="@@apiv2_redux/cloud_docs/get_doc_state_and_actions",ko="@@apiv2_redux/cloud_docs/get_doc_state_and_actions_result",Do="@@apiv2_redux/cloud_docs/get_doc_state_and_actions_logged_out",Vo="@@apiv2_redux/cloud_docs/get_doc_state_and_actions_logged_out_result",Ao="@@apiv2_redux/cloud_docs/get_file_details",Lo="@@apiv2_redux/cloud_docs/get_file_details_result",Mo="@@apiv2_redux/cloud_docs/get_file_id",No="@@apiv2_redux/cloud_docs/get_file_id_result",Uo="@@apiv2_redux/cloud_docs/get_file_metadata",Ko="@@apiv2_redux/cloud_docs/get_file_metadata_result",zo="@@apiv2_redux/cloud_docs/get_gdd_migration_details",$o="@@apiv2_redux/cloud_docs/get_gdd_migration_details_result",Bo="@@apiv2_redux/cloud_docs/get_gdd_migration_settings",Wo="@@apiv2_redux/cloud_docs/get_gdd_migration_settings_result",Ho="@@apiv2_redux/cloud_docs/get_integrations",qo="@@apiv2_redux/cloud_docs/get_integrations_result",Go="@@apiv2_redux/cloud_docs/get_lock_provider",Zo="@@apiv2_redux/cloud_docs/get_lock_provider_result",Xo="@@apiv2_redux/cloud_docs/get_metadata",Yo="@@apiv2_redux/cloud_docs/get_metadata_result",Qo="@@apiv2_redux/cloud_docs/get_migration_folder_url_in_gdrive",Jo="@@apiv2_redux/cloud_docs/get_migration_folder_url_in_gdrive_result",es="@@apiv2_redux/cloud_docs/get_migration_report_url",ts="@@apiv2_redux/cloud_docs/get_migration_report_url_result",is="@@apiv2_redux/cloud_docs/get_navigation_properties",rs="@@apiv2_redux/cloud_docs/get_navigation_properties_result",ns="@@apiv2_redux/cloud_docs/get_pointer_url",as="@@apiv2_redux/cloud_docs/get_pointer_url_result",os="@@apiv2_redux/cloud_docs/get_preferred_editor_url",ss="@@apiv2_redux/cloud_docs/get_preferred_editor_url_result",ls="@@apiv2_redux/cloud_docs/get_token",cs="@@apiv2_redux/cloud_docs/get_token_result",ds="@@apiv2_redux/cloud_docs/google_shortcut_settings/get",us="@@apiv2_redux/cloud_docs/google_shortcut_settings/get_result",ps="@@apiv2_redux/cloud_docs/google_shortcut_settings/set",vs="@@apiv2_redux/cloud_docs/google_shortcut_settings/set_result",gs="@@apiv2_redux/cloud_docs/lock",_s="@@apiv2_redux/cloud_docs/lock_result",ws="@@apiv2_redux/cloud_docs/log_client_event",fs="@@apiv2_redux/cloud_docs/log_client_event_result",ms="@@apiv2_redux/cloud_docs/log_new_partner_users",ys="@@apiv2_redux/cloud_docs/log_new_partner_users_result",bs="@@apiv2_redux/cloud_docs/log_token_in_use",hs="@@apiv2_redux/cloud_docs/log_token_in_use_result",Es="@@apiv2_redux/cloud_docs/log_user_action",xs="@@apiv2_redux/cloud_docs/log_user_action_result",Ss="@@apiv2_redux/cloud_docs/logged_out/encrypt_email",Ps="@@apiv2_redux/cloud_docs/logged_out/encrypt_email_result",Os="@@apiv2_redux/cloud_docs/logged_out/get_pointer_url",Is="@@apiv2_redux/cloud_docs/logged_out/get_pointer_url_result",Ts="@@apiv2_redux/cloud_docs/logged_out/log_user_action",Rs="@@apiv2_redux/cloud_docs/logged_out/log_user_action_result",Fs="@@apiv2_redux/cloud_docs/pass_snackbar/get",Cs="@@apiv2_redux/cloud_docs/pass_snackbar/get_result",js="@@apiv2_redux/cloud_docs/pass_snackbar/set",ks="@@apiv2_redux/cloud_docs/pass_snackbar/set_result",Ds="@@apiv2_redux/cloud_docs/preferred_editor/get",Vs="@@apiv2_redux/cloud_docs/preferred_editor/get_result",As="@@apiv2_redux/cloud_docs/preferred_editor/set",Ls="@@apiv2_redux/cloud_docs/preferred_editor/set_result",Ms="@@apiv2_redux/cloud_docs/preferred_editor_prompt/disable",Ns="@@apiv2_redux/cloud_docs/preferred_editor_prompt/disable_result",Us="@@apiv2_redux/cloud_docs/rename",Ks="@@apiv2_redux/cloud_docs/rename_result",zs="@@apiv2_redux/cloud_docs/set_gdd_migration_settings",$s="@@apiv2_redux/cloud_docs/set_gdd_migration_settings_result",Bs="@@apiv2_redux/cloud_docs/signin_snackbar/get",Ws="@@apiv2_redux/cloud_docs/signin_snackbar/get_result",Hs="@@apiv2_redux/cloud_docs/signin_snackbar/set",qs="@@apiv2_redux/cloud_docs/signin_snackbar/set_result",Gs="@@apiv2_redux/cloud_docs/start_gdd_migration",Zs="@@apiv2_redux/cloud_docs/start_gdd_migration_result",Xs="@@apiv2_redux/cloud_docs/team_settings/get",Ys="@@apiv2_redux/cloud_docs/team_settings/get_result",Qs="@@apiv2_redux/cloud_docs/team_settings/set",Js="@@apiv2_redux/cloud_docs/team_settings/set_result",el="@@apiv2_redux/cloud_docs/unlock",tl="@@apiv2_redux/cloud_docs/unlock_result",il="@@apiv2_redux/cloud_docs/user_education_snackbar/get",rl="@@apiv2_redux/cloud_docs/user_education_snackbar/get_result",nl="@@apiv2_redux/cloud_docs/user_education_snackbar/set",al="@@apiv2_redux/cloud_docs/user_education_snackbar/set_result",ol=g._createAction(lo),sl=g._createAction(uo),ll=g._createAction(vo),cl=g._createAction(_o),dl=g._createAction(fo),ul=g._createAction(yo),pl=g._createAction(ho),vl=g._createAction(xo),gl=g._createAction(Po),_l=g._createAction(Io),wl=g._createAction(To),fl={[so]:{endpoint:"add_image_preview_to_shortcut",action:ol},[co]:{endpoint:"admin_settings/get",action:sl},[po]:{endpoint:"admin_settings/set",action:ll},[go]:{endpoint:"alpha/dropin_move",action:cl},[wo]:{endpoint:"authorize",action:dl},[mo]:{endpoint:"convert_gdd_to_ms_office_file",action:ul},[bo]:{endpoint:"convert_to_web_shortcut",action:pl},[Eo]:{endpoint:"create",action:vl},[So]:{endpoint:"create_shortcut",action:gl},[Oo]:{endpoint:"create_web_shortcut_to_external_file",action:_l},[To]:{endpoint:"get_cloud_editor_url",action:g._createAction(Ro)},[Fo]:{endpoint:"get_default_folder_id",action:g._createAction(Co)},[jo]:{endpoint:"get_doc_state_and_actions",action:g._createAction(ko)},[Do]:{endpoint:"get_doc_state_and_actions_logged_out",action:g._createAction(Vo)},[Ao]:{endpoint:"get_file_details",action:g._createAction(Lo)},[Mo]:{endpoint:"get_file_id",action:g._createAction(No)},[Uo]:{endpoint:"get_file_metadata",action:g._createAction(Ko)},[zo]:{endpoint:"get_gdd_migration_details",action:g._createAction($o)},[Bo]:{endpoint:"get_gdd_migration_settings",action:g._createAction(Wo)},[Ho]:{endpoint:"get_integrations",action:g._createAction(qo)},[Go]:{endpoint:"get_lock_provider",action:g._createAction(Zo)},[Xo]:{endpoint:"get_metadata",action:g._createAction(Yo)},[Qo]:{endpoint:"get_migration_folder_url_in_gdrive",action:g._createAction(Jo)},[es]:{endpoint:"get_migration_report_url",action:g._createAction(ts)},[is]:{endpoint:"get_navigation_properties",action:g._createAction(rs)},[ns]:{endpoint:"get_pointer_url",action:g._createAction(as)},[os]:{endpoint:"get_preferred_editor_url",action:g._createAction(ss)},[ls]:{endpoint:"get_token",action:g._createAction(cs)},[ds]:{endpoint:"google_shortcut_settings/get",action:g._createAction(us)},[ps]:{endpoint:"google_shortcut_settings/set",action:g._createAction(vs)},[gs]:{endpoint:"lock",action:g._createAction(_s)},[ws]:{endpoint:"log_client_event",action:g._createAction(fs)},[ms]:{endpoint:"log_new_partner_users",action:g._createAction(ys)},[bs]:{endpoint:"log_token_in_use",action:g._createAction(hs)},[Es]:{endpoint:"log_user_action",action:g._createAction(xs)},[Ss]:{endpoint:"logged_out/encrypt_email",action:g._createAction(Ps)},[Os]:{endpoint:"logged_out/get_pointer_url",action:g._createAction(Is)},[Ts]:{endpoint:"logged_out/log_user_action",action:g._createAction(Rs)},[Fs]:{endpoint:"pass_snackbar/get",action:g._createAction(Cs)},[js]:{endpoint:"pass_snackbar/set",action:g._createAction(ks)},[Ds]:{endpoint:"preferred_editor/get",action:g._createAction(Vs)},[As]:{endpoint:"preferred_editor/set",action:g._createAction(Ls)},[Ms]:{endpoint:"preferred_editor_prompt/disable",action:g._createAction(Ns)},[Us]:{endpoint:"rename",action:g._createAction(Ks)},[zs]:{endpoint:"set_gdd_migration_settings",action:g._createAction($s)},[Bs]:{endpoint:"signin_snackbar/get",action:g._createAction(Ws)},[Hs]:{endpoint:"signin_snackbar/set",action:g._createAction(qs)},[Gs]:{endpoint:"start_gdd_migration",action:g._createAction(Zs)},[Xs]:{endpoint:"team_settings/get",action:g._createAction(Ys)},[Qs]:{endpoint:"team_settings/set",action:g._createAction(Js)},[el]:{endpoint:"unlock",action:g._createAction(tl)},[il]:{endpoint:"user_education_snackbar/get",action:g._createAction(rl)},[nl]:{endpoint:"user_education_snackbar/set",action:g._createAction(al)}},ml=g._createMiddleware(fl),yl={},bl={},hl={},El={},xl={},Sl={},Pl={},Ol={},Il={},Tl={},Rl={},Fl={},Cl=[],jl={volume:1,muted:!1},kl={},Dl={currentPath:void 0},Vl=Object.assign(Object.assign({},Dl),{fitScaleFactor:0}),Al=Object.assign(Object.assign({},Dl),{currentPageIndex:0,fitScaleFactor:0}),Ll=Object.assign(Object.assign({},Dl),{currentTabIndex:0,fitScaleFactor:0}),Ml=Object.assign(Object.assign({},Dl),{currentTimestamp:0,isPlaying:!1,isTranscriptShowing:!1,isClosedCaptionShowing:!1,isDefaultAudioTrackSelected:!0,areControlsHidden:!1}),Nl={isDocSidebarOpen:!1,showVideoFrameSteppers:!1,isFullScreen:!1,hasBeenFlipped:!1,isRightRailOpen:!1,isEditingVideo:!1,isPreviewLoading:!1,isDeleteFileModalOpen:!1,isToolbarRenameActive:!1,isTitleBarRenameActive:!1,isRenameInitiatedFromOverflow:!1,toolbar:{override:void 0,overridePluginId:void 0},initialEditAction:void 0,isUiHidden:{fullscreen:!1,nonFullscreen:!1}},Ul=[".gdoc",".gslides",".paper",".papert",".binder"],Kl={max:16,min:.01,multiplier:1.25,delta:.05},zl={max:64,min:.01,multiplier:1.25,delta:.05},$l={max:10,min:.1,multiplier:1.1},Bl=(e,t,i)=>Math.abs(e-t)<Math.abs(e-i)?e:t,Wl=(e,t,i)=>{const{delta:r,multiplier:n}=i;let a=e*(t?n:1/n);return r&&(a=Math.round(a/r)*r,Math.abs(a-e)<r&&(a+=t?r:-r)),((e,{min:t,max:i})=>Math.min(Math.max(e,t),i))(a,i)},Hl=({scaleFactor:e,ascend:t,previewType:i,fitScaleFactor:r,useCombinedScale:n})=>{if(!e)return 1;const a=n?zl:(e=>e===s.PreviewType.SsrDoc?$l:Kl)(i),o=Wl(e,t,a),l=Wl(o,t,a);for(const i of((e,t)=>{const i=[1];return t&&Math.abs(1-t)>.02&&i.push(t),((e,t)=>e?e.sort(((e,i)=>t?e-i:i-e)):[])(i,e)})(t,r))if(t){if(e<i&&l>=i)return Bl(i,o,l)}else if(e>i&&l<=i)return Bl(i,o,l);return o},ql=(e,t)=>{switch(e){case s.PreviewType.Image:return Vl;case s.PreviewType.SsrDoc:return Al;case s.PreviewType.Excel:return Ll;case s.PreviewType.Audio:case s.PreviewType.Video:return Ml;case s.PreviewType.CloudDoc:return t&&Ul.includes(t)?Al:Dl;default:return Dl}},Gl={previewData:(e=yl,i)=>{var r;let n;switch(i.type){case me.SetPreviewMetadata:if(!l.isNestedArchiveFilePreviewKey(i.payload.previewKey))return n=i.payload.previewKey.serialized,Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({previewType:Z(i.payload)},e[n]),i.payload)});break;case Ba:{if(!i.payload||!i.payload.result)return e;const r=i.payload.result.results,n=i.meta.previewKey;return Object.assign(Object.assign({},e),r.reduce(((e,r)=>{var a;if(null==r.file.file_id){if(!(null===(a=i.payload.arg)||void 0===a?void 0:a.files)||1!==i.payload.arg.files.length)throw Error("Invalid response: file_id must be present in FileInfo for get_preview_data_batch");r.file.file_id=i.payload.arg.files[0].file_id}return r.preview&&(e[n.serialized]=Object.assign(Object.assign({},r.preview),{previewType:Z(r.preview)})),null!=r.err&&(e[n.serialized]=Object.assign(Object.assign({},e[n.serialized]),{previewType:s.PreviewType.Error,error:new nt(Mt(r.err),t.ErrorLifecycle.Download,`Got error from preview api: ${r.err[".tag"]}`)})),e}),{}))}case me.RefreshBlobSuccess:{if(!i.payload)return e;const{previewKey:t,preview:n}=i.payload;if(l.isNestedArchiveFilePreviewKey(t))return e;const a=t.serialized,o=null===(r=e[a])||void 0===r?void 0:r.content;return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({previewType:Z(e[a])},e[a]),{content:Object.assign(Object.assign({".tag":"ssr_doc"},o),n)})})}}return e},archiveFiles:(e=bl,t)=>{var i;switch(t.type){case za:case Xa:{const i=t.meta.rootFileId,r=c.cloneDeep(e);if(null==r[i]&&(r[i]={}),!t.payload||!t.payload.result)return r;for(const e of t.payload.result.archive_files)r[i]=Object.assign(Object.assign({},r[i]),{[e.subpath]:Object.assign(Object.assign({},e.preview),{previewType:Z(e.preview,e.filename)})});return r}case me.SetArchiveFiles:{const{rootFileId:i,files:r}=t.payload;return Object.assign(Object.assign({},e),{[i]:r})}case me.SetPreviewMetadata:if(l.isNestedArchiveFilePreviewKey(t.payload.previewKey)){const{rootFileId:r,subpath:n}=t.payload.previewKey;return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},e[r]),{[n]:Object.assign(Object.assign({previewType:Z(t.payload)},null===(i=e[r])||void 0===i?void 0:i[n]),t.payload)})})}}return e},fileMetadata:(e=hl,t)=>{const{payload:i}=t;if(!i)return e;if(t.type===me.InitializeFilePreview){const i=t.payload.fileInfo.file_id,r=t.payload.fileInfo.previewKey.serialized;return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},e[r]),{file_id:i,file_name:t.payload.fileName,size:t.payload.fileInfo.size,timeRange:t.payload.timeRange})})}if(t.type===me.SetFileMetadata){const i=t.payload.previewKey.serialized;return Object.assign(Object.assign({},e),{[i]:t.payload})}return e},rivieraData:(e=El,t)=>{var i;const{payload:r}=t;if(!r)return e;switch(t.type){case me.SetRivieraData:{const{previewKey:i,data:r}=t.payload;if(r)return Object.assign(Object.assign({},e),{[i.serialized]:r});break}case me.FetchPageDataWithMetadataResult:{const r=t.payload.previewKey.serialized,n=a.filterDocPreviewRivieraData(e[r]),o=null!==(i=null==n?void 0:n.pages)&&void 0!==i?i:[],s=null==n?void 0:n.isPasswordProtected,{metadata:l,pages:c,isPasswordProtected:d,needsPassword:u}=t.payload.data;if(!l)return e;let p=o||new Array(l.page_count);return Array.isArray(c)&&c.length&&(p=[...p],c.forEach((e=>p[e.pageIndex]=Object.assign(Object.assign({},p[e.pageIndex]),e)))),Object.assign(Object.assign({},e),{[r]:{isPasswordProtected:s||d,needsPassword:u,metadata:l,pages:p}})}case me.FetchExcelSheetLayoutData:{const i=t.payload.previewKey.serialized,r=e[i];if(null!=r&&"workbook"in r){if(!a.isExcelPreviewRivieraData(r))break;return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{sheets:Object.assign(Object.assign({},r.sheets),{[t.payload.sheetIndex]:{state:"pending"}})})})}return Object.assign(Object.assign({},e),{[i]:{sheets:{[t.payload.sheetIndex]:{state:"pending"}},workbook:{state:"pending"}}})}case me.FetchExcelSheetLayoutDataResult:{const i=t.payload.previewKey.serialized,{sheetIndex:r,data:n}=t.payload,o=e[i],s=a.isExcelPreviewRivieraData(o)?o.sheets:{};if(n)return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},o),{sheets:Object.assign(Object.assign({},s),{[r]:gt(n.sheets[r])}),workbook:Et(n)})});if(t.error){const n=a.isExcelPreviewRivieraData(o)&&"loaded"===o.workbook.state?o.workbook:vt(t.error);return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},o),{sheets:Object.assign(Object.assign({},s),{[r]:vt(t.error)}),workbook:n})})}break}case me.FetchTranscriptData:{const i=t.payload.previewKey.serialized,r=a.filterAudioVideoRivieraData(e[i]);if(r)return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{transcript:{state:"pending"}})});break}case me.FetchTranscriptDataResult:{const i=t.payload.previewKey.serialized,r=e[i],n=t.payload.transcript;if(!r)return e;if(t.error)return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{transcript:vt(t.error)})});if(n)return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{transcript:gt(n)})});break}case me.StartTranscriptGenerating:{const i=t.payload.previewKey.serialized,r=e[i];if(r)return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{transcript:{state:"pending"}})});break}case me.SetTranscriptError:{const i=t.payload.previewKey.serialized,r=e[i],n=t.error;if(n&&r)return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{transcript:vt(n)})});break}}return e},cloudDocsData:(e=xl,t)=>{const{payload:i,type:r,error:n}=t;if(r===Ro){if(n)return Object.assign(Object.assign({},e),{[t.payload.arg.file_id]:vt(n)});if(null==i?void 0:i.result)return Object.assign(Object.assign({},e),{[t.payload.arg.file_id]:gt(i.result)})}return e},filePreviewUi:(e=Sl,t)=>{var i,r,n,o,s,l,d;if(!t.payload)return e;if(t.type===me.InitializeFileViewer)return Object.assign(Object.assign({},e),{[t.payload.fileViewerId]:{}});let u;if(t.type===me.InitializeFilePreview)u=t.payload.fileInfo.previewKey.serialized;else{if(!t.payload.previewKey)return e;u=t.payload.previewKey.serialized}const p=t.payload.fileViewerId,v=e[p]||{},g=v[u]||{},_=a.filterZoomableFilePreviewUi(g);switch(t.type){case me.InitializeFilePreview:{const{previewType:i,fileExtension:r}=t.payload,n=ql(i,r);return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},n),g)})})}case me.InitializeNestedArchiveFilePreview:{const{previewType:i,currentPath:r}=t.payload,n=ql(i);return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign(Object.assign({},n),{currentPath:r}),g)})})}case me.PageNavigation:{const{sourceContext:i,pageIndex:r,centerOnYOffset:n}=t.payload;return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{pageNavigation:{sourceContext:i,pageIndex:r,centerOnYOffset:n}})})})}case me.ResolvePageNavigation:return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{pageNavigation:void 0})})});case me.UpdateDocCurrentPageIndex:const{pageCount:w}=t.payload;let{pageIndex:f}=t.payload;return f<0?f=0:w&&f>=w-1&&(f=w-1),Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{currentPageIndex:f})})});case me.PageUp:{const t=null!==(r=null===(i=a.filterDocFilePreviewUiState(g))||void 0===i?void 0:i.currentPageIndex)&&void 0!==r?r:null;if(t)return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{currentPageIndex:Math.max(t-1,0)})})});break}case me.PageDown:{const i=null!==(o=null===(n=a.filterDocFilePreviewUiState(g))||void 0===n?void 0:n.currentPageIndex)&&void 0!==o?o:null;if(i)return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{currentPageIndex:Math.min(i+1,t.payload.pageCount||1)})})});break}case me.ZoomIn:{if(null==_)return e;const{previewType:i,useCombinedScale:r}=t.payload,n=null!==(s=_.zoomScaleFactor)&&void 0!==s?s:_.fitScaleFactor;return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{zoomScaleFactor:Hl({scaleFactor:n,ascend:!0,previewType:i,fitScaleFactor:_.fitScaleFactor,useCombinedScale:r})})})})}case me.ZoomOut:{if(null==_)return e;const{previewType:i,useCombinedScale:r}=t.payload,n=null!==(l=_.zoomScaleFactor)&&void 0!==l?l:_.fitScaleFactor;return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{zoomScaleFactor:Hl({scaleFactor:n,ascend:!1,previewType:i,fitScaleFactor:_.fitScaleFactor,useCombinedScale:r})})})})}case me.ZoomToggleOriginalOrFit:{if(null==_)return e;const i=null!==(d=_.zoomScaleFactor)&&void 0!==d?d:_.fitScaleFactor,r=i===_.fitScaleFactor?1:void 0,n=(null==_?void 0:_.storedFitScaleFactor)&&1===i?null==_?void 0:_.storedFitScaleFactor:void 0,a=t.payload.fitOnly?void 0:n||r;return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{zoomScaleFactor:a})})})}case me.UpdateFitScaleFactor:{if(null==_)return e;const{fitScaleFactor:i}=_;return i===t.payload.fitScaleFactor?e:Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{storedFitScaleFactor:t.payload.storedFitScaleFactor,fitScaleFactor:t.payload.fitScaleFactor})})})}case me.UpdateFitToWidthScaleFactor:{if(null==_)return e;const{storedFitToWidthScaleFactor:i}=_;return i===t.payload.storedFitToWidthScaleFactor?e:Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{storedFitToWidthScaleFactor:t.payload.storedFitToWidthScaleFactor})})})}case me.UpdateZoomScaleFactor:{if(null==_)return e;const{fitScaleFactor:i,storedFitScaleFactor:r,storedFitToWidthScaleFactor:n,zoomScaleFactor:a}=_;let o=t.payload.zoomScaleFactor;return"fitToPage"===t.payload.zoomType?o=1===i?i:r:"fitToWidth"===t.payload.zoomType&&(o=n),a===o?e:Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{zoomScaleFactor:o})})})}case me.UpdateDimensions:return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{dimensions:t.payload.dimensions})})});case me.SwitchWorkbookTab:return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{currentTabIndex:t.payload.tabIndex})})});case me.UpdateArchiveFileCurrentPath:return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{currentPath:t.payload.currentPath})})});case me.UpdateAudioVideoPlaybackState:const m=c.pick(t.payload,"currentTimestamp","isPlaying");return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),m)})});case me.SetIsClosedCaptionShowing:return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{isClosedCaptionShowing:t.payload.showing})})});case me.SetIsTranscriptShowing:return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{isTranscriptShowing:t.payload.showing})})});case me.SetIsDefaultAudioTrackSelected:return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{isDefaultAudioTrackSelected:t.payload.isDefaultAudioTrackSelected})})});case me.SetAreVideoControlsHidden:return Object.assign(Object.assign({},e),{[p]:Object.assign(Object.assign({},v),{[u]:Object.assign(Object.assign({},g),{areControlsHidden:t.payload.areVideoControlsHidden})})})}return e},fileViewerUi:(e=Pl,t)=>{if(!t.payload)return e;const{fileViewerId:i}=t.payload;if(t.type===me.InitializeFileViewer)return Object.assign(Object.assign({},e),{[i]:Nl});const r=e[i];if(!r)return e;switch(t.type){case me.OpenRightRail:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isRightRailOpen:!0})});case me.CloseRightRail:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isRightRailOpen:!1})});case me.OpenDocSidebar:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isDocSidebarOpen:!0})});case me.CloseDocSidebar:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isDocSidebarOpen:!1})});case me.EnterFullScreen:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isFullScreen:!0})});case me.ExitFullScreen:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isFullScreen:!1})});case me.ToggleVideoFrameSteppers:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{showVideoFrameSteppers:t.payload.enabled})});case me.FlipToNextFile:case me.FlipToPreviousFile:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{hasBeenFlipped:!0})});case me.EditVideo:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isEditingVideo:!0,initialEditAction:t.payload.initialEditAction||void 0})});case me.CancelEditingVideo:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isEditingVideo:!1})});case me.SetPreviewLoadingAction:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isPreviewLoading:t.payload.isPreviewLoading})});case me.SetDeleteFileModalOpen:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isDeleteFileModalOpen:t.payload.isOpen})});case me.SetToolbarRenameActive:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isToolbarRenameActive:t.payload.isActive,isRenameInitiatedFromOverflow:t.payload.isRenameInitiatedFromOverflow})});case me.SetTitleBarRenameActive:return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isTitleBarRenameActive:t.payload.isActive})});case me.OverrideFloatingToolbar:{const{state:n,internal:a,pluginId:o}=t.payload;return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{toolbar:Object.assign(Object.assign({},r.toolbar),{override:n,overridePluginId:a?"fvsdk":o})})})}case me.SetUiShown:{const{isFullscreen:n}=t.payload,a=n?"fullscreen":"nonFullscreen";return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isUiHidden:Object.assign(Object.assign({},r.isUiHidden),{[a]:!1})})})}case me.SetUiHidden:{const{isFullscreen:n}=t.payload,a=n?"fullscreen":"nonFullscreen";return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},r),{isUiHidden:Object.assign(Object.assign({},r.isUiHidden),{[a]:!0})})})}default:return e}},loggingSession:(e=Il,t)=>{if(t.type===me.InitializeFilePreviewSession){const{fileViewerId:i,sourceSession:r}=t.payload;return Object.assign(Object.assign({},e),{[i]:hn({file_viewer_session_id:t.payload.fileViewerId,file_preview_session_id:bn(),file_id:t.payload.fileInfo.file_id,sj_id:t.payload.fileInfo.sj_id,ns_id:t.payload.fileInfo.ns_id,device_type:t.payload.deviceType,file_extension:G(t.payload.fileExtension),extra:r})})}if(t.type===ot.UpdateSession)return Object.assign(Object.assign({},e),{[t.payload.file_viewer_session_id]:t.payload});if(t.type===me.InitializeFilePreview){const{payload:{fileViewerId:i,fileInfo:r,previewType:n}}=t,a=e[i];return a?Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},a),{file_id:r.file_id,ns_id:r.ns_id,extra:Object.assign(Object.assign({},a.extra),{preview_type:n})})}):e}return e},rootFileInfo:(e=Ol,t)=>{var i;switch(t.type){case me.InitializeFilePreviewSession:const{rootPreviewKey:r,fileInfo:n}=t.payload;if(!r)return e;const a=null!==(i=n.file_id)&&void 0!==i?i:"fakeFileId";return Object.assign(Object.assign({},e),{[t.payload.fileViewerId]:Object.assign(Object.assign({fileId:a,previewKey:r},t.payload.fileInfo),{bootstrap:{state:"initializing"}})});case Ba:if(t.payload.result){const i={},r=t.meta.previewKey;for(const n of Object.keys(e)){const a=e[n];for(const e of t.payload.result.results)if((null==a?void 0:a.previewKey)===r){const t=e.file;i[n]=Object.assign(Object.assign({},t),{bootstrap:{state:"initializing"},previewKey:r})}}if(Object.keys(i).length>0)return Object.assign(Object.assign({},e),i)}return e;case me.SetBootstrappedFile:{const i=e[t.payload.fileViewerId];if((null==i?void 0:i.previewKey.serialized)===t.payload.previewKey.serialized)return Object.assign(Object.assign({},e),{[t.payload.fileViewerId]:Object.assign(Object.assign({},i),{bootstrap:{state:"ready"}})});break}}return e},fileContentMetadata:(e=Tl,t)=>{if(t.type===g.Action.GetFileContentMetadataResult&&t.payload.result){const i=(e=>{if(!e.meta)throw new Error(`missing meta argument to action ${e.type}`);return e.meta})(t).previewKey;return Object.assign(Object.assign({},e),{[i.serialized]:t.payload.result})}return e},plugins:(e=Rl,t)=>{var i,r,n,o,l,c;if(t.type===me.InitializeFileViewer){const{fileViewerId:i,pluginParams:r}=t.payload,{activeEditPlugin:n,editActivationParams:a}=r;return Object.assign(Object.assign({},e),{[i]:{activeRightRailPluginId:void 0,activeEditPluginId:n,hideContentPanePluginId:void 0,editPluginActivationParams:a,rightRailPluginActivationParams:void 0}})}if(t.type===me.SetPreviewMetadata&&t.payload.previewType===s.PreviewType.Error&&t.payload.fileViewerId){const{fileViewerId:i}=t.payload;return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},e[i]),{activeEditPluginId:void 0})})}if(t.type===me.SetActiveRightRailPlugin){const{fileViewerId:i,pluginId:r,pluginActivationParams:n}=t.payload;return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},e[i]),{activeRightRailPluginId:r,rightRailPluginActivationParams:n})})}if(t.type===me.FlipToNextFile||t.type===me.FlipToPreviousFile){const{fileViewerId:s}=t.payload;if((null===(i=e[s])||void 0===i?void 0:i.activeRightRailPluginId)===a.TRANSCRIPT_BLADE_PLUGIN_ID)return Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},e[s]),{activeRightRailPluginId:a.INFO_BLADE_PLUGIN_ID})});if((null===(n=null===(r=e[s])||void 0===r?void 0:r.sidebarPlugins)||void 0===n?void 0:n.right)===a.TRANSCRIPT_BLADE_PLUGIN_ID)return Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},e[s]),{sidebarPlugins:Object.assign(Object.assign({},null===(o=e[s])||void 0===o?void 0:o.sidebarPlugins),{right:void 0})})})}if(t.type===me.SetActiveEditPlugin){const{fileViewerId:i,pluginId:r,pluginActivationParams:n}=t.payload;return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},e[i]),{activeEditPluginId:r,editPluginActivationParams:n})})}if(t.type===me.HideContentPane){const{fileViewerId:i,pluginId:r}=t.payload;return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},e[i]),{hideContentPanePluginId:r})})}if(t.type===me.SetLeftSidebarPlugin){const{fileViewerId:i,pluginId:r}=t.payload;return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},e[i]),{sidebarPlugins:Object.assign(Object.assign({},null===(l=e[i])||void 0===l?void 0:l.sidebarPlugins),{left:r})})})}if(t.type===me.SetRightSidebarPlugin){const{fileViewerId:i,pluginId:r}=t.payload;return Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},e[i]),{sidebarPlugins:Object.assign(Object.assign({},null===(c=e[i])||void 0===c?void 0:c.sidebarPlugins),{right:r})})})}return e},sharedLinkInfo:(e=Fl,t)=>{const{payload:i,type:r}=t;if(r===me.SetSharedLinkInfo){const t=i.previewKey.serialized;return Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},e[t]),i)})}return e},videoRequests:(e=Cl,t)=>{switch(t.type){case me.RequestVideoSeek:return[...e,{videoRequestType:"seek",time:t.payload.time}];case me.RequestVideoSeekRelative:return[...e,{videoRequestType:"seekRelative",delta:t.payload.delta}];case me.RequestVideoPause:return[...e,{videoRequestType:"pause"}];case me.ClearVideoRequests:return[];default:return e}},volume:(e=jl,t)=>{switch(t.type){case me.SetVolume:return Object.assign(Object.assign({},e),{volume:t.payload.volume});case me.SetMuted:return Object.assign(Object.assign({},e),{muted:t.payload.muted});default:return e}},brandingInfo:(e=kl,t)=>{const{payload:i,type:r}=t;if(r===me.SetBrandingInfo){const t=i.previewKey.serialized;return Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},e),i)})}return e}},Zl=({getState:e,dispatch:r})=>n=>o=>i.__awaiter(void 0,void 0,void 0,(function*(){var i,c,d,u,p,v;const g=e();switch(o.type){case me.FetchPageDataWithMetadata:{const{textUrlTmpl:e,startPage:r,endPage:l,previewKey:c,fileViewerId:d}=o.payload,u=null===(i=a.getPreviewMetadata(g,c))||void 0===i?void 0:i.content,p=a.getRivieraData(g,c);if(!u||!("image_url_tmpl"in u)||!u.image_url_tmpl)return n(o);const v=yield jt.fetchPageDataWithMetadata({supportedWidths:"supported_widths"in u?u.supported_widths:void 0,imageUrlTmpl:u.image_url_tmpl,textUrlTmpl:e},r,l,p);return v.error?n(ze({previewKey:c,previewType:s.PreviewType.Error,error:new nt(t.FVErrorCode.RivieraDataFetchFailure,t.ErrorLifecycle.Download,v.error.message)})):n(xe({fileViewerId:d,previewKey:c,data:v.data}))}case me.FetchTranscriptData:{const e=o.payload.previewKey;if(l.isNestedArchiveFilePreviewKey(e))return n(o);fn(!!g.previewData[e.serialized],t.FVErrorCode.InvalidFileInfo,t.ErrorLifecycle.Download,`Preview Data for ${e.serialized} should have been available`);const i=a.getPreviewMetadata(g,e),r=kt(null==i?void 0:i.content),s=yield jt.fetchTranscriptData(o.payload.url,r),u=Object.assign({segments:null!==(d=null===(c=s.data)||void 0===c?void 0:c.segments)&&void 0!==d?d:[]},s.data);return n((_={transcript:u,previewKey:e},w=s.error,{type:me.FetchTranscriptDataResult,payload:_,error:w}))}case me.RefreshBlob:{const{previewKey:e,fileViewerId:i}=o.payload,l=a.getPreviewMetadata(g,e),c=yield jt.refreshDocBlob(o.payload.refreshUrl,o.payload.password);if((null===(u=c.error)||void 0===u?void 0:u.statusCode)===t.RivieraStatus.PasswordProtected)return n(xe({fileViewerId:i,previewKey:e,data:{pages:[],metadata:{page_count:0,dimensions:[]},isPasswordProtected:!0,needsPassword:!0}}));if(c.error)return n(ze({previewKey:e,previewType:s.PreviewType.Error,error:new nt(t.FVErrorCode.RivieraDataFetchFailure,t.ErrorLifecycle.Download,c.error.message)}));const d=c.data;if(n(function(e){return{payload:e,type:me.RefreshBlobSuccess}}({previewKey:e,preview:{text_url_tmpl:d.text,image_url_tmpl:d.image,refresh_url:d.refresh}})),!l)return n(ze({previewKey:e,previewType:s.PreviewType.Error,error:new nt(t.FVErrorCode.InvalidFileInfo,t.ErrorLifecycle.Download,`Preview Data for ${e.serialized} should have been available`)}));if(o.payload.password)return r(Ee({fileViewerId:i,previewKey:e,textUrlTmpl:d.text}));const _=a.getFilePreviewUi(g,o.payload.fileViewerId,e),w=Ut(null!==(v=null===(p=a.filterDocFilePreviewUiState(_))||void 0===p?void 0:p.currentPageIndex)&&void 0!==v?v:0);return r(Ee({fileViewerId:i,previewKey:e,textUrlTmpl:d.text,startPage:w[0],endPage:w[1]}))}case me.FetchExcelSheetLayoutData:{n(o);const{sheetIndex:e,workbookDataUrlTmpl:t,previewKey:i,fileViewerId:a}=o.payload,s=yield jt.fetchExcelWorkbookLayoutData(t,e);return r(function(e,t){return{type:me.FetchExcelSheetLayoutDataResult,payload:e,error:t}}({fileViewerId:a,previewKey:i,sheetIndex:e,data:s.data},s.error))}}var _,w;return n(o)})),Xl=({getState:e})=>t=>i=>{var r;const n=e(),{filePreviewUi:o,rivieraData:l}=n,{previewKey:c,fileViewerId:d}=i.payload;if(!c)return t(i);const u=a.getPreviewMetadata(n,c),p=l[c.serialized];if(!o[d]||!u||!u.content)return t(i);if(!(null===(r=o[d])||void 0===r?void 0:r[c.serialized]))return t(i);switch(i.type){case me.ZoomIn:return t(Oe(Object.assign(Object.assign({},i.payload),{previewType:"ssr_doc"===u.content[".tag"]?s.PreviewType.SsrDoc:s.PreviewType.Image})));case me.ZoomOut:return t(Ie(Object.assign(Object.assign({},i.payload),{previewType:"ssr_doc"===u.content[".tag"]?s.PreviewType.SsrDoc:s.PreviewType.Image})));case me.UpdateDocCurrentPageIndex:{const e=a.filterDocPreviewRivieraData(p);if((u.content[".tag"]===s.PreviewType.SsrDoc||u.content[".tag"]===s.PreviewType.CloudDoc)&&(null==e?void 0:e.metadata))return t(Se(Object.assign(Object.assign({},i.payload),{pageCount:e.metadata.page_count})));break}case me.PageDown:{const e=a.filterDocPreviewRivieraData(p);if((u.content[".tag"]===s.PreviewType.SsrDoc||u.content[".tag"]===s.PreviewType.CloudDoc)&&(null==e?void 0:e.metadata))return t((v=Object.assign(Object.assign({},i.payload),{pageCount:e.metadata.page_count}),{type:me.PageDown,payload:v}));break}}var v;return t(i)};function Yl(e){return({dispatch:t})=>i=>r=>(r.type===me.DownloadFile?e.downloadFile():r.type===me.CopyToDropbox&&e.copyToDropbox({role:r.payload.role,logModalConfirm:()=>{t(ct({userAction:o.UserAction.SaveToDropboxApprove,fileViewerId:r.payload.fileViewerId,actionContext:o.UserActionContext.RightRail}))},logModalCancel:()=>{t(ct({userAction:o.UserAction.SaveToDropboxCancel,fileViewerId:r.payload.fileViewerId,actionContext:o.UserActionContext.RightRail}))}}),i(r))}function Ql(e){return({dispatch:t})=>r=>n=>i.__awaiter(this,void 0,void 0,(function*(){const i=r(n);if(n.type===me.Rename&&e.rename){const{newFilename:i,isRenameFromOverflowMenu:r}=n.payload,a=()=>{t(ct({userAction:o.UserAction.RenameSuccess,fileViewerId:n.payload.fileViewerId,actionContext:n.payload.sourceContext}))},s=()=>{t(ct({userAction:o.UserAction.RenameFailed,fileViewerId:n.payload.fileViewerId,actionContext:n.payload.sourceContext}))};e.rename({newFilename:i,isRenameFromOverflowMenu:r,onRenameSuccess:a,onRenameFailed:s})}else if(n.type===me.Delete&&e.delete){const i=()=>{t(ct({userAction:o.UserAction.Delete,fileViewerId:n.payload.fileViewerId,actionContext:n.payload.sourceContext,extra:{key:n.payload.key}}))},r=()=>{t(ct({userAction:o.UserAction.DeleteSuccess,fileViewerId:n.payload.fileViewerId,actionContext:n.payload.sourceContext}))},a=()=>{t(ct({userAction:o.UserAction.DeleteFailed,fileViewerId:n.payload.fileViewerId,actionContext:n.payload.sourceContext}))},s=()=>{t(ct({userAction:o.UserAction.DeleteFailedNoPermission,fileViewerId:n.payload.fileViewerId,actionContext:n.payload.sourceContext}))},l=()=>{t(ct({userAction:o.UserAction.DeleteCancel,fileViewerId:n.payload.fileViewerId,actionContext:n.payload.sourceContext}))},c=e=>{t(he({isOpen:e,fileViewerId:n.payload.fileViewerId}))};e.delete({onDelete:i,onDeleteSuccess:r,onDeleteFailed:a,onDeleteFailedNoPermission:s,onDeleteCancel:l,setDeleteFileModalOpen:c})}return i}))}function Jl(e){return({dispatch:t})=>r=>n=>i.__awaiter(this,void 0,void 0,(function*(){const i=r(n);if(n.type===me.EnterFullScreen){const{fileViewerId:i,previewKey:r}=n.payload,a=()=>{t(Ae(Object.assign(Object.assign({},n.payload),{skipAction:!0})))};e.enterFullScreen(a,!!n.payload.skipAction),t(Te({fileViewerId:i,previewKey:r,sourceContext:o.UserActionContext.Toolbar,fitOnly:!0,skipLogging:!0}))}else n.type===me.ExitFullScreen&&e.exitFullScreen(!!n.payload.skipAction);return i}))}function ec(e){return({getState:t})=>i=>r=>{var n,o,s,l,c,d;switch(r.type){case me.Share:return null===(n=e.openShareModal)||void 0===n||n.call(e),i(r);case me.OpenWith:return null===(o=e.openDefaultNativeApp)||void 0===o||o.call(e),i(r);case me.OpenWebPreview:return null===(s=e.openWebPreview)||void 0===s||s.call(e),i(r);case me.OpenVersionHistory:return e.openVersionHistory(),i(r);case me.Restore:return e.restorePreviousVersion(),i(r);case me.OpenFullscreenPreview:return e.openFullScreenPreview&&e.openFullScreenPreview(),i(r);case me.OpenUrl:const{url:u,fallbackUrl:p}=r.payload;return e.openUrl&&e.openUrl(u,p),i(r);case me.CloseViewer:const v=a.getCurrentFilePreviewUI(t(),r.payload.fileViewerId),g=r.payload.previewKey;if(g&&(null===(l=null==v?void 0:v.currentPath)||void 0===l?void 0:l.length)){const e=v.currentPath.slice(0,-1);return i(Xe(Object.assign(Object.assign({},r.payload),{previewKey:g,currentPath:e,fromUrlChanged:!1,isDir:!0})))}return e.closeViewer&&e.closeViewer(),i(r);case me.ShowAuthModal:const{encryptionOptions:_,sharedLinkUrl:w,kind:f,mode:m,loggingExtra:y}=r.payload;return e.showAuthModal&&e.showAuthModal({encryptionOptions:_,sharedLinkUrl:w,kind:f,mode:m,loggingExtra:y}),i(r);case me.FlipToNextFile:return null===(c=e.flipToNextFile)||void 0===c||c.call(e),i(r);case me.FlipToPreviousFile:return null===(d=e.flipToPreviousFile)||void 0===d||d.call(e),i(r);case me.UpdateFiles:return e.updateFiles&&e.updateFiles(),i(r);default:return i(r)}}}function tc(e){return({getState:t})=>r=>n=>i.__awaiter(this,void 0,void 0,(function*(){const i=r(n);if(n.type===me.Print){const{fileViewerId:i,previewType:r}=n.payload,o=a.getPrintUrl(t(),i);e.print(o,r)}return i}))}const ic="unfurl",rc="file_subpath";function nc(e){return()=>t=>i=>{switch(i.type){case me.UpdateArchiveFileCurrentPath:i.payload.fromUrlChanged||e.setQueryStringParameter(rc,0===(r=i.payload.currentPath).length?null:`/${r.join("/")}`);break;case me.OpenFileURL:e.openFile(i.payload.fqPath);break;case me.CloseViewer:e.setQueryStringParameter(rc,null);break;case me.Redirect:e.redirect(i.payload.href,i.payload.newTab);break;case me.InitializeFileViewer:null!==e.getQueryStringParameter(ic)&&e.setQueryStringParameter(ic,null)}var r;return t(i)}}function ac(e){return()=>t=>i=>(i.type===me.TriggerDynamicRoutingModalCheck&&e.triggerDynamicRoutingModalCheck(),t(i))}const oc=({store:e,fileViewerId:t,reinitializeFileViewer:r,exitPluginEditMode:n,hideContentPane:s,updatePreviewMetadata:l,showAuthModal:c,canCloseViewer:d,sdkBatteries:u})=>({fileFlipping:{flipToNextFile(i){const r=Vi(e.getState(),t);null!=r&&e.dispatch(Ue({fileViewerId:t,previewKey:r,sourceContext:i}))},flipToPreviousFile(i){const r=Vi(e.getState(),t);null!=r&&e.dispatch(Ke({fileViewerId:t,previewKey:r,sourceContext:i}))}},navigateToPage(i,r){const n=Vi(e.getState(),t);null!=n&&(e.dispatch(Se({fileViewerId:t,previewKey:n,pageIndex:i,sourceContext:r})),e.dispatch(Pe({fileViewerId:t,previewKey:n,sourceContext:o.UserActionContext.RightRail,pageIndex:i})))},closeRightRail(i){e.dispatch(Me({fileViewerId:t,sourceContext:i}))},openRightRail(i){e.dispatch(Le({fileViewerId:t,sourceContext:i}))},getActiveRightRailPluginId:()=>vi(e.getState(),t),getIsRightRailOpen:()=>a.isRightRailOpen(e.getState(),t),openUrl({url:t,fallbackUrl:i}){e.dispatch(Ne({url:t,fallbackUrl:i}))},reinitializeFileViewer(e){r(e)},exitEditMode(){n()},setActiveEditPlugin(i,r,n){e.dispatch(qe({fileViewerId:t,pluginId:i,sourceContext:r,pluginActivationParams:n}))},hideContentPane(e){s(e)},updatePreviewMetadata(e,t){l(e,t)},startToolbarRename(i=!1){e.dispatch(be({isActive:!0,isRenameInitiatedFromOverflow:i,fileViewerId:t}))},toggleRenameState(i=!1){e.dispatch({payload:{fileViewerId:t,isActive:i},type:me.SetTitleBarRenameActive})},setDeleteFileModalOpen(i){e.dispatch(he({isOpen:i,fileViewerId:t}))},seek(t){var i;e.dispatch((i={time:t},{type:me.RequestVideoSeek,payload:i}))},seekRelative(t){var i;e.dispatch((i={delta:t},{type:me.RequestVideoSeekRelative,payload:i}))},pause(){e.dispatch({type:me.RequestVideoPause,payload:{}})},generateTranscript(i){const r=Vi(e.getState(),t);if(!r)return!1;const n=a.getPreviewMetadata(e.getState(),r),o=kt(null==n?void 0:n.content),s=a.getVideoTranscriptData(e.getState(),r);if(!Dt(o,s))return!1;const l=u.optionalIOClients.flowsClient;if(!l)return!1;var c;e.dispatch((c={previewKey:r},{type:me.StartTranscriptGenerating,payload:c}));const d=a.getSharedLinkInfo(e.getState(),t);return l.submitFileWorkflow({template:{sequence:[{workflow_action:{".tag":"transcribe_media"}}]},file_ids:[i],shared_link_url:null==d?void 0:d.url},900).then((t=>{var i,n;if("success"===t.status){const t=a.getPreviewMetadata(e.getState(),r);"video"!==(null===(i=null==t?void 0:t.content)||void 0===i?void 0:i[".tag"])&&"audio"!==(null===(n=null==t?void 0:t.content)||void 0===n?void 0:n[".tag"])||!t.content.transcript_url||e.dispatch(function(e){return{payload:e,type:me.FetchTranscriptData}}({url:t.content.transcript_url,previewKey:r}))}else if("error"===t.status){const i=new Ot(t.errorReason||"error_unknown");e.dispatch(function(e,t){return{type:me.SetTranscriptError,payload:e,error:t}}({previewKey:r},i))}return!0})),!0},setOptInToVideoTranscript(){return i.__awaiter(this,void 0,void 0,(function*(){var i;e.dispatch((i={fileViewerId:t,onSuccess:r},{type:me.SetOptInToVideoTranscript,payload:i}))}))},openVideoEditor(i){var r;e.dispatch((r={fileViewerId:t,sourceContext:o.UserActionContext.TitleBarMain,initialEditAction:i},{type:me.EditVideo,payload:r}))},toggleVideoFrameSteppers(i){var r;e.dispatch((r={fileViewerId:t,enabled:i},{type:me.ToggleVideoFrameSteppers,payload:r}))},overrideFloatingToolbar(i,r){e.dispatch(Ye({fileViewerId:t,state:r,pluginId:i}))},navigateToPath(t){e.dispatch({payload:{fqPath:t},type:me.OpenFileURL})},showAuthModal:c,canCloseViewer:d,openRightRailPlugin(i,r){null!=Vi(e.getState(),t)&&(e.dispatch(Le({fileViewerId:t,sourceContext:i})),e.dispatch(He({fileViewerId:t,sourceContext:i,pluginId:r})))},setIsTranscriptShowing(i){const r=Vi(e.getState(),t);var n;r&&e.dispatch((n={fileViewerId:t,previewKey:r,showing:i},{type:me.SetIsTranscriptShowing,payload:n}))},openLeftSidebarPlugin(i,r){Vi(e.getState(),t)&&e.dispatch(Ge({fileViewerId:t,sourceContext:r,pluginId:i}))},openRightSidebarPlugin(i,r){Vi(e.getState(),t)&&e.dispatch(Ze({fileViewerId:t,sourceContext:r,pluginId:i}))},closeSidebarPlugin(i,r){Vi(e.getState(),t)&&(function(e,t){var i,r;return null===(r=null===(i=gi(e,t))||void 0===i?void 0:i.sidebarPlugins)||void 0===r?void 0:r.left}(e.getState(),t)===i?e.dispatch(Ge({fileViewerId:t,sourceContext:r,pluginId:void 0})):function(e,t){var i,r;return null===(r=null===(i=gi(e,t))||void 0===i?void 0:i.sidebarPlugins)||void 0===r?void 0:r.right}(e.getState(),t)===i&&e.dispatch(Ze({fileViewerId:t,sourceContext:r,pluginId:void 0})))},closeViewer(i){const r=Vi(e.getState(),t);e.dispatch(Be({fileViewerId:t,previewKey:r,sourceContext:i}))}});class sc{constructor(e,t,r,n,c,d){this.instances={},this.rightRailInstances={},this.loadPlugins=()=>i.__awaiter(this,void 0,void 0,(function*(){const e={},t={};this.instances=e,this.rightRailInstances=t;const i=yield Promise.all(this.wrappedPluginLoaders.map((e=>e.load())));i.forEach((i=>{if(i){const[r,n]=i;e[r]=n,ie(n)&&(t[r]=n)}}))})),this.wrapPluginLoader=e=>{const t=e.pluginId,{intl:r}=this.platformProps,n={intl:r,apiv2ClientBase:this.apiv2ClientBase};let a=null,o=null;const s=()=>i.__awaiter(this,void 0,void 0,(function*(){if(a)return[t,a];const i=performance.now();return a=yield e.load(n,this.context),this.store.dispatch(ut({eventName:"plugin_load_ms",duration:performance.now()-i,fileViewerId:this.fileViewerId,tags:{pluginName:t,isRedesign2023Enabled:l.isRedesign2023Enabled(this.platformProps.config).toString()}})),[t,a]}));return{load:()=>e.isEnabled&&!e.isEnabled(this.context)?Promise.resolve(null):(o||(o=s()),o)}},this.exitPluginEditMode=e=>i.__awaiter(this,void 0,void 0,(function*(){this.store.dispatch(qe({fileViewerId:this.fileViewerId,sourceContext:e||o.UserActionContext.Editor,pluginId:void 0}))})),this.hideContentPane=e=>{var t;this.store.dispatch((t={fileViewerId:this.fileViewerId,sourceContext:o.UserActionContext.Toolbar,pluginId:e},{type:me.HideContentPane,payload:t}))},this.updatePreviewMetadata=(e,t)=>{const i=e.file_id,r=e.sj_id,n=e.ns_id,a=e.url,o=l.getPreviewKey(i,n,r,a);t&&o&&this.store.dispatch(ze(Object.assign(Object.assign({},t),{previewKey:o})))},this.reinitializeFileViewer=e=>i.__awaiter(this,void 0,void 0,(function*(){this.reinitialize(e)})),this.getPluginInstances=()=>({pluginInstances:this.instances,rightRailPluginInstances:this.rightRailInstances}),this.doTeardown=()=>i.__awaiter(this,void 0,void 0,(function*(){var e,t;try{yield this.triggerPluginsPreviewWillTeardown()}catch(i){i instanceof Error&&(null===(t=null===(e=this.sdkBatteries.optionalIOClients.reportExceptionClient)||void 0===e?void 0:e.reportException)||void 0===t||t.call(e,i,s.PreviewType.Other,!0))}})),this.fileViewerId=n,this.platformProps=e,this.apiv2ClientBase=t,this.reinitialize=c,this.sdkBatteries=d;const{store:u,config:p,showAuthModal:v,canCloseViewer:g}=e;this.store=u,this.navigation=oc({store:u,fileViewerId:n,reinitializeFileViewer:this.reinitializeFileViewer,exitPluginEditMode:this.exitPluginEditMode,hideContentPane:this.hideContentPane,updatePreviewMetadata:this.updatePreviewMetadata,showAuthModal:v,canCloseViewer:g,sdkBatteries:d}),this.context=function({store:e,sdkConfig:t,fileViewerId:i,navigation:r}){return{fileViewerId:i,getFilePreviewSessionId:()=>a.getFilePreviewSessionId(e.getState(),i),getFileViewerSessionId:()=>{var t;return null===(t=a.getFilePreviewSession(e.getState(),i))||void 0===t?void 0:t.file_viewer_session_id},logUserAction:(t,r,n)=>{e.dispatch(lt({event:o.EventType.UserAction,fileViewerId:i,extra:Object.assign(Object.assign({action:t},r?{context:r}:{}),n||{})}))},sdkConfig:t,getPluginData:()=>Ai(e.getState(),{fileViewerId:i,navigation:r})}}({store:this.store,sdkConfig:p,fileViewerId:this.fileViewerId,navigation:this.navigation}),this.wrappedPluginLoaders=r.map(this.wrapPluginLoader)}triggerPluginsPreviewDidInitialize(e){var t,i;for(const r of Object.values(this.instances))null===(i=null===(t=r.lifecycle)||void 0===t?void 0:t.previewDidInitialize)||void 0===i||i.call(t,e)}triggerPluginsPreviewWillTeardown(){var e,t;for(const i of Object.values(this.instances))null===(t=null===(e=i.lifecycle)||void 0===e?void 0:e.previewWillTeardown)||void 0===t||t.call(e)}}class lc{constructor(e,r,n=[],c){this.mounted=!1,this.sessionActive=!1,this.initializeOpts=void 0,this.loadContentMetadata=e=>i.__awaiter(this,void 0,void 0,(function*(){const e=this.store,t=this.fileViewerId,i=a.getRootFile(e.getState(),t);if(!i)return;const{file_id:r,url:n,previewKey:o}=i;e.dispatch(g.getFileContentMetadataAction({arg:{file_path_or_id:r,url:n}},{previewKey:o}))})),this.resolveFilePreview=(e,r,n)=>i.__awaiter(this,void 0,void 0,(function*(){var i;let a;fn(!(!e.url&&!e.file_id),t.FVErrorCode.InvalidFileInfo,t.ErrorLifecycle.Support,"You have to either provide a file ID or shared link url to fetch the preview data");const o=null!==(i=e.url)&&void 0!==i?i:n;a=o?{url:o,file_id:e.file_id}:e.ns_id&&e.sj_id?{ns_id:e.ns_id,sj_id:e.sj_id}:{file_id:e.file_id},yield this.store.dispatch(Ja({arg:{files:[a],include_dimensions:!0},params:{}},{previewKey:r}))})),this.hasFileFlipped=e=>{const t=a.getRootFile(this.store.getState(),this.fileViewerId);return(null==t?void 0:t.previewKey.serialized)!==e.serialized},this.reinitialize=e=>i.__awaiter(this,void 0,void 0,(function*(){if(!this.initializeOpts)throw new Error("Reinitialize called before initialization");var t;let i;this.store.dispatch((t={},{type:me.UpdateFiles,payload:t})),i=(null==e?void 0:e.fileInfo)?e.fileInfo:this.initializeOpts.fileInfo.file_id?{file_id:this.initializeOpts.fileInfo.file_id}:this.initializeOpts.fileInfo;const r=Object.assign(Object.assign(Object.assign({},this.initializeOpts),e),{fileInfo:i,forceReloadPreviewMetadata:!0});return this.initialize(r)})),this.userIsOnline=()=>!!navigator.onLine||navigator.connection&&navigator.connection.rtt>0,this.initialize=e=>i.__awaiter(this,void 0,void 0,(function*(){var i,r,n;const{fileMetadata:c,fileSize:u,fileInfo:p,previewMetadata:v,sourceSession:g,pluginParams:_={},supportedPreviewTypes:w=X,sharedLinkInfo:f,brandingInfo:m,timeRange:b,forceReloadPreviewMetadata:h}=e,E=!this.initializeOpts;this.initializeOpts=e,d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_INITIALIZE_START);const{file_name:x}=c,S=p.file_id,P=p.sj_id,O=p.ns_id,I=p.url,T=l.getPreviewKey(S,O,P,I),{store:R,config:F,deviceType:C,accountId:j,callbacks:k}=this.platformProps,V=this.fileViewerId,A=y(x);var L;a.getRootFile(R.getState(),V)&&this.mounted&&(yield this.doTeardown(),g.was_flipped=!0),E&&R.dispatch((L={fileViewerId:V,deviceType:C,pluginParams:_},{type:me.InitializeFileViewer,payload:L})),this.sessionActive=!0,R.dispatch(Re({fileViewerId:V,fileInfo:p,deviceType:C,fileExtension:A,rootPreviewKey:T,sourceSession:Object.assign(Object.assign({},g),{redesign2023Variant:l.getRedesign2023Variant(F)})})),R.dispatch(tt({isPreviewLoading:!0,fileViewerId:V})),R.dispatch(function(e){return{type:me.SetFileMetadata,payload:e}}(Object.assign(Object.assign({},c),{size:u,previewKey:T,timeRange:b}))),v&&R.dispatch(ze(Object.assign(Object.assign({},v),{previewKey:T})));const M=null===(i=R.getState().loggingSession[this.fileViewerId])||void 0===i?void 0:i.file_preview_session_id;if(!M)return;k&&k.onPreviewSessionInitialized&&k.onPreviewSessionInitialized(M),R.dispatch(st({event:o.SessionEventType.FilePreviewAttemptStarted,fileViewerId:V,previewSessionId:M}));const N=performance.now();try{fn(!!A,t.FVErrorCode.NoExtension,t.ErrorLifecycle.Support,"Missing file extension"),fn(!!p.url||!!p.file_id,t.FVErrorCode.InvalidFileInfo,t.ErrorLifecycle.Support,"You have to either provide a file ID or shared link url to fetch the preview data");try{const e=a.getPreviewMetadata(R.getState(),T);if(!h&&e&&p.file_id||(yield this.resolveFilePreview(p,T,null==f?void 0:f.url)),!this.userIsOnline())throw new nt(t.FVErrorCode.UserOffline,t.ErrorLifecycle.Support,"There is a network connectivity issue")}catch(e){throw Lt(e)?e:new nt(t.FVErrorCode.PreviewsDataApiFailure,t.ErrorLifecycle.Support,e instanceof Error?e.message:void 0)}if(this.hasFileFlipped(T))return;const e=a.getRootFile(R.getState(),V);if(!e)return;const{file_id:i,ns_id:l,sj_id:c}=e;f&&R.dispatch(function(e){return{type:me.SetSharedLinkInfo,payload:e}}(Object.assign(Object.assign({},f),{previewKey:T}))),m&&R.dispatch(function(e){return{type:me.SetBrandingInfo,payload:e}}(Object.assign(Object.assign({},m),{previewKey:T})));const v=performance.now();R.dispatch(ut({eventName:"fetch_preview_data_ms",duration:v-N,fileViewerId:V})),d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_GET_PREVIEW_METADATA),fn(!!i,t.FVErrorCode.MalformedPreviewsDataApiResponse,t.ErrorLifecycle.Support,"Missing `file_id` in `file_info`");const g=a.getPreviewMetadata(R.getState(),T);if(!g)throw new nt(t.FVErrorCode.PreviewsDataApiFailure,t.ErrorLifecycle.Support,"PreviewMetadata must be defined during initialization.");const _=g.previewType;if(R.dispatch(function(e){return{type:me.InitializeFilePreview,payload:e}}({fileViewerId:V,fileInfo:{file_id:i,size:u,ns_id:l,sj_id:c,previewKey:T},fileExtension:A,fileName:x,previewType:_,timeRange:b})),null==g?void 0:g.error)throw g.error;if(fn(_!==s.PreviewType.Error,t.FVErrorCode.MalformedPreviewsDataApiResponse,t.ErrorLifecycle.Support,"Preview Type got resolved to PreviewType.Error, possibly because of missing `content`"),fn(w.includes(_),t.FVErrorCode.UnsupportedPreviewType,t.ErrorLifecycle.Support,"Unsupported preview type"),fn(function(e,t,i,r){if(!isFinite(t))return!0;const n=D(e,i,r);return!n||t<=n}(x,u,_,F),t.FVErrorCode.FileTooLarge,t.ErrorLifecycle.Support,"Unsupported file size"),R.dispatch(st({event:o.SessionEventType.FilePreviewSupportConfirmed,fileViewerId:V,previewSessionId:M,extra:{preview_type:_}})),this.loadContentMetadata(p),this.hasFileFlipped(T))return;if(R.dispatch(We({fileViewerId:V,previewKey:T})),F.log_views_to_pass){const e={file_views:[{file_info:{file_identifier:i,shared_link_details:f?{url:f.url}:void 0},platform_type:{".tag":Lr()&&Ar()?"mobile_android":Vr?"mobile_ios":"web"}}]};j?this.apiv2ClientBase.ns("seen_state").rpc("log_file_view",e,{}):this.apiv2ClientBase.ns("seen_state").rpc("logged_out/log_file_view",e,{})}try{yield this.pluginManager.loadPlugins(),d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_PLUGINS_INITIALIZED)}catch(e){e instanceof Error&&(null===(n=null===(r=this.sdkBatteries.optionalIOClients.reportExceptionClient)||void 0===r?void 0:r.reportException)||void 0===n||n.call(r,e,_,!0))}}catch(e){const i=Lt(e)?e:new nt(t.FVErrorCode.Unknown,t.ErrorLifecycle.Unknown);R.dispatch(ze({previewKey:T,previewType:s.PreviewType.Error,error:i,fileViewerId:V})),R.dispatch(We({fileViewerId:V,previewKey:T})),R.dispatch(tt({isPreviewLoading:!1,fileViewerId:V})),yield this.pluginManager.loadPlugins()}this.pluginManager.triggerPluginsPreviewDidInitialize(_),d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_INITIALIZE_COMPLETE)})),this.getStaticProps=e=>{const{store:t,intl:i,config:r,platformConfig:n,callbacks:a,canCloseViewer:o}=this.platformProps,s=this.pluginManager.navigation,l=this.pluginManager.context,c=this.handleAppDestroy,d=this.handleAppMount,u=this.sdkBatteries,{fileConfig:p,isLoggedIn:v,defaultRightRailPlugin:g}=e;return{store:t,intl:i,id:this.fileViewerId,callbacks:a,config:r,canCloseViewer:o,pluginNavigation:s,pluginContext:l,onDestroy:c,onMount:d,batteries:u,platformConfig:n,fileConfig:Object.assign(Object.assign({},k),p),isLoggedIn:v,defaultRightRailPlugin:g}},this.getAppProps=()=>{if(!this.initializeOpts)throw new Error("File Viewer not initialized");const{pluginInstances:e,rightRailPluginInstances:t}=this.pluginManager.getPluginInstances();return{pluginInstances:e,rightRailPluginInstances:t}},this.doTeardown=()=>i.__awaiter(this,void 0,void 0,(function*(){this.endSession(),yield this.pluginManager.doTeardown()})),this.endSession=()=>{var e;if(this.sessionActive){this.sessionActive=!1;const{store:t}=this.platformProps,i=null===(e=t.getState().loggingSession[this.fileViewerId])||void 0===e?void 0:e.file_preview_session_id,r=d.PreviewsEventLogger.getEventTimelineWithStartTime();i&&t.dispatch(st({event:o.SessionEventType.FilePreviewSessionEnded,fileViewerId:this.fileViewerId,previewSessionId:i,extra:Object.keys(r).length?{timeline:JSON.stringify(r)}:void 0}))}d.PreviewsEventLogger.endCurrentSession()},this.handleAppDestroy=()=>i.__awaiter(this,void 0,void 0,(function*(){this.mounted=!1,yield this.doTeardown()})),this.handleAppMount=()=>{this.mounted=!0},this.cleanup=()=>{window.removeEventListener("beforeunload",this.endSession)};const u=bn();this.fileViewerId=u,this.platformProps=e,this.apiv2ClientBase=r,this.sdkBatteries=c;const{store:p}=e;this.store=p,this.pluginManager=new sc(e,r,n,u,this.reinitialize,c),this.pluginManager.loadPlugins(),window.addEventListener("beforeunload",this.endSession,{once:!0}),d.PreviewsEventLogger.mark(d.PreviewsTimingEvents.FVSDK_CONSTRUCTOR)}}const cc={osModifierKey:"ctrlKey"},dc=({dispatch:e,getState:t})=>i=>r=>{if(i(r),r.type!==me.SwitchWorkbookTab)return;const{previewKey:n,fileViewerId:o,tabIndex:s}=r.payload;if(l.isNestedArchiveFilePreviewKey(n))return;const c=t(),d=a.getPreviewMetadata(c,n),u=a.getRivieraData(c,n);if(null==d||!a.isExcelApiV2MetadataContent(d.content))return;if(null==u||!a.isExcelPreviewRivieraData(u))return;const{workbook_data_url_tmpl:p}=d.content;if(null!=u.sheets){const t=u.sheets[s];null!=t&&"errored"!==t.state||e((v={previewKey:n,fileViewerId:o,sheetIndex:s,workbookDataUrlTmpl:p},{type:me.FetchExcelSheetLayoutData,payload:v}))}var v},uc=[a.TRANSCRIPT_BLADE_PLUGIN_ID,a.AI_PLUGIN_ID];function pc(e){return({dispatch:t})=>r=>n=>i.__awaiter(this,void 0,void 0,(function*(){var i,s,l,c,d,u,p,v,g,_,w,f;switch(n.type){case me.InitializeFileViewer:{r(n);const i=!!n.payload.pluginParams.shouldFocusApproval,s={fileViewerId:n.payload.fileViewerId,sourceContext:o.UserActionContext.Initialization,previewKey:void 0};if(e.rightRail&&!i){const i=e.rightRail.getCollapsedState(),r=e.rightRail.getBladeState();r&&!uc.includes(r)&&t(He(Object.assign(Object.assign({},s),{pluginId:r,skipLogging:!0}))),t(i?Me(Object.assign(Object.assign({},s),{skipLogging:!0})):Le(Object.assign(Object.assign({},s),{skipLogging:!0})))}else t(Le(Object.assign(Object.assign({},s),{skipLogging:!0})));if(e.docSidebar){const i=e.docSidebar.getCollapsedState();t((i?Ce:Fe)(Object.assign(Object.assign({},s),{skipLogging:!0})))}else t(Ce(Object.assign(Object.assign({},s),{skipLogging:!0})));if(e.video&&(t(Qe(Object.assign(Object.assign({},s),{volume:e.video.getVolumeState(),skipLogging:!0}))),t(Je(Object.assign(Object.assign({},s),{muted:e.video.getMutedState(),skipLogging:!0})))),e.sidebar){const i=e.sidebar.getSidebarState();if(i){const{left:e,right:r}=i;t(Ge(Object.assign(Object.assign({},s),{pluginId:e}))),r!==a.AI_PLUGIN_ID&&t(Ze(Object.assign(Object.assign({},s),{pluginId:r})))}}if(e.ui){const i=e.ui.getHiddenState();t((i?ke:je)(Object.assign(Object.assign({},s),{isFullscreen:!0})))}return}case me.OpenRightRail:null===(i=e.rightRail)||void 0===i||i.setCollapsedState({isCollapsed:!1});break;case me.CloseRightRail:null===(s=e.rightRail)||void 0===s||s.setCollapsedState({isCollapsed:!0});break;case me.SetActiveRightRailPlugin:n.payload.pluginId&&n.payload.sourceContext===o.UserActionContext.RightRail&&(null===(l=e.rightRail)||void 0===l||l.setBladeState({bladeId:n.payload.pluginId}));break;case me.OpenDocSidebar:null===(c=e.docSidebar)||void 0===c||c.setCollapsedState({isCollapsed:!1});break;case me.CloseDocSidebar:null===(d=e.docSidebar)||void 0===d||d.setCollapsedState({isCollapsed:!0});break;case me.SetVolume:null===(u=e.video)||void 0===u||u.setVolumeState(n.payload.volume);break;case me.SetMuted:null===(p=e.video)||void 0===p||p.setMuteState(n.payload.muted);break;case me.SetOptInToVideoTranscript:try{yield null===(v=e.accountPageUserRelatedPreference)||void 0===v?void 0:v.setOptInToVideoTranscript(),n.payload.onSuccess()}catch(e){}break;case me.SetLeftSidebarPlugin:null===(g=e.sidebar)||void 0===g||g.setLeftSidebarState(n.payload.pluginId);break;case me.SetRightSidebarPlugin:null===(_=e.sidebar)||void 0===_||_.setRightSidebarState(n.payload.pluginId);break;case me.SetUiShown:n.payload.isFullscreen&&(null===(w=e.ui)||void 0===w||w.setHiddenState({isHidden:!1}));break;case me.SetUiHidden:n.payload.isFullscreen&&(null===(f=e.ui)||void 0===f||f.setHiddenState({isHidden:!0}))}return r(n)}))}function vc(e){return()=>t=>r=>i.__awaiter(this,void 0,void 0,(function*(){if(r.type===me.ReportException){const t=r.payload.fileType||"unknown";e.reportException(r.payload.error,t,r.payload.isCritical)}return t(r)}))}function gc(e){var t,i;const{batteries:n,callbacks:a,featureConfig:s,initData:l,platformConfig:c,pluginLoaders:d}=e,{accountId:u,deviceType:p}=l||{},{optionalIOClients:v,coreIOClients:_,logger:w,intl:f}=n,{apiv2ClientBase:m}=_,{fileSystemClient:y,fileActionsClient:b,fullScreenClient:h,navigationClient:E,printClient:x,urlClient:S,preferencesClient:P,cloudDocsClient:O,reportExceptionClient:I}=v,T=function(e){const t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?r.compose(r.applyMiddleware(...e),window.__REDUX_DEVTOOLS_EXTENSION__({name:"File Viewer SDK"})):r.applyMiddleware(...e);return r.createStore(r.combineReducers(Gl),{},t)}([...E?[ec(E)]:[],Zl,oo(m.ns("previews")),g.middleware(m.ns("files")),Xl,...S?[nc(S)]:[],...(null==s?void 0:s.excel_support)?[dc]:[],...y?[Yl(y)]:[],...b?[Ql(b)]:[],...h?[Jl(h)]:[],...x?[tc(x)]:[],...P?[pc(P)]:[],...O?[ac(O)]:[],..."ms_view_embed"===(null===(t=null==s?void 0:s.excel_support)||void 0===t?void 0:t.embed_support)?[ml(m.ns("cloud_docs"))]:[],...I?[vc(I)]:[],...w?[Un(w)]:[]]);let R=j;s&&(R=Object.assign(Object.assign({},R),s));const F={callbacks:a,intl:f,store:T,accountId:u,showAuthModal:n.optionalIOClients.showAuthModal,canCloseViewer:!!(null===(i=n.optionalIOClients.navigationClient)||void 0===i?void 0:i.closeViewer),deviceType:p||o.DeviceType.desktop,config:R,platformConfig:Object.assign(Object.assign({},cc),c)},C=null==d?void 0:d.filter((e=>null!=e));return{createFileViewer:()=>new lc(F,m,C,n),config:R}}r.injectInternalStyle("js/file_viewer/file_viewer/components.module.out.css",(e=>"._fvsdk-mount-point_5pmvv_1{flex:1;overflow:hidden}"));const _c=(e,t)=>{t.prefetchImage&&e.default_src&&jt.fetchImage(e.default_src).catch()},wc=(e,t)=>{t.prefetchDocImage&&jt.fetchDocImage({imageUrlTmpl:e}).catch()},fc=n.reactExports.createContext(null),mc=e=>{const{initData:t,featureConfig:i,children:r}=e,a=null==t?void 0:t.accountId,o=n.reactExports.useMemo((()=>gc(e)),[i,a]);return n.reactExports.createElement(fc.Provider,{value:o},r)};mc.displayName="FileViewerSDKContextProvider";const yc=e=>{const{initializeOpts:t,className:a,id:o,viewport:s,components:l}=e,c=n.reactExports.useContext(fc);if(!c)throw new Error("File Viewer SDK Context must be provided");var d,u;d=c.config,u=null==t?void 0:t.previewMetadata,n.React$1.useMemo((()=>{var e;const t={prefetchImage:"V1"===d.previews_exp_prefetch_optimization,prefetchDocImage:!0};switch(null===(e=null==u?void 0:u.content)||void 0===e?void 0:e[".tag"]){case"image":_c(u.content,t);break;case"ssr_doc":wc(u.content.image_url_tmpl,t)}}),[d,u]);const p=n.reactExports.useMemo((()=>c.createFileViewer()),[c]);n.reactExports.useEffect((()=>()=>{p.cleanup()}),[p]);const[v,g]=n.reactExports.useState(),_=n.reactExports.useRef(null);return n.reactExports.useEffect((()=>{i.__awaiter(void 0,void 0,void 0,(function*(){yield p.initialize(t),g(p.getAppProps())}))}),[p,t]),n.reactExports.createElement("div",{className:r.cx(a||"_fvsdk-mount-point_5pmvv_1"),id:o||"fvsdk-mount-point",ref:_},n.reactExports.createElement(Ua,Object.assign({},p.getStaticProps(t),v,{components:l,viewport:s})))};yc.displayName="FileViewerInstance",yc.displayName="FileViewerInstance";const bc=e=>{const{initializeOpts:t,className:r,id:a,viewport:o,components:s}=e,l=i.__rest(e,["initializeOpts","className","id","viewport","components"]),c={initializeOpts:t,className:r,id:a,viewport:o,components:s};return n.reactExports.createElement(mc,Object.assign({},l),n.reactExports.createElement(yc,Object.assign({},c)))};bc.displayName="FileViewer",bc.displayName="FileViewer";var hc=Object.freeze({__proto__:null,FileViewer:bc,FileViewerInstance:yc,FileViewerSDKContext:fc,FileViewerSDKContextProvider:mc});t.ArchiveFileBreadcrumbs=Kr,t.DEFAULT_CONFIG=j,t.DEFAULT_EXCEL_SCALE_FACTOR=.5,t.DEFAULT_FILE_CONFIG=k,t.DEFAULT_SUPPORTED_PREVIEW_TYPES=X,t.DOC_LI_MARGIN=16,t.DOC_PAGE_MARGIN=Hi,t.DOC_PAGE_MARGIN_LEFT=Zi,t.DOC_SIDEBAR_WIDTH=Xi,t.ErrorBoundary=ga,t.FVError=nt,t.FileViewer=bc,t.FileViewerInstance=yc,t.FileViewerSDKContextProvider=mc,t.FullScreenButton=yr,t.FullscreenButton=on,t.HideToolbarButton=sn,t.IMAGE_PADDING=Q,t.KeyboardBindingConnector=ia,t.OverlayTransition=Ni,t.PDF_BASE_WIDTH=1024,t.PreviewControlWrapper=vr,t.PreviewRenderer=pi,t.SlideTransition=Ui,t.TITLE_BAR_TEST_ID="fv-sdk-title-bar",t.ToolbarButton=_r,t.TranscriptRivieraError=Ot,t.VIDEO_CONTROLS_INACTIVE_TIMEOUT_MS=5e3,t.VIDEO_EDITING_SIZE_LIMIT=536870912,t.activationHubM1FileTypes=["pdf","ppt","pptx","doc","docx"],t.app="_app_m8kvz_5",t.archiveSubpathQueryParam=rc,t.asyncComponent=at,t.border="4px",t.calcContentHeight=function(e,t){return e-(t?64:0)},t.calcContentWidth=function(e,t,i=!0,r=!1){return!i||r||e<=833?e:e-(t?329:57)},t.calcDocFitToWidthScale=function(e){const{width:t,dimensions:i,isDocSidebarVisible:r,maxWidth:n}=e;if(0===i.length)return 1;const a=Math.max(0,t-Hi-Zi-(r?Xi:0)-30),o=n?Math.min(a,n):a;return i.reduce(((e,[t])=>Math.min(e,o/t)),Number.POSITIVE_INFINITY)},t.calculateDocumentScaleFactor=tr,t.calculateFitBox=function(e,t,i){const r=e/t;return isNaN(i)||isNaN(r)||!isFinite(r)||!isFinite(i)?[0,0]:r>i?[t*i,t]:[e,e/i]},t.calculateImageSizerDimensions=J,t.calculatePageRange=Ut,t.canPreviewInPreviewDoc=function(e){return!!e&&[s.PreviewType.CloudDoc,s.PreviewType.SsrDoc].includes(null==e?void 0:e.previewType)},t.cancelEditingVideo=function(e){return{type:me.CancelEditingVideo,payload:e}},t.clearVideoRequests=function(){return{type:me.ClearVideoRequests,payload:{}}},t.clickDropboxLogo=function(e){return{type:me.ClickDropboxLogo,payload:e}},t.close="_close_5e2zk_11",t.close$1="_close_1titd_176",t.closeDocSidebar=Ce,t.closeViewer=Be,t.components_esnext=hc,t.container="_container_4llxd_13",t.container$1="_container_1titd_144",t.containerBorder="_containerBorder_4llxd_28",t.copyToDropbox=function(e){return{type:me.CopyToDropbox,payload:e}},t.downloadFile=function(e){return{type:me.DownloadFile,payload:e}},t.emptyFolder="_emptyFolder_1xop8_1",t.enterFullScreen=Ve,t.excelSheetRenderFailed=function(e){return{payload:e,type:me.ExcelSheetRenderFailed}},t.excelSheetRenderSucceeded=function(e){return{payload:e,type:me.ExcelSheetRenderSucceeded}},t.exitFullScreen=Ae,t.fetchPageDataWithMetadata=Ee,t.findInDocHighlightPrimary="var(--color__accent__lime)",t.findInDocHighlightSecondary="var(--color__accent__banana)",t.findInDocTriggered=()=>{z(t.TooltipTourUpdateType.Increment,t.GuidedTours.Search,0),$(t.GuidedTours.Search,1,3)},t.focused="_focused_4llxd_104",t.folderTable="_folderTable_1xop8_9",t.getArchiveFilesAction=Ya,t.getBrowserFindBinding=function(e){return{keyboardEventCriteria:{key:"f",osModifierKey:!0},callback:e}},t.getCloudDocExitUrl=fe,t.getCloudEditorUrlAction=wl,t.getEscapeBinding=function(e){return{keyboardEventCriteria:{key:r.Key_enum.Key.Escape},callback:Hn(e)}},t.getFileExtension=y,t.getFileSizeLimit=D,t.getFilenameFromPath=function(e){return e.split("/").pop()},t.getFindInDocBinding=function(e){return{keyboardEventCriteria:{key:"f",osModifierKey:!0},callback:Hn(e)}},t.getHomeEndBindings=function({home:e,end:t}){return[(i=e,{keyboardEventCriteria:{key:r.Key_enum.Key.Home},callback:Hn(i)}),Qn(t)];var i},t.getImageSizeScale=ee,t.getIsTranscriptNonempty=e=>{var t;return"loaded"===(null==e?void 0:e.state)&&!!(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.segments)&&e.data.segments.length>0},t.getKeyboardBinding=Jn,t.getPageUpDownBindings=function({pageUp:e,pageDown:t}){return[(i=e,{keyboardEventCriteria:{key:r.Key_enum.Key.PageUp},callback:Hn(i)}),Zn(t)];var i},t.getParentFolderFromPath=function(e){if(!e)return null;const t=e.split("/");return t.length<2?null:t[t.length-2]},t.getPluginsState=gi,t.getToolbarConfigByPreviewType=nr,t.getToolbarConfigForEditMode=rr,t.getTranscriptPermission=kt,t.getUpDownBindings=function({up:e,down:t}){return[(i=e,{keyboardEventCriteria:{key:r.Key_enum.Key.ArrowUp},callback:Hn(i)}),Xn(t)];var i},t.getWhitelistedFileExtension=G,t.getXlsImgUrl=function(e,t,i){const r=new URL(e,"https://www.dropbox.com");if("/previews_asset/"===r.pathname){return(r.pathname+r.search).replace(/SHEET_PLACEHOLDER/,t.toString()).replace(/TILE_PLACEHOLDER/,i.toString())}return r.searchParams.set("sheet",t.toString()),r.searchParams.set("tile",i.toString()),r.toString()},t.getZoomInOutBindings=function({zoomIn:e,zoomOut:t}){return[...(i=e,[{keyboardEventCriteria:{key:"=",osModifierKey:!0},callback:Hn(i)},{keyboardEventCriteria:{key:"+",osModifierKey:!0},callback:Hn(i)}]),...Yn(t)];var i},t.helpCenterEmitter=K,t.imgLayer="_imgLayer_1titd_63",t.initialState={drawers:[],engagements:[],experimentVariant:"OFF",hubEntryPoint:null,isTooltipTourActive:!1,tooltipTourActiveStep:0,fileExtension:""},t.initializeFilePreviewSession=Re,t.initializeNestedArchiveFilePreview=function(e){return{type:me.InitializeNestedArchiveFilePreview,payload:e}},t.internalLink="_internalLink_1titd_52",t.invariant=fn,t.isActionBarPlugin=ne,t.isEditMode="_isEditMode_4llxd_70",t.isFullScreen=$i,t.isKeyboardEvent=Wn,t.isPluginEditMode=_i,t.isPpt=Ji,t.isTranscriptAvailable=At,t.isUnfocusedInEditMode="_isUnfocusedInEditMode_4llxd_108",t.is_mobile_or_tablet=Mr,t.is_supported_mobile_browser=Ar,t.linksLayer="_linksLayer_1titd_42",t.loader="_loader_4llxd_91",t.logBackgroundEvent=function(e){return{type:ot.LogBackgroundEvent,payload:e}},t.logPreviewEvent=lt,t.logSessionEvent=st,t.logUserActionEvent=ct,t.logVideoEvent=function(e){return{type:ot.LogVideoEvent,payload:e}},t.logVideoEventDuration=function(e){return{type:ot.LogVideoEventDuration,payload:e}},t.logVideoEventQuantity=function(e){return{type:ot.LogVideoEventQuantity,payload:e}},t.loggedOutGetArchiveFilesAction=ro,t.mac=Nr,t.makePendingLoadableData=_t,t.mapMetadataToFile=function(e,t=!1){if(e)return{uniqueKey:e.file_id,title:e.file_name,isFolder:t,extension:y(e.file_name).replace(/\./,"")}},t.maybePreloadFile=we,t.maybePreloadFiles=function(e,t,i){const r=[];if(0===e.length)return Promise.all(r);const n=[];return[1,2,3,4,5,6,-1,-2].forEach((function(i){const r=(t+i+e.length)%e.length;-1===n.indexOf(r)&&n.push(r)})),n.forEach((function(t){if(e.length>t&&t>0){const n=e[t];n&&r.push(we(n,i))}})),Promise.all(r)},t.noToolbarShown=ar,t.open="_open_4llxd_24",t.openDocSidebar=Fe,t.openUrl=Ne,t.openWebPreview=function(e){return{type:me.OpenWebPreview,payload:e}},t.openWith=function(e){return{type:me.OpenWith,payload:e}},t.overrideFloatingToolbar=Ye,t.page="_page_1titd_100",t.pageNavigation=Pe,t.pdfViewport="_pdfViewport_1titd_104",t.pptFullSizer="_pptFullSizer_1titd_134",t.pptSizer="_pptSizer_1titd_128",t.pptViewport="_pptViewport_1titd_110",t.preloadImage=Y,t.print=De,t.redirect=function(e){return{payload:e,type:me.Redirect}},t.refreshBlobAction=function(e){return{payload:e,type:me.RefreshBlob}},t.removeFragmentFromURL=e=>{const t=window.location.href.replace(e,"");window.history.replaceState(null,"",t)},t.renameFile=ye,t.resolvePageNavigation=function(e){return{type:me.ResolvePageNavigation,payload:e}},t.resolvePreviewType=Z,t.resolvePreviewTypeFromExtension=q,t.rivieraClient=jt,t.safari=Dr,t.selectDrawer=(e,i)=>{K.dispatch(t.HCEvents.SELECT_DRAWER,{drawer:e,source:i})},t.selected="_selected_4llxd_100",t.setActiveEditPlugin=qe,t.setArchiveFiles=function(e){return{type:me.SetArchiveFiles,payload:e}},t.setAreVideoControlsHidden=function(e){return{type:me.SetAreVideoControlsHidden,payload:e}},t.setHubEntryPoint=e=>{K.dispatch(t.HCEvents.SET_ENTRY_POINT,{entryPoint:e})},t.setIsClosedCaptionShowing=function(e){return{type:me.SetIsClosedCaptionShowing,payload:e}},t.setIsDefaultAudioTrackSelected=function(e){return{payload:e,type:me.SetIsDefaultAudioTrackSelected}},t.setMuted=Je,t.setPreviewMetadata=ze,t.setUiHidden=ke,t.setVolume=Qe,t.setupGetPlayDurationSeconds=function(e){return{type:me.SetupGetPlayDurationSeconds,payload:e}},t.shallowEqual=function(e,t){if(Nt(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(let r=0;r<i.length;r++)if(!Object.prototype.hasOwnProperty.call(t,i[r])||!Nt(e[i[r]],t[i[r]]))return!1;return!0},t.shouldEnableClosedCaptionsButton=(e,t)=>{var i,r;return!!e&&(!!t&&(!Vt(t)&&("loaded"!==t.state||0!==(null===(r=null===(i=t.data)||void 0===i?void 0:i.segments)||void 0===r?void 0:r.length))))},t.shouldGenerateTranscript=Dt,t.shouldShowDocSidebar=er,t.sidebarWidth=Wi,t.snackbar="_snackbar_5e2zk_34",t.switchWorkbookTab=function(e){return{type:me.SwitchWorkbookTab,payload:e}},t.textLayer="_textLayer_1titd_22",t.textbox="_textbox_1titd_17",t.thumbnail="_thumbnail_4llxd_74",t.thumbnailWidth="112px",t.triggerDynamicRoutingModalCheck=function(){return{type:me.TriggerDynamicRoutingModalCheck,payload:{}}},t.updateArchiveFileCurrentPath=Xe,t.updateAudioVideoPlaybackState=function(e){return{payload:e,type:me.UpdateAudioVideoPlaybackState}},t.updateDimensions=function(e){return{type:me.UpdateDimensions,payload:e}},t.updateDocCurrentPageIndex=Se,t.updateFitScaleFactor=function(e){return{type:me.UpdateFitScaleFactor,payload:e}},t.updateFitToWidthScaleFactor=function(e){return{type:me.UpdateFitToWidthScaleFactor,payload:e}},t.updateTooltipTourStep=z,t.updateZoomScaleFactor=function(e){return{type:me.UpdateZoomScaleFactor,payload:e}},t.useMountTransition=()=>{const[e,t]=n.React$1.useState(!1),[i,r]=n.React$1.useState(!1);return n.React$1.useEffect((()=>{e?r(!0):(t(!0),r(!1))}),[e]),i},t.useMouseActive=an,t.useOnce=e=>{const t=or(e);return n.reactExports.useMemo((()=>c.once(t)),[t])},t.usePreviewControls=gr,t.useRecordPreviewsTimerOnMount=(e,t,i,o=!0)=>{const s=r.useSelector((t=>t.loggingSession[e])),{batteries:l}=a.useFileViewerContext();n.React$1.useEffect((()=>{var e,r;const n=performance.getEntriesByName(t,"mark");if(n.length>0&&o){performance.clearMarks(t);const a=n[0],o=performance.now()-a.startTime;null===(r=null===(e=null==l?void 0:l.logger)||void 0===e?void 0:e.logDuration)||void 0===r||r.call(e,{eventName:t,durationInMs:o,session:s?xn(s):void 0,tags:i})}else;}),[null==l?void 0:l.logger,o,s,i,t])},t.useResponsiveSize=rn,t.useResponsiveSizeV2=()=>{const e=a.useWindowSize(),i=null==e?void 0:e.width;return void 0===i||i>1024?t.FileViewerBreakpoint.LG:i>768?t.FileViewerBreakpoint.MD:t.FileViewerBreakpoint.SM},t.useStabilizedCallback=or,t.useUponTranscriptGeneration=(e,i)=>{const r=n.reactExports.useRef(!1),a=!(e=>!(!e||"pending"===e.state||"errored"===(null==e?void 0:e.state)&&e.error.statusCode===t.RivieraStatus.NotFound))(e);a&&(r.current=!0),n.reactExports.useEffect((()=>{r.current&&At(e)&&(i(),r.current=!1)}),[i,e])},t.v4=bn,t.writeTranscriptToClipboard=(e,t=!1)=>{if(!e||0===e.length)return;const i=c.flatten(e.map((({text:e,startTime:i})=>t?[i,e]:[e]))).join("\r\n");navigator.clipboard.writeText(i)},t.zoomIn=Oe,t.zoomOut=Ie}));
//# sourceMappingURL=c_file_viewer_file_viewer_components.js-vflAjvzLK.map
