define(["require","exports","./e_edison","./e_ui_page_files_router","./c_lodash-es_lodash","./c_core_i18n","./c_bug_reporting_routing","./c_pagelet_logger","./c_browse_selection_indicator","./c_file_viewer_async_controller","./c_tslib","./c_edison_ui_spa_chrome","./c_maestro_layout_search","./e_core_exception","./c_src_slider_index","./c_loggers_device_type","./c_src_sink_index","./c_apex-metrics_src_types","./c_src_simple-action-bar_action_bar_types","./c_core_exception_info","./c_downloads","./c_action_bar_action_bar_strings","./c_portable_delete_snackbars","./c_browse_interface","./c_file_actions_portable_copy","./c_file_actions_portable_move","./c_file_actions_portable_select_destination","./c_src_simple-action-bar_inline_action_bar","./c_src_highlighted-truncated-string_em-string","./c_combinations_index","./c_react-window_dist_index","./c_ui_selectable_list","./c_icon_file_folder_icon","./c_src_simple-action-bar_inline_overflow_menu","./c_photo-editor_logging_photo_editor_events_logger","./c_src_preview-photo-editor_types","./c_file_store_utils","./c_photo-editor_logging_logging_utils","metaserver/static/js/modules/constants/files_spa","metaserver/static/js/modules/constants/env","metaserver/static/js/modules/constants/viewer","metaserver/static/js/modules/constants/auth","metaserver/static/js/modules/constants/request","./c_core_xhr","./c_csrf","./c_browser_cookies","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/ajax_strings","./c_core_notify","metaserver/static/js/modules/constants/locales","./c_core_browser_detection","metaserver/static/js/modules/constants/webtiming","metaserver/static/js/modules/constants/campaigns_orchestration","metaserver/static/js/modules/constants/maestro_nav_strings","metaserver/static/js/modules/constants/trademark","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/undo_strings","metaserver/static/js/modules/core/langpack","./c_file_viewer_logging_performance","./c_spectrum_media_table_skeleton","./c_spectrum_vertically_fixed","./c_exenv_index","./c_spectrum_util_raf_throttle","./c_portable_delete_strings","./c_file_actions_strings","./c_files_view_file_actions_snackbars","./c_files_view_file_actions_file_from_metadata","./c_ui_fileops_actions","./c_data_action_creators_index","./c_history","./c_ux_analytics_dispatch_custom_event","./c_browse_crypto_subtle_digest","./c_action_bar_file_actions_logging","./c_sharing_async_share_modal_util","./c_hive_schemas_web-modal-activity","./c_truncate_index","./c_resize-observer-polyfill_dist_ResizeObserver","./c_keymaster","./c_icon_file_icon","./c_icon_folder_icon","./c_ui_title_bubble","./c_ui_overlay","./c_raf_throttle","./c_icon_shortcuts_icon"],(function(e,t,o,i,a,n,s,r,c,l,d,_,p,u,h,m,g,f,b,v,E,S,T,y,w,I,x,R,A,k,O,L,C,N,P,M,j,$,z,F,D,B,H,G,U,V,W,Y,q,K,X,J,Z,Q,ee,te,oe,ie,ae,ne,se,re,ce,le,de,_e,pe,ue,he,me,ge,fe,be,ve,Ee,Se,Te,ye,we,Ie,xe,Re,Ae,ke,Oe,Le,Ce){"use strict";const Ne=e=>{var{altText:t,inverse:i}=e,a=d.__rest(e,["altText","inverse"]);const n="dig-Illustration dig-Illustration-spot"+(i?" dig-Illustration--inverse":"");return o.reactExports.createElement("svg",Object.assign(Object.assign({role:"presentation"},a),{className:n,viewBox:"0 0 500 500",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),o.reactExports.createElement("title",null,t),o.reactExports.createElement("path",{d:"M195.338 122.11c25.893-3.989 62.229-6.601 77.787-8.251 9.415.639 21.924-3.926 47.075 3.192 25.152 7.119 53.633 18.639 78.684 32.402 25.05 13.762 35.336 26.896 46.57 36.411 11.235 9.515 5.921 4.485 9.602 11.166 3.681 6.68 6.633 9.796 8.803 22.238 2.171 12.442 3.608 26.871 2.051 39.969-1.557 13.099-5.702 16.032-9.835 25.522-4.133 9.489-3.336 12.099-10.829 21.925-7.429 9.742-16.842 18.301-26.388 26.981l-.248.225c-9.631 8.757-7.666 9.513-21.52 16.581-13.853 7.067-36.405 14.636-47.748 18.754C337.999 373.344 334 372.5 334 372.5c-19.099.653-47.38-.133-80.154-.011-32.773.121-53.755 1.219-77.338-.818-23.583-2.038-28.333-6.131-40.575-9.371-12.241-3.24-7.539-1.033-20.631-6.829-13.091-5.797-31.019-13.912-44.826-22.154-13.807-8.243-15.928-8.142-24.21-19.059-8.282-10.917-13.488-26.365-17.2-35.526-3.713-9.161-1.267-5.548-1.364-10.28-.098-4.732-.612-4.693.878-13.38 1.49-8.687 1.668-16.946 6.573-30.055 4.906-13.108 8.361-22.755 17.955-35.487 9.594-12.733 20.444-20.637 30.015-28.173 9.57-7.537 5.732-3.998 17.84-9.509s23.823-12.098 42.698-18.046c18.875-5.947 25.784-7.703 51.677-11.692z",fill:"#C8AFF0"}),o.reactExports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M246.777 167.089c-12.725.744-13.058.788-24.658 3.181-4.685.967-12.957 2.4-18.382 3.184-9.225 1.333-10.328 1.614-17.037 4.331-12.01 4.863-19.425 10.395-30.301 22.606l-7.435 8.348-1.619 4.688c-.89 2.579-2.127 6.729-2.748 9.222-.865 3.471-1.789 5.653-3.941 9.305l-2.811 4.771-.94 6.766c-.879 6.323-.897 7.049-.276 11.113.54 3.538 1.203 5.498 3.554 10.515 1.589 3.391 3.223 6.564 3.631 7.05.408.487 2.712 2.102 5.12 3.589l4.378 2.705h9.404l1.631-2.141c.897-1.178 1.728-2.027 1.845-1.887.118.14-.045 1.805-.363 3.7-.67 3.999-.085 8.5 2.263 17.394l1.347 5.104 4.596 2.57c2.527 1.414 4.909 2.545 5.293 2.514 1.119-.091 11.753-4.29 15.969-6.305 5.139-2.457 6.328-3.551 7.617-7.007 1.403-3.763 3.22-12.318 3.537-16.652.136-1.873.345-4.169.464-5.104l.216-1.699 1.489 1.042c.819.573 3.99 2.361 7.046 3.972l5.556 2.931 6.277 7.382 6.277 7.382 5.828 3.038c8.619 4.493 15.592 7.645 18.261 8.256 3.572.816 10.752.679 17.723-.339l6.25-.913.963-3.548c.531-1.952.964-4.076.964-4.72 0-1.261-2.945-8.527-4.814-11.876-.63-1.129-1.065-2.143-.968-2.254.098-.11 2.902-1.082 6.231-2.158 3.328-1.077 11.298-3.956 17.709-6.398 6.411-2.441 14.818-5.413 18.683-6.603 7.532-2.319 17.06-6.86 18.363-8.752.425-.616 1.933-3.372 3.352-6.123 2.044-3.964 2.783-6.026 3.562-9.944l.983-4.943-1.667-6.006c-1.52-5.479-2.096-6.732-6.555-14.248-5.567-9.387-8.991-13.616-16.322-20.158-12.005-10.714-17.503-14.193-31.608-20.002-5.97-2.458-9.003-3.423-11.656-3.707-1.973-.21-5.806-1.044-8.519-1.852-6.398-1.905-10.176-2.115-23.762-1.32z",fill:"#905235"}),o.reactExports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M427.171 120.968c-6.24 2.944-10.761 5.472-10.761 6.014 0 .365.513.94 1.141 1.279.937.507 1.436.437 2.806-.392 1.508-.913 9.701-4.839 10.097-4.839.253 0-2.524 9.337-4.133 13.895-.788 2.232-2.129 5.431-2.981 7.109-.852 1.678-1.55 3.126-1.55 3.217 0 .09.612.682 1.361 1.313l1.36 1.149.909-1.37c1.881-2.838 8.629-6.557 19.909-10.974 6.707-2.627 6.811-2.691 7.282-4.514.264-1.017.434-1.849.379-1.849-.557 0-19.692 7.77-21.604 8.773-1.394.731-2.612 1.329-2.708 1.329-.096 0 .153-.897.554-1.994.4-1.096 1.329-4.147 2.065-6.779.736-2.632 1.823-5.982 2.416-7.444l1.078-2.658-.946-.931c-1.059-1.042-4.779-1.228-6.674-.334z",fill:"currentColor"}),o.reactExports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M206.46 191.015c0 .875 9.84 10.178 10.258 9.698.359-.412-1.287-2.251-4.446-4.966-1.658-1.424-3.484-3.173-4.057-3.886-1.064-1.319-1.755-1.653-1.755-.846zm162.098 10.04c-2.077.506-9.257 4.345-9.257 4.948 0 1.132 1.637.828 5.275-.977 2.19-1.086 4.519-2.118 5.175-2.292l1.192-.316-2.17 4.589c-1.194 2.524-2.41 5.146-2.702 5.826-.292.68-1.663 3.638-3.046 6.573-2.014 4.274-2.413 5.476-2.004 6.042 1.179 1.633 2.006 1.294 6.726-2.755 6.397-5.488 13.568-10.901 17.064-12.88 1.598-.905 2.906-1.825 2.906-2.045 0-.734-2.076-1.497-3.196-1.174-.608.175-1.23.296-1.383.268-.152-.028-.395.16-.539.419-.146.259-1.039.944-1.986 1.523-2.55 1.558-7.095 4.966-12.648 9.484l-1.883 1.533 1.617-3.37c5.229-10.898 5.911-12.618 5.458-13.76-.592-1.494-2.461-2.159-4.599-1.636zm-141.217 1.88c-3.699.634-8.455 2.499-9.532 3.737-.565.649-1.849 1.615-2.852 2.145-1.713.905-1.75.966-.612 1.006 1.45.049 2.31-.438 4.035-2.285.863-.924 2.499-1.768 4.912-2.536 3.259-1.036 4.196-1.121 9.431-.855 3.196.163 7.605.281 9.796.263 4.653-.039 7.147.941 8.678 3.412 1.028 1.659.803 2.048-.438.757-.418-.435-.972-.641-1.232-.457-.281.2 1.027 2.03 3.248 4.542 3.19 3.609 3.979 4.852 5.557 8.744 1.012 2.496 1.974 5.256 2.139 6.133.165.878 1.13 2.659 2.143 3.959 2.339 2.998 3.053 4.614 3.748 8.479.497 2.768.47 3.467-.246 6.412-.443 1.818-.889 4.214-.991 5.323-.323 3.49 2.896 14.327 5.532 18.622.619 1.009 1.388 2.568 1.708 3.464.32.895 1.011 2.359 1.535 3.253.524.893 1.027 1.879 1.117 2.19.09.312.388.408.661.214.356-.253.257-.806-.346-1.944-.464-.874-.844-1.853-.845-2.175-.004-1.366 5.621-4.595 12.914-7.412 1.776-.686 4.488-1.871 6.028-2.634 1.539-.762 4.445-2.099 6.458-2.971 4.2-1.819 4.528-1.979 11.194-5.464 2.723-1.425 5.435-2.977 6.027-3.452.592-.474 2.433-1.676 4.09-2.672 4.836-2.904 9.304-7.026 10.776-9.942 1.33-2.634 2.663-7.746 2.935-11.258.243-3.144-.39-3.93-.797-.989-1.513 10.945-4.537 15.563-13.99 21.368-3.489 2.142-4.914 3.072-7.443 4.858-.896.633-3.214 1.822-5.149 2.643-1.936.82-3.721 1.666-3.967 1.88-.246.213-2.288 1.129-4.537 2.033-2.25.905-4.816 2.058-5.702 2.562-.885.505-3.598 1.681-6.027 2.614-6.494 2.494-9.817 4.143-11.603 5.757-.874.791-1.746 1.433-1.937 1.429-.512-.012-3.665-6.746-4.599-9.822-.908-2.993-.665-3.506 1.667-3.525 2.586-.022 10.942-1.938 13.192-3.024 2.948-1.425 4.676-2.793 4.676-3.704 0-.394-.51-1.838-1.134-3.209-1.088-2.391-3.821-5.32-7.132-7.641-1.737-1.217-3.841-4.733-5.109-8.535-.781-2.343-.984-4.197-1.161-10.606-.245-8.85-.097-9.567 3.151-15.339 1.052-1.869 1.913-3.636 1.913-3.926 0-.971-3.817 4.725-5.147 7.679-1.116 2.48-1.311 3.463-1.311 6.586 0 3.567.402 7.71 1.333 13.719.446 2.883 2.629 8.418 4.14 10.499.423.583 1.351 1.398 2.061 1.81 2.82 1.637 7.952 8.749 6.968 9.656-2.013 1.856-11.07 4.45-17.941 5.137l-1.502.151-.444-3.464c-.284-2.219-.301-4.353-.045-5.938.535-3.313.497-5.71-.163-10.144-.596-4.011-1.579-6.654-3.494-9.393-1.472-2.105-2.968-6.882-2.968-9.476 0-1.865-1.522-7.198-2.643-9.261-.317-.583-1.573-1.602-2.791-2.265-1.219-.663-2.642-1.894-3.163-2.735-1.968-3.177-5.71-4.279-11.017-3.246-1.333.26-1.88.154-2.313-.445-.455-.631-1.425-.773-4.927-.723-2.398.033-5.329.227-6.513.431zm-98.091.826c-.516.592-.306.986.843 1.588 2.684 1.405 8.558 7.823 10.7 11.69.754 1.361 1.627 3.588 1.941 4.948.313 1.361.742 2.731.952 3.045.237.355.172.667-.175.827-.353.163-.282.27.198.295.887.046.886.058.29-3.646-.758-4.714-2.33-7.838-6.159-12.239-4.523-5.198-7.662-7.575-8.59-6.508zm126.676 7.903c.832.67 3.06 5.368 3.06 6.453 0 .169-.613-.672-1.361-1.87-.748-1.197-1.475-2.29-1.615-2.429-.139-.138-.723-.862-1.297-1.608-1.2-1.559-.459-1.892 1.213-.546zm6.081 22.075c.005.341.279 1.732.608 3.093l.599 2.474.033-1.979c.018-1.089-.085-2.48-.227-3.093-.275-1.177-1.026-1.545-1.013-.495zm-73.63 2.099c-.829.652-1.797 1.498-2.153 1.881-.355.383-2.002 1.978-3.659 3.545-1.658 1.566-5.154 5.393-7.769 8.504l-4.756 5.656-3.329-1.743c-1.83-.959-3.439-2.076-3.575-2.483-.135-.406-1.438-1.668-2.894-2.804-1.457-1.136-3.736-3.216-5.066-4.623-2.415-2.555-4.286-3.841-6.516-4.48-1.95-.559-1.34.433 1.035 1.686 1.221.643 3.412 2.445 4.869 4.003 1.458 1.558 3.519 3.418 4.58 4.133 1.062.715 2.364 1.974 2.894 2.798.53.824 1.163 1.498 1.408 1.498.715 0 5.019 2.368 5.319 2.926.453.843-1.077 3.005-2.731 3.863-1.272.658-1.394.836-.678.986.797.166.86.479.71 3.522-.114 2.311.048 3.924.525 5.236.853 2.346.875 2.16-.279 2.415-.823.183-.789.225.226.282.849.048 1.313.426 1.604 1.305.426 1.287 1.291 1.698 1.291.614 0-.342-.484-1.668-1.076-2.946-.869-1.877-1.076-3.029-1.076-5.989 0-3.127.164-3.947 1.122-5.589 2.595-4.45 8.364-11.464 13.516-16.432a183.337 183.337 0 0 0 4.736-4.781c1.302-1.373 2.852-2.872 3.444-3.33.674-.523.835-.834.431-.836-.355 0-1.324.532-2.153 1.183zm28.753 7.122c-1.74 2.829-6.812 13.372-7.525 15.644-.891 2.84-2.291 10.54-2.047 11.263.393 1.166 7.266 5.152 10.798 6.262 2.442.768 4.294 2.233 5.499 4.353.586 1.031 1.901 2.796 2.921 3.923 1.924 2.124 6.42 5.62 7.227 5.62.717 0-10.692-12.755-12.207-13.647-.739-.436-2.312-1.116-3.496-1.511-2.553-.852-10.118-4.649-10.118-5.078 0-.164.295-2.08.656-4.257.724-4.378 1.707-7.766 2.798-9.649.394-.681 1.543-3.13 2.553-5.443 1.01-2.314 2.073-4.54 2.361-4.949.916-1.294 2.379-4.454 2.058-4.443-.17.006-.835.867-1.478 1.912zm18.279 10.457c-1.902.319-4.409 1.549-4.409 2.163 0 .094 1.017-.126 2.261-.489 1.243-.362 2.992-.789 3.887-.948.894-.159 1.513-.501 1.374-.76-.14-.258-.387-.442-.551-.407-.163.033-1.316.232-2.562.441zm24.659 1.465c-.488.908 2.011 8.991 2.579 8.338.256-.294-1.697-8.816-2.022-8.819-.163-.002-.414.215-.557.481zm-4.327 7.48c.185.927.461 2.576.615 3.665.206 1.46.36 1.747.586 1.096.373-1.077-.43-5.661-1.072-6.117-.319-.227-.359.195-.129 1.356zm-8.811.568c0 1.137-2.502 1.486-7.816 1.091-3.36-.251-4.669-.192-4.669.21 0 .307.559.558 1.242.558.684 0 1.797.333 2.476.74 1.496.896 6.605.992 8.605.161 1.281-.532 1.483-.477 2.276.619.933 1.288 1.18.996.462-.547-.794-1.704-2.576-3.664-2.576-2.832zm103.531 2.459c-.505 1.275-.25 1.118-7.951 4.892-5.918 2.9-12.479 6.619-14.389 8.156-1.607 1.294-1.574.724.17-2.927.953-1.997 1.733-3.884 1.733-4.195 0-.311-.475-.923-1.056-1.36-.972-.732-1.255-.73-3.552.033-2.551.847-7.597 3.646-9.69 5.375-2.478 2.048.339 2.518 2.937.49 1.681-1.312 4.182-2.681 7.135-3.906l1.586-.658-1.304 2.565a144.165 144.165 0 0 1-2.839 5.241l-1.535 2.678.978.91c.946.881 1.745 1.13 2.983.932.325-.052 2.166-1.232 4.09-2.622 3.528-2.55 8.616-5.55 15.336-9.043 4.63-2.406 6.461-3.918 6.452-5.33-.011-1.771-.603-2.443-1.084-1.231zm-221.714 4.406c5.199 3.112 14.202 6.319 19.805 7.054l2.153.283-1.722-.692c-.947-.38-4.241-1.495-7.319-2.477-3.079-.982-7.535-2.644-9.903-3.694-6.114-2.71-6.975-2.846-3.014-.474zm150.78 18.251c.186.822.013.99-1.023.99-1.76 0-5.761 3.028-7.617 5.765-2.12 3.127-2.204 5.708-.225 6.884 1.121.666 1.666.705 3.289.236 1.069-.31 2.507-.421 3.194-.248 2.436.615 4.412-2.052 5.071-6.842.389-2.831-.058-4.947-1.408-6.661-1.084-1.378-1.578-1.426-1.281-.124zm-54.387 7.673c-.749.652-.677.709.909.725.947.01 3.466.339 5.597.731 2.131.392 6.297.951 9.257 1.243 2.96.292 5.866.632 6.458.757 1.066.223 1.067.22.108-.331-.533-.307-.969-.714-.969-.906 0-.191-1.792-.502-3.983-.691-2.19-.188-5.92-.649-8.288-1.025-7.764-1.231-8.222-1.257-9.089-.503z",fill:"#1E1919"}))},Pe=({link:e,onTTI:t})=>(o.React$1.useEffect((()=>{null==t||t()}),[]),o.React$1.createElement("div",{className:"photos-empty-folder-container"},o.React$1.createElement("div",{className:"photos-empty-folder-illustration-container"},o.React$1.createElement("div",{className:"photos-empty-folder-illustration"},o.React$1.createElement(Ne,{altText:"Sleeping dog on a purple cushion."}))),o.React$1.createElement("div",{className:"photos-empty-folder-text"},o.React$1.createElement(i.Title,{className:"photos-empty-folder-title"},n.intl.formatMessage({id:"caO1Cd",defaultMessage:"You have no photos or videos."})),o.React$1.createElement(i.Link,{href:e,hasNoUnderline:!0,className:"photos-empty-folder-link"},n.intl.formatMessage({id:"6A86xm",defaultMessage:"Add photos or videos to your Dropbox and they’ll appear here."})))));Pe.displayName="EmptyState";const Me="web_photos",je="photos-file-viewer-container";var $e,ze,Fe,De;!function(e){e.None="NONE",e.Loading="LOADING",e.Created="CREATED",e.Errored="ERRORED"}($e||($e={})),function(e){e.LOAD_ITEMS_ACTION="LOAD_ITEMS_ACTION",e.SET_FILTER_ACTION="SET_FILTER_ACTION",e.SET_GROUPING_ACTION="SET_GROUPING_ACTION",e.SET_GRID_SIZE_ACTION="SET_GRID_SIZE_ACTION",e.SET_SELECTION_ACTION="SET_SELECTION_ACTION",e.SET_VISIBLE_TOP_SECTION_INDEX_ACTION="SET_VISIBLE_TOP_SECTION_INDEX_ACTION",e.SET_USER_ACTION="SET_USER_ACTION",e.UPDATE_FAVORITES_ACTION="UPDATE_FAVORITES_ACTION",e.REMOVE_ITEMS_ACTION="REMOVE_ITEMS_ACTION",e.SET_SHARE_LINK_ACTION="SET_SHARE_LINK_ACTION",e.SET_SHARE_LINK_STATUS_ACTION="SET_SHARE_LINK_STATUS_ACTION",e.SET_API_STATE="SET_API_STATE",e.SET_PREWARM_PREVIEW_DATA="SET_PREWARM_PREVIEW_DATA",e.UPDATE_FILE="UPDATE_FILE"}(ze||(ze={})),function(e){e.DEFAULT="DEFAULT",e.FETCH="FETCH",e.SUCCESS="SUCCESS",e.ERROR="ERROR"}(Fe||(Fe={})),function(e){e.DELTA="delta",e.SHARE="share"}(De||(De={}));i.injectInternalStyle("typescript/component_libraries/photos/src/filter-bar/index.module.out.css",(e=>"._photos-filter-bar_1v986_1{border-bottom:1px solid var(--color__standard__border);border-top:1px solid var(--color__standard__border);display:flex;flex:0 0;padding:var(--spacing__unit--2)}._photos-filter-bar_selection_1v986_9{margin-right:var(--spacing__unit--0_5)}@media screen and (min-width:768px){._photos-filter-bar_selection_1v986_9{border-right:1px solid var(--color__standard__border);margin-right:var(--spacing__unit--3);padding-right:var(--spacing__unit--3)}}"));var Be,He,Ge;function Ue({onSelection:e,selectedValue:t,choices:a,compact:n,className:s}){const r=o=>{o&&o!==t&&e(o)};return n?o.React$1.createElement(i.Menu.Wrapper,{onSelection:r,className:s},(({getContentProps:e,getTriggerProps:n})=>{var s;return o.React$1.createElement(o.React$1.Fragment,null,o.React$1.createElement(i.Button$1,Object.assign({},n(),{variant:"opacity",withDropdownIcon:!0}),null===(s=a.find((e=>e.value==t)))||void 0===s?void 0:s.text),o.React$1.createElement(i.Menu.Content,Object.assign({},e(),{placement:"bottom-end"}),o.React$1.createElement(i.Menu.Segment,null,a.map((({value:e,text:a,testid:n})=>o.React$1.createElement(i.Menu.SelectItem,{key:e,value:e,selected:e===t,"data-testid":n},a))))))})):o.React$1.createElement(i.SegmentedControl,{selectedValue:t,onSelection:r,className:s},a.map((({value:e,text:t,testid:a})=>o.React$1.createElement(i.SegmentedControl.Option,{variant:"text",key:e,value:e,"data-testid":a},t))))}!function(e){e.YEARS="years",e.MONTHS="months",e.DAYS="days"}(Be||(Be={})),function(e){e.ALL="all",e.PHOTOS="photos",e.VIDEOS="videos",e.STARRED="starred"}(He||(He={})),function(e){e[e.EXTRA_SMALL=1]="EXTRA_SMALL",e[e.SMALL=2]="SMALL",e[e.MEDIUM=3]="MEDIUM",e[e.LARGE=4]="LARGE",e[e.EXTRA_LARGE=5]="EXTRA_LARGE"}(Ge||(Ge={}));const Ve=({filter:e,grouping:t,gridSize:i,onFilterChange:a,onGroupingChange:s,onSizeChange:r,compact:c})=>{const l="_photos-filter-bar_selection_1v986_9",{filterChoices:d,groupingChoices:_}=function(){const{allItemsText:e,photosText:t,videosText:o,starredText:i,yearsText:a,monthsText:s,daysText:r}=function(){const e=n.useIntl();return{allItemsText:e.formatMessage({id:"EZV/rb",defaultMessage:"All Items"}),photosText:e.formatMessage({id:"UIUkU/",defaultMessage:"Photos"}),videosText:e.formatMessage({id:"zJ1b5+",defaultMessage:"Videos"}),starredText:e.formatMessage({id:"IQQznX",defaultMessage:"Starred"}),yearsText:e.formatMessage({id:"rk1sjy",defaultMessage:"Years"}),monthsText:e.formatMessage({id:"Az9n5x",defaultMessage:"Months"}),daysText:e.formatMessage({id:"5GOC/d",defaultMessage:"Days"})}}(),c=[{value:He.ALL,text:e},{value:He.PHOTOS,text:t},{value:He.VIDEOS,text:o},{value:He.STARRED,text:i}],l=[{value:Be.YEARS,text:a,testid:"grouping-years"},{value:Be.MONTHS,text:s,testid:"grouping-months"},{value:Be.DAYS,text:r,testid:"grouping-days"}];return{filterChoices:c,groupingChoices:l}}();return o.React$1.createElement("div",{className:"_photos-filter-bar_1v986_1"},o.React$1.createElement(Ue,{className:l,onSelection:a,selectedValue:e,choices:d,compact:c}),o.React$1.createElement(Ue,{className:l,onSelection:s,selectedValue:t,choices:_,compact:c}),o.React$1.createElement(h.ZoomSlider,{min:Ge.EXTRA_SMALL,max:Ge.EXTRA_LARGE,value:i,onChange:r}))};Ve.displayName="FilterBar";class We{constructor(e){this.category="web-photos_web_events",this.user_id=null,this.team_id=null,this.session_id=null,this.anon_ip=null,this.country=null,this.url=null,this.ua_browser_name=null,this.ua_browser_version=null,this.locale_user_selected=null,this.timestamp=e.timestamp,this.event_name=e.event_name,this.event_action=e.event_action,this.event_object=e.event_object,this.action_surface=e.action_surface,this.platform="web",this.device_type=e.device_type,this.browser_lang=e.browser_lang,this.browser_width=e.browser_width,this.browser_height=e.browser_height,this.device_width=e.device_width,this.device_height=e.device_height,this.extras=e.extras,Object.seal(this)}}const Ye=["open","download","move","comment","add_comments","star","unstar","version_history"];function qe(e){return Ye.find((t=>t===(null==e?void 0:e.toLowerCase())))}const Ke=["photos","videos","all","starred"];function Xe(e){return Ke.find((t=>t===(null==e?void 0:e.toLowerCase())))}const Je=["day","month","year"];function Ze(e){return Je.find((t=>t===(null==e?void 0:e.toLowerCase())))}const Qe=new i.HiveLogger;var et,tt;!function(e){e.shownPhotosPage="shown_photos_page",e.shownPhotosEmptyState="shown_photos_empty_state",e.scrollPhotosPage="scroll_photos_page",e.scrollPhotosScrubber="scroll_photos_scrubber",e.selectPhotoThumbnail="select_photo_thumbnail",e.starPhotoThumbnail="star_photo_thumbnail",e.unstarPhotoThumbnail="unstar_photo_thumbnail",e.openPhotoPreview="open_photo_preview",e.openPhotoSecondaryMenu="open_photo_secondary_menu",e.selectPhotoSecondaryMenu="select_photo_secondary_menu",e.selectPhotoActionBar="select_photo_action_bar",e.selectPhotoGroupBy="select_photo_group_by",e.selectPhotoFilter="select_photo_filter",e.deltaReturnedItems="delta_returned_items",e.shownSharingButton="shown_sharing_button",e.selectSharingButton="select_sharing_button",e.selectCopyLinkButton="select_copy_link_button",e.selectPreviewLink="select_preview_link"}(et||(et={})),function(e){e.viewPhotosPage="view_photos_page",e.photosInteraction="photos_interaction"}(tt||(tt={}));const ot={[b.ActionBarActionTypes.MOVE]:"move",[b.ActionBarActionTypes.OPEN]:"open",[b.ActionBarActionTypes.DOWNLOAD]:"download",[b.ActionBarActionTypes.COMMENT]:"comment",[b.ActionBarActionTypes.STAR]:"star",[b.ActionBarActionTypes.UNSTAR]:"unstar",[b.ActionBarActionTypes.VERSION_HISTORY]:"version_history"},it={[Be.DAYS]:"day",[Be.MONTHS]:"month",[Be.YEARS]:"year"},at={[et.scrollPhotosPage]:["scrollDepth"],[et.scrollPhotosScrubber]:["grouping"],[et.selectPhotoThumbnail]:["thumbnailSelectCount"],[et.selectPhotoSecondaryMenu]:["secondaryMenuSelection"],[et.selectPhotoActionBar]:["actionBarSelection","itemCount"],[et.selectPhotoGroupBy]:["groupBySelection"],[et.selectPhotoFilter]:["filterSelection"],[et.selectSharingButton]:["itemCount"],[et.selectPreviewLink]:["itemCount"],[et.deltaReturnedItems]:["itemCount"]};function nt(e,t){const o=Object.assign(Object.assign({timestamp:Date.now(),event_name:e},function(e){switch(e){case et.shownPhotosPage:return{event_action:"shown",event_object:"photos_page",action_surface:"web_photos"};case et.shownPhotosEmptyState:return{event_action:"shown",event_object:"photos_empty_state",action_surface:"web_photos"};case et.scrollPhotosPage:return{event_action:"scroll",event_object:"photos_page",action_surface:"web_photos"};case et.scrollPhotosScrubber:return{event_action:"scroll",event_object:"scrubber",action_surface:"web_photos"};case et.selectPhotoThumbnail:return{event_action:"select",event_object:"photo_thumbnail",action_surface:"web_photos"};case et.starPhotoThumbnail:return{event_action:"star",event_object:"photo_thumbnail",action_surface:"web_photos"};case et.unstarPhotoThumbnail:return{event_action:"unstar",event_object:"photo_thumbnail",action_surface:"web_photos"};case et.openPhotoPreview:return{event_action:"open",event_object:"photo_preview",action_surface:"web_photos"};case et.openPhotoSecondaryMenu:return{event_action:"open",event_object:"photo_secondary_menu",action_surface:"web_photos"};case et.selectPhotoSecondaryMenu:return{event_action:"select",event_object:"photo_secondary_menu",action_surface:"web_photos"};case et.selectPhotoActionBar:return{event_action:"select",event_object:"photo_action_bar",action_surface:"web_photos"};case et.selectPhotoGroupBy:return{event_action:"select",event_object:"photo_group_by",action_surface:"web_photos"};case et.selectPhotoFilter:return{event_action:"select",event_object:"photo_filter",action_surface:"web_photos"};case et.shownSharingButton:return{event_action:"shown",event_object:"sharing_button",action_surface:"web_photos"};case et.selectSharingButton:return{event_action:"select",event_object:"sharing_button",action_surface:"web_photos"};case et.selectCopyLinkButton:return{event_action:"select",event_object:"copy_link_button",action_surface:"web_photos"};case et.selectPreviewLink:return{event_action:"select",event_object:"preview_link",action_surface:"web_photos"};case et.deltaReturnedItems:return{event_action:"returned_items",event_object:"delta",action_surface:"web_photos"};default:i.enforceExhaustive(e)}}(e)),{device_type:m.getDeviceType(),browser_lang:window.navigator.language,browser_width:window.innerWidth,browser_height:window.innerHeight,device_width:window.screen.width,device_height:window.screen.height});if(t&&st(e)){o.extras={};for(const i of at[e]){const e=t[i];"string"==typeof e&&(o.extras[i]=e)}}Qe.log(new We(o));const a=function(e){switch(e){case et.shownPhotosPage:return tt.viewPhotosPage;case et.scrollPhotosPage:return null;default:return tt.photosInteraction}}(e);a&&i.UserSurvey.trackEvent(a,"photos"),function(e,t){const o="Web_Photos";switch(e){case et.shownPhotosPage:i.logEvent({class:"photos",action:"shown",object:"photos_page",properties:{actionSurface:o}});break;case et.shownPhotosEmptyState:i.logEvent(function(e){return{class:"photos",action:"shown",object:"photos_empty_state",properties:e}}({actionSurface:o}));break;case et.scrollPhotosPage:i.logEvent(function(e){return{class:"photos",action:"scroll",object:"photos_page",properties:e}}({actionSurface:o,scrollDepth:parseInt(rt("scrollDepth",e,t)||"",10)}));break;case et.scrollPhotosScrubber:i.logEvent(function(e){return{class:"photos",action:"scroll",object:"photo_scrubber",properties:e}}(Object.assign({actionSurface:o},t)));break;case et.selectPhotoThumbnail:i.logEvent(function(e){return{class:"photos",action:"select",object:"photo_thumbnail",properties:e}}({actionSurface:o,thumbnailSelectCount:parseInt(rt("thumbnailSelectCount",e,t)||"",10),eventState:"start"}));break;case et.starPhotoThumbnail:i.logEvent(function(e){return{class:"photos",action:"star",object:"photo_thumbnail",properties:e}}({actionSurface:o}));break;case et.unstarPhotoThumbnail:i.logEvent(function(e){return{class:"photos",action:"unstar",object:"photo_thumbnail",properties:e}}({actionSurface:o}));break;case et.openPhotoPreview:i.logEvent(function(e){return{class:"photos",action:"open",object:"photo_preview",properties:e}}({actionSurface:o}));break;case et.openPhotoSecondaryMenu:break;case et.selectPhotoSecondaryMenu:i.logEvent(function(e){return{class:"photos",action:"select",object:"photo_secondary_menu",properties:e}}({actionSurface:o,photoActionSelection:qe(ot[rt("secondaryMenuSelection",e,t)||""])}));break;case et.selectPhotoActionBar:i.logEvent(function(e){return{class:"photos",action:"select",object:"photo_action_bar",properties:e}}({actionSurface:o,photoActionSelection:qe(ot[rt("actionBarSelection",e,t)||""])}));break;case et.selectPhotoGroupBy:i.logEvent(function(e){return{class:"photos",action:"select",object:"photo_group_by",properties:e}}({actionSurface:o,photoGroupBySelection:Ze(it[rt("groupBySelection",e,t)||""])}));break;case et.selectPhotoFilter:i.logEvent(function(e){return{class:"photos",action:"select",object:"photo_filter",properties:e}}({actionSurface:o,photoFilterSelection:Xe(rt("filterSelection",e,t)||"")}));break;case et.shownSharingButton:i.logEvent(function(e){return{class:"photos",action:"shown",object:"sharing_button",properties:e}}({actionSurface:o}));break;case et.selectSharingButton:i.logEvent(function(e){return{class:"photos",action:"select",object:"sharing_button",properties:e}}(Object.assign({actionSurface:o},t)));break;case et.selectCopyLinkButton:i.logEvent(function(e){return{class:"photos",action:"select",object:"copy_link_button",properties:e}}({actionSurface:o}));break;case et.selectPreviewLink:i.logEvent(function(e){return{class:"photos",action:"select",object:"preview_link",properties:e}}(Object.assign({actionSurface:o},t)));break;case et.deltaReturnedItems:break;default:i.enforceExhaustive(e)}}(e,o.extras)}function st(e){return e in at}function rt(e,t,o){let i;const a=at[t];if(o&&st(t)&&(null==a?void 0:a.includes(e))){const t=o[e];"string"==typeof t&&(i=t)}return i}const ct="web_photos";var lt,dt;function _t(e){return 0===e?dt.EMPTY:0<e&&e<1e3?dt.SMALL:1e3<=e&&e<1e4?dt.MEDIUM:1e4<=e&&e<5e4?dt.LARGE:e>=5e4?dt.X_LARGE:dt.UNKNOWN}!function(e){e.AMP_PHOTOS_LOAD_ITEMS_LATENCY="load_items/latency"}(lt||(lt={})),function(e){e.EMPTY="empty",e.SMALL="small",e.MEDIUM="medium",e.LARGE="large",e.X_LARGE="x_large",e.UNKNOWN="unknown"}(dt||(dt={}));const pt=e=>i.getStateAtNamespace(e,i.PHOTOS_TIMELINE_NAMESPACE_KEY),ut=e=>pt(e).filteredItems,ht=e=>pt(e).sections,mt=e=>pt(e).filter,gt=e=>pt(e).grouping,ft=e=>pt(e).gridSize,bt=e=>pt(e).selection,vt=e=>pt(e).visibleTopSectionIndex,Et=e=>pt(e).shareLink,St=e=>pt(e).shareLinkStatus,Tt=e=>pt(e).user,yt=e=>pt(e).context,wt=i.createSelector((e=>pt(e).items),(e=>i.immutableExports.OrderedMap(e.filter((e=>{var t;return!!(null===(t=e.metadata)||void 0===t?void 0:t.extra_file_metadata)&&!!e.file_obj_id})).map((e=>{var t,o,a,n,s,r,c,l,d,_,p,u,h,m;return[e.file_obj_id,i.File.fromAnyFileObject({file_id:null===(o=null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.extra_file_metadata)||void 0===o?void 0:o.file_id,sjid:null===(n=null===(a=null==e?void 0:e.metadata)||void 0===a?void 0:a.extra_file_metadata)||void 0===n?void 0:n.sjid,ns_id:null===(r=null===(s=null==e?void 0:e.metadata)||void 0===s?void 0:s.extra_file_metadata)||void 0===r?void 0:r.ns_id,fq_path:null===(l=null===(c=null==e?void 0:e.metadata)||void 0===c?void 0:c.extra_file_metadata)||void 0===l?void 0:l.fq_path,bytes:null===(_=null===(d=null==e?void 0:e.metadata)||void 0===d?void 0:d.extra_file_metadata)||void 0===_?void 0:_.size_bytes,href:null===(u=null===(p=null==e?void 0:e.metadata)||void 0===p?void 0:p.extra_file_metadata)||void 0===u?void 0:u.href,is_in_backup_folder:null===(m=null===(h=null==e?void 0:e.metadata)||void 0===h?void 0:h.extra_file_metadata)||void 0===m?void 0:m.is_in_backup_folder})]}))))),It=i.createSelector(wt,ut,((e,t)=>i.immutableExports.List(t.map((t=>e.get((null==t?void 0:t.file_obj_id)||""))).filter((e=>!!e))))),xt=i.createSelector(wt,bt,((e,t)=>Rt(e,t))),Rt=(e,t)=>i.immutableExports.OrderedMap(t.selected.toArray().map((t=>[t,e.get(t)])).filter((([e,t])=>!!t))),At=i.createSelector(xt,(e=>{let t=0;return e.forEach((e=>{t+=e.bytes})),t})),kt=i.createSelector((e=>pt(e).apiStatus[De.DELTA]),mt,(e=>pt(e).favoritesLoaded),((e,t,o)=>{const{pagesLoaded:i,hasMoreData:a}=e,n=!o&&a;return t===He.STARRED&&n||0===i}));function Ot(e,t){return(e,o)=>d.__awaiter(this,void 0,void 0,(function*(){const a=yield e(i.updateStarredStatus({id:t,newStatus:!i.getIsStarred(o(),t),showSnackbar:!1}));try{i.unwrapResult(a);const t=o(),n=mt(t);n===He.STARRED&&e(Nt(n))}catch(e){(e=>{u.reportException({err:e,severity:v.SEVERITY.NON_CRITICAL,tags:[Me]})})(e)}}))}function Lt({state:e,hasMoreData:t,error:o,apiName:i}){const a={state:e,error:o};return void 0!==t&&(a.hasMoreData=t),{type:ze.SET_API_STATE,payload:{apiStatus:a,apiName:i}}}function Ct(e){return(t,o)=>d.__awaiter(this,void 0,void 0,(function*(){const a=i.getStarredBoolObject(o());t({type:ze.REMOVE_ITEMS_ACTION,payload:{fileIds:e},favorites:a})}))}function Nt(e){return(t,o)=>d.__awaiter(this,void 0,void 0,(function*(){const a=i.getStarredBoolObject(o());t({type:ze.SET_FILTER_ACTION,payload:{filter:e,favorites:a}})}))}function Pt(e){return{type:ze.SET_SHARE_LINK_ACTION,payload:{shareLink:e}}}function Mt(e){return{type:ze.SET_SHARE_LINK_STATUS_ACTION,payload:{shareLinkStatus:e}}}const jt="web-photos-snackbar-id",$t=({user:e,firstFile:t},o)=>{l.asyncOpenPreview({containerId:je,files:[t],indexOfPreviewFile:0,user:e,shouldFocusComment:o,updateBrowserLocation:!1,fileViewOrigin:i.FileViewOriginType.PHOTOS})};function zt(t,o,a,n,s,r,c,l){const _=a.first(),p={user:n,context:o,files:a,firstFile:_};switch(t){case b.ActionBarActionTypes.COMMENT:$t(p,!0);break;case b.ActionBarActionTypes.COPY:(({user:e,firstFile:t,files:o})=>{d.__awaiter(void 0,void 0,void 0,(function*(){const a=o.toArray().map((e=>({fq_path:e.fq_path,is_dir:e.is_dir,file_id:e.file_id}))),n=yield x.selectDestination({user:e,filesPath:a,currentFQPath:i.parent_dir(t.fq_path),operationType:"COPY"});w.portableCopy({newPath:n,filesPath:a,source:"photos",user:e})}))})(p);break;case b.ActionBarActionTypes.DOWNLOAD:(({files:e,user:t},o)=>{if(e.size>1){const i=e.toArray().map((e=>e.fq_path));E.get_zip({fq_paths:i,subject_uid:t.id,block_hash:o,parent_path:"/",flat_zip_mode:!0})}else E.get({url:e.first().href})})(p,s);break;case b.ActionBarActionTypes.DELETE:(({files:e,user:t},o)=>{const i=e.toArray(),a=i.map((e=>({file_id:e.file_id,is_dir:e.is_dir}))),n=i.map((e=>e.file_id)),s=a.length;T.portableDelete({user:t,filesPath:a,fq_path:e.first().fq_path},{onNetworkRequest:()=>T.deleteSnackBarInProgress(jt,s),onSuccess:()=>{o(n),T.deleteCompleteSnackBar(jt,s)},onError:e=>T.deleteFailedSnackBar(e,jt,s)})})(p,c);break;case b.ActionBarActionTypes.MOVE:(({user:e,firstFile:t,files:o})=>{d.__awaiter(void 0,void 0,void 0,(function*(){const a=o.toArray().map((e=>({fq_path:e.fq_path,is_dir:e.is_dir,file_id:e.file_id}))),n=yield x.selectDestination({user:e,filesPath:a,currentFQPath:i.parent_dir(t.fq_path),operationType:"MOVE"});I.portableMove({newPath:n,currentFQPath:i.parent_dir(t.fq_path),filesPath:a,source:"photos",user:e})}))})(p);break;case b.ActionBarActionTypes.OPEN:$t(p,!1);break;case b.ActionBarActionTypes.STAR:case b.ActionBarActionTypes.UNSTAR:1===a.size&&r(n,_.file_id);break;case b.ActionBarActionTypes.VERSION_HISTORY:(({user:e,firstFile:t})=>{const o=y.getFileHistoryUrl({fqPath:t.fq_path,userId:e.id});i.redirect(o)})(p);break;case b.ActionBarActionTypes.EDIT_IMAGE:l(_.file_id);break;case b.ActionBarActionTypes.ADD_TO_COLLECTION:(({files:t})=>{d.__awaiter(void 0,void 0,void 0,(function*(){const{showCollectionSaverModal:o}=yield new Promise((function(t,o){e(["./c_components_saver_modal_index"],t,o)}));o({fileIds:t.toArray().map((({file_id:e})=>e)),surface:"photos"})}))})(p)}}const Ft={actionType:b.ActionBarActionTypes.OPEN,isEnabled:!0,icon:i.OpenLine,text:S.OPEN_ACTION_STRING},Dt={actionType:b.ActionBarActionTypes.DOWNLOAD,isEnabled:!0,icon:i.DownloadLine,text:S.DOWNLOAD_ACTION_STRING},Bt={actionType:b.ActionBarActionTypes.MOVE,isEnabled:!0,icon:i.MoveLine,text:S.MOVE_ACTION_STRING},Ht={actionType:b.ActionBarActionTypes.COPY,isEnabled:!0,icon:i.CopyLine,text:S.COPY_ACTION_STRING},Gt={actionType:b.ActionBarActionTypes.DELETE,isEnabled:!0,icon:i.DeleteLine,text:S.DELETE_ACTION_STRING},Ut={actionType:b.ActionBarActionTypes.COMMENT,isEnabled:!0,icon:i.CommentLine,text:S.COMMENT_ACTION_STRING},Vt={actionType:b.ActionBarActionTypes.STAR,isEnabled:!0,icon:i.StarLine,text:S.STAR_ACTION_STRING},Wt={actionType:b.ActionBarActionTypes.UNSTAR,isEnabled:!0,icon:i.StarFill,text:S.UNSTAR_ACTION_STRING},Yt={actionType:b.ActionBarActionTypes.VERSION_HISTORY,isEnabled:!0,icon:i.ClockLine,text:S.VERSION_HISTORY_ACTION_STRING},qt={actionType:b.ActionBarActionTypes.EDIT_IMAGE,isEnabled:!0,icon:i.EditLine,text:S.EDIT_IMAGE_ACTION_STRING},Kt={actionType:b.ActionBarActionTypes.ADD_TO_COLLECTION,isEnabled:!0,icon:i.AddToCollectionLine,text:S.ADD_TO_COLLECTION_STRING},Xt=(e,t,o,i)=>{const a=[Ft,Dt,Bt,Ht],n=[Ft,Dt,Bt,Ht,Gt,Ut,e?Wt:Vt];return i||n.push(Yt),o&&(a.push(Kt),n.splice(4,0,Kt)),t&&(a.push(qt),n.splice(2,0,qt)),{atTopLevelIfSpace:a,alwaysInOverflow:[n]}},Jt=Object.freeze({logWebPhotosEvent:()=>{}}),Zt=o.reactExports.createContext(Jt),Qt=Zt.Provider;function eo(){const{logWebPhotosEvent:e}=o.reactExports.useContext(Zt);return e}i.injectInternalStyle("typescript/component_libraries/photos/src/share-button/index.module.out.css",(e=>"p._access-text_xfbzk_1{margin-left:var(--spacing__base_unit)}._multishare-button_xfbzk_5{margin-left:auto}"));const to=({isLoading:e,openShareLinkModal:t,intl:a})=>{const{shareButtonText:n,accessText:s}=function(e){return{shareButtonText:e.formatMessage({id:"0WmBsM",defaultMessage:"Share Link"}),accessText:e.formatMessage({id:"SPOVai",defaultMessage:"Only you have access"})}}(a);return o.React$1.createElement(o.React$1.Fragment,null,o.React$1.createElement(i.Button$1,{variant:"opacity","data-testid":"ShareButton",withIconLeft:o.React$1.createElement(i.UIIcon,{src:i.LinkLine}),onClick:()=>{t()},disabled:e,isLoading:e,className:"_multishare-button_xfbzk_5"},n),o.React$1.createElement(i.Text,{tagName:"p",color:"faint",className:"_access-text_xfbzk_1"},s))};to.displayName="ShareButton";class oo extends o.React$1.Component{constructor(){super(...arguments),this.actionHandler={handleAction:e=>{this.context.logWebPhotosEvent(et.selectPhotoActionBar,{actionBarSelection:`${e.type}`,itemCount:`${this.props.selectedFiles.count()}`}),zt(e.type,this.props.context,this.props.selectedFiles,this.props.user,this.props.blockHash,this.props.toggleFavorite,this.props.removeItems,this.props.openPhotoEditorModal)}}}componentDidUpdate(e){0===e.selectedFiles.count()&&0!==this.props.selectedFiles.count()&&this.context.logWebPhotosEvent(et.shownSharingButton)}render(){const{selectedFiles:e}=this.props;if(0===e.count())return null;const t=e.first().file_id,i=1===e.count()?Xt(this.props.isFavorite(t),this.props.isEditable(t),this.props.isCollectionsInPhotosEnabled,this.props.isBackupFile(t)):(e=>{const t=[Dt,Ht,Gt],o=[Dt,Ht,Gt];return e&&(t.push(Kt),o.push(Kt)),{atTopLevelIfSpace:t,alwaysInOverflow:[o]}})(this.props.isCollectionsInPhotosEnabled);return o.React$1.createElement("div",{className:"photos-action-bar"},o.React$1.createElement(R.ActionBar,{className:"photos-action-toolbar-actionbar",responsive:!0,actionHandler:this.actionHandler,actions:i,intl:n.intl}),o.React$1.createElement(to,{isLoading:this.props.shareLinkStatus===$e.Loading,openShareLinkModal:this.props.openShareLinkModal,intl:n.intl}))}}oo.contextType=Zt,oo.displayName="PhotosActionBarController";const io=i.connect((e=>({selectedFiles:xt(e),user:Tt(e),context:yt(e),shareLinkStatus:St(e)})),{toggleFavorite:Ot,removeItems:Ct})(oo);i.injectInternalStyle("typescript/component_libraries/photos/src/loading-tile/index.module.out.css",(e=>"._loading-tile_1ouhk_1{align-items:center;display:flex;height:100%;justify-content:center;opacity:.35;width:100%}._shine_1ouhk_10{animation-duration:1s;animation-fill-mode:forwards;animation-iteration-count:infinite;animation-name:_shimmer-animation_1ouhk_1;animation-timing-function:linear;background:var(--color__inverse__disabled__background);background-image:linear-gradient(90deg,hsla(37,15%,83%,.49) -2.73%,hsla(36,24%,96%,.82) 57.33%,hsla(37,15%,83%,0) 92.58%);background-repeat:no-repeat;background-size:600px;position:relative}@keyframes _shimmer-animation_1ouhk_1{0%{background-position:-468px 0}to{background-position:468px 0}}"));const ao=()=>{const{loadingAriaLable:e}={loadingAriaLable:n.useIntl().formatMessage({id:"WaMtfr",defaultMessage:"Loading Photo"})};return o.React$1.createElement("div",{className:"_loading-tile_1ouhk_1 _shine_1ouhk_10","data-testid":"loading-tile","aria-label":e})};i.injectInternalStyle("typescript/component_libraries/photos/src/photo-header/index.module.out.css",(e=>"._photo-grid_date-header_1kimt_1{padding:var(--spacing__unit--1_5) 0}"));const no={[Be.DAYS]:{year:"numeric",month:"long",day:"numeric"},[Be.MONTHS]:{year:"numeric",month:"long"},[Be.YEARS]:{year:"numeric"}};var so;!function(e){e[e.NONE=0]="NONE",e[e.SOME=1]="SOME",e[e.ALL=2]="ALL"}(so||(so={}));const ro=({date:e,count:t,format:a,selection:s,onChange:r})=>{const{checkboxAriaLabel:c,withSubtextLabel:l}=function(e,t,o,i){const a=n.useIntl();let s;switch(o){case so.ALL:s=a.formatMessage({id:"vRKKk/",defaultMessage:"Deselect {count, plural, one{# item} other{all # items}} for {formattedDate}"},{count:i,formattedDate:a.formatDate(e,no[t])});break;case so.SOME:s=a.formatMessage({id:"40UruG",defaultMessage:"Deselect {count, plural, one{# item} other{# items}} for {formattedDate}"},{count:i,formattedDate:a.formatDate(e,no[t])});break;case so.NONE:default:s=a.formatMessage({id:"N8hmrd",defaultMessage:"Select {count, plural, one{# item} other{all # items}} for {formattedDate}"},{count:i,formattedDate:a.formatDate(e,no[t])})}return{checkboxAriaLabel:s,withSubtextLabel:a.formatMessage({id:"hCjeki",defaultMessage:"{count, plural, one{# item} other{# items}}"},{count:i})}}(e,a,s,t);return o.React$1.createElement("div",{className:"_photo-grid_date-header_1kimt_1"},o.React$1.createElement(k.LabelGroup,{withText:o.React$1.createElement(i.Text,{variant:"label",isBold:!0},o.React$1.createElement(n.FormattedDate,Object.assign({value:e},no[a]))),withSubtext:l,direction:"horizontal",withLeftAccessory:o.React$1.createElement(i.Checkbox,{isIndeterminate:s===so.SOME,checked:s===so.ALL,onChange:r,"aria-label":c})}))};ro.displayName="PhotoSectionHeader";const co=o.reactExports.memo(ro);function lo(e){var t;t="undefined"!=typeof window?window:"undefined"!=typeof self?self:global;var o,i,a="undefined"!=typeof document&&document.attachEvent;if(!a){var n=(i=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)},function(e){return i(e)}),s=(o=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.clearTimeout,function(e){return o(e)}),r=function(e){var t=e.__resizeTriggers__,o=t.firstElementChild,i=t.lastElementChild,a=o.firstElementChild;i.scrollLeft=i.scrollWidth,i.scrollTop=i.scrollHeight,a.style.width=o.offsetWidth+1+"px",a.style.height=o.offsetHeight+1+"px",o.scrollLeft=o.scrollWidth,o.scrollTop=o.scrollHeight},c=function(e){if(!(e.target.className&&"function"==typeof e.target.className.indexOf&&e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)){var t=this;r(this),this.__resizeRAF__&&s(this.__resizeRAF__),this.__resizeRAF__=n((function(){(function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height})(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(o){o.call(t,e)})))}))}},l=!1,d="",_="animationstart",p="Webkit Moz O ms".split(" "),u="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),h=document.createElement("fakeelement");if(void 0!==h.style.animationName&&(l=!0),!1===l)for(var m=0;m<p.length;m++)if(void 0!==h.style[p[m]+"AnimationName"]){d="-"+p[m].toLowerCase()+"-",_=u[m],l=!0;break}var g="resizeanim",f="@"+d+"keyframes "+g+" { from { opacity: 0; } to { opacity: 0; } } ",b=d+"animation: 1ms "+g+"; "}return{addResizeListener:function(o,i){if(a)o.attachEvent("onresize",i);else{if(!o.__resizeTriggers__){var n=o.ownerDocument,s=t.getComputedStyle(o);s&&"static"==s.position&&(o.style.position="relative"),function(t){if(!t.getElementById("detectElementResize")){var o=(f||"")+".resize-triggers { "+(b||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',i=t.head||t.getElementsByTagName("head")[0],a=t.createElement("style");a.id="detectElementResize",a.type="text/css",null!=e&&a.setAttribute("nonce",e),a.styleSheet?a.styleSheet.cssText=o:a.appendChild(t.createTextNode(o)),i.appendChild(a)}}(n),o.__resizeLast__={},o.__resizeListeners__=[],(o.__resizeTriggers__=n.createElement("div")).className="resize-triggers";var l=n.createElement("div");l.className="expand-trigger",l.appendChild(n.createElement("div"));var d=n.createElement("div");d.className="contract-trigger",o.__resizeTriggers__.appendChild(l),o.__resizeTriggers__.appendChild(d),o.appendChild(o.__resizeTriggers__),r(o),o.addEventListener("scroll",c,!0),_&&(o.__resizeTriggers__.__animationListener__=function(e){e.animationName==g&&r(o)},o.__resizeTriggers__.addEventListener(_,o.__resizeTriggers__.__animationListener__))}o.__resizeListeners__.push(i)}},removeResizeListener:function(e,t){if(a)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",c,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(_,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(e){}}}}}var _o=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),po=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},uo=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},ho=function(e){function t(){var e,o,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,n=Array(a),s=0;s<a;s++)n[s]=arguments[s];return o=i=uo(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(n))),i.state={height:i.props.defaultHeight||0,width:i.props.defaultWidth||0},i._onResize=function(){var e=i.props,t=e.disableHeight,o=e.disableWidth,a=e.onResize;if(i._parentNode){var n=i._parentNode.offsetHeight||0,s=i._parentNode.offsetWidth||0,r=window.getComputedStyle(i._parentNode)||{},c=parseInt(r.paddingLeft,10)||0,l=parseInt(r.paddingRight,10)||0,d=parseInt(r.paddingTop,10)||0,_=parseInt(r.paddingBottom,10)||0,p=n-d-_,u=s-c-l;(!t&&i.state.height!==p||!o&&i.state.width!==u)&&(i.setState({height:n-d-_,width:s-c-l}),a({height:n,width:s}))}},i._setRef=function(e){i._autoSizer=e},uo(i,o)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),_o(t,[{key:"componentDidMount",value:function(){var e=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=lo(e),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var e=this.props,t=e.children,i=e.className,a=e.disableHeight,n=e.disableWidth,s=e.style,r=this.state,c=r.height,l=r.width,d={overflow:"visible"},_={},p=!1;return a||(0===c&&(p=!0),d.height=0,_.height=c),n||(0===l&&(p=!0),d.width=0,_.width=l),o.reactExports.createElement("div",{className:i,ref:this._setRef,style:po({},d,s)},!p&&t(_))}}]),t}(o.reactExports.PureComponent);ho.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}};const mo=4;i.injectInternalStyle("typescript/component_libraries/photos/src/virtualized-grid/index.module.out.css",(e=>"._virtualized-grid_ulma3_1 ._tile_ulma3_1{position:absolute;top:0}._virtualized-grid_ulma3_1 ul{list-style-type:none;margin:0;padding:0}"));const go={virtualizedGrid:"_virtualized-grid_ulma3_1",tile:"_tile_ulma3_1"},fo=({index:e,size:t,children:i})=>{const a=e*(t+mo);return o.React$1.createElement("li",{className:"_tile_ulma3_1",style:{height:t,width:t,left:a}},i)};fo.displayName="TileWrapper";const bo=o.reactExports.memo(fo),vo=({index:e,style:t,data:i})=>{const{renderHeader:a,renderTile:n,rows:s,tileSize:r,thumbnailSize:c}=i,l=s[e];return o.React$1.createElement("ul",{style:t},Eo(l)?o.React$1.createElement(a,Object.assign({},l)):l.map(((e,t)=>o.React$1.createElement(bo,{index:t,size:r,key:t},o.React$1.createElement(n,{item:e,thumbnailSize:c})))))};function Eo(e){return!Array.isArray(e)}function So(e){const t=o.reactExports.useRef(null),{minimumWidth:i,items:a,sections:n,headerHeight:s}=e;return o.reactExports.useLayoutEffect((()=>{var e;null===(e=t.current)||void 0===e||e.resetAfterIndex(0,!1)}),[i,a.length,n,s]),o.React$1.createElement(ho,{onResize:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.resetAfterIndex(0,!0)}},(i=>o.React$1.createElement(To,Object.assign({},i,e,{listRef:t}))))}function To({minimumWidth:e,thumbnailSize:t,items:i,sections:a,renderTile:n,renderHeader:s,headerHeight:r,overscanCount:c,tilesPerRow:l,onTilePerRowChange:d,onScroll:_,onScrollSection:p,gridRef:u,height:h,width:m,listRef:g,onGridItemsRendered:f}){const b=Date.now(),[v,E]=function(e){var t;const[i,a]=o.reactExports.useState(0),n=o.reactExports.useRef(),{offsetWidth:s,clientWidth:r}=null!==(t=n.current)&&void 0!==t?t:{offsetWidth:0,clientWidth:0};return o.reactExports.useLayoutEffect((()=>{a(s-r)}),[e,s,r]),[i,n]}(m),S=Math.max(Math.floor((m-v)/(e+mo)),1),T=(m-v-mo*(S-1))/S,{rows:y,sectionIndices:w}=o.reactExports.useMemo((()=>function(e,t,o){const i=[],a=[];for(let n=0;n<t.sectionLabels.length;n++){a.push(i.length),i.push({index:n,label:t.sectionLabels[n]});const s=t.sectionStartIndices[n],r=t.sectionStartIndices[n+1],c=void 0===r?e.length:r;for(let t=s;t<c;t+=o){const a=Math.min(c,t+o);i.push(e.slice(t,a))}}return{rows:i,sectionIndices:a}}(i,a,S)),[i,a,S]);o.reactExports.useEffect((()=>{void 0!==d&&S!==l&&d(S)}),[d,S,l]),o.reactExports.useImperativeHandle(u,(()=>({scrollToSection:e=>{var t;null===(t=null==g?void 0:g.current)||void 0===t||t.scrollToItem(w[e],"start")},scrollToItem:(e,t)=>{var o;const i=function(e,t,o){let i=-1;for(let a=0;a<t.length;a++){const n=t[a];if(n&&!Eo(n)){if(n.find((t=>o(t,e)))){i=a;break}}}return i}(e,y,t);-1!==i&&(null===(o=null==g?void 0:g.current)||void 0===o||o.scrollToItem(i,"smart"))}})));const I=o.reactExports.useCallback((({visibleStartIndex:e,overscanStopIndex:t,overscanStartIndex:o})=>{if(p&&p(function(e,t){for(let o=e+1;o>=0;o--){const e=t[o];if(e&&Eo(e))return e.index}return 0}(e,y)),f){const e=yo(o,y),i=function(e,t){let o;for(let i=e;i>=0;i--){const e=t[i];if(e&&!Eo(e)){o=e;break}}return o}(t,y);f({overscanStartItem:e&&e[0],overscanStopItem:i&&i[(null==i?void 0:i.length)-1]},b)}}),[p,y,f,yo]),x={renderTile:n,renderHeader:s,rows:y,tileSize:T,thumbnailSize:t},R=o.reactExports.useMemo((()=>o.React$1.forwardRef(((e,t)=>o.React$1.createElement("div",Object.assign({"data-testid":"virtualized-grid"},e,{ref:t}))))),[]);return o.React$1.createElement(O.VariableSizeList,{onScroll:_,className:go.virtualizedGrid,ref:g,outerRef:E,height:h,width:m,overscanCount:c,itemCount:y.length,outerElementType:R,itemSize:e=>mo+(Eo(y[e])?r:T),estimatedItemSize:T+mo+a.sectionLabels.length/y.length*(r-T),itemData:x,onItemsRendered:p?I:void 0},vo)}function yo(e,t){let o;for(let i=e;i<t.length;i++){const e=t[i];if(e&&!Eo(e)){o=e;break}}return o}o.reactExports.memo(vo,O.areEqual);i.injectInternalStyle("typescript/component_libraries/photos/src/scroll-spy/index.module.out.css",(e=>':root{--scroll-spy-width:36px;--scroll-spy-width__focused:93px;--scroll-spy__line-length:20px;--scroll-spy__line-thickness:2px;--scroll-spy__gradient:linear-gradient(180deg,#fff 9.18%,hsla(0,0%,100%,0) 49.48%,#fff 90.82%);--scroll-spy--z-index:1;--scroll-spy__gradient--z-index:calc(var(--scroll-spy--z-index) + 1);--scroll-spy--hover--z-index:calc(var(--scroll-spy__gradient--z-index) + 1);--scroll-spy__gradient--hover--z-index:calc(var(--scroll-spy--hover--z-index) + 1)}._photos-scroll-spy_7byf2_18{flex:0 0 var(--scroll-spy-width);margin-left:var(--spacing__base_unit);position:relative;-webkit-user-select:none;user-select:none;width:var(--scroll-spy-width)}._section-labels--container_7byf2_26{background-color:var(--color__standard__background);height:100%;margin:0;opacity:0;position:absolute;right:0;top:0;transform:translateX(var(--scroll-spy-width__focused));transition:opacity var(--motion__time--fast) var(--motion__ease--out),transform var(--motion__time--fast) var(--motion__ease--out);width:var(--scroll-spy-width__focused);z-index:var(--scroll-spy--hover--z-index)}._section-labels--container_7byf2_26:before{background:var(--scroll-spy__gradient);content:"";height:100%;pointer-events:none;position:absolute;right:0;top:0;width:100%;z-index:var(--scroll-spy__gradient--hover--z-index)}._section-labels_7byf2_26{align-items:safe center;height:100%;overflow-y:auto;padding:0 var(--spacing__base_unit)}._section-labels--list_7byf2_60{display:flex;flex-flow:column;list-style-type:none;margin-block:0;-webkit-padding-start:0;padding-inline-start:0;text-align:right;width:100%}._label_7byf2_70._selected_7byf2_70,._label_7byf2_70:hover{color:var(--color__attention__text)}._label_7byf2_70{cursor:pointer;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}._photos-scroll-spy_7byf2_18:hover ._section-labels--container_7byf2_26{opacity:1;transform:translateX(0)}._section-lines--container_7byf2_90{height:100%;margin:0}._section-lines--container_7byf2_90 ::-webkit-scrollbar{display:none}._section-lines--container_7byf2_90:before{background:var(--scroll-spy__gradient);content:"";height:100%;pointer-events:none;position:absolute;right:0;top:0;width:100%;z-index:var(--scroll-spy__gradient--z-index)}._section-lines_7byf2_90{align-items:safe center;height:100%;overflow-y:auto;width:100%}._section-lines--list_7byf2_126{display:flex;flex-flow:column;list-style-type:none;margin-block:0;padding:0 var(--spacing__unit--0_5);-webkit-padding-start:0;padding-inline-start:0}._line_7byf2_135{align-self:flex-end;background-color:var(--color__standard__border);border-radius:calc(var(--scroll-spy__line-thickness)/2);height:var(--scroll-spy__line-thickness);margin:calc(var(--type__body__xsmall--lineheight_label)/2 - var(--scroll-spy__line-thickness)/2) 0;width:var(--scroll-spy__line-length)}._line_7byf2_135._selected_7byf2_70{background-color:var(--color__attention__text)}._line_7byf2_135:first-child,._line_7byf2_135:last-child{width:calc(var(--scroll-spy__line-length) + var(--spacing__base_unit))}._section-padder_7byf2_156{display:block;min-height:50%;min-width:100%}'));const wo="_photos-scroll-spy_7byf2_18",Io="_section-labels--container_7byf2_26",xo="_section-labels_7byf2_26",Ro="_section-labels--list_7byf2_60",Ao="_label_7byf2_70",ko="_selected_7byf2_70",Oo="_section-lines--container_7byf2_90",Lo="_section-lines_7byf2_90",Co="_section-lines--list_7byf2_126",No="_line_7byf2_135",Po="_section-padder_7byf2_156",Mo={[Be.DAYS]:{year:"numeric",month:"short",day:"numeric"},[Be.MONTHS]:{year:"numeric",month:"short"},[Be.YEARS]:{year:"numeric"}},jo=({items:e,onClick:t,selectedIndex:a})=>{const n=e.map((()=>({labelRef:o.React$1.createRef(),lineRef:o.React$1.createRef()}))),s=o.React$1.createRef();return o.React$1.useLayoutEffect((()=>{var e,t,o,i,r,c,l,d;if("number"==typeof a&&n.length>a){const{labelRef:_,lineRef:p}=n[a];null===(t=null===(e=p.current)||void 0===e?void 0:e.scrollIntoView)||void 0===t||t.call(e,{behavior:"auto",block:"center"});const u=(null!==(i=null===(o=_.current)||void 0===o?void 0:o.offsetTop)&&void 0!==i?i:0)-(null!==(c=null===(r=n[0].labelRef.current)||void 0===r?void 0:r.offsetTop)&&void 0!==c?c:0);null===(d=null===(l=s.current)||void 0===l?void 0:l.scrollTo)||void 0===d||d.call(l,{top:u})}}),[n,s,a]),o.React$1.createElement("div",{className:wo},o.React$1.createElement("div",{className:Io},o.React$1.createElement("div",{className:xo,ref:s},o.React$1.createElement("div",{className:Po}),o.React$1.createElement("ul",{className:Ro},e.map(((e,s)=>o.React$1.createElement(i.Text,{tagName:"li",variant:"label",size:"xsmall",color:"faint",className:i.cx(Ao,{[ko]:a===s}),onClick:()=>{t&&t(s)},key:s,ref:n[s].labelRef},e)))),o.React$1.createElement("div",{className:Po}))),o.React$1.createElement("div",{className:Oo},o.React$1.createElement("div",{className:Lo,"aria-hidden":!0},o.React$1.createElement("div",{className:Po}),o.React$1.createElement("ul",{className:Co,"aria-hidden":!0},e.map(((e,t)=>o.React$1.createElement("li",{className:i.cx(No,{[ko]:a===t}),key:t,ref:n[t].lineRef})))),o.React$1.createElement("div",{className:Po}))))};jo.displayName="ScrollSpy";const $o=e=>{var{items:t,format:i}=e,a=d.__rest(e,["items","format"]);const s=n.useIntl();return o.React$1.createElement(jo,Object.assign({items:t.map((e=>s.formatDate(e,Mo[i])))},a))};$o.displayName="TimelineScrollSpy";i.injectInternalStyle("typescript/component_libraries/photos/src/photo-tile/index.module.out.css",(e=>'._photo-tile_apskw_1:before{content:"";height:100%;position:absolute;transition:background-color var(--motion__time--faster);width:100%}._photo-tile_apskw_1:hover:before{background:linear-gradient(180deg,#2b2929,rgba(43,41,41,0) 25% 75%,#2b2929)}._photo-tile_apskw_1._photo-tile--selected_apskw_13:before{background:var(--color__inverse__attention__border--faint)}._photo-tile_apskw_1:hover{cursor:pointer}._photo-tile-img_apskw_21{animation:_fadein_apskw_1 var(--motion__time--faster);color:transparent;height:100%;object-fit:cover;width:100%}._photo-tile_apskw_1{background-color:var(--color__opacity--1);height:100%;position:relative;width:100%}._duration-badge_apskw_37{background-color:var(--color__inverse__standard__background);bottom:0;color:var(--color__inverse__standard__text);right:0;-webkit-user-select:none;user-select:none}._duration-badge_apskw_37,._tile-checkbox_apskw_47{margin:var(--spacing__unit--1_5);position:absolute}._tile-checkbox_apskw_47{left:0;opacity:0;top:0}._photo-tile_apskw_1:focus ._tile-checkbox_apskw_47,._photo-tile_apskw_1:hover ._tile-checkbox_apskw_47,._tile-checkbox--selected_apskw_55,._tile-checkbox_apskw_47:active,._tile-checkbox_apskw_47:focus{opacity:1}._photo-tile_star_apskw_66{bottom:0;left:0;margin:var(--spacing__unit--0_5);opacity:0;position:absolute}._photo-tile_apskw_1:focus ._photo-tile_star_apskw_66,._photo-tile_apskw_1:hover ._photo-tile_star_apskw_66,._photo-tile_star_apskw_66._starred_apskw_77,._photo-tile_star_apskw_66:focus{opacity:1}._photo-tile_overflow-menu_apskw_81{margin:var(--spacing__unit--0_5);opacity:0;position:absolute;right:0;top:0}._photo-tile_apskw_1:focus-within ._photo-tile_overflow-menu_apskw_81,._photo-tile_apskw_1:focus ._photo-tile_overflow-menu_apskw_81,._photo-tile_apskw_1:hover ._photo-tile_overflow-menu_apskw_81,._photo-tile_overflow-menu_apskw_81:focus,._photo-tile_overflow-menu_apskw_81:hover{opacity:1}'));var zo;!function(e){e.SELECT="select",e.CLICK="click",e.FAVORITE="favorite"}(zo||(zo={}));const Fo=({duration:e,isSelected:t,isStarred:a,onUserInteraction:s,thumbnailUrl:r,actions:c,overFlowActionHandler:l,menuToggleHandler:d,imageName:_,dateCreated:p,index:u,handleLoadError:h})=>{const{addFavoriteAriaLabel:m,removeFavoriteAriaLabel:g,selectAriaLabel:f,unSelectAriaLabel:b,tileVideoAltText:v,tileImageAltText:E,mediaName:S}=function(e,t){const o=n.useIntl(),i=t?o.formatDate(t,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}):"",a=`${e} ${i}`;return{addFavoriteAriaLabel:o.formatMessage({id:"H09L3p",defaultMessage:"Add to favorites"}),removeFavoriteAriaLabel:o.formatMessage({id:"W7fGIp",defaultMessage:"Remove from favorites"}),selectAriaLabel:o.formatMessage({id:"h36j1+",defaultMessage:"Select Item"}),unSelectAriaLabel:o.formatMessage({id:"3neLkf",defaultMessage:"Unselect Item"}),tileImageAltText:o.formatMessage({id:"n32qVg",defaultMessage:"Image - {mediaName}"},{mediaName:a}),tileVideoAltText:o.formatMessage({id:"psaLH/",defaultMessage:"Video - {mediaName}"},{mediaName:a}),mediaName:a}}(_,p),T={handleAction:e=>{e.event.stopPropagation(),l(e.type)},handleMenuToggle:()=>{}},y={secondaryActionsContext:{firstEntryAccessibilityHint:S,noOfEntries:1}},w=`${e?"photo-tile-video":"photo-tile-image"}-${u}`,I=`photo-tile-select-${u}`,x=`photo-tile-star-${u}`;return o.React$1.createElement("div",{className:i.cx("_photo-tile_apskw_1",{"_photo-tile--selected_apskw_13":t}),"data-testid":"photo-tile",onClick:e=>s(zo.CLICK,e),tabIndex:0},o.React$1.createElement(i.Checkbox,{"data-testid":I,id:I,className:i.cx("_tile-checkbox_apskw_47",{"_tile-checkbox--selected_apskw_55":t}),checked:t,onClick:e=>{e.stopPropagation(),s(zo.SELECT,e)},inverse:!0,"aria-label":t?b:f,"aria-labelledby":`${I} ${w}`}),o.React$1.createElement("div",{onClick:e=>e.stopPropagation()},o.React$1.createElement(N.InlineOverflowMenu,{accessibilityConfig:y,actions:c,actionHandler:T,className:"_photo-tile_overflow-menu_apskw_81",intl:n.useIntl(),size:"small",isMobile:!1,handleOverflowMenuToggle:d,overflowMenuTitle:"",inverse:!0})),o.React$1.createElement(i.IconButton,{"data-testid":x,id:x,className:i.cx("_photo-tile_star_apskw_66",{_starred_apskw_77:a}),variant:"transparent",onClick:e=>{e.stopPropagation(),s(zo.FAVORITE,e)},inverse:!0,tabIndex:0,"aria-label":a?g:m,"aria-labelledby":`${x} ${w}`},o.React$1.createElement(i.UIIcon,{src:a?i.StarFill:i.StarLine,"aria-hidden":"true"})),e&&o.React$1.createElement(i.AccessoryBadge,{className:"_duration-badge_apskw_37"},e),o.React$1.createElement("img",{id:w,className:"_photo-tile-img_apskw_21",draggable:!1,src:r,alt:e?v:E,onError:()=>{h()}}))};Fo.displayName="PhotoTile";const Do=o.reactExports.memo(Fo);function Bo(e){if(!e||!Number.isFinite(e)||e<=0)return;const t=Math.round(e/1e3),o=t%60,i=Math.floor(t/60),a=i%60,n=Math.floor(i/60);return n?`${n}:${Ho(a)}:${Ho(o)}`:`${a}:${Ho(o)}`}function Ho(e){return e<10?`0${e}`:String(e)}Do.displayName="PhotoTileMemo";const Go=o.React$1.createContext({selection:i.createSelection(),actions:()=>{},handleDeselect:()=>{},handleSelect:()=>{},handlePreview:()=>{},handleFavorite:()=>{},isFavorite:()=>{},isEditable:()=>{},isBackupFile:()=>{},actionHandler:()=>{}}),Uo=({item:e,thumbnailSize:t})=>{var i,a,n,s;const{selection:r,actions:c,handleDeselect:l,handleSelect:d,handlePreview:_,handleFavorite:p,isFavorite:h,isEditable:m,isBackupFile:g,actionHandler:f}=o.reactExports.useContext(Go),b=eo(),E=o.reactExports.useCallback((()=>{u.reportException({err:Error("PhotoTile image did not load"),tags:[Me,`fileid: ${e.file_obj_id}`],severity:v.SEVERITY.NONCRITICAL})}),[e]),S=e.file_obj_id||"",T=(null===(i=e.metadata)||void 0===i?void 0:i.media_metadata.thumbnail)||"",y=h(e.file_obj_id),w=m(e.file_obj_id),I=g(e.file_obj_id),x=o.reactExports.useMemo((()=>r.selected.has(S)),[r,S]),R=o.reactExports.useMemo((()=>T&&C.getThumbnailUrlForItem(T,t,1)),[T,t]),A=o.reactExports.useCallback(((e,t)=>{switch(e){case zo.SELECT:x?l(S,t.shiftKey):d(S,t.shiftKey?L.SelectOptions.EXTEND:L.SelectOptions.DEFAULT);break;case zo.CLICK:_(S);break;case zo.FAVORITE:p(S)}}),[x,l,d,S]),k=c(y,w,I),O=o.reactExports.useCallback((t=>{b(et.selectPhotoSecondaryMenu,{secondaryMenuSelection:`${t}`}),f(t,e)}),[e,f,b]),N=o.reactExports.useCallback((({isOpen:e})=>{e&&b(et.openPhotoSecondaryMenu)}),[b]);return o.React$1.createElement(Do,{onUserInteraction:A,thumbnailUrl:R,duration:Bo(null===(a=e.metadata)||void 0===a?void 0:a.media_metadata.duration),isSelected:x,isStarred:y,actions:k,overFlowActionHandler:O,menuToggleHandler:N,imageName:(null===(n=e.metadata)||void 0===n?void 0:n.file_metadata.name)||"",dateCreated:null===(s=e.metadata)||void 0===s?void 0:s.media_metadata.date_created,index:e.index,handleLoadError:E})};Uo.displayName="PhotoTile";const Vo=o.React$1.createContext({updateSelection:()=>{},selection:i.createSelection(),sections:{sectionLabels:[],sectionStartIndices:[]},grouping:Be.MONTHS,itemIds:[]}),Wo=({label:e,index:t})=>{const{updateSelection:i,grouping:a,selection:n,sections:s,itemIds:r}=o.reactExports.useContext(Vo),c=s.sectionStartIndices[t],l=s.sectionStartIndices[t+1],d=void 0===l?r.length:l,_=Yo(n,r,c,d),p=o.reactExports.useCallback((()=>{_===so.NONE?i(n.selected.union(r.slice(c,l)).toArray()):i(n.selected.subtract(r.slice(c,l)).toArray())}),[t,_,s,n]);return o.React$1.createElement(co,{count:d-c,date:e,format:a,selection:_,onChange:p})};Wo.displayName="PhotoHeader";const Yo=(e,t,o,i)=>{let a;for(let n=o;n<i;n++){const o=e.selected.has(t[n]);if(void 0===a)a=o;else if(o!==a)return so.SOME}return a?so.ALL:so.NONE},qo={[Ge.EXTRA_SMALL]:{width:80,thumbnailSize:256},[Ge.SMALL]:{width:100,thumbnailSize:256},[Ge.MEDIUM]:{width:150,thumbnailSize:256},[Ge.LARGE]:{width:200,thumbnailSize:512},[Ge.EXTRA_LARGE]:{width:400,thumbnailSize:512}},Ko=({items:e,sections:t,gridSize:i,grouping:a,overFlowActions:n,onTTI:s=(()=>{}),onSelectionChange:r,handlePreview:c,handleFavorite:l,selection:d,visibleTopSectionIndex:_,onVisibleTopSectionIndexChange:p,isFavorite:u,isEditable:h,isBackupFile:m,overFlowActionHandler:g,isLoading:f,loadingTilesCount:b=80,onGridItemsRendered:v,photoTileGridRef:E})=>{o.reactExports.useEffect(s,[]);const S=o.reactExports.useMemo((()=>e.toArray().map((e=>(null==e?void 0:e.file_obj_id)||""))),[e]),[T,y]=o.reactExports.useState(1),w=o.reactExports.useRef(),{onScroll:I,logScrollToSection:x}=Xo(a),R={sectionLabels:[new Date],sectionStartIndices:[0]},A=o.reactExports.useCallback((e=>{var t;null===(t=w.current)||void 0===t||t.scrollToSection(e),p(e),x()}),[w.current,p]);return o.reactExports.useImperativeHandle(E,(()=>({scrollToItem:(e,t)=>{var o;null===(o=w.current)||void 0===o||o.scrollToItem(e,t)}}))),o.React$1.createElement("div",{className:"photo-grid-wrapper"},o.React$1.createElement(L.SelectableList,{itemIds:S,keyScope:L.SELECTABLE_TILE_GRID_KEY_SCOPE,onSelectionChange:r,selection:d,tilesPerRow:T,sectionStartIndices:t.sectionStartIndices},(({handleDeselect:s,handleSelect:r,updateSelection:_})=>o.React$1.createElement(Vo.Provider,{value:{updateSelection:_,itemIds:S,grouping:a,selection:d,sections:f?R:t}},o.React$1.createElement(Go.Provider,{value:{handleDeselect:s,handleSelect:r,selection:d,handlePreview:c,handleFavorite:l,isFavorite:u,isEditable:h,isBackupFile:m,actions:n,actionHandler:g}},o.React$1.createElement(So,{items:f?Array(b).fill({}):e.map(((e,t)=>Object.assign(Object.assign({},e),{index:t}))).toArray(),sections:f?R:t,minimumWidth:qo[i].width,thumbnailSize:qo[i].thumbnailSize,renderHeader:Wo,headerHeight:44,renderTile:f?ao:Uo,overscanCount:20,tilesPerRow:T,onTilePerRowChange:y,onScroll:I,onScrollSection:p,gridRef:w,onGridItemsRendered:v}))))),o.React$1.createElement($o,{items:t.sectionLabels,format:a,selectedIndex:_,onClick:A}))};Ko.displayName="PhotoTileGrid";const Xo=e=>{const t=eo(),i=o.reactExports.useRef(0);return{onScroll:o.reactExports.useCallback((e=>{const o=Math.floor(e.scrollOffset/window.innerHeight);i.current<o&&(i.current=o,t(et.scrollPhotosPage,{scrollDepth:`${o}`}))}),[t]),logScrollToSection:()=>{t(et.scrollPhotosScrubber,{grouping:e.toString()})}}};i.injectInternalStyle("typescript/component_libraries/photos/src/share-modal/index.module.out.css",(e=>"._share-modal-header_980xj_1{border-bottom:1px solid var(--color__standard__border)}._share-modal-header-content_980xj_5{align-items:center;display:flex;flex-direction:row}._share-modal-header-icon_980xj_11{margin-right:var(--spacing__base_unit)}._share-modal-content-size_980xj_15{margin-left:var(--spacing__base_unit)}._share-modal-body_980xj_19{margin-top:var(--spacing__base_unit)}"));const Jo=({modalOpen:e,numSelectedItems:t,generateShareLink:a,closeModal:s,calculateReadableSelectionSize:r})=>{const{headerMessage:c,shareText:l,permissionsText:d,cancelButtonText:_,generateLinkButtonText:p}=function(e){const t=n.useIntl();return{headerMessage:t.formatMessage({id:"FHXjfu",defaultMessage:"{num, plural, one{# item} other{# items}}"},{num:e}),shareText:t.formatMessage({id:"L1WxZI",defaultMessage:"Share a link"}),permissionsText:t.formatMessage({id:"JpIFJJ",defaultMessage:"Anyone with this link can view and download these items"}),cancelButtonText:t.formatMessage({id:"lG6dGA",defaultMessage:"Cancel"}),generateLinkButtonText:t.formatMessage({id:"KPeC3o",defaultMessage:"Copy link"})}}(t),u=e?r():"";return o.React$1.createElement(i.Modal$1,{open:e,isCentered:!0,withCloseButton:"Close",onRequestClose:()=>{s()},className:"share-modal"},o.React$1.createElement(i.Modal$1.Header,{hasBottomSpacing:"title-standard",className:"_share-modal-header_980xj_1"},o.React$1.createElement(i.Modal$1.Title,{className:"_share-modal-header-content_980xj_5"},o.React$1.createElement(i.UIIcon,{src:i.ImageLine,className:"_share-modal-header-icon_980xj_11"})," ",c,o.React$1.createElement(i.Text,{color:"faint",className:"_share-modal-content-size_980xj_15"},u))),o.React$1.createElement(i.Modal$1.Body,{hasVerticalSpacing:!1,className:"_share-modal-body_980xj_19"},o.React$1.createElement(i.Title,null,l),o.React$1.createElement(i.Text,{tagName:"p"},d)),o.React$1.createElement(i.Modal$1.Footer,{className:"share-modal-footer"},o.React$1.createElement(i.Button$1,{variant:"opacity",onClick:()=>{s()}},_),o.React$1.createElement(i.Button$1,{variant:"primary",onClick:()=>{a()}},p)))};Jo.displayName="ShareModal";i.injectInternalStyle("typescript/component_libraries/photos/src/share-snackbar/index.module.out.css",(e=>"._multishare-snackbar_1bgm1_1{margin:0 auto}._multishare-snackbar-container_1bgm1_5{bottom:0;position:absolute;width:100%}"));const Zo=({isCreated:e,isErrored:t,openShareLink:a})=>{const{previewLinkText:s,snackbarMessageText:r}=function(e,t){const o=n.useIntl();let i="";e?i=o.formatMessage({id:"/n3qOR",defaultMessage:"Share link created and copied to clipboard"}):t&&(i=o.formatMessage({id:"fhpAGc",defaultMessage:"Something went wrong..."}));return{previewLinkText:o.formatMessage({id:"WLtCOz",defaultMessage:"Preview link"}),snackbarMessageText:i}}(e,t);return o.React$1.createElement("div",{className:"_multishare-snackbar-container_1bgm1_5"},o.React$1.createElement(i.Snackbar$1,{open:e||t,className:"_multishare-snackbar_1bgm1_1"},e&&o.React$1.createElement(i.UIIcon,{src:i.CheckmarkLine,role:"presentation"}),o.React$1.createElement(i.Snackbar$1.Message,null,r),e&&o.React$1.createElement(i.Snackbar$1.Actions,null,o.React$1.createElement(i.Button$1,{variant:"transparent",inverse:!0,onClick:()=>{a()},withIconLeft:o.React$1.createElement(i.UIIcon,{src:i.OpenLine})},s))))};Zo.displayName="ShareSnackbar";i.injectInternalStyle("typescript/component_libraries/photos/src/loading-snackbar/index.module.out.css",(e=>"._photos-loading-message_1lscd_1{bottom:0;display:flex;justify-content:center;position:absolute;width:100%}._photos-loading-message-text_1lscd_9{font-style:italic}._photos-loading-message_snackbar_1lscd_13{min-width:200px}@media screen and (min-width:768px){._photos-loading-message_snackbar_1lscd_13{min-width:500px}}"));const Qo=({open:e})=>{const t=o.reactExports.useRef(null),{loadingMessage:a}=function(e,t){const[i,a]=o.reactExports.useState(),[s,r]=o.reactExports.useState([]),c=n.useIntl(),l=c.formatMessage({id:"AByeey",defaultMessage:"Connecting to server ..."}),d=c.formatMessage({id:"TDLa3J",defaultMessage:"Gathering all the photos ..."}),_=c.formatMessage({id:"N/7KYe",defaultMessage:"This may take a moment ..."}),p=c.formatMessage({id:"4MTtI9",defaultMessage:"Almost there ..."}),u=[{timeout:2e3,message:l},{timeout:4e3,message:d},{timeout:6e3,message:_},{timeout:8e3,message:p}];return o.reactExports.useEffect((()=>{if(e){const o=u.map((o=>setTimeout((()=>{var i;e&&(null===(i=t.current)||void 0===i||i.animate([{opacity:0},{opacity:1}],300),a(o.message))}),o.timeout)));r(o)}else s.forEach(clearTimeout);return function(){s.forEach(clearTimeout)}}),[e]),{loadingMessage:i}}(e,t);return o.React$1.createElement("div",{className:"_photos-loading-message_1lscd_1","data-testid":"photos-loading-message"},o.React$1.createElement(i.Snackbar$1,{open:e&&!!a,className:"_photos-loading-message_snackbar_1lscd_13"},o.React$1.createElement(i.Snackbar$1.Message,null,o.React$1.createElement("span",{className:"_photos-loading-message-text_1lscd_9",ref:t},a)),o.React$1.createElement(i.Snackbar$1.ProgressBar,null,o.React$1.createElement(i.ProgressBar,{in:e,isIndeterminate:!0}))))};Qo.displayName="LoadingSnackbar";i.injectInternalStyle("metaserver/static/js/photo-editor/plugin/modal.module.out.css",(e=>"._image-editor-modal_14qyj_1{flex:1}"));const ei="_image-editor-modal_14qyj_1",ti=o.reactExports.lazy((()=>d.__awaiter(void 0,void 0,void 0,(function*(){const{RootComponent:t}=yield new Promise((function(t,o){e(["./c_photo-editor_layout_root"],t,o)}));return{default:t}})))),oi=({isOpen:e,file:t,user:a,onExit:s,onImageChanged:r,updatePreviewMetadata:c,onImageEditorReady:l})=>{const d=o.React$1.useMemo((()=>({fileId:t.file_id,size:t.bytes,fqPath:t.fq_path,nsId:t.ns_id,sjId:t.sjid,url:t.href})),[t]),_=o.React$1.useMemo((()=>$.createStore()),[t,a]),p=o.reactExports.useCallback((e=>{P.logImageEditorErrorEvent(e,!1),null==s||s()}),[P.logImageEditorEvent]),u=o.React$1.useMemo((()=>({exit:s,onImageChanged:r,updatePreviewMetadata:c})),[s,r,c]);return o.React$1.createElement(n.Provider,{value:n.intl},o.React$1.createElement(i.ErrorBoundary,{onCatch:p},o.React$1.createElement(i.Modal$1,{open:e,fullScreen:!0,className:ei},o.React$1.createElement(o.reactExports.Suspense,{fallback:o.React$1.createElement($.Loading,null)},o.React$1.createElement(ti,{user:a,file:t,imageFile:d,store:_,pluginApi:u,sharedLinkInfo:void 0,onImageEditorReady:l,integratedEditor:!1})))))};class ii extends o.React$1.Component{constructor(e){super(e),this.user=i.mustGetActiveUser(),this.handleTTI=()=>{this.context.logWebPhotosEvent(et.shownPhotosPage),ii.pageletLogger.componentReady("PhotosTimeline")},this.handleTTIEmptyPhotosPage=()=>{this.context.logWebPhotosEvent(et.shownPhotosPage),this.context.logWebPhotosEvent(et.shownPhotosEmptyState),ii.pageletLogger.componentReady("PhotosTimeline")},this.handleFilterChange=e=>{this.context.logWebPhotosEvent(et.selectPhotoFilter,{filterSelection:e}),this.props.setFilter(e)},this.handleGroupingChange=e=>{this.context.logWebPhotosEvent(et.selectPhotoGroupBy,{groupBySelection:e}),this.props.setGrouping(e)},this.handleGridSizeChange=e=>{this.props.setGridSize(e)},this.handleSelectionChange=e=>{this.context.logWebPhotosEvent(et.selectPhotoThumbnail,{thumbnailSelectCount:`${e.selected.size}`}),this.props.setSelection(e),this.props.setShareLinkStatus($e.None),this.props.setShareLink("")},this.getReadableSelectionSizeText=()=>{const e=this.props.selectedMediaSize;return i.format_bytes(e)},this.generateShareLink=()=>{this.closeModal(),this.context.logWebPhotosEvent(et.selectCopyLinkButton);const e=this.props.selection.selected.toArray();this.props.fetchShareLink(e)},this.openShareLink=()=>{const e=this.props.selection.selected.size;this.context.logWebPhotosEvent(et.selectPreviewLink,{itemCount:`${e}`}),i.open_tab(this.props.shareLink)},this.openModal=()=>{const e=this.props.selection.selected.size;this.context.logWebPhotosEvent(et.selectSharingButton,{itemCount:`${e}`}),this.setState({modalOpen:!0})},this.closeModal=()=>{this.setState({modalOpen:!1})},this.handleFavorite=e=>{this.context.logWebPhotosEvent(this.getFavoriteById(e)?et.unstarPhotoThumbnail:et.starPhotoThumbnail),this.props.toggleFavorite(this.user,e)},this.handleEdit=e=>{const{filteredFiles:t}=this.props,o=t.findEntry((t=>t.file_id===e));if(o&&o.length>1){const e=o[1],t=P.startAndRetrieveTimer({metricName:P.AmpMetrics.TTI_EDITOR,metricTags:{size_bucket:_t($.convertByteToMegabyte(e.bytes)),entry_point:P.EntryPoint.PHOTOS}},!1);this.setState({imageEditorModalOpen:!0,imageToEdit:e,imageEditorTimeStart:Date.now(),imageEditorTTItimer:t}),P.logAmpMetric({metricName:P.AmpMetrics.OPEN_EDITOR,metricTags:{entry_point:P.EntryPoint.PHOTOS}},!1)}},this.onImageEditorReady=()=>{this.state.imageEditorTimeStart&&(P.logImageEditorEvent(P.ImageEditorEvent.selectEdit,!1,{loadingTime:(Date.now()-this.state.imageEditorTimeStart).toString(10),entryPoint:P.EntryPoint.PHOTOS}),this.setState({imageEditorTimeStart:void 0})),this.state.imageEditorTTItimer&&(P.stopTimer(this.state.imageEditorTTItimer),this.setState({imageEditorTTItimer:void 0}))},this.onImageEditorChanged=(e,t)=>{t&&this.props.updateFile(t)},this.onImageEditorExit=()=>this.setState({imageEditorModalOpen:!1,imageToEdit:void 0}),this.isEditableFn=e=>this.isEditable(e),this.handlePreview=e=>{this.context.logWebPhotosEvent(et.openPhotoPreview);const{filteredFiles:t,items:o}=this.props,a=t.findIndex((t=>t.file_id===e)),n=t.toArray(),s=o.get(a);this.setState({fileViewerCurrentIndex:a}),l.asyncOpenPreview({disableHydrateStore:!0,containerId:je,files:n,indexOfPreviewFile:a,user:this.user,updateBrowserLocation:!1,onCloseViewer:()=>{var e;s&&(null===(e=this.photoTileGridRef.current)||void 0===e||e.scrollToItem(Object.assign(Object.assign({},s),{index:a}),((e,t)=>e.file_obj_id===t.file_obj_id)))},onFlipNext:()=>{this.setState({fileViewerCurrentIndex:this.state.fileViewerCurrentIndex+1>=n.length?0:this.state.fileViewerCurrentIndex+1})},onFlipPrevious:()=>{this.setState({fileViewerCurrentIndex:this.state.fileViewerCurrentIndex-1<0?n.length-1:this.state.fileViewerCurrentIndex-1})},fileViewOrigin:i.FileViewOriginType.PHOTOS})},this.overFlowActionHandler=(e,t)=>{var o;zt(e,this.props.context,i.immutableExports.List([i.File.fromApiV2Object(null===(o=t.metadata)||void 0===o?void 0:o.extra_file_metadata)]),this.props.user,this.props.blockHash,this.props.toggleFavorite,this.props.removeItems,this.handleEdit)},this.onGridItemsRenderedThrottled=a.throttle((e=>{const{overscanStartItem:t,overscanStopItem:o}=e;if(this.props.filteredFiles.size>0&&void 0!==t&&void 0!==o){const e=t.index,i=o.index;this.props.prewarmPreviewInfo(this.props.filteredFiles.toArray().slice(e,i+1),this.user)}}),200),this.onGridItemsRendered=(e,t)=>{this.onGridItemsRenderedThrottled(e);const o=Date.now()-t;g.getMetricsReporter().createStats({ns:"web_photos",name:"render_photo_thumbnails"}).recordDuration(o,f.TimeUnit.MILLISECONDS)},this.renderTitle=e=>o.React$1.createElement("div",{className:"photos-header"},o.React$1.createElement("div",{className:"photos-title"},o.React$1.createElement(p.MaestroHeaderTitle,null,n.intl.formatMessage({id:"yLLoZO",defaultMessage:"Photos"}))),o.React$1.createElement("div",{className:"photos-selection-view-container"},o.React$1.createElement(c.SelectionIndicator,{responsive:e,selectedFilesCount:this.props.selection.selected.size,rightRailCollapsed:!0,isInFamilyFolder:!1}))),this.renderAppContent=e=>{const{blockHash:t,items:a,sections:n,filter:r,grouping:c,gridSize:l,selection:d,visibleTopSectionIndex:_,shareLinkStatus:p,showLoadingState:u}=this.props,h=this.props.selection.selected.count();let m;return m=this.props.allFiles.count()||u?o.React$1.createElement(o.React$1.Fragment,null,this.state.imageToEdit&&o.React$1.createElement(oi,{isOpen:this.state.imageEditorModalOpen,file:this.state.imageToEdit,user:this.user,onExit:this.onImageEditorExit,onImageChanged:this.onImageEditorChanged,onImageEditorReady:this.onImageEditorReady}),o.React$1.createElement(Jo,{modalOpen:this.state.modalOpen,numSelectedItems:h,generateShareLink:this.generateShareLink,closeModal:this.closeModal,calculateReadableSelectionSize:this.getReadableSelectionSizeText}),o.React$1.createElement(io,{blockHash:t,openShareLinkModal:this.openModal,openPhotoEditorModal:this.handleEdit,isFavorite:e=>!!this.getFavoriteById(e),isEditable:this.isEditableFn,isCollectionsInPhotosEnabled:this.props.isCollectionsInPhotosEnabled,isBackupFile:e=>!!this.isBackupFile(e)}),o.React$1.createElement(Ve,{filter:r,grouping:c,gridSize:l,onFilterChange:this.handleFilterChange,onGroupingChange:this.handleGroupingChange,onSizeChange:this.handleGridSizeChange,compact:!e.isMatchedLarge}),o.React$1.createElement(Ko,{key:"photo-tile-grid",items:a,isFavorite:e=>!!this.getFavoriteById(e),isEditable:this.isEditableFn,isBackupFile:e=>!!this.isBackupFile(e),sections:n,gridSize:l,grouping:c,onTTI:this.handleTTI,selection:d,onSelectionChange:this.handleSelectionChange,handlePreview:this.handlePreview,visibleTopSectionIndex:_,onVisibleTopSectionIndexChange:e=>this.props.setVisibleTopSectionIndex(e),handleFavorite:this.handleFavorite,overFlowActions:(e,t,o)=>Xt(e,t,this.props.isCollectionsInPhotosEnabled,o),overFlowActionHandler:this.overFlowActionHandler,isLoading:u,onGridItemsRendered:this.onGridItemsRendered,photoTileGridRef:this.photoTileGridRef}),o.React$1.createElement(Zo,{isCreated:p===$e.Created,isErrored:p===$e.Errored,openShareLink:this.openShareLink}),o.React$1.createElement(Qo,{open:this.props.showLoadingState})):o.React$1.createElement(Pe,{link:i.get_browse_root(this.user),onTTI:this.handleTTIEmptyPhotosPage}),o.React$1.createElement(s.RegisterComponentWithBugReporter,{componentId:"web.photos",componentName:"Photos"},o.React$1.createElement("div",{className:"photos-timeline"},m))},this.state={modalOpen:!1,imageEditorModalOpen:!1,fileViewerCurrentIndex:0},this.photoTileGridRef=o.React$1.createRef()}componentDidMount(){this.mountFileViewerTarget(),i.log_js_modules_application_code_start(),this.props.setUser(this.user),this.props.loadItems({context:this.context}),new Promise((function(t,o){e(["./c_ui_preview_crop_and_rotate_crop_rotate_exports"],t,o)})).then((function(e){return e.crop_rotate_exports_esnext})).then((({getStoreForCropRotateInPreview:t,getUpdatedFile:o})=>{const i=t();this.cropRotateStoreUnsubscribe=i.subscribe((()=>{const t=o(i.getState());t&&this.state.updatedFileCropRotateRevisionId!==t.revision_id&&(this.setState({updatedFileCropRotateRevisionId:t.revision_id}),this.props.updateFile(t),new Promise((function(t,o){e(["./c_file_viewer_controller"],t,o)})).then((e=>{const t=this.props.filteredFiles.toArray();e.updateProps({file:t[this.state.fileViewerCurrentIndex],files:t})})))}))}))}componentDidUpdate(e){this.props.allFiles.size!==e.allFiles.size&&this.props.loadFavorites(this.props.allFiles.toArray().map(i.idTypePairFromStarrableItem)).then((()=>{this.props.setFilter(this.props.filter)}))}componentWillUnmount(){var e;this.unmountFileViewerTarget(),null===(e=this.cropRotateStoreUnsubscribe)||void 0===e||e.call(this)}mountFileViewerTarget(){let e=document.getElementById(je);e||(e=document.createElement("div"),e.id=je,document.body.prepend(e))}unmountFileViewerTarget(){new Promise((function(t,o){e(["./c_file_viewer_controller"],t,o)})).then((e=>{e.isShown()&&e.close()}))}getFavoriteById(e){return this.props.favorites[e]}isEditable(e){const t=this.props.allFiles.get(e);return!t||-1!==M.imageTypeAllowed.indexOf(j.getExtension(t))}isBackupFile(e){const t=this.props.allFiles.get(e);return t&&t.is_in_backup_folder}render(){return o.React$1.createElement(n.Provider,{value:n.intl},o.React$1.createElement(_.ChromeWrapper,{user:i.mustGetActiveUser(),titleRegion:this.renderTitle,searchBarProps:{searchVariant:"full-page"},embeddedAppRegion:this.renderAppContent,chromeClass:i.cx("dig2--enabled","photos-grid-chrome"),useMaestroPortal:!0}))}}ii.pageletLogger=new r.PageletLogger("photos_page",["PhotosTimeline"]),ii.contextType=Zt,ii.displayName="UnconnectedPhotosTimeline";const ai=i.connect((e=>({items:ut(e),allFiles:wt(e),sections:ht(e),filter:mt(e),grouping:gt(e),gridSize:ft(e),selection:bt(e),visibleTopSectionIndex:vt(e),user:Tt(e),filteredFiles:It(e),favorites:i.getStarredBoolObject(e),context:yt(e),shareLink:Et(e),shareLinkStatus:St(e),selectedMediaSize:At(e),showLoadingState:kt(e)})),{loadItems:function e({cursor:t,startTimestamp:o,count:a,context:n}){return(s,r)=>d.__awaiter(this,void 0,void 0,(function*(){const c=i.mustGetActiveUserId(),l=new i.UserApiV2Client;o||(o=Date.now());let d=a||0;s(Lt({apiName:De.DELTA,state:Fe.FETCH})),l.ns("photos").rpc("delta",{cursor:t,get_extra_file_metadata:!0,include_thumbnail_url:!0},{subjectUserId:c}).then((t=>{if(t.entries&&t.entries.length){const e=i.getStarredBoolObject(r());s({type:ze.LOAD_ITEMS_ACTION,payload:{items:t.entries,clearExistingData:0===d,favorites:e}}),d+=t.entries.length}s(Lt({apiName:De.DELTA,state:Fe.SUCCESS,hasMoreData:t.has_more})),t.has_more?s(e({cursor:t.cursor,startTimestamp:o,count:d,context:n})):(o&&function(e){const t=g.getMetricsReporter().createStats({ns:ct,name:e.ampMetrics},e.ampTags);e.ampDurationInMilliseconds?t.recordDuration(e.ampDurationInMilliseconds,f.TimeUnit.MILLISECONDS):t.record(1)}({ampMetrics:lt.AMP_PHOTOS_LOAD_ITEMS_LATENCY,ampTags:{size_bucket:_t(d)},ampDurationInMilliseconds:Date.now()-o}),n&&n.logWebPhotosEvent(et.deltaReturnedItems,{itemCount:`${d}`}))})).catch((e=>{s(Lt({apiName:De.DELTA,state:Fe.ERROR,error:e})),u.reportException({err:e,severity:v.SEVERITY.NON_CRITICAL,tags:[Me]})}))}))},loadFavorites:i.fetchMissingStarredStatuses,removeItems:Ct,setFilter:Nt,setGrouping:function(e){return{type:ze.SET_GROUPING_ACTION,payload:{grouping:e}}},setGridSize:function(e){return{type:ze.SET_GRID_SIZE_ACTION,payload:{gridSize:e}}},setSelection:function(e){return{type:ze.SET_SELECTION_ACTION,payload:{selection:e}}},setVisibleTopSectionIndex:function(e){return{type:ze.SET_VISIBLE_TOP_SECTION_INDEX_ACTION,payload:{index:e}}},setUser:function(e){return{type:ze.SET_USER_ACTION,payload:{user:e}}},toggleFavorite:Ot,fetchShareLink:function(e){return(t,o)=>d.__awaiter(this,void 0,void 0,(function*(){t({type:ze.SET_SHARE_LINK_STATUS_ACTION,payload:{shareLinkStatus:$e.Loading}}),t(Lt({apiName:De.SHARE,state:Fe.FETCH}));const o=i.mustGetActiveUserId();(new i.UserApiV2Client).ns("photos").rpc("share",{file_ids:e},{subjectUserId:o}).then((e=>{t(Lt({apiName:De.SHARE,state:Fe.SUCCESS})),e.share_link&&(t(Pt(e.share_link)),t(Mt($e.Created)),navigator.clipboard.writeText(e.share_link))})).catch((e=>{t(Mt($e.Errored)),t(Lt({apiName:De.SHARE,state:Fe.ERROR,error:e})),u.reportException({err:e,severity:v.SEVERITY.NON_CRITICAL,tags:[Me]})}))}))},setShareLink:Pt,setShareLinkStatus:Mt,prewarmPreviewInfo:function(t,o){return(a,n)=>d.__awaiter(this,void 0,void 0,(function*(){const s=n()[i.PHOTOS_TIMELINE_NAMESPACE_KEY],r=(null==s?void 0:s.prewarmedPreviewData)||{},c=t.filter((e=>void 0===r[e.file_id]));(yield new Promise((function(t,o){e(["./c_file_viewer_controller"],t,o)}))).prewarmPreviewData(c,o),a({type:ze.SET_PREWARM_PREVIEW_DATA,payload:{files:c}})}))},updateFile:function(e){return(t,o)=>d.__awaiter(this,void 0,void 0,(function*(){const a=i.getStarredBoolObject(o());t({type:ze.UPDATE_FILE,payload:{file:e},favorites:a})}))}})(ii),ni=i.requireCssWithComponent(ai,["/static/metaserver/static/css/photos/photos-vflkbp1Ws.css"]);i.getStoreForStarred();const si={[Be.DAYS]:1,[Be.MONTHS]:2,[Be.YEARS]:3},ri={items:i.immutableExports.List(),filteredItems:i.immutableExports.List(),sections:{sectionLabels:[],sectionStartIndices:[]},filter:He.ALL,grouping:Be.MONTHS,gridSize:Ge.MEDIUM,selection:i.createSelection(),visibleTopSectionIndex:0,context:new i.BrowseContext,shareLink:"",shareLinkStatus:$e.None,favoritesLoaded:!1,apiStatus:{[De.DELTA]:{state:Fe.DEFAULT,pagesLoaded:0},[De.SHARE]:{state:Fe.DEFAULT,pagesLoaded:0}},prewarmedPreviewData:{}},ci=(e,t,o)=>{const i=[],a=[];let n;return e.forEach(((e,s)=>{var r;const c=null===(r=e.metadata)||void 0===r?void 0:r.media_metadata;if(c){const e=new Date(c.date_taken||c.date_created);a.length&&li(t,e,a[a.length-1])||(a.push(e),i.push(s),void 0===n&&o&&li(t,e,o)&&(n=a.length-1))}})),{sections:{sectionLabels:a,sectionStartIndices:i},visibleTopSectionIndex:null!=n?n:0}},li=(e,t,o)=>{switch(e){case Be.YEARS:return t.getFullYear()===o.getFullYear();case Be.MONTHS:return t.getFullYear()===o.getFullYear()&&t.getMonth()===o.getMonth();case Be.DAYS:return t.getFullYear()===o.getFullYear()&&t.getMonth()===o.getMonth()&&t.getDate()===o.getDate();default:i.throwEnforceExhaustive()}},di=(e,t,o)=>{if(o===He.ALL)return e;const a=e.filter((e=>{var i,a,n;const s=null!==(n=null===(a=null===(i=e.metadata)||void 0===i?void 0:i.media_metadata.media_type)||void 0===a?void 0:a[".tag"])&&void 0!==n?n:"other";switch(o){case He.PHOTOS:return"photo"===s;case He.VIDEOS:return"video"===s;case He.STARRED:return!!e.file_obj_id&&t[e.file_obj_id];default:return!0}}));return i.immutableExports.List(a)},_i=(e,{payload:{grouping:t}})=>{const o=((e,t,o)=>{const i=si[t]-si[o];return Math.min(Math.max(e+i,Ge.EXTRA_SMALL),Ge.EXTRA_LARGE)})(e.gridSize,e.grouping,t),i=e.sections.sectionLabels&&e.sections.sectionLabels[e.visibleTopSectionIndex],{sections:a,visibleTopSectionIndex:n}=ci(e.filteredItems,t,i);return Object.assign(Object.assign({},e),{sections:a,grouping:t,gridSize:o,visibleTopSectionIndex:n})},pi=(e,t,o)=>{const i=di(e.items,o,t),a=e.sections.sectionLabels&&e.sections.sectionLabels[e.visibleTopSectionIndex],{sections:n,visibleTopSectionIndex:s}=ci(i,e.grouping,a);return Object.assign(Object.assign({},e),{filteredItems:i,sections:n,filter:t,visibleTopSectionIndex:s})};function ui(e=ri,t){switch(t.type){case ze.LOAD_ITEMS_ACTION:return((e,{payload:{items:t,clearExistingData:o,favorites:a}})=>{const n=(o?i.immutableExports.List(t):e.items.concat(t)).sort(((e,t)=>{var o,i,a,n;const s=(null===(o=e.metadata)||void 0===o?void 0:o.media_metadata.date_taken)||(null===(i=e.metadata)||void 0===i?void 0:i.media_metadata.date_created)||"";return((null===(a=t.metadata)||void 0===a?void 0:a.media_metadata.date_taken)||(null===(n=t.metadata)||void 0===n?void 0:n.media_metadata.date_created)||"").localeCompare(s)})),s=di(n,a,e.filter),r=e.sections.sectionLabels&&e.sections.sectionLabels[e.visibleTopSectionIndex],{sections:c,visibleTopSectionIndex:l}=ci(s,e.grouping,r);return Object.assign(Object.assign({},e),{items:n,filteredItems:s,sections:c,visibleTopSectionIndex:l})})(e,t);case ze.SET_GROUPING_ACTION:return _i(e,t);case ze.SET_GRID_SIZE_ACTION:return((e,{payload:{gridSize:t}})=>Object.assign(Object.assign({},e),{gridSize:t}))(e,t);case ze.SET_SELECTION_ACTION:return((e,{payload:{selection:t}})=>Object.assign(Object.assign({},e),{selection:t}))(e,t);case ze.SET_FILTER_ACTION:return pi(e,t.payload.filter,t.payload.favorites);case ze.SET_VISIBLE_TOP_SECTION_INDEX_ACTION:return Object.assign(Object.assign({},e),{visibleTopSectionIndex:t.payload.index});case ze.SET_USER_ACTION:return((e,{payload:{user:t}})=>Object.assign(Object.assign({},e),{user:t}))(e,t);case ze.REMOVE_ITEMS_ACTION:return((e,{payload:{fileIds:t,favorites:o}})=>{const i=e.items.filter((e=>!t.includes(e.file_obj_id))),a=e.selection.update("selected",(e=>e.subtract(t))),n=Object.assign(Object.assign({},e),{items:i,selection:a});return pi(n,e.filter,o)})(e,t);case ze.SET_SHARE_LINK_ACTION:return((e,{payload:{shareLink:t}})=>Object.assign(Object.assign({},e),{shareLink:t}))(e,t);case ze.SET_SHARE_LINK_STATUS_ACTION:return((e,{payload:{shareLinkStatus:t}})=>Object.assign(Object.assign({},e),{shareLinkStatus:t}))(e,t);case ze.UPDATE_FAVORITES_ACTION:return((e,{payload:{}})=>Object.assign(Object.assign({},e),{favoritesLoaded:!0}))(e,t);case ze.UPDATE_FILE:return((e,{payload:{file:t,favorites:o}})=>{if(!t.preview||!t.preview.content||"image"!==t.preview.content[".tag"])return e;const i=t.preview.content.thumbnail_url_tmpl,a=e.items.map((e=>{var o,a;return e.file_obj_id===t.file_id&&e.metadata?Object.assign(Object.assign({},e),{metadata:Object.assign(Object.assign({},e.metadata),{extra_file_metadata:Object.assign(Object.assign({},null===(o=e.metadata)||void 0===o?void 0:o.extra_file_metadata),{sjid:t.sjid}),media_metadata:Object.assign(Object.assign({},null===(a=e.metadata)||void 0===a?void 0:a.media_metadata),{thumbnail:i})})}):e})),n=di(a,o,e.filter),s=e.sections.sectionLabels&&e.sections.sectionLabels[e.visibleTopSectionIndex],{sections:r,visibleTopSectionIndex:c}=ci(n,e.grouping,s);return Object.assign(Object.assign({},e),{items:a,filteredItems:n,sections:r,visibleTopSectionIndex:c})})(e,t);case ze.SET_API_STATE:return((e,{payload:{apiStatus:t,apiName:o}})=>{const i=e.apiStatus[o].pagesLoaded;return Object.assign(Object.assign({},e),{apiStatus:Object.assign(Object.assign({},e.apiStatus),{[o]:Object.assign(Object.assign(Object.assign({},e.apiStatus[o]),t),{pagesLoaded:t.state===Fe.SUCCESS?i+1:i})})})})(e,t);case ze.SET_PREWARM_PREVIEW_DATA:return((e,{payload:{files:t}})=>{const o=t.reduce(((e,t)=>(e[t.file_id]=!0,e)),{});return Object.assign(Object.assign({},e),{prewarmedPreviewData:Object.assign(Object.assign({},e.prewarmedPreviewData),o)})})(e,t);default:return e}}let hi;class mi extends f.Message{constructor(e){super(),this.blockHash="",this.isCollectionsInPhotosEnabled=!1,f.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new mi).fromBinary(e,t)}static fromJson(e,t){return(new mi).fromJson(e,t)}static fromJsonString(e,t){return(new mi).fromJsonString(e,t)}static equals(e,t){return f.proto3.util.equals(mi,e,t)}}mi.runtime=f.proto3,mi.typeName="photos_web.PhotosTimelinePageProps",mi.fields=f.proto3.util.newFieldList((()=>[{no:2,name:"block_hash",kind:"scalar",T:9},{no:4,name:"webTimingLoggerServerContext",kind:"message",T:i.WebTimingLoggerServerContext},{no:5,name:"is_collections_in_photos_enabled",kind:"scalar",T:8}]));class gi extends f.Message{constructor(e){super(),this.title="",this.takedownRequestType=0,this.linkKey="",this.secureHash="",this.sharedLinkInfo="",this.shareToken="",this.sharePermission="",f.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new gi).fromBinary(e,t)}static fromJson(e,t){return(new gi).fromJson(e,t)}static fromJsonString(e,t){return(new gi).fromJsonString(e,t)}static equals(e,t){return f.proto3.util.equals(gi,e,t)}}gi.runtime=f.proto3,gi.typeName="photos_web.SharedPhotosPageProps",gi.fields=f.proto3.util.newFieldList((()=>[{no:1,name:"webTimingLoggerServerContext",kind:"message",T:i.WebTimingLoggerServerContext},{no:2,name:"title",kind:"scalar",T:9},{no:3,name:"takedownRequestType",kind:"scalar",T:13},{no:4,name:"link_key",kind:"scalar",T:9},{no:5,name:"secure_hash",kind:"scalar",T:9},{no:6,name:"shared_link_info",kind:"scalar",T:9},{no:7,name:"share_token",kind:"scalar",T:9},{no:8,name:"share_permission",kind:"scalar",T:9},{no:9,name:"encryption_options",kind:"message",T:i.EncryptionOptions}]));class fi extends f.Message{constructor(e){super(),f.proto3.util.initPartial(e,this)}static fromBinary(e,t){return(new fi).fromBinary(e,t)}static fromJson(e,t){return(new fi).fromJson(e,t)}static fromJsonString(e,t){return(new fi).fromJsonString(e,t)}static equals(e,t){return f.proto3.util.equals(fi,e,t)}}fi.runtime=f.proto3,fi.typeName="edison_photos_web.PhotosPrefetchData",fi.fields=f.proto3.util.newFieldList((()=>[{no:1,name:"props",kind:"message",T:mi}]));const bi=(hi||(hi=i.getStoreAndRegisterReducers({[i.PHOTOS_TIMELINE_NAMESPACE_KEY]:ui})),hi);class vi extends o.React$1.Component{render(){return o.React$1.createElement(i.StandardMaestroPage,null,o.React$1.createElement(Ei,null))}}vi.displayName="Photos";class Ei extends o.React$1.Component{constructor(e){super(e),this.state={},function(){return d.__awaiter(this,void 0,void 0,(function*(){const e=yield o.Edison.fetch("photos_web.PhotosWebEdisonPrefetchService","PhotosPrefetch");return o.unmarshalProto(e,fi)}))}().then((e=>{const t=e.props;t&&this.setState({props:t})}))}render(){return o.React$1.createElement(i.Provider,{store:bi},o.React$1.createElement(Qt,{value:{logWebPhotosEvent:nt}},this.state.props&&o.React$1.createElement(ni,Object.assign({},this.state.props))))}}Ei.displayName="PhotosPrefetcher";const Si=["/static/metaserver/static/css/main-vflRpIqNQ.css","/static/metaserver/static/css/dig-components/index.web-vflGcQt8W.css"],Ti=i.requireCssWithComponent(vi,Si),yi=i.requireCssWithComponent(Ei,Si);t.Photos=vi,t.PhotosComponent=yi,t.PhotosPrefetcher=Ei,t.RootComponent=Ti}));
//# sourceMappingURL=c_ui_page_photos_web.js-vflssYR7s.map
