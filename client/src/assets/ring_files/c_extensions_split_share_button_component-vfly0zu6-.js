define(["require","exports","./c_tslib","./e_ui_page_files_router","./c_lodash-es_lodash","./e_edison","./c_src_sink_index","./c_core_i18n","./c_mjs_hero_workshop-tools","./c_components_chooser_default_chooser","./c_docsend_src_utils","./c_hooks_lib_index","./c_form_row_index","./e_core_exception","./c_integrations_data_selectors","./c_extensions_extensions_utils","./c_extensions_cloud_docs_compat","./c_profile_services_profile_services_link","./c_profile_services_profile_services_constants","./c_src_instrumentation_common_context","./c_src_instrumentation_constants","./c_loggers_device_type","./c_history","./c_core_browser_detection","./c_file_transfers_lib_utils","./c_file_transfers_async_browse_entry_point_onboarding_modal_async","./c_onboarding_checklist_async_share_button_tooltip","./c_browse_tts","./c_campaigns_campaigns_element_id_enum","./c_docsend_analytics_add_on_helpers_modals","./c_collections_utils_file_identifier","./c_pap-events_previews_select_share_menu","./c_sharing_upsells_util","./c_publish_publish_modal","./c_pap-events_publish_modal_shown_publish_entrypoint","./c_pap-events_publish_modal_select_publish_entrypoint"],(function(e,t,n,a,r,o,s,i,l,c,d,u,p,m,h,_,g,f,v,b,y,E,S,A,x,w,O,R,M,k,C,T,$,D,I,F){"use strict";const N=e=>{a.logEvent(e)},P=e=>({class:"docsend",action:"click",object:"docsend_hub_entry_button",properties:{docsendHubEntryButtonTarget:e}}),L={};function V(e){return void 0===L[e]?(L[e]=a.getUserMetadata(["DOCSEND_ADDON_SHARING_DO_NOT_SHOW_WELCOME_MODAL"],e).then((e=>!!e.DOCSEND_ADDON_SHARING_DO_NOT_SHOW_WELCOME_MODAL)),L[e]):L[e]}a.injectInternalStyle("typescript/component_libraries/docsend/src/components/sharing/welcome_modal.module.out.css",(e=>"._hero_1c7lx_1{background-color:var(--color__core__secondary)}._dontShowAgainCheckbox_1c7lx_5{display:flex;margin-left:0;margin-right:auto}._dontShowAgainCheckbox_1c7lx_5>*+*{margin-left:var(--spacing__base_unit)}"));const B="_hero_1c7lx_1",U="_dontShowAgainCheckbox_1c7lx_5",j=({isOpen:e,closeModal:t,onSubmit:n})=>{const r=i.useIntl(),[s,c]=o.reactExports.useState(!1);return o.React$1.createElement(o.React$1.Fragment,null,o.React$1.createElement(a.Modal$1,{open:e,isCentered:!0,withCloseButton:r.formatMessage({id:"vawEMm",defaultMessage:"Close"}),"aria-labelledby":"welcome-modal-title",onRequestClose:t},o.React$1.createElement("div",{className:B},o.React$1.createElement(l.ShareHero,{aspectRatio:"16:9"})),o.React$1.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},o.React$1.createElement(a.Modal$1.Title,{id:"welcome-modal-title"},o.React$1.createElement(i.FormattedMessage,{id:"/kM+cl",defaultMessage:"Send a copy of this file with advanced tracking"}))),o.React$1.createElement(a.Modal$1.Body,null,o.React$1.createElement(i.FormattedMessage,{id:"1ZZUut",defaultMessage:"Securely share this file and track real-time engagement metrics to help refine your content."})),o.React$1.createElement(a.Modal$1.Footer,null,o.React$1.createElement("div",{className:U},o.React$1.createElement(a.Checkbox,{id:"welcome_modal-dontshowagain",onChange:e=>c(e.currentTarget.checked)}),o.React$1.createElement(a.Text,{tagName:"label",htmlFor:"welcome_modal-dontshowagain"},o.React$1.createElement(i.FormattedMessage,{id:"TeQ39/",defaultMessage:"Don’t show again"}))),o.React$1.createElement(a.Button$1,{variant:"opacity",onClick:t},o.React$1.createElement(i.FormattedMessage,{id:"uZz9YD",defaultMessage:"Cancel"})),o.React$1.createElement(a.Button$1,{variant:"primary",onClick:()=>n({dontShowAgain:s})},o.React$1.createElement(i.FormattedMessage,{id:"WoOMK6",defaultMessage:"Send a copy"})))))};var H;j.displayName="WelcomeModal",function(e){e.SAVE_PROGRESS="save_progress"}(H||(H={})),o.React$1.createContext(null);const W={Sidebar:c.Sidebar,Header:c.Header,Search:c.Search,ViewToggleMenu:c.ViewToggleMenu,ActionsMenu:c.ActionsMenu,FileView:c.FileView,Footer:c.Footer,Container:c.ChooserContainer};a.injectInternalStyle("typescript/component_libraries/docsend/src/components/dropbox_chooser/dropbox_chooser.module.out.css",(e=>"._dropins-chooser-modal_132vk_1{display:flex;flex-direction:column}._dropzone-container_132vk_6{margin-top:var(--spacing__unit--3)}._dropins-chooser-modal-footer_132vk_10{padding-top:0}._dropbox-chooser-container_132vk_14{display:flex;flex-grow:1;height:500px}._dropins-chooser-copy-chooser_132vk_20{display:flex;flex-direction:column;flex-grow:1}"));const z="_dropins-chooser-modal_132vk_1",q="_dropzone-container_132vk_6",G="_dropins-chooser-modal-footer_132vk_10",Y="_dropbox-chooser-container_132vk_14",X="_dropins-chooser-copy-chooser_132vk_20";function Z(e){const{allowVideo:t,onAfterClose:n,onCopyFile:r,onClose:s,isOpen:l,isCopying:c,logModalButtonSelectEvent:u,errorBanner:p,userHasLinks:m=!1}=e,h=i.useIntl();return o.React$1.createElement(a.Modal$1,{open:l,onAfterOpen:()=>u("copy_file"),isCentered:!0,shouldCloseOnOverlayClick:!1,withCloseButton:"Close",onAfterClose:n,onRequestClose:s,"aria-labelledby":"dropbox-chooser-modal-title"},o.React$1.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},o.React$1.createElement(a.Modal$1.Title,{id:"dropbox-chooser-modal-title","data-testid":"DropboxChooserModal_Title"},c?o.React$1.createElement(i.FormattedMessage,{id:"tCgmet",defaultMessage:"Creating a copy of this file …"}):o.React$1.createElement(i.FormattedMessage,{id:"xecksd",defaultMessage:"Create a copy"}))),o.React$1.createElement(a.Modal$1.Body,{className:z},e.isCopying?o.React$1.createElement("div",{className:q},o.React$1.createElement("div",{className:"dig-Dropzone-container"},o.React$1.createElement("div",{className:"dig-Dropzone-wrapper"},o.React$1.createElement("div",{className:"dig-Dropzone-progress-bar"},o.React$1.createElement(a.ProgressBar,{isIndeterminate:!0,in:!0})),o.React$1.createElement("span",{className:"dig-Text dig-Text--variant-paragraph dig-Text--size-standard dig-Text--color-standard"},h.formatMessage({id:"bxJzuw",defaultMessage:"Copying …"}))))):o.React$1.createElement(o.React$1.Fragment,null,p,m?o.React$1.createElement(i.FormattedMessage,{id:"N1Vwa0",defaultMessage:"When you copy a Dropbox file, changes made to the original won’t affect your shared file."}):o.React$1.createElement(i.FormattedMessage,{id:"1RJ9m4",defaultMessage:"When you create a copy of a Dropbox file, changes made to the original won’t be reflected in the new version."}),o.React$1.createElement(W.Container,{auth:e.auth,onSubmit:r,onCancel:s,extensions:t?d.ACCEPTED_EXTENSIONS:d.CLASSIC_EXTENSIONS,fileSelect:!0,folderSelect:!1,multiSelect:!1,className:Y},o.React$1.createElement("div",{className:X},o.React$1.createElement(W.Search,null),o.React$1.createElement(W.ActionsMenu,{showTabs:!1}),o.React$1.createElement(W.FileView,null),o.React$1.createElement(W.Footer,{submitText:h.formatMessage({id:"BN9N67",defaultMessage:"Create copy"})}))))),o.React$1.createElement(a.Modal$1.Footer,{className:G}))}var K=e=>"checkbox"===e.type,J=e=>e instanceof Date,Q=e=>null==e;const ee=e=>"object"==typeof e;var te=e=>!Q(e)&&!Array.isArray(e)&&ee(e)&&!J(e),ne=e=>te(e)&&e.target?K(e.target)?e.target.checked:e.target.value:e,ae=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),re=e=>Array.isArray(e)?e.filter(Boolean):[],oe=e=>void 0===e,se=(e,t,n)=>{if(!t||!te(e))return n;const a=re(t.split(/[,[\].]+?/)).reduce(((e,t)=>Q(e)?e:e[t]),e);return oe(a)||a===e?oe(e[t])?n:e[t]:a};const ie={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},le={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ce="max",de="min",ue="maxLength",pe="minLength",me="pattern",he="required",_e="validate",ge=o.React$1.createContext(null),fe=()=>o.React$1.useContext(ge);var ve=(e,t,n,a=!0)=>{const r={};for(const o in e)Object.defineProperty(r,o,{get:()=>{const r=o;return t[r]!==le.all&&(t[r]=!a||le.all),n&&(n[r]=!0),e[r]}});return r},be=e=>te(e)&&!Object.keys(e).length,ye=(e,t,n)=>{const{name:a,...r}=e;return be(r)||Object.keys(r).length>=Object.keys(t).length||Object.keys(r).find((e=>t[e]===(!n||le.all)))},Ee=e=>Array.isArray(e)?e:[e],Se=(e,t,n)=>n&&t?e===t:!e||!t||e===t||Ee(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function Ae(e){const t=o.React$1.useRef(e);t.current=e,o.React$1.useEffect((()=>{const n=!e.disabled&&t.current.subject.subscribe({next:t.current.callback});return()=>(e=>{e&&e.unsubscribe()})(n)}),[e.disabled])}var xe=e=>"string"==typeof e,we=(e,t,n,a)=>{const r=Array.isArray(e);return xe(e)?(a&&t.watch.add(e),se(n,e)):r?e.map((e=>(a&&t.watch.add(e),se(n,e)))):(a&&(t.watchAll=!0),n)},Oe=e=>"function"==typeof e,Re=e=>{for(const t in e)if(Oe(e[t]))return!0;return!1};function Me(e){const t=fe(),{name:n,control:a=t.control,shouldUnregister:r}=e,s=ae(a._names.array,n),i=function(e){const t=fe(),{control:n=t.control,name:a,defaultValue:r,disabled:s,exact:i}=e||{},l=o.React$1.useRef(a);l.current=a;const c=o.React$1.useCallback((e=>{if(Se(l.current,e.name,i)){const t=we(l.current,n._names,e.values||n._formValues);u(oe(l.current)||te(t)&&!Re(t)?{...t}:Array.isArray(t)?[...t]:oe(t)?r:t)}}),[n,i,r]);Ae({disabled:s,subject:n._subjects.watch,callback:c});const[d,u]=o.React$1.useState(oe(r)?n._getWatch(a):r);return o.React$1.useEffect((()=>{n._removeUnmounted()})),d}({control:a,name:n,defaultValue:se(a._formValues,n,se(a._defaultValues,n,e.defaultValue)),exact:!0}),l=function(e){const t=fe(),{control:n=t.control,disabled:a,name:r,exact:s}=e||{},[i,l]=o.React$1.useState(n._formState),c=o.React$1.useRef({isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=o.React$1.useRef(r),u=o.React$1.useRef(!0);return d.current=r,Ae({disabled:a,callback:o.React$1.useCallback((e=>u.current&&Se(d.current,e.name,s)&&ye(e,c.current)&&l({...n._formState,...e})),[n,s]),subject:n._subjects.state}),o.React$1.useEffect((()=>(u.current=!0,()=>{u.current=!1})),[]),ve(i,n._proxyFormState,c.current,!1)}({control:a,name:n}),c=o.React$1.useRef(a.register(n,{...e.rules,value:i}));return o.React$1.useEffect((()=>{const e=(e,t)=>{const n=se(a._fields,e);n&&(n._f.mount=t)};return e(n,!0),()=>{const t=a._options.shouldUnregister||r;(s?t&&!a._stateFlags.action:t)?a.unregister(n):e(n,!1)}}),[n,a,s,r]),{field:{name:n,value:i,onChange:o.React$1.useCallback((e=>{c.current.onChange({target:{value:ne(e),name:n},type:ie.CHANGE})}),[n]),onBlur:o.React$1.useCallback((()=>{c.current.onBlur({target:{value:se(a._formValues,n),name:n},type:ie.BLUR})}),[n,a]),ref:o.React$1.useCallback((e=>{const t=se(a._fields,n);e&&t&&e.focus&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}),[n,a._fields])},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!se(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!se(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!se(l.touchedFields,n)},error:{enumerable:!0,get:()=>se(l.errors,n)}})}}const ke=e=>e.render(Me(e));var Ce=(e,t,n,a,r)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[a]:r||!0}}:{},Te=e=>/^\w*$/.test(e),$e=e=>re(e.replace(/["|']|\]/g,"").split(/\.|\[/));function De(e,t,n){let a=-1;const r=Te(t)?[t]:$e(t),o=r.length,s=o-1;for(;++a<o;){const t=r[a];let o=n;if(a!==s){const n=e[t];o=te(n)||Array.isArray(n)?n:isNaN(+r[a+1])?{}:[]}e[t]=o,e=e[t]}return e}const Ie=(e,t,n)=>{for(const a of n||Object.keys(e)){const n=se(e,a);if(n){const{_f:e,...a}=n;if(e&&t(e.name)){if(e.ref.focus&&oe(e.ref.focus()))break;if(e.refs){e.refs[0].focus();break}}else te(a)&&Ie(a,t)}}};var Fe=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),Ne=(e,t,n)=>{const a=re(se(e,n));return De(a,"root",t[n]),De(e,n,a),e},Pe=e=>"boolean"==typeof e,Le=e=>"file"===e.type,Ve=e=>xe(e)||o.React$1.isValidElement(e),Be=e=>"radio"===e.type,Ue=e=>e instanceof RegExp;const je={value:!1,isValid:!1},He={value:!0,isValid:!0};var We=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!oe(e[0].attributes.value)?oe(e[0].value)||""===e[0].value?He:{value:e[0].value,isValid:!0}:He:je}return je};const ze={isValid:!1,value:null};var qe=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),ze):ze;function Ge(e,t,n="validate"){if(Ve(e)||Array.isArray(e)&&e.every(Ve)||Pe(e)&&!e)return{type:n,message:Ve(e)?e:"",ref:t}}var Ye=e=>te(e)&&!Ue(e)?e:{value:e,message:""},Xe=async(e,t,n,a,r)=>{const{ref:o,refs:s,required:i,maxLength:l,minLength:c,min:d,max:u,pattern:p,validate:m,name:h,valueAsNumber:_,mount:g,disabled:f}=e._f;if(!g||f)return{};const v=s?s[0]:o,b=e=>{a&&v.reportValidity&&(v.setCustomValidity(Pe(e)?"":e||" "),v.reportValidity())},y={},E=Be(o),S=K(o),A=E||S,x=(_||Le(o))&&!o.value||""===t||Array.isArray(t)&&!t.length,w=Ce.bind(null,h,n,y),O=(e,t,n,a=ue,r=pe)=>{const s=e?t:n;y[h]={type:e?a:r,message:s,ref:o,...w(e?a:r,s)}};if(r?!Array.isArray(t)||!t.length:i&&(!A&&(x||Q(t))||Pe(t)&&!t||S&&!We(s).isValid||E&&!qe(s).isValid)){const{value:e,message:t}=Ve(i)?{value:!!i,message:i}:Ye(i);if(e&&(y[h]={type:he,message:t,ref:v,...w(he,t)},!n))return b(t),y}if(!(x||Q(d)&&Q(u))){let e,a;const r=Ye(u),s=Ye(d);if(Q(t)||isNaN(t)){const n=o.valueAsDate||new Date(t);xe(r.value)&&(e=n>new Date(r.value)),xe(s.value)&&(a=n<new Date(s.value))}else{const n=o.valueAsNumber||(t?+t:t);Q(r.value)||(e=n>r.value),Q(s.value)||(a=n<s.value)}if((e||a)&&(O(!!e,r.message,s.message,ce,de),!n))return b(y[h].message),y}if((l||c)&&!x&&(xe(t)||r&&Array.isArray(t))){const e=Ye(l),a=Ye(c),r=!Q(e.value)&&t.length>e.value,o=!Q(a.value)&&t.length<a.value;if((r||o)&&(O(r,e.message,a.message),!n))return b(y[h].message),y}if(p&&!x&&xe(t)){const{value:e,message:a}=Ye(p);if(Ue(e)&&!t.match(e)&&(y[h]={type:me,message:a,ref:o,...w(me,a)},!n))return b(a),y}if(m)if(Oe(m)){const e=Ge(await m(t),v);if(e&&(y[h]={...e,...w(_e,e.message)},!n))return b(e.message),y}else if(te(m)){let e={};for(const a in m){if(!be(e)&&!n)break;const r=Ge(await m[a](t),v,a);r&&(e={...r,...w(a,r.message)},b(r.message),n&&(y[h]=e))}if(!be(e)&&(y[h]={ref:v,...e},!n))return y}return b(!0),y},Ze="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function Ke(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(Ze&&(e instanceof Blob||e instanceof FileList)||!n&&!te(e))return e;t=n?[]:{};for(const n in e){if(Oe(e[n])){t=e;break}t[n]=Ke(e[n])}}return t}var Je=e=>({isOnSubmit:!e||e===le.onSubmit,isOnBlur:e===le.onBlur,isOnChange:e===le.onChange,isOnAll:e===le.all,isOnTouch:e===le.onTouched});function Qe(e){for(const t in e)if(!oe(e[t]))return!1;return!0}function et(e,t){const n=Te(t)?[t]:$e(t),a=1==n.length?e:function(e,t){const n=t.slice(0,-1).length;let a=0;for(;a<n;)e=oe(e)?a++:e[t[a++]];return e}(e,n),r=n[n.length-1];let o;a&&delete a[r];for(let t=0;t<n.slice(0,-1).length;t++){let a,r=-1;const s=n.slice(0,-(t+1)),i=s.length-1;for(t>0&&(o=e);++r<s.length;){const t=s[r];a=a?a[t]:e[t],i===r&&(te(a)&&be(a)||Array.isArray(a)&&Qe(a))&&(o?delete o[t]:delete e[t]),o=a}}return e}function tt(){let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var nt=e=>Q(e)||!ee(e);function at(e,t){if(nt(e)||nt(t))return e===t;if(J(e)&&J(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const r of n){const n=e[r];if(!a.includes(r))return!1;if("ref"!==r){const e=t[r];if(J(n)&&J(e)||te(n)&&te(e)||Array.isArray(n)&&Array.isArray(e)?!at(n,e):n!==e)return!1}}return!0}var rt=e=>{const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},ot=e=>"select-multiple"===e.type,st=e=>Be(e)||K(e),it=e=>rt(e)&&e.isConnected;function lt(e,t={}){const n=Array.isArray(e);if(te(e)||n)for(const n in e)Array.isArray(e[n])||te(e[n])&&!Re(e[n])?(t[n]=Array.isArray(e[n])?[]:{},lt(e[n],t[n])):Q(e[n])||(t[n]=!0);return t}function ct(e,t,n){const a=Array.isArray(e);if(te(e)||a)for(const a in e)Array.isArray(e[a])||te(e[a])&&!Re(e[a])?oe(t)||nt(n[a])?n[a]=Array.isArray(e[a])?lt(e[a],[]):{...lt(e[a])}:ct(e[a],Q(t)?{}:t[a],n[a]):n[a]=!at(e[a],t[a]);return n}var dt=(e,t)=>ct(e,t,lt(t)),ut=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:a})=>oe(e)?e:t?""===e?NaN:e?+e:e:n&&xe(e)?new Date(e):a?a(e):e;function pt(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return Le(t)?t.files:Be(t)?qe(e.refs).value:ot(t)?[...t.selectedOptions].map((({value:e})=>e)):K(t)?We(e.refs).value:ut(oe(t.value)?e.ref.value:t.value,e)}var mt=(e,t,n,a)=>{const r={};for(const n of e){const e=se(t,n);e&&De(r,n,e._f)}return{criteriaMode:n,names:[...e],fields:r,shouldUseNativeValidation:a}},ht=e=>oe(e)?void 0:Ue(e)?e.source:te(e)?Ue(e.value)?e.value.source:e.value:e,_t=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function gt(e,t,n){const a=se(e,n);if(a||Te(n))return{error:a,name:n};const r=n.split(".");for(;r.length;){const a=r.join("."),o=se(t,a),s=se(e,a);if(o&&!Array.isArray(o)&&n!==a)return{name:n};if(s&&s.type)return{name:a,error:s};r.pop()}return{name:n}}var ft=(e,t,n,a,r)=>!r.isOnAll&&(!n&&r.isOnTouch?!(t||e):(n?a.isOnBlur:r.isOnBlur)?!e:!(n?a.isOnChange:r.isOnChange)||e),vt=(e,t)=>!re(se(e,t)).length&&et(e,t);const bt={mode:le.onSubmit,reValidateMode:le.onChange,shouldFocusError:!0};function yt(e={}){let t,n={...bt,...e},a={isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,errors:{}},r={},o=Ke(n.defaultValues)||{},s=n.shouldUnregister?{}:Ke(o),i={action:!1,mount:!1,watch:!1},l={mount:new Set,unMount:new Set,array:new Set,watch:new Set},c=0,d={};const u={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},p={watch:tt(),array:tt(),state:tt()},m=Je(n.mode),h=Je(n.reValidateMode),_=n.criteriaMode===le.all,g=async e=>{let t=!1;return u.isValid&&(t=n.resolver?be((await y()).errors):await E(r,!0),e||t===a.isValid||(a.isValid=t,p.state.next({isValid:t}))),t},f=(e,t,n,a)=>{const l=se(r,e);if(l){const r=se(s,e,oe(n)?se(o,e):n);oe(r)||a&&a.defaultChecked||t?De(s,e,t?r:pt(l._f)):x(e,r),i.mount&&g()}},v=(e,t,n,r,s)=>{let i=!1;const l={name:e},c=se(a.touchedFields,e);if(u.isDirty){const e=a.isDirty;a.isDirty=l.isDirty=S(),i=e!==l.isDirty}if(u.dirtyFields&&(!n||r)){const n=se(a.dirtyFields,e);at(se(o,e),t)?et(a.dirtyFields,e):De(a.dirtyFields,e,!0),l.dirtyFields=a.dirtyFields,i=i||n!==se(a.dirtyFields,e)}return n&&!c&&(De(a.touchedFields,e,n),l.touchedFields=a.touchedFields,i=i||u.touchedFields&&c!==n),i&&s&&p.state.next(l),i?l:{}},b=async(n,r,o,s)=>{const i=se(a.errors,n),l=u.isValid&&a.isValid!==r;var m;if(e.delayError&&o?(m=()=>((e,t)=>{De(a.errors,e,t),p.state.next({errors:a.errors})})(n,o),t=e=>{clearTimeout(c),c=window.setTimeout(m,e)},t(e.delayError)):(clearTimeout(c),t=null,o?De(a.errors,n,o):et(a.errors,n)),(o?!at(i,o):i)||!be(s)||l){const e={...s,...l?{isValid:r}:{},errors:a.errors,name:n};a={...a,...e},p.state.next(e)}d[n]--,u.isValidating&&!Object.values(d).some((e=>e))&&(p.state.next({isValidating:!1}),d={})},y=async e=>n.resolver?await n.resolver({...s},n.context,mt(e||l.mount,r,n.criteriaMode,n.shouldUseNativeValidation)):{},E=async(e,t,r={valid:!0})=>{for(const o in e){const i=e[o];if(i){const{_f:e,...o}=i;if(e){const o=l.array.has(e.name),c=await Xe(i,se(s,e.name),_,n.shouldUseNativeValidation,o);if(c[e.name]&&(r.valid=!1,t))break;!t&&(se(c,e.name)?o?Ne(a.errors,c,e.name):De(a.errors,e.name,c[e.name]):et(a.errors,e.name))}o&&await E(o,t,r)}}return r.valid},S=(e,t)=>(e&&t&&De(s,e,t),!at(k(),o)),A=(e,t,n)=>{const a={...i.mount?s:oe(t)?o:xe(e)?{[e]:t}:t};return we(e,l,a,n)},x=(e,t,n={})=>{const a=se(r,e);let o=t;if(a){const n=a._f;n&&(!n.disabled&&De(s,e,ut(t,n)),o=Ze&&rt(n.ref)&&Q(t)?"":t,ot(n.ref)?[...n.ref.options].forEach((e=>e.selected=o.includes(e.value))):n.refs?K(n.ref)?n.refs.length>1?n.refs.forEach((e=>!e.disabled&&(e.checked=Array.isArray(o)?!!o.find((t=>t===e.value)):o===e.value))):n.refs[0]&&(n.refs[0].checked=!!o):n.refs.forEach((e=>e.checked=e.value===o)):Le(n.ref)?n.ref.value="":(n.ref.value=o,n.ref.type||p.watch.next({name:e})))}(n.shouldDirty||n.shouldTouch)&&v(e,o,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&M(e)},w=(e,t,n)=>{for(const a in t){const o=t[a],s=`${e}.${a}`,i=se(r,s);!l.array.has(e)&&nt(o)&&(!i||i._f)||J(o)?x(s,o,n):w(s,o,n)}},O=(e,t,n={})=>{const i=se(r,e),c=l.array.has(e),d=Ke(t);De(s,e,d),c?(p.array.next({name:e,values:s}),(u.isDirty||u.dirtyFields)&&n.shouldDirty&&(a.dirtyFields=dt(o,s),p.state.next({name:e,dirtyFields:a.dirtyFields,isDirty:S(e,d)}))):!i||i._f||Q(d)?x(e,d,n):w(e,d,n),Fe(e,l)&&p.state.next({}),p.watch.next({name:e})},R=async e=>{const o=e.target;let i=o.name;const c=se(r,i);if(c){let u,f;const E=o.type?pt(c._f):ne(e),S=e.type===ie.BLUR||e.type===ie.FOCUS_OUT,A=!_t(c._f)&&!n.resolver&&!se(a.errors,i)&&!c._f.deps||ft(S,se(a.touchedFields,i),a.isSubmitted,h,m),x=Fe(i,l,S);De(s,i,E),S?(c._f.onBlur&&c._f.onBlur(e),t&&t(0)):c._f.onChange&&c._f.onChange(e);const w=v(i,E,S,!1),O=!be(w)||x;if(!S&&p.watch.next({name:i,type:e.type}),A)return O&&p.state.next({name:i,...x?{}:w});if(!S&&x&&p.state.next({}),d[i]=(d[i],1),p.state.next({isValidating:!0}),n.resolver){const{errors:e}=await y([i]),t=gt(a.errors,r,i),n=gt(e,r,t.name||i);u=n.error,i=n.name,f=be(e)}else u=(await Xe(c,se(s,i),_,n.shouldUseNativeValidation))[i],f=await g(!0);c._f.deps&&M(c._f.deps),b(i,f,u,w)}},M=async(e,t={})=>{let o,s;const i=Ee(e);if(p.state.next({isValidating:!0}),n.resolver){const t=await(async e=>{const{errors:t}=await y();if(e)for(const n of e){const e=se(t,n);e?De(a.errors,n,e):et(a.errors,n)}else a.errors=t;return t})(oe(e)?e:i);o=be(t),s=e?!i.some((e=>se(t,e))):o}else e?(s=(await Promise.all(i.map((async e=>{const t=se(r,e);return await E(t&&t._f?{[e]:t}:t)})))).every(Boolean),(s||a.isValid)&&g()):s=o=await E(r);return p.state.next({...!xe(e)||u.isValid&&o!==a.isValid?{}:{name:e},...n.resolver?{isValid:o}:{},errors:a.errors,isValidating:!1}),t.shouldFocus&&!s&&Ie(r,(e=>se(a.errors,e)),e?i:l.mount),s},k=e=>{const t={...o,...i.mount?s:{}};return oe(e)?t:xe(e)?se(t,e):e.map((e=>se(t,e)))},C=(e,t)=>({invalid:!!se((t||a).errors,e),isDirty:!!se((t||a).dirtyFields,e),isTouched:!!se((t||a).touchedFields,e),error:se((t||a).errors,e)}),T=(e,t={})=>{for(const i of e?Ee(e):l.mount)l.mount.delete(i),l.array.delete(i),se(r,i)&&(t.keepValue||(et(r,i),et(s,i)),!t.keepError&&et(a.errors,i),!t.keepDirty&&et(a.dirtyFields,i),!t.keepTouched&&et(a.touchedFields,i),!n.shouldUnregister&&!t.keepDefaultValue&&et(o,i));p.watch.next({}),p.state.next({...a,...t.keepDirty?{isDirty:S()}:{}}),!t.keepIsValid&&g()},$=(e,t={})=>{let a=se(r,e);const c=Pe(t.disabled);return De(r,e,{...a||{},_f:{...a&&a._f?a._f:{ref:{name:e}},name:e,mount:!0,...t}}),l.mount.add(e),a?c&&De(s,e,t.disabled?void 0:se(s,e,pt(a._f))):f(e,!0,t.value),{...c?{disabled:t.disabled}:{},...n.shouldUseNativeValidation?{required:!!t.required,min:ht(t.min),max:ht(t.max),minLength:ht(t.minLength),maxLength:ht(t.maxLength),pattern:ht(t.pattern)}:{},name:e,onChange:R,onBlur:R,ref:s=>{if(s){$(e,t),a=se(r,e);const n=oe(s.value)&&s.querySelectorAll&&s.querySelectorAll("input,select,textarea")[0]||s,i=st(n),l=a._f.refs||[];if(i?l.find((e=>e===n)):n===a._f.ref)return;De(r,e,{_f:{...a._f,...i?{refs:[...l.filter(it),n,...Array.isArray(se(o,e))?[{}]:[]],ref:{type:n.type,name:e}}:{ref:n}}}),f(e,!1,void 0,n)}else a=se(r,e,{}),a._f&&(a._f.mount=!1),(n.shouldUnregister||t.shouldUnregister)&&(!ae(l.array,e)||!i.action)&&l.unMount.add(e)}}};return{control:{register:$,unregister:T,getFieldState:C,_executeSchema:y,_getWatch:A,_getDirty:S,_updateValid:g,_removeUnmounted:()=>{for(const e of l.unMount){const t=se(r,e);t&&(t._f.refs?t._f.refs.every((e=>!it(e))):!it(t._f.ref))&&T(e)}l.unMount=new Set},_updateFieldArray:(e,t=[],n,l,c=!0,d=!0)=>{if(l&&n){if(i.action=!0,d&&Array.isArray(se(r,e))){const t=n(se(r,e),l.argA,l.argB);c&&De(r,e,t)}if(u.errors&&d&&Array.isArray(se(a.errors,e))){const t=n(se(a.errors,e),l.argA,l.argB);c&&De(a.errors,e,t),vt(a.errors,e)}if(u.touchedFields&&d&&Array.isArray(se(a.touchedFields,e))){const t=n(se(a.touchedFields,e),l.argA,l.argB);c&&De(a.touchedFields,e,t)}u.dirtyFields&&(a.dirtyFields=dt(o,s)),p.state.next({isDirty:S(e,t),dirtyFields:a.dirtyFields,errors:a.errors,isValid:a.isValid})}else De(s,e,t)},_getFieldArray:t=>re(se(i.mount?s:o,t,e.shouldUnregister?se(o,t,[]):[])),_subjects:p,_proxyFormState:u,get _fields(){return r},get _formValues(){return s},get _stateFlags(){return i},set _stateFlags(e){i=e},get _defaultValues(){return o},get _names(){return l},set _names(e){l=e},get _formState(){return a},set _formState(e){a=e},get _options(){return n},set _options(e){n={...n,...e}}},trigger:M,register:$,handleSubmit:(e,t)=>async o=>{o&&(o.preventDefault&&o.preventDefault(),o.persist&&o.persist());let i=!0,c=Ke(s);p.state.next({isSubmitting:!0});try{if(n.resolver){const{errors:e,values:t}=await y();a.errors=e,c=t}else await E(r);be(a.errors)?(p.state.next({errors:{},isSubmitting:!0}),await e(c,o)):(t&&await t({...a.errors},o),n.shouldFocusError&&Ie(r,(e=>se(a.errors,e)),l.mount))}catch(e){throw i=!1,e}finally{a.isSubmitted=!0,p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:be(a.errors)&&i,submitCount:a.submitCount+1,errors:a.errors})}},watch:(e,t)=>Oe(e)?p.watch.subscribe({next:n=>e(A(void 0,t),n)}):A(e,t,!0),setValue:O,getValues:k,reset:(t,n)=>((t,n={})=>{const c=t||o,d=Ke(c),m=t&&!be(t)?d:o;if(n.keepDefaultValues||(o=c),!n.keepValues){if(n.keepDirtyValues)for(const e of l.mount)se(a.dirtyFields,e)?De(m,e,se(s,e)):O(e,se(m,e));else{if(Ze&&oe(t))for(const e of l.mount){const t=se(r,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;try{if(rt(e)){e.closest("form").reset();break}}catch(e){}}}r={}}s=e.shouldUnregister?n.keepDefaultValues?Ke(o):{}:d,p.array.next({values:m}),p.watch.next({values:m})}l={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},i.mount=!u.isValid||!!n.keepIsValid,i.watch=!!e.shouldUnregister,p.state.next({submitCount:n.keepSubmitCount?a.submitCount:0,isDirty:n.keepDirty||n.keepDirtyValues?a.isDirty:!(!n.keepDefaultValues||at(t,o)),isSubmitted:!!n.keepIsSubmitted&&a.isSubmitted,dirtyFields:n.keepDirty||n.keepDirtyValues?a.dirtyFields:n.keepDefaultValues&&t?dt(o,t):{},touchedFields:n.keepTouched?a.touchedFields:{},errors:n.keepErrors?a.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})})(Oe(t)?t(s):t,n),resetField:(e,t={})=>{se(r,e)&&(oe(t.defaultValue)?O(e,se(o,e)):(O(e,t.defaultValue),De(o,e,t.defaultValue)),t.keepTouched||et(a.touchedFields,e),t.keepDirty||(et(a.dirtyFields,e),a.isDirty=t.defaultValue?S(e,se(o,e)):S()),t.keepError||(et(a.errors,e),u.isValid&&g()),p.state.next({...a}))},clearErrors:e=>{e?Ee(e).forEach((e=>et(a.errors,e))):a.errors={},p.state.next({errors:a.errors})},unregister:T,setError:(e,t,n)=>{const o=(se(r,e,{_f:{}})._f||{}).ref;De(a.errors,e,{...t,ref:o}),p.state.next({name:e,errors:a.errors,isValid:!1}),n&&n.shouldFocus&&o&&o.focus&&o.focus()},setFocus:(e,t={})=>{const n=se(r,e)._f,a=n.refs?n.refs[0]:n.ref;a.focus(),t.shouldSelect&&a.select()},getFieldState:C}}function Et(e){const t=e.toTimeString().split(" ")[0].split(":");return`${t[0]}:${t[1]}`}a.injectInternalStyle("typescript/component_libraries/docsend/src/components/sharing/link_modal.module.out.css",(e=>"._modalBody_5k6al_2 legend{margin:unset}._form-footer_5k6al_6{align-items:center;display:flex;justify-content:flex-end;width:100%}._button-group_5k6al_13{display:flex}._link-settings_5k6al_17{display:grid;gap:var(--spacing__unit--1)}._delete-button-container_5k6al_22{width:100%}._error-banner_5k6al_26{margin-bottom:var(--spacing__unit--3)}._loading-body_5k6al_30{align-items:center;display:flex;justify-content:center;min-height:350px}._password-input_5k6al_36{width:75%}._expire-date-time-container_5k6al_40{display:flex;gap:var(--spacing__unit--2_5)}._expire-date-container_5k6al_45{width:50%}._expire-date-container_5k6al_45 [class*=dig-ClickOutside]{width:100%}._expire-time-container_5k6al_53{width:50%}._expire-time-container_5k6al_53 [class*=dig-TextInputContainer]{width:100%}._disabled_5k6al_61{color:var(--dig-color__disabled__base);pointer-events:none}"));const St={modalBody:"_modalBody_5k6al_2",formFooter:"_form-footer_5k6al_6",buttonGroup:"_button-group_5k6al_13",linkSettings:"_link-settings_5k6al_17",deleteButtonContainer:"_delete-button-container_5k6al_22",errorBanner:"_error-banner_5k6al_26",loadingBody:"_loading-body_5k6al_30",passwordInput:"_password-input_5k6al_36",expireDateTimeContainer:"_expire-date-time-container_5k6al_40",expireDateContainer:"_expire-date-container_5k6al_45",expireTimeContainer:"_expire-time-container_5k6al_53",disabled:"_disabled_5k6al_61"},At=({isEditingLink:e})=>o.React$1.createElement(a.Modal$1.Title,{id:"create-edit-link-modal-title"},e?o.React$1.createElement(i.FormattedMessage,{id:"nOpl1K",defaultMessage:"Edit link settings"}):o.React$1.createElement(i.FormattedMessage,{id:"CiNEXx",defaultMessage:"Create a link to share this file"}));function xt({isEdittingLink:e,defaultValues:t,onSubmit:r,downloadOnly:s,isOpen:l,closeModal:c,onDelete:d,submitErrorMessage:m,reportModalException:h,localizedDateFormat:_}){const g=i.useIntl(),f=o.React$1.useMemo((()=>new Date((new Date).setHours(0,0,0,0))),[]),v=o.React$1.useCallback((e=>!!e&&e<f),[f]),b=o.React$1.useMemo((()=>{var e,n,a;return{account:null!==(e=null==t?void 0:t.account)&&void 0!==e?e:g.formatMessage({id:"2sjPUJ",defaultMessage:"Link {createdTime, date, med} at {createdTime, time, short}"},{createdTime:new Date}),requireEmail:!!(null==t?void 0:t.requireEmail),passcode:null!==(n=null==t?void 0:t.passcode)&&void 0!==n?n:null,allowDownloading:!!s||!!(null==t?void 0:t.allowDownloading),expireDate:null!==(a=null==t?void 0:t.expireDateTime)&&void 0!==a?a:null,expireTime:(null==t?void 0:t.expireDateTime)?Et(t.expireDateTime):null}}),[g,t]),{handleSubmit:y,control:E,formState:{isSubmitting:S,errors:A},reset:x,watch:w,setValue:O}=function(e={}){const t=o.React$1.useRef(),[n,a]=o.React$1.useState({isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,errors:{}});t.current?t.current.control._options=e:t.current={...yt(e),formState:n};const r=t.current.control,s=o.React$1.useCallback((e=>{ye(e,r._proxyFormState,!0)&&(r._formState={...r._formState,...e},a({...r._formState}))}),[r]);return Ae({subject:r._subjects.state,callback:s}),o.React$1.useEffect((()=>{r._stateFlags.mount||(r._proxyFormState.isValid&&r._updateValid(),r._stateFlags.mount=!0),r._stateFlags.watch&&(r._stateFlags.watch=!1,r._subjects.state.next({})),r._removeUnmounted()})),t.current.formState=ve(n,r._proxyFormState),t.current}({reValidateMode:"onSubmit",defaultValues:b}),R=o.reactExports.useRef(null),M=o.reactExports.useRef(null),k=e=>{e.currentTarget.select()},C=new Date(Date.now()+864e5);C.setSeconds(0,0);const T=w("expireDate"),$=w("expireTime"),[D,I]=o.React$1.useState(!!(null==t?void 0:t.expireDateTime)&&t.expireDateTime<=new Date);o.React$1.useEffect((()=>{(!T||!$||Ot(T,$)>new Date)&&I(!1)}),[T,$]);const[F,N]=o.React$1.useState(null),P=o.React$1.useCallback((e=>n.__awaiter(this,void 0,void 0,(function*(){N(null);try{yield r(function(e){var t;const{expireTime:a,expireDate:r,account:o}=e,s=n.__rest(e,["expireTime","expireDate","account"]),i=null!==(t=null==o?void 0:o.trim())&&void 0!==t?t:null;if(""===a||!r)return Object.assign(Object.assign({},s),{account:i,expireDateTime:r});return Object.assign(Object.assign({},s),{account:i,expireDateTime:Ot(r,a)})}(e))}catch(e){null==h||h(e instanceof Error?e:new Error(`Unexpected link submission error: ${e}`),["owner-docsend-gf","docsend-hub-link-submission-error"]),m&&N(m)}}))),[r,m]),L=o.React$1.useCallback((()=>{N(null),x(b),I(!!(null==t?void 0:t.expireDateTime)&&t.expireDateTime<new Date)}),[null==t?void 0:t.expireDateTime,b,x]);o.reactExports.useEffect((()=>{l&&L()}),[L,l]);const V=g.formatMessage({id:"3qttDa",defaultMessage:"Enter a link name"});return o.React$1.createElement(o.React$1.Fragment,null,o.React$1.createElement(a.Modal$1.Body,{className:St.modalBody},D&&o.React$1.createElement(a.Banner,{type:"warning",className:St.errorBanner},o.React$1.createElement(a.Banner.Message,null,o.React$1.createElement(i.FormattedMessage,{id:"+7xLKD",defaultMessage:"Link expired. Remove the expiration date or select a date in the future."}))),!!F&&o.React$1.createElement(a.Banner,{type:"alert",className:St.errorBanner},o.React$1.createElement(a.Banner.Message,null,F)),o.React$1.createElement(p.FormRow,null,o.React$1.createElement("div",{ref:R},o.React$1.createElement(p.FormLabel,{htmlFor:"link-name-field","aria-describedby":"link-name-desc"},o.React$1.createElement(i.FormattedMessage,{id:"mDkVSH",defaultMessage:"Link name"}))),o.React$1.createElement(ke,{control:E,name:"account",defaultValue:null==t?void 0:t.account,rules:{required:V,maxLength:{value:255,message:g.formatMessage({id:"DpjHDU",defaultMessage:"Link name is too long. Keep it under 255 characters."})},validate:{notEmptyString:e=>!!(null==e?void 0:e.trim())||V}},render:({field:{value:e,onChange:t}})=>o.React$1.createElement(a.TextInput,{id:"link-name-field",onChange:t,value:null!=e?e:"",onFocus:k})}),A.account?o.React$1.createElement(p.FormHelperText,{variant:"alert"},A.account.message):o.React$1.createElement(p.FormHelperText,{id:"link-name-field-desc"},o.React$1.createElement(i.FormattedMessage,{id:"XW/z2H",defaultMessage:"Naming a link makes it easy to identify at a glance. Link names are only visible to you."}))),o.React$1.createElement(p.FormControlGroup,null,o.React$1.createElement("div",{className:St.linkSettings,ref:M},o.React$1.createElement(p.FormLabel,{tagName:"legend"},o.React$1.createElement(i.FormattedMessage,{id:"TF+xyZ",defaultMessage:"Link security settings"})),o.React$1.createElement(p.FormRow,{variant:"control"},o.React$1.createElement(ke,{control:E,name:"requireEmail",render:({field:{value:e,onChange:t}})=>o.React$1.createElement(a.Checkbox,{id:"require-email-checkbox",checked:e,onChange:t})}),o.React$1.createElement(a.Label,{htmlFor:"require-email-checkbox"},o.React$1.createElement(i.FormattedMessage,{id:"PkuF0m",defaultMessage:"Require an email to view"}))),o.React$1.createElement(wt,{id:"expiration-checkbox",labelText:g.formatMessage({id:"2GOJGt",defaultMessage:"Set an expiration date"}),defaultValue:!!(null==t?void 0:t.expireDateTime),onChangeCallback:e=>{!0===e&&(O("expireDate",C),O("expireTime",Et(C)))}},o.React$1.createElement(p.FormRow,null,o.React$1.createElement("div",{className:St.expireDateTimeContainer},o.React$1.createElement("div",{className:St.expireDateContainer},o.React$1.createElement(ke,{control:E,name:"expireDate",shouldUnregister:!0,rules:{required:g.formatMessage({id:"bu3TEP",defaultMessage:"Select a date in the future"}),validate:{pastDate:e=>!v(e)||g.formatMessage({id:"61iDEu",defaultMessage:"Select a date in the future"})}},render:({field:{value:e,onChange:t}})=>o.React$1.createElement(u.DatePickerInput,{value:null!=e?e:null,id:"expiration-picker",onChange:t,"data-testid":"CreateEditLinkModal__DatePickerInput",isInvalid:!!A.expireDate,isDateBlocked:v,dayLabelFormat:e=>g.formatDate(e,{day:"2-digit"}),monthLabelFormat:e=>g.formatDate(e,{month:"long",year:"numeric"}),weekdayLabelFormat:e=>g.formatDate(e,{weekday:"narrow"}),format:_})}),A.expireDate&&o.React$1.createElement(p.FormHelperText,{variant:"alert"},A.expireDate.message)),o.React$1.createElement("div",{className:St.expireTimeContainer},o.React$1.createElement(ke,{control:E,name:"expireTime",shouldUnregister:!0,rules:{required:g.formatMessage({id:"q6m95e",defaultMessage:"Enter a valid time"}),validate:{pastTime:e=>!T||Ot(T,e)>new Date||g.formatMessage({id:"ZfORMN",defaultMessage:"Select a time in the future"})}},render:({field:{value:e,onChange:t}})=>o.React$1.createElement(a.TextInput,{type:"time",value:null!=e?e:"",id:"expiration-picker",onChange:t,isInvalid:!!A.expireTime,"data-testid":"CreateEditLinkModal__TimePickerInput"})}),A.expireTime&&o.React$1.createElement(p.FormHelperText,{variant:"alert"},A.expireTime.message))))),o.React$1.createElement(wt,{id:"passcode-checkbox",labelText:g.formatMessage({id:"L4mvAK",defaultMessage:"Add password protection"}),defaultValue:!!(null==t?void 0:t.passcode)},o.React$1.createElement(p.FormRow,null,o.React$1.createElement(ke,{control:E,name:"passcode",shouldUnregister:!0,rules:{required:g.formatMessage({id:"S9/hCj",defaultMessage:"Enter a password"}),maxLength:{value:100,message:g.formatMessage({id:"h5iTH4",defaultMessage:"Password is too long. Keep it under 100 characters."})}},render:({field:{value:e,onChange:t}})=>o.React$1.createElement("div",{className:St.passwordInput},o.React$1.createElement(a.TextInput,{id:"passcode-field",onChange:t,value:null!=e?e:"","data-testid":"CreateEditLinkModal__PasscodeInput",isInvalid:!!A.passcode}))}),A.passcode&&o.React$1.createElement(p.FormHelperText,{variant:"alert"},A.passcode.message))),o.React$1.createElement(p.FormRow,{variant:"control"},o.React$1.createElement(ke,{control:E,name:"allowDownloading",render:({field:{value:e,onChange:t}})=>o.React$1.createElement(a.Checkbox,{id:"download-checkbox",className:s?St.disabled:"",checked:!!s||e,onChange:t,disabled:s})}),o.React$1.createElement(a.Label,{htmlFor:"download-checkbox",className:s?St.disabled:""},o.React$1.createElement(i.FormattedMessage,{id:"DfeWE8",defaultMessage:"Allow downloads"})))))),o.React$1.createElement(a.Modal$1.Footer,null,o.React$1.createElement("div",{className:St.formFooter},e&&d&&o.React$1.createElement("div",{className:St.deleteButtonContainer},o.React$1.createElement(a.Button$1,{variant:"transparent",onClick:d,disabled:S},o.React$1.createElement(a.Text,{color:"error"},o.React$1.createElement(i.FormattedMessage,{id:"ts+c+9",defaultMessage:"Delete link"})))),o.React$1.createElement("div",{className:St.buttonGroup},o.React$1.createElement(a.Button$1,{variant:"opacity",onClick:c},o.React$1.createElement(i.FormattedMessage,{id:"//TQQx",defaultMessage:"Cancel"})),o.React$1.createElement(a.Button$1,{variant:"primary",onClick:y(P),disabled:S||D},e?o.React$1.createElement(i.FormattedMessage,{id:"xTDvqL",defaultMessage:"Save"}):o.React$1.createElement(i.FormattedMessage,{id:"5zfDki",defaultMessage:"Create link"}))))))}function wt({children:e,defaultValue:t=!1,id:n,labelText:r,onChangeCallback:s}){const[i,l]=o.React$1.useState(t);return o.React$1.createElement(o.React$1.Fragment,null,o.React$1.createElement(p.FormRow,{variant:"control"},o.React$1.createElement(a.Checkbox,{id:n,checked:i,onChange:()=>{const e=!i;l(e),s&&s(e)}}),!!r&&o.React$1.createElement(a.Label,{htmlFor:n},r)),i&&e)}function Ot(e,t){if(!t)return e;const n=t.split(":"),a=new Date(e);return a.setHours(Number(n[0]),Number(n[1])),a}function Rt(e){var{isLoading:t,isOpen:r,closeModal:s,reportModalException:l}=e,c=n.__rest(e,["isLoading","isOpen","closeModal","reportModalException"]);const d=i.useIntl();return o.React$1.createElement(a.Modal$1,{open:r,isCentered:!0,shouldCloseOnOverlayClick:!1,withCloseButton:d.formatMessage({id:"vawEMm",defaultMessage:"Close"}),"aria-labelledby":"create-edit-link-modal-title",onRequestClose:s},o.React$1.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard"},o.React$1.createElement(At,{isEditingLink:!!c.isEdittingLink})),t?o.React$1.createElement(a.Modal$1.Body,{className:St.loadingBody},o.React$1.createElement(a.Spinner,{"data-testid":"spinner"})):o.React$1.createElement(xt,Object.assign({isOpen:r,closeModal:s,reportModalException:l},c)))}At.displayName="ModalTitle";const Mt=o.React$1.createContext({}),kt=({closeModal:e,onCancelLinkCreate:t,documentGroup:n,onSubmit:r})=>{var s;const l=i.useIntl(),[c,d]=o.reactExports.useState(null),u="ON"===(null===(s=o.React$1.useContext(Mt).hubExperiments)||void 0===s?void 0:s.videoAnalytics);return o.reactExports.useEffect((()=>{n.then((e=>d(e)))}),[n]),c?o.React$1.createElement(Rt,{isOpen:!0,onSubmit:e=>r(c.documentGroupId,e),closeModal:()=>t((null==c?void 0:c.documentGroupId)||""),submitErrorMessage:l.formatMessage({id:"XskuuZ",defaultMessage:"Couldn’t create link. Try again later."}),downloadOnly:c.downloadOnly,localizedDateFormat:a.localized_date_format}):o.React$1.createElement(Z,{allowVideo:u,isOpen:!0,isCopying:!0,onCopyFile:()=>{},onClose:e,onAfterClose:()=>{},logModalButtonSelectEvent:()=>{}})};function Ct(e){var t,n,a;const r=(null!==(n=null===(t=e.expireDateTime)||void 0===t?void 0:t.getTime())&&void 0!==n?n:0)/1e3;return{require_email:!!e.requireEmail,downloadable:!!e.allowDownloading,passcode:null!==(a=e.passcode)&&void 0!==a?a:void 0,expire_at:r}}function Tt(e,t){const n=new URLSearchParams;t&&n.set("link",t),a.redirect(new o.URI({path:`/docsend/files/${e}`,fragment:n.toString()}))}function $t(e,t){const r=new a.DefaultUserApiV2Client(e),s=function(e,t){var r,o;return n.__awaiter(this,void 0,void 0,(function*(){const n=new a.DefaultUserApiV2Client(e);yield n.ns("docsend_hub").rpc("provision",{},{});const s=yield n.ns("docsend_hub").rpc("create_document_from_dropbox",{file_id:t},{});return{documentGroupId:`${null===(r=s.document)||void 0===r?void 0:r.id}`,downloadOnly:!!(null===(o=s.document)||void 0===o?void 0:o.download_only)}}))}(e,t),l=e=>{m.reportException({err:e}),a.Snackbar.fail(o.React$1.createElement(i.Provider,{value:i.intl},o.React$1.createElement(i.FormattedMessage,{id:"eIkVAu",defaultMessage:"Something went wrong. Try again later."}))),a.unmountModal()};a.mountModal(o.React$1.createElement(i.Provider,{value:i.intl},o.React$1.createElement(kt,{documentGroup:s,closeModal:a.unmountModal,onCancelLinkCreate:Dt,onSubmit:(e,t)=>r.ns("docsend_hub").rpc("create_link",function(e,t){var n;return{link_name:null!==(n=t.account)&&void 0!==n?n:void 0,document_group_id:e,link_settings:Ct(t)}}(e,t),{}).then((t=>Tt(e,t.link_url||""))).catch(l)}))),s.catch(l)}function Dt(e){""===e?a.Snackbar.fail(o.React$1.createElement(i.Provider,{value:i.intl},o.React$1.createElement(i.FormattedMessage,{id:"eIkVAu",defaultMessage:"Something went wrong. Try again later."}))):a.Snackbar.complete(o.React$1.createElement(i.Provider,{value:i.intl},o.React$1.createElement(i.FormattedMessage,{id:"8jPTar",defaultMessage:"File copied."})),void 0,{actionButtonText:"View",onActionClick:()=>Tt(e)}),a.unmountModal()}function It(e,t){return n.__awaiter(this,void 0,void 0,(function*(){var n;!(yield(n=e.id,Promise.race([V(n),new Promise((e=>setTimeout((()=>e(!1)),100)))])))?a.mountModal(o.React$1.createElement(i.Provider,{value:i.intl},o.React$1.createElement(j,{isOpen:!0,closeModal:a.unmountModal,onSubmit:n=>{n.dontShowAgain&&function(e){L[e]=Promise.resolve(!0),a.setUserMetadata({DOCSEND_ADDON_SHARING_DO_NOT_SHOW_WELCOME_MODAL:!0},e)}(e.id),$t(e,t)}}))):$t(e,t)}))}var Ft;kt.displayName="SendAndTrackModal",function(e){e[e.NO_TOOLTIP=0]="NO_TOOLTIP",e[e.BIG_ONBOARDING_TOOLTIP=1]="BIG_ONBOARDING_TOOLTIP",e[e.SMALL_TOOLTIP=2]="SMALL_TOOLTIP"}(Ft||(Ft={}));const Nt=new f.ProfileServicesLinkingHandler,Pt={zoom:"zoom",slack_dropbox:"dropbox_slack",trello:"trello"};function Lt(e,t,n,a,r={}){return{event_name:y.InstrEventType.ServiceConnectionFlowEnd,service_type:e[".tag"],feature_name:t,extra:Object.assign(Object.assign({},r),{desired_outcome:n,outcome:a,was_successful:`${a===n}`})}}function Vt(e,t){return!!e&&t in e&&"is_connected"===e[t].connection_state[".tag"]}function Bt(e,t,r,o,s,i){return n.__awaiter(this,void 0,void 0,(function*(){if(Vt(t,o))return!0;const l=b.withDefaults(a.createIntegrationsActionsLogger().logEvent,{extra:b.getCommonContextExtra({serviceList:Object.keys(t).map((e=>t[e]))})}),c=t[o];c&&l(function(e,t,n,a,r={}){return{event_name:y.InstrEventType.ServiceConnectionFlowStart,service_type:e[".tag"],feature_name:n,extra:Object.assign(Object.assign({},r),{connection_state:t[".tag"],desired_outcome:a})}}(c.service_type,c.connection_state,s,y.InstrConnectServiceFlowOutcome.Connected));try{yield function(e,t,a){return n.__awaiter(this,void 0,void 0,(function*(){const n={".tag":t},r=()=>{const t=v.ProfileServicesConstants.from_api_service_type(n),{action:a}=v.ProfileServicesConstants.get_service_data(n,"profile_card_v2");return a?Nt.auth_service_with_user_promise(t,e,null,a):Promise.reject({reason:"no_service_action"})};if(a&&Pt[t]){const e=yield Nt.auth_service_with_user_with_landing_page(n,r);f.ProfileServicesLinkingHandler.show_import_notifications(e)}else{const e=yield r();f.ProfileServicesLinkingHandler.show_import_notifications(e)}}))}(e.id,o,i);const t=yield function(e,t){return new Promise((n=>t({user:e,onRefresh:n})))}(e,r),a=Vt(t,o);return c&&l(Lt(c.service_type,s,y.InstrConnectServiceFlowOutcome.Connected,a?y.InstrConnectServiceFlowOutcome.Connected:y.InstrConnectServiceFlowOutcome.Error)),a}catch(e){throw c&&l(Lt(c.service_type,s,y.InstrConnectServiceFlowOutcome.Connected,y.InstrConnectServiceFlowOutcome.Error,{error:JSON.stringify(e)})),e}}))}const Ut=new class{constructor(){this.events=[],this.listeners=new Set}push(e){this.events=[e,...this.events],this.listeners.forEach((e=>e(this.events)))}subscribe(e){this.listeners.add(e),e(this.events)}unsubscribe(e){this.listeners.delete(e)}};function jt(e,t,n){Ut.push({eventName:e,data:t,eventType:n})}function Ht(e,t={}){a.logEvent(e,t,"commerce");try{const t=function(e){var t;return null===(t=e.constructor.getTypeUrl())||void 0===t?void 0:t.split(".").pop()}(e);jt(t,e,"pap")}catch(e){console.error(e)}}new Set(["3dm","3ds","3fr","3g2","3ga","3gp","3gpp","3gpp2","7z","aac","abap","abr","abs","accdb","accde","accdr","accdt","ace","ada","adp","aep","ahk","ai","aif","aiff","als","amr","apk","apkg","app","application","arf","arj","arw","as","as3","asc","ascx","asf","asm","asp","aspx","ass","atn","attributes","au","avi","awk","azw4","bak","band","bas","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bdoc","bib","bimx","bin","binder","blend","bmp","brush","bsh","bsp","build","builder","bundle","bup","bz","bz2","c","c++","c4d","cab","capfile","capx","catpart","cbr","cc","cda","cdr","cetrainer","cfc","cfg","cfm","cfml","chm","civ5mod","cl","class","clip","clj","cls","cmake","cmap","cmd","coffee","com","cpio","cpl","cpp","cpt","cptx","cpy","cr2","cr3","crdownload","crw","crx","cs","cshtml","cson","csproj","css","csv","ct","ctb","ctp","curio","cxx","d","dat","db","dbf","dbs","dcm","dcr","dcs","ddl","deb","dem","dgn","di","dif","diff","disco","djvu","dll","dmbot","dmg","dml","dng","do","doc","docb","docm","docx","dot","dotm","dotx","dpx","drv","ds_store","dst","dta","dtbase","dtd","dtml","dv","dvi","dwf","dwg","dwl","dwl2","dxf","egg","ehi","el","emakefile","eml","enc","enl","eps","epub","erb","erf","erl","ex4","exe","f","f4v","f90","f95","fbx","fdr","fdx","fig","filter","fla","flac","flipchart","flp","flv","fmf","fmp12","form","framework","fs","fsi","fsscript","fsx","fxp","gadget","gba","gdoc","gemfile","gemspec","ggb","gif","gitconfig","gmz","go","gp5","gpx","graffle","groovy","gry","gsheet","gslides","gvy","gz","gzip","h","h++","haml","handlebars","hbs","hcp","heic","hex","hh","hpp","hrl","hs","hta","htc","htm","html","hwp","hxx","ibooks","ico","ics","idl","idml","ifc","ifo","igs","iim","iiq","img","inc","indd","inf","ini","inl","ino","ipa","ipk","ipp","ips","ipt","ipynb","irbrc","iso","j2c","j2k","jade","jar","jav","java","jp2","jpc","jpeg","jpf","jpg","jpg2","jpm","jpx","js","jse","json","jsp","jsx","jww","kdb","kdbx","kdc","kext","key","keynote","kfn","kml","kmz","kth","l","less","lha","lhs","lib4d","lisp","lnk","log","lrcat","lrec","lrtemplate","lst","ltx","lua","lz","lzh","lzma","m","m2t","m2ts","m3u","m3u8","m4a","m4r","m4v","ma","maff","make","mapset","markdn","markdown","mat","max","mb","mcmeta","mcworld","md","md5","mdb","mdown","mef","mht","mid","mjdoc","mkdn","mkv","ml","mli","mll","mly","mm","mmap","mobi","mod","mos","mov","mp3","mp4","mpeg","mpg","mpkg","mpp","mq4","mrw","msc","mscz","msg","msh","msh1","msh1xml","msh2","msh2xml","mshxml","msi","msm","msp","mst","mts","mtw","mud","mus","musx","mxf","mxm","myo","nb","nef","nfo","notebook","nrw","numbers","nwd","obj","odg","odp","ods","odt","oga","ogg","oggtheora","ogv","ogx","omf","omniplan","one","onetoc2","oo3","opj","opml","opus","orf","osascript","osk","osm","osz","otf","out","ova","p","p7m","package","pages","paper","papert","part","partial","pas","patch","pbo","pde","pdf","pdo","pef","pes","pfx","php","php2","php3","php4","php5","phtml","pif","pk3","pka","pkg","pkt","pl","plist","pln","plugin","pm","png","pod","pot","potm","potx","pp","ppam","ppm","pps","ppsm","ppsx","ppt","pptm","pptx","prc","prj","prn","pro","profile","properties","prproj","prt","ps","ps1","ps1xml","ps2","ps2xml","psarc","psb","psc","psc1","psc2","psd","psd1","psm1","pst","pt","ptm","ptp","ptx","pub","py","pyw","pzf","pzfx","qbb","qbm","qbw","qbx","qdfm","qpkg","qtz","r","r3d","raf","rake","rar","razersynapse","rb","rbx","rbz","rc","rdata","rdp","re","readme","reg","rest","result","resw","resx","rfa","rhtml","rjs","rm","rmvb","rpm","rprofile","rpy","rs","rss","rst","rte","rtf","rtfd","run","rvt","rw2","rwl","rwsw","rwtheme","rxml","s","sas","sass","sav","sb2","scala","scf","schematic","scm","sconscript","sconstruct","scr","script","scriv","scs","scss","sfx","sgml","sh","shp","shtml","shx","sib","sims3pack","sit","sitx","skb","sketch","skp","sldasm","slddrw","sldm","sldprt","sldx","slx","smi","sml","sookasa","space","sps","spv","sql","sr2","src","srt","step","stl","story","stp","studio","studio3","sty","svg","svgz","swf","swift","tac","tar","taz","tbz","tbz2","tcl","tex","text","textclipping","textile","tga","tgz","thm","tif","tiff","tld","tli","tlz","tmod","tmp","tmpl","torrent","tpl","ts","tst","tsx","ttf","twbx","txt","txz","tz","ufo","unitypackage","ups","url","utf8","uue","vb","vbe","vbs","vcf","vdx","vi","vim","vob","vpdoc","vsd","vsdx","vtt","vwx","vxd","wad","war","watch","wav","wbk","wbmp","web","webarchive","webloc","webm","webp","website","wire","wlmp","wma","wmv","world","wpd","wps","ws","wsc","wsdl","wsf","wsh","wxy","x3f","x_t","xar","xcf","xcodeproj","xd","xhtml","xla","xlam","xll","xlm","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx","xlw","xmind","xml","xmp","xnb","xoml","xps","xsd","xsl","xslt","xz","yaml","yaws","ydk","yml","z","z2f","zip","zipx","zsh"]);const Wt=()=>{var e;const t=a.Viewer.get_viewer(),n=t.is_signed_in?null!==(e=a.getActiveUser())&&void 0!==e?e:t.personal_user:void 0,r=null==n?void 0:n.email;return!!r&&/@(dropbox|dbx51)\.com$/i.test(r)},zt=(e,t)=>(Object.keys(e).forEach((t=>{"object"==typeof e[t]?e[t]=zt(e[t],!0):-1===[null,void 0].indexOf(e[t])&&(e[t]=String(e[t]))})),t||(e.eventId=a.UUID.v4()),e);const qt={};const Gt="/shop",Yt="/create",Xt=`${Gt}/products`;var Zt,Kt;!function(e){e.SEND_VERIFY_EMAIL="send_verify_email"}(Zt||(Zt={})),function(e){e[e.FINDING_IN_PROGRESS=0]="FINDING_IN_PROGRESS",e[e.NOT_CREATED=1]="NOT_CREATED",e[e.CREATED=2]="CREATED"}(Kt||(Kt={}));const Jt=(e,t)=>{const n=(e=>e.map((e=>e.file_id)).join("."))(e);var r;a.open_tab((r={referrer:t,fileIds:n},new o.URI({scheme:"https",authority:"www.dropbox.com",path:`${Gt}${Yt}`,query:r}).toString()))},Qt=e=>{const t={audio:0,document:0,image:0,other:0,video:0};return e.forEach((e=>{const n=a.file_extension(a.filename(e.fq_path)),r=a.ExtensionCategories[n].toLowerCase();r in t?t[r]++:t.other++})),t};a.injectInternalStyle("metaserver/static/js/extensions/split_share_button_component.module.out.css",(e=>"._docsend_tooltip_image_x0mff_1{height:98px;width:157px}._docsend_lightbulb_icon_x0mff_6{color:var(--color__attention__text);height:14px;width:16px}._docsend_badge_x0mff_12{background:var(--color__attention__background);height:18px;width:26px}._button-wrapper_x0mff_18{display:flex;white-space:nowrap}._button-wrapper_x0mff_18._invisible_x0mff_23{display:none}._share-fake-split-button_x0mff_27>.extensions-split-share__share-button{margin-right:1px}._unportaled-menu_x0mff_31{white-space:nowrap}"));const en="_docsend_tooltip_image_x0mff_1",tn="_docsend_lightbulb_icon_x0mff_6",nn="_docsend_badge_x0mff_12",an="_button-wrapper_x0mff_18",rn="_invisible_x0mff_23",on="_share-fake-split-button_x0mff_27",sn="_unportaled-menu_x0mff_31",ln=a.getStore(),cn=o.React$1.forwardRef(((e,t)=>{var{openOption:r,description:s,rightAccessory:i,experimentInfo:l,fileExt:c,campaignAnchorName:d,dataTooltipId:u,onImpression:p}=e,m=n.__rest(e,["openOption","description","rightAccessory","experimentInfo","fileExt","campaignAnchorName","dataTooltipId","onImpression"]);let h;return h=r.iconElement?r.iconElement:r.iconUrl?o.React$1.createElement("img",{alt:"",src:r.iconUrl,width:24,height:24}):null,o.React$1.useEffect((()=>{"docsend_analytics_add_on"===(null==l?void 0:l.experimentName)&&a.ProEventsLogger.log(`docsend_analytics_add_on_${l.variant}`,{entryPoint:"split_share_menu",fileExt:c}),null==p||p()}),[]),o.React$1.createElement(a.Menu.ActionItem,Object.assign({value:r,withLeftAccessory:h,withSubtitle:s,withRightAccessory:i,"data-testid":r?`split-share-menu-action-${r.userAction}`:"","data-campaigns-element-id":d,"data-tooltip":u,ref:t},m),r.text)}));cn.displayName="MenuContentItem";class dn extends o.React$1.Component{constructor(t){super(t),this.preloadCampaignMenuItemAssets=()=>{new Promise((function(t,n){e(["./c_campaign_formats_menu_campaign_menu_item"],t,n)}))},this.handleClickShare=e=>{e.preventDefault(),this.props.onShowShare(),this.props.logShareButtonClick&&this.props.logShareButtonClick(this.props.renderMenuOnly?a.ActionSourceValue.OVERFLOW_MENU:a.ActionSourceValue.SPLIT_SHARE),this.currentSession&&this.currentSession.event("click_share",{trigger_type:this.props.triggerType}),e.stopPropagation()},this.handleSelectAction=e=>{e.handler()},this.logSelectActionOverflowMenu=(e,t)=>{var n,r;this.props.logShareButtonClick&&this.props.logShareButtonClick(this.props.renderMenuOnly?a.ActionSourceValue.OVERFLOW_MENU:a.ActionSourceValue.SPLIT_SHARE,e),null===(r=(n=this.props).previewsLogUserAction)||void 0===r||r.call(n,e,this.props.renderMenuOnly?a.ActionSourceValue.OVERFLOW_MENU:a.ActionSourceValue.SPLIT_SHARE),g.logEvent(this.currentSession,"select_action",{type:t,trigger_type:this.props.triggerType})},this.handlePreventMouseDown=e=>{e.preventDefault(),this.state.tooltipState===Ft.BIG_ONBOARDING_TOOLTIP&&(this.markSplitShareTooltipViewed(),this.setState({tooltipState:Ft.NO_TOOLTIP})),e.stopPropagation()},this.handlePopoverHover=()=>{this.currentSession&&this.currentSession.event("popover_trigger_hover",{trigger_type:this.props.triggerType})},this.handleShareHover=()=>{this.currentSession&&this.currentSession.event("share_hover",{trigger_type:this.props.triggerType})},this.handlePopoverToggle=({isOpen:e})=>{const{onDropdownOpen:t,onDropdownClose:n,triggerType:r}=this.props;e&&t?t():!e&&n&&n(),this.currentSession&&this.currentSession.event(e?"open_popover":"close_popover",{trigger_type:r}),a.logEvent(T.PAP_Select_ShareMenu({actionSurface:"browse_screen"}))},this.handleUploadToCanvas=(t,a,r)=>{const{refreshSharingServiceInfo:o,sharingServiceInfo:s,landingPageEnabled:i}=this.props;s&&o&&function(t,a,r,o,s,i,l){Bt(t,a,r,"canvas",s,i).then((a=>n.__awaiter(this,void 0,void 0,(function*(){if(a){l&&l();const{showUploadToCanvasModal:n}=yield new Promise((function(t,n){e(["./c_integrations_canvas_upload_to_canvas"],t,n)}));n(t,o)}}))))}(a,s,o,t,"split_share_button",i,r)},this.handleUpdateLinkState=(e,t)=>{const{updateLinkState:n}=this.props;n({actionId:e,linkState:t})},this.handleAppAction=(e,t,n)=>{const{context:a,featureFlags:r}=this.props,o=e.map((e=>e));_.redirectToActionOrShowAuth(t,o,n,r,a,this.handleUpdateLinkState,this.handleShareAction),g.logEvent(this.currentSession,"select_action",g.getAppActionExtras(n))},this.handleShareAction=(e,t,n)=>{R.logBrowseTTS("share_with_external_app");const a=n.handler.service_type[".tag"],r={".tag":"profile_linked"},o=()=>{this.handleUpdateLinkState(n.id,r),_.authorizeNoRedirect(e,n.id)};if("canvas"===a)return this.handleUploadToCanvas(t,e,o)},this.getAppActionIconUrl=e=>{const{icon:t}=e;return t&&t.url&&!t.is_static?t.url:o.static_url("/static/metaserver/static/images/generic_app_icon-vflIPYT1H.png")},this.getAppActionOpenOptionActions=({handler:e})=>{if("profile_service"!==e[".tag"])return{type:g.OpenButtonAction.APP_ACTION,userAction:a.UserAction.ShareToAction};e.service_type[".tag"];return{type:g.OpenButtonAction.APP_ACTION,userAction:a.UserAction.ShareToAction}},this.handleHellosignDeepIntegrationLaunch=(t,n,a,r)=>new Promise((function(t,n){e(["./c_integrations_hellosign_deep_integration_launcher"],t,n)})).then((({getLauncher:e})=>{const o=e();return o.init({entryPoint:r||"share_menu",file:t,user:n,source:a}),o})).then((e=>(e.launch(),e))),this.getHellosignOpenOption=(e,t)=>{const n=i.intl.formatMessage({id:"KPapIP",defaultMessage:"Send for signature"});return{handler:(n,r)=>{this.handleHellosignDeepIntegrationLaunch(e,t,n,r),this.logSelectActionOverflowMenu(a.UserAction.SendForSignatureAction,g.OpenButtonAction.PREPARE_FOR_SIGNATURE)},iconElement:o.React$1.createElement(a.UIIcon,{src:a.SendLine}),spriteName:null,text:n,type:g.OpenButtonAction.PREPARE_FOR_SIGNATURE,userAction:a.UserAction.SendForSignatureAction}},this.handleShareWithAnalytics=(e,t,n,r,o)=>{a.ProEventsLogger.log(`docsend_analytics_add_on_${n}_click`,{entryPoint:"split_share_menu",fileExt:o}),this.logSelectActionOverflowMenu(a.UserAction.ShareWithAnalytics,g.OpenButtonAction.SHARE_WITH_ANALYTICS),"browse"===this.props.retrievalSource&&a.logEvent(a.PAP_NavigateTo_Docsend({actionSurface:"browse_screen",destinationSurface:"docsend_create_link_screen"})),r.useDocSendHub?It(t,e.file_id):k.showDocsendModal({fileId:e.file_id,fileName:a.filename(e.fq_path),filePath:a.parent_dir(e.fq_path),user:t,stormcrowVariant:n,entryPoint:"split_share_menu"})},this.getAppActionOpenOption=(e,t,n,a={})=>{const{type:r,userAction:o}=this.getAppActionOpenOptionActions(n);return Object.assign({handler:()=>{this.handleAppAction(e,t,n),this.logSelectActionOverflowMenu(o,r)},spriteName:null,text:n.description,type:r,userAction:o,iconUrl:this.getAppActionIconUrl(n)},a)},this.getDocSendOpenOption=(e,t,n,r={},o,s,i)=>{const{type:l,userAction:c}=this.getAppActionOpenOptionActions(n);return Object.assign({handler:()=>{this.handleAppAction(e,t,n),this.logSelectActionOverflowMenu(c,l);const{useDocSendHub:r}=d.getDocsendAnalyticsAddOnConfig(this.props.user,this.props.featureFlags.docsendAnalyticsAddOn);N(P(r?"docsend_hub":"docsend_standalone")),s&&a.logEvent({class:"onboard",action:"click",object:"core_act_docsend_advanced_sharing_split_share_menu",properties:{experimentVariant:i}}),o&&($.setHasConfirmedDocsendSplitShareItemInUserMetadata(this.props.user.id),ln.dispatch(a.setDocsendAdvancedSharingHasConfirmedSplitShareMenu({docsendAdvancedSharingHasConfirmedSplitShareMenu:!0}))),"browse"===this.props.retrievalSource&&a.logEvent(a.PAP_NavigateTo_Docsend({destinationSurface:"docsend_create_link_screen",actionSurface:"browse_screen"}))},spriteName:null,text:n.description,type:l,userAction:c,iconUrl:this.getAppActionIconUrl(n)},r)},this.getMoreAppsOpenOption=(e,t)=>({handler:()=>{this.handleMoreApps(e,t),g.logEvent(this.currentSession,"select_show_more",{}),this.logSelectActionOverflowMenu(a.UserAction.OpenMoreApps,g.OpenButtonAction.OPEN_MORE_APPS)},text:i.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}),type:g.OpenButtonAction.OPEN_MORE_APPS,userAction:a.UserAction.OpenMoreApps,spriteName:null,iconElement:o.React$1.createElement(a.UIIcon,{src:a.AddCircleLine})}),this.getAddAppsOpenOption=(e,t)=>({handler:()=>{this.handleMoreApps(e,t),g.logEvent(this.currentSession,"select_add_apps",{}),this.logSelectActionOverflowMenu(a.UserAction.OpenAddApps,g.OpenButtonAction.OPEN_ADD_APPS)},text:i.intl.formatMessage({id:"XFA09U",defaultMessage:"Connect apps"}),type:g.OpenButtonAction.OPEN_ADD_APPS,userAction:a.UserAction.OpenAddApps,spriteName:null,iconElement:o.React$1.createElement(a.UIIcon,{src:a.AddCircleLine})}),this.getAppCenterLinkOpenOption=()=>({handler:()=>{g.logEvent(this.currentSession,"select_show_more",{}),this.logSelectActionOverflowMenu(a.UserAction.OpenMoreApps,g.OpenButtonAction.OPEN_MORE_APPS),a.open_tab(new o.URI({path:"/apps"}))},text:i.intl.formatMessage({id:"Gevpqz",defaultMessage:"Connect more apps"}),type:g.OpenButtonAction.OPEN_MORE_APPS,userAction:a.UserAction.OpenMoreApps,spriteName:null,iconElement:o.React$1.createElement(a.UIIcon,{src:a.AddCircleLine})}),this.handleMoreApps=(e,t)=>{const{appActions:n,featureFlags:a,context:r,categoryInfo:o}=this.props,s=_.getCategoryIdToInfos(o);_.showExtensionsMiniDirectoryModal(i.intl.formatMessage({id:"A7cFjC",defaultMessage:"Share with these apps"}),t,e,n.filter((e=>![g.TRANSFER_FP_APP_ID].includes(e.app_id))).sort(g.actionCompareFn),s,a,this.handleUpdateLinkState,r,this.currentSession,this.handleShareAction)},this.computeReferrer=e=>{const t=this.props.renderMenuOnly?a.ActionSourceValue.OVERFLOW_MENU:a.ActionSourceValue.SPLIT_SHARE;return _.computeSplitShareMenuReferrer(e,t,this.props.retrievalSource)},this.handleAddToTransfer=(t,a,r)=>{const{fileTransfersModalExp:o}=this.props.featureFlags;"ON"===o?((t,a,r)=>{n.__awaiter(void 0,void 0,void 0,(function*(){const{showTransferModal:n}=yield new Promise((function(t,n){e(["./c_containers_transfer_modal"],t,n)}));return n(t,a,r)}))})(r,t,a):w.asyncShowBrowseEntryPointOnboardingModal({primaryActionOnClick:()=>x.redirectToCreateTransferWithFiles(t,a),userId:r.id})},this.handleSellWithShop=(t,a,r,o)=>{var s;(({files:e,referrer:t,experimentVariant:n="OFF"})=>{const a=Qt(e);Ht({class:"commerce_web_entry_points",action:"click",object:"split_share_menu_item",properties:{isDropboxer:Wt(),commerceTotalAudioFilesAdded:a.audio,commerceTotalImageFilesAdded:a.image,commerceTotalSsrDocFilesAdded:a.document,commerceTotalVideoFilesAdded:a.video,commerceTotalOtherFilesAdded:a.other,commerceWebEntryPointLocation:t,experimentVariant:n}})})({files:t,referrer:a,experimentVariant:o}),r?(s=t,n.__awaiter(void 0,void 0,void 0,(function*(){const{showSellACopyModal:t}=yield new Promise((function(t,n){e(["./c_commerce_components_sell_a_copy_modal"],t,n)}));return t(s)}))):Jt(t,a)},this.shouldShowReplayOpenOption=e=>{const t=a.file_extension(a.filename(e.fq_path)),n=a.ExtensionCategories[t];return"VIDEO"===n||"AUDIO"===n||"IMAGE"===n},this.getReplayOpenOption=e=>({handler:()=>{const t=`https://replay.dropbox.com/project/creating/${e}?creationSource=dropbox_share_action`;window.open(t),this.logSelectActionOverflowMenu(a.UserAction.OpenInReplay,g.OpenButtonAction.OPEN_IN_REPLAY),"browse"===this.props.retrievalSource&&a.logEvent(a.PAP_NavigateTo_Replay({destinationSurface:"replay_preview",actionSurface:"browse_screen"}))},spriteName:null,text:i.intl.formatMessage({id:"lOEIzZ",defaultMessage:"Get feedback"}),type:g.OpenButtonAction.OPEN_IN_REPLAY,userAction:a.UserAction.OpenInReplay,iconElement:o.React$1.createElement(a.UIIcon,{src:a.DropboxReplayLine})}),this.getPublishOption=(e,t,n)=>({handler:()=>{const r=a.file_extension(a.filename(t.fq_path)),o=a.ExtensionCategories[r];!o||"IMAGE"!==o&&"VIDEO"!==o||a.logEvent(F.PAP_Select_PublishEntrypoint({publishItemType:"IMAGE"===o?"image":"video",publishEntrypointLocation:void 0===n?"previews_share_dropdown":"browse_share_dropdown"})),D.showPublishModal(e,t)},spriteName:null,text:i.intl.formatMessage({id:"u+gDFt",defaultMessage:"Publish to social"}),type:g.OpenButtonAction.PUBLISH_TO_SOCIAL,userAction:a.UserAction.PublishToSocial,iconElement:o.React$1.createElement(a.UIIcon,{src:a.RocketLine})}),this.getShareWithEmailOpenOption=()=>{const{onShowShare:e}=this.props;return{handler:()=>{e(),this.logSelectActionOverflowMenu(a.UserAction.InviteViaEmail,g.OpenButtonAction.INVITE_VIA_EMAIL)},spriteName:null,text:i.intl.formatMessage({id:"8U/qbn",defaultMessage:"Share with Dropbox"}),type:g.OpenButtonAction.INVITE_VIA_EMAIL,userAction:a.UserAction.InviteViaEmail,iconElement:o.React$1.createElement(a.UIIcon,{className:"test-id-share-dig-icon",src:a.ShareArrowLine})}},this.getShareWithCollectionOptions=e=>({handler:()=>{e(),this.logSelectActionOverflowMenu(a.UserAction.ShareWithCollection,g.OpenButtonAction.SHARE_WITH_COLLECTION)},spriteName:null,text:i.intl.formatMessage({id:"wBdEdI",defaultMessage:"Send as a collection"}),type:g.OpenButtonAction.SHARE_WITH_COLLECTION,userAction:a.UserAction.ShareWithCollection,iconElement:o.React$1.createElement(a.UIIcon,{src:a.CollectionLine})}),this.getTransferOpenOptions=e=>({handler:()=>{e(),this.logSelectActionOverflowMenu(a.UserAction.Transfer,g.OpenButtonAction.TRANSFER)},spriteName:null,text:i.intl.formatMessage({id:"3MahuB",defaultMessage:"Send a copy"}),type:g.OpenButtonAction.TRANSFER,userAction:a.UserAction.Transfer,iconElement:o.React$1.createElement(a.UIIcon,{src:a.DropboxTransferLine})}),this.getShopOpenOptions=e=>({handler:e,spriteName:null,text:i.intl.formatMessage({id:"7UOMXW",defaultMessage:"Sell a copy"}),type:g.OpenButtonAction.SELL_WITH_SHOP,userAction:a.UserAction.SellWithShop,iconElement:o.React$1.createElement(a.UIIcon,{src:a.TagLine})}),this.getPopoverTriggerRenderer=(e,t)=>t=>{const{isVisible:n,variant:r}=this.props,s=Object.assign({className:a.cx("extensions-split-share-menu__trigger",a.OA_PULSAR_CLASS,a.OAPulsarAction.SHARE_FILE),tabIndex:n?void 0:-1,onMouseEnter:this.handlePopoverHover,"aria-label":i.intl.formatMessage({id:"5MpLpV",defaultMessage:"Expand share menu"}),"data-testid":"share-menu-dropdown"},t);return e?o.React$1.createElement(a.Button$1,Object.assign({},s,{withIconLeft:o.React$1.createElement(a.UIIcon,{src:a.ShareArrowLine,className:"extensions-split-share--icon"}),variant:r,withDropdownIcon:!0}),i.intl.formatMessage({id:"DHK0zq",defaultMessage:"Share all selected"})):o.React$1.createElement(a.Button$1,Object.assign({},s,{variant:r,withDropdownIcon:!0,_hasSquaredSize:!0}))},this.renderPopoverItems=()=>{const{user:e,files:t,appActions:s,nonHellosignAppActions:l,featureFlags:{docsendAnalyticsAddOn:c,hellosignDeepIntegration:u,dndSplitShare:p,fileTransfersAppAction:m,replayDropboxShareActionExp:h,commerceDeprecationM1Enabled:_,commerceSellerFeaturesEnabled:f,commerceSellACopyExperiment:v,shareWithCollection:b,coreActDocsendAdvancedSharing:y,publishShareEntrypointEnabled:E},isSendForSignatureEnabled:S}=this.props,w=1===t.length,O=t[0],R=t.map((e=>e)),k=this.computeReferrer(R),T="DEEP_INTEGRATION"===u&&!A.is_supported_mobile_browser(),$=w&&a.isHellosignFileByExtension(g.getFileExt(Object.assign(Object.assign({},O),{bytes:0})));let D=null,F=s;if(T&&$&&S){F=l;const t=this.getHellosignOpenOption(O,e);D=o.React$1.createElement(cn,{openOption:t})}const L=a.file_extension(a.filename(O.fq_path)),V=d.getDocsendAnalyticsAddOnConfig(e,c),B=w&&V.isSupportedFile(O.bytes,L),U=this.userEligibilityOnDocSendAdvanceCampaign(),j=U||"CONTROL"===y&&!A.is_supported_mobile_browser();let H=null;if("ON"===p&&!V.splitShare.removeDocsendAppAction){const n=F.find((e=>e.app_id===a.DOCSEND_PROD_APP_ID));if(n){F=F.filter((e=>e.app_id!==a.DOCSEND_PROD_APP_ID));const r=this.getDocSendOpenOption(t,e,n,{text:V.splitShare.moveDocsendEntryPoint?i.intl.formatMessage({id:"oziSoO",defaultMessage:"Send with DocSend"}):i.intl.formatMessage({id:"r4C3UE",defaultMessage:"Send and track"})},U,j,y);let s;V.splitShare.logExposure&&B&&(s={experimentName:"docsend_analytics_add_on",variant:V.variantForLogging});const l=o.static_url("/static/metaserver/static/js/extensions/assets/DocsendTootltipImage-vflti6T_M.png"),c=i.intl.formatMessage({id:"WX5xac",defaultMessage:"Secure sharing and analytics to help win new clients"});let d=null;const u=o.React$1.createRef();let p=null;U&&(p=o.React$1.createElement(a.AccessoryBadge,{"data-testid":"core_act_docsend_advanced_sharing_badge",className:nn},o.React$1.createElement(a.UIIcon,{className:tn,src:a.LightbulbPictogram})),d=o.React$1.createElement(a.Tooltip.Control,{variant:"rich",open:this.state.showDocsendAdvanceCampaignTooltip,triggerRef:u,auto:!0,placement:"left","data-testid":"core_act_docsend_advanced_sharing_tooltip"},o.React$1.createElement("div",{style:{width:"157px"}},o.React$1.createElement("img",{src:l,className:en,alt:""}),c))),H=o.React$1.createElement("div",{ref:u,onMouseEnter:()=>this.setState({showDocsendAdvanceCampaignTooltip:!0}),onMouseLeave:()=>this.setState({showDocsendAdvanceCampaignTooltip:!1})},d,o.React$1.createElement(cn,{"data-testid":n.app_id,key:r.text,openOption:r,experimentInfo:s,fileExt:L,rightAccessory:p,onImpression:()=>{U&&this.onImpressionDocSendAdvanceCampaign()}}))}}V.splitShare.removeDocsendAppAction&&(F=F.filter((e=>e.app_id!==a.DOCSEND_PROD_APP_ID)));let W=null;if(V.splitShare.showMenuItem&&B){const t=V.useDocSendHub?"docsend_hub":"docsend_standalone",n={handler:()=>{N(P(t)),this.handleShareWithAnalytics(O,e,V.variantForLogging,V,L)},spriteName:null,text:i.intl.formatMessage({id:"yP4n16",defaultMessage:"Send and track"}),type:g.OpenButtonAction.SHARE_WITH_ANALYTICS,userAction:a.UserAction.ShareWithAnalytics,iconElement:o.React$1.createElement(a.UIIcon,{src:a.AnalyticsLine})},r=V.useDocSendHub?i.intl.formatMessage({id:"JcBW5w",defaultMessage:"New"}):i.intl.formatMessage({id:"QT7EnD",defaultMessage:"Beta"});W=o.React$1.createElement(a.Tooltip,{title:i.intl.formatMessage({id:"iZTVjV",defaultMessage:"Get viewer insights for the files you share using Dropbox"}),placement:"left"},o.React$1.createElement(cn,{"data-testid":"analytics-add-on-menu-item",key:n.text,openOption:n,experimentInfo:{experimentName:"docsend_analytics_add_on",variant:V.variantForLogging},rightAccessory:o.React$1.createElement(a.AccessoryBadge,null,r),fileExt:L,onImpression:()=>N((e=>({class:"docsend",action:"shown",object:"docsend_hub_entry_button",properties:{docsendHubEntryButtonTarget:e}}))(t))}))}const z=F.find((e=>e.app_id===g.TRANSFER_FP_APP_ID)),q=x.shouldShowTransferInSplitShare(!!z||"ON"===m,R),G="V1"===b&&((Y=R).length>1&&Y.length<C.MAX_ITEMS_IN_COLLECTION&&!Y.some((e=>e.is_dir)));var Y;const X=()=>{(e=>{n.__awaiter(void 0,void 0,void 0,(function*(){try{a.Snackbar.sync(i.intl.formatMessage({id:"cPT7lZ",defaultMessage:"Creating your collection…"}),!0,"share-with-collection"),C.logEntryPointNewCollection("share_with_collection",e.length);const{id:t,sharingInfo:n}=yield C.createCollection(`${e.length} files`,{shared_link_info:{link_type:{".tag":"view"},link_settings:{allow_download:!0,audience:{".tag":"public"}}}});yield C.addFilesToCollection(t,C.mapFileIdsToFileIdentifiers(e.map((e=>e.file_id))));let r=i.intl.formatMessage({id:"thkRGH",defaultMessage:"The link to the collection was copied to your clipboard."});const o=`${C.COLLECTIONS_PAGE_BASENAME}/${t}?share=1`;a.browserRedirectWrapper(o);try{yield navigator.clipboard.writeText(n.viewLink.url)}catch(e){r=i.intl.formatMessage({id:"lyObby",defaultMessage:"The link to the collection has been created. You can share the collection by copying it."})}a.Snackbar.complete(r,"share-with-collection")}catch(e){return void a.Snackbar.fail(i.intl.formatMessage({id:"F/SGkz",defaultMessage:"Couldn’t create the collection, but you can try again later."}),"share-with-collection")}}))})(R)},Z=()=>this.handleAddToTransfer(R,k,e),K=((e,t)=>{const n=t.every((e=>{const t=a.file_extension(a.filename(e.fq_path)),n=a.ExtensionCategories[t];return"VIDEO"===n||"AUDIO"===n||"IMAGE"===n||"pdf"===t}));return e&&t.length>0&&n&&!A.is_mobile_or_tablet()})("ON"===f&&"ON"!==_,R),J="ON"===v,Q="ON"===E&&(()=>{if("fq_path"in O){const e=a.ExtensionCategories[L];return"VIDEO"===e||"IMAGE"===e}return!1})()&&w,{installedActions:ee,unpromotedActions:te}=g.partitionActions(F),ne=Boolean(w),ae=ne||Boolean(q)||Boolean(H)||Boolean(D)||Boolean(K)||Boolean(G)||Boolean(Q),re=V.splitShare.moveDocsendEntryPoint,oe=(!r.isEmpty(te)||!r.isEmpty(ee)||!ae||re&&H)&&o.React$1.createElement(a.Menu.Segment,null,re?H:null,ee.map((n=>{const a=this.getAppActionOpenOption(t,e,n);return o.React$1.createElement(cn,{"data-testId":n.app_id,key:a.text,openOption:a})})),!r.isEmpty(te)&&w?o.React$1.createElement(cn,{openOption:r.isEmpty(ee)?this.getAddAppsOpenOption(O,e):this.getMoreAppsOpenOption(O,e)}):!ae&&r.isEmpty(ee)&&o.React$1.createElement(cn,{openOption:this.getAppCenterLinkOpenOption()}));return o.React$1.createElement(o.reactExports.Fragment,null,ae&&o.React$1.createElement(a.Menu.Segment,null,ne&&o.React$1.createElement(cn,{campaignAnchorName:M.CampaignsElementIdEnum.BROWSE_VIEW_RIGHT_PANEL_SHARE_WITH_DROPBOX_BUTTON,openOption:this.getShareWithEmailOpenOption()}),Q&&o.React$1.createElement(cn,{openOption:this.getPublishOption(this.props.user,O,this.props.retrievalSource),campaignAnchorName:M.CampaignsElementIdEnum.PUBLISH_SHARE_DROPDOWN_ENTRYPOINT,rightAccessory:o.React$1.createElement(a.AccessoryBadge,null,i.intl.formatMessage({id:"LlL5Qr",defaultMessage:"New"})),onImpression:()=>{const e=a.ExtensionCategories[L];!e||"IMAGE"!==e&&"VIDEO"!==e||a.logEvent(I.PAP_Shown_PublishEntrypoint({publishItemType:"IMAGE"===e?"image":"video",publishEntrypointLocation:void 0===this.props.retrievalSource?"previews_share_dropdown":"browse_share_dropdown"}))}}),W,"ON"===h&&w&&this.shouldShowReplayOpenOption(O)&&o.React$1.createElement(cn,{openOption:this.getReplayOpenOption(O.file_id),rightAccessory:o.React$1.createElement(a.AccessoryBadge,null,i.intl.formatMessage({id:"LlL5Qr",defaultMessage:"New"}))}),q&&Z&&o.React$1.createElement(cn,{campaignAnchorName:M.CampaignsElementIdEnum.BROWSE_VIEW_RIGHT_PANEL_SEND_A_COPY_BUTTON,dataTooltipId:"split-share-menu-transfer-menu-item",openOption:this.getTransferOpenOptions(Z)}),D,re?null:H,K&&o.React$1.createElement(cn,{openOption:this.getShopOpenOptions((()=>{this.handleSellWithShop(R,k,J,v),this.logSelectActionOverflowMenu(a.UserAction.SellWithShop,g.OpenButtonAction.SELL_WITH_SHOP)})),onImpression:()=>(({files:e,referrer:t,experimentVariant:n="OFF"})=>{const a=Qt(e);Ht({class:"commerce_web_entry_points",action:"shown",object:"split_share_menu_item",properties:{isDropboxer:Wt(),commerceTotalAudioFilesAdded:a.audio,commerceTotalImageFilesAdded:a.image,commerceTotalSsrDocFilesAdded:a.document,commerceTotalVideoFilesAdded:a.video,commerceTotalOtherFilesAdded:a.other,commerceWebEntryPointLocation:t,experimentVariant:n}})})({files:R,referrer:k,experimentVariant:v})}),G&&o.React$1.createElement(cn,{openOption:(()=>this.getShareWithCollectionOptions(X))()})),oe)},this.markSplitShareTooltipViewed=()=>{a.markTooltipViewed(this.props.user.id,"split_share_edu")},this.state={tooltipState:Ft.NO_TOOLTIP,showDocsendAdvanceCampaignTooltip:!1},this.telemetryClient=_.createTelemetryClient(Object.assign({component:"split-share-btn"},t.context)),this.onboardingChecklistShareButtonTooltipTriggerRef=o.React$1.createRef()}componentDidMount(){this.props.showEduTooltip&&this.setEduTooltip(),this.preloadCampaignMenuItemAssets(),this.preloadDocSendHubWelcomeModal()}preloadDocSendHubWelcomeModal(){d.getDocsendAnalyticsAddOnConfig(this.props.user,this.props.featureFlags.docsendAnalyticsAddOn).useDocSendHub&&V(this.props.user.id)}userEligibilityOnDocSendAdvanceCampaign(){const{docsendAdvancedSharingHasOpenedSharingSettings:e,docsendAdvancedSharingHasConfirmedSplitShareMenu:t,docsendAdvancedSharingHasShared:n,docsendAdvancedSharingHasSeenShareModal:a,featureFlags:{coreActDocsendAdvancedSharing:r}}=this.props;return"V1"===r&&(e&&n&&!t&&!a&&!A.is_supported_mobile_browser())}onImpressionDocSendAdvanceCampaign(){const{featureFlags:{coreActDocsendAdvancedSharing:e}}=this.props;"V1"===e&&a.logEvent({class:"onboard",action:"shown",object:"core_act_docsend_advanced_sharing_split_share_menu",properties:{experimentVariant:e}})}setEduTooltip(){return n.__awaiter(this,void 0,void 0,(function*(){const e=yield a.getTooltipHistory(this.props.user.id,["open_with_edu","split_share_edu"]),t=this.props.files[0];"split_share_edu"===a.allowedTooltips(this.props.appActions.length>0,t.fq_path?"."+a.file_extension(a.filename(t.fq_path)):"",this.props.featureFlags).find((t=>void 0!==e[t]&&!e[t]))&&this.setState({tooltipState:Ft.BIG_ONBOARDING_TOOLTIP})}))}render(){const{files:e,context:t,isVisible:n,shareButtonLabel:s,triggerType:i,shouldUsePortalPopover:l,appActions:c,featureFlags:d,showLeftDigIcon:u,variant:p,renderMenuOnly:m,expActionBarRedesignEnabled:h}=this.props,f=1===e.length,v=e[0];t?this.currentSession=this.telemetryClient.session({ext:_.getPiiSafeExtension(v?"."+a.file_extension(a.filename(v.fq_path)):"")}):delete this.currentSession;const b={"aria-label":s,className:a.cx(a.OA_PULSAR_CLASS,a.OAPulsarAction.SHARE_FILE,"extensions-split-share__share-button",{"primary-action-menu__button":i===a.TriggerType.SidebarPrimaryButton}),onClick:this.handleClickShare,tabIndex:n?void 0:-1,onMouseEnter:this.handleShareHover},y=o.React$1.createElement(a.Button$1,Object.assign({},b,{withIconLeft:u&&o.React$1.createElement(a.UIIcon,{src:a.ShareArrowLine,className:"extensions-split-share--icon"}),variant:p,"data-testid":"share-button"}),o.React$1.createElement(a.UserEducationEffect,{containerName:"SplitShareButton",name:"ShareButtonLabel",useSpan:!0},s)),E=this.getPopoverTriggerRenderer(!f,s),S=f&&"DEEP_INTEGRATION"===d.hellosignDeepIntegration&&a.isHellosignFileByExtension(g.getFileExt(Object.assign(Object.assign({},v),{bytes:0})))&&!A.is_supported_mobile_browser();return m?this.renderPopoverItems():o.React$1.createElement("div",{className:a.cx(an,"extensions-split-share-btn",{[rn]:!n,"hellosign-available":S,[on]:!r.isEmpty(c)}),ref:this.onboardingChecklistShareButtonTooltipTriggerRef},f&&y,o.React$1.createElement(O.AsyncOnboardingChecklistShareButtonTooltip,{triggerRef:this.onboardingChecklistShareButtonTooltipTriggerRef}),o.React$1.createElement(a.Menu.Wrapper,{className:a.cx("extensions-split-share__popover",{"hellosign-available-dropdown":S,[sn]:!l,"down-arrow-share-button-prompt-select":!0}),onClick:this.handlePreventMouseDown,onDoubleClick:this.handlePreventMouseDown,onSelection:this.handleSelectAction,onToggle:this.handlePopoverToggle,closeOnSelection:!0,isPortaled:l,"data-campaigns-element-id":M.CampaignsElementIdEnum.BROWSE_VIEW_RIGHT_PANEL_SHARE_DROPDOWN_BUTTON,"data-tooltip":"split-share-menu"},(({getContentProps:e,getTriggerProps:t})=>o.React$1.createElement(o.React$1.Fragment,null,E(t()),o.React$1.createElement(a.Menu.Content,Object.assign({placement:"bottom-end",className:h?"rc-action-bar-submenu-content":""},e()),this.renderPopoverItems())))))}}dn.defaultProps={isVisible:!0,shareButtonLabel:i.intl.formatMessage({id:"TFeNOo",defaultMessage:"Share"}),triggerType:a.TriggerType.PrimaryButton,variant:"opacity"},dn.displayName="SplitShareButtonComponent";const un={refreshSharingServiceInfo:a.refreshSharingServiceInfoAdapter,updateLinkState:a.updateLinkState},pn=a.connect(((e,t)=>{const n=t.files.map((e=>Object.assign(Object.assign({},e),{bytes:0})));return{appActions:g.getShareActionsForFiles(e,n),nonHellosignAppActions:g.getNonHellosignActionsForFiles(e,n,a.HELLOSIGN_PROD_APP_ID),categoryInfo:g.getCategoryInfos(e),featureFlags:g.getFeatureFlags(e),sharingServiceInfo:g.getSharingServiceInfoAdapter(e),landingPageEnabled:h.isConnectServiceLandingPagesEnabled(e),isSendForSignatureEnabled:h.isSendForSignatureEnabled(e),docsendAdvancedSharingHasOpenedSharingSettings:g.getDocsendAdvancedSharingHasOpenedSharingSettings(e),docsendAdvancedSharingHasShared:g.getDocsendAdvancedSharingHasShared(e),docsendAdvancedSharingHasSeenShareModal:g.getDocsendAdvancedSharingHasSeenShareModal(e),docsendAdvancedSharingHasConfirmedSplitShareMenu:g.getDocsendAdvancedSharingHasConfirmedSplitShareMenu(e)}}),un)(dn),mn=a.requireCssWithComponent(pn,["/static/metaserver/static/css/app_actions/index-vflnoIMoQ.css"]);var hn=Object.freeze({__proto__:null,SplitShareButton:mn,SplitShareButtonComponent:dn});t.COMMERCE_CREATE_LISTING="COMMERCE_CREATE_LISTING_PAGE",t.ORDERS_SURFACE="COMMERCE_ORDERS",t.PRODUCTS_PAGE_FULL_PATH=Xt,t.SELLER_DASHBOARD_SURFACE="SELLER_DASHBOARD",t.SELL_A_COPY_SURFACE="COMMERCE_SELL_A_COPY",t.chunkArray=function(e,t){t<1&&(t=e.length);const n=[];for(let a=0;a<e.length;a+=t)n.push(e.slice(a,a+t));return n},t.getFileAccessCountsForLogging=e=>{const t={unknown_file_access:0,downloadable_file_access:0,view_only_file_access:0,other:0,total:0};return null==e||e.forEach((e=>{const n=(e=>{var t;return(null===(t=e.access_type)||void 0===t?void 0:t[".tag"])||"other"})(e);n in t&&t[n]++,t.total++})),t},t.getFileTypesForLogging=e=>{const t={audio:0,cloud_doc:0,excel:0,html:0,image:0,linkfile:0,other:0,restricted:0,ssr_doc:0,video:0};return null==e||e.forEach((e=>{(null==e?void 0:e.type)&&(null==e?void 0:e.type)in t?t[null==e?void 0:e.type]++:t.other++})),t},t.getUserOSName=function(e){e||(e=navigator.userAgent);let t="Unknown";return-1!==e.indexOf("Win")&&(t="Windows"),-1!==e.indexOf("Mac")&&(t="Mac"),-1!==e.indexOf("Linux")&&(t="Linux"),-1!==e.indexOf("Android")&&(t="Android"),-1!==e.indexOf("like Mac")&&(t="iOS"),t},t.isDropboxer=Wt,t.isFileViewOnly=e=>{var t;return"view_only_file_access"===(null===(t=e.access_type)||void 0===t?void 0:t[".tag"])},t.isLocalFileType=function(e){return Boolean(e.destPath)},t.logEvent=jt,t.logEvent$1=Ht,t.logManageProducts=()=>{Ht({class:"commerce_web_entry_points",action:"click",object:"manage_your_products",properties:{isDropboxer:Wt()}})},t.logViewProductPage=()=>{Ht({class:"commerce_web_entry_points",action:"click",object:"view_product_page",properties:{isDropboxer:Wt()}})},t.revokeLocalFilePreviewURLs=function(){for(const[e,t]of Object.entries(qt))URL.revokeObjectURL(t),delete qt[e]},t.split_share_button_component_esnext=hn,t.toEventExtraValues=zt}));
//# sourceMappingURL=c_extensions_split_share_button_component.js-vflYzhOUe.map
