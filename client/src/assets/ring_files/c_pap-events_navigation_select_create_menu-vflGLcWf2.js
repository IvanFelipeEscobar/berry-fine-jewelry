define(["exports","./e_ui_page_files_router","./e_edison","./c_src_simple-action-bar_action_bar_types","./c_spectrum_icon_partners_index","./c_core_i18n","./c_flows_redux_store","./c_browse_tts","./c_tslib","./c_capture_sdk_helpers","./c_capture_redux_selectors","./c_capture_async_recorder","./c_core_browser_detection"],(function(e,t,o,n,a,i,r,s,c,E,l,u,d){"use strict";const m={dropbox_form:o.static_url("/static/metaserver/static/images/dropbox_form-vfl1f-v2W.svg")},p=({iconName:e,displayName:t})=>{const n=m[e];return n?o.React$1.createElement("img",{alt:t,src:n,width:"24px",height:"24px"}):o.React$1.createElement(a.IconPartners,{name:e,width:"24px",height:"24px"})};p.displayName="NewFileIcon";const _=i.intl.formatMessage({id:"8/w9ir",defaultMessage:"Create new file"}),A=i.intl.formatMessage({id:"o96TiK",defaultMessage:"Create"}),R=i.intl.formatMessage({id:"+HsOFj",defaultMessage:"Google Docs"}),T=i.intl.formatMessage({id:"cpuRML",defaultMessage:"Google Sheets"}),O=i.intl.formatMessage({id:"PcJCVL",defaultMessage:"Google Slides"}),L=i.intl.formatMessage({id:"0rYKaW",defaultMessage:"Excel Workbook"}),I=i.intl.formatMessage({id:"e9uLbL",defaultMessage:"PowerPoint Presentation"}),P=i.intl.formatMessage({id:"yY5byF",defaultMessage:"Word Document"}),g=i.intl.formatMessage({id:"neBk7u",defaultMessage:"Dropbox Paper"}),C=i.intl.formatMessage({id:"Rvv7NR",defaultMessage:"Dropbox Paper Template"}),M=i.intl.formatMessage({id:"sbO30Y",defaultMessage:"Dropbox Binder (Beta)"}),S=i.intl.formatMessage({id:"4gEt6j",defaultMessage:"Shortcut"}),f=i.defineMessage({id:"5L+krI",defaultMessage:"Automated folder"}),D=()=>{const e=o.React$1.useRef(null),a=i.useIntl(),c={nodeType:"dropdown",actionType:n.ActionBarActionTypes.CREATE,menuItem:{type:n.ActionBarActionTypes.CREATE,menuItem:n.FolderCreationAction.AUTOMATED_FOLDER}};return o.reactExports.useEffect((()=>{r.getStoreForAutomations()}),[]),o.React$1.createElement(o.React$1.Fragment,null,o.React$1.createElement(t.Menu.ActionItem,{ref:e,onClick:()=>{s.logBrowseTTS("create_automated_folder")},value:c,withLeftAccessory:o.React$1.createElement(t.UIIcon,{src:t.AutomationLine})},a.formatMessage(f)))};var F;D.displayName="CreateAutomatedFolderAction";const y="dropbox_browse",N="CAPTURE_FILES_INTEGRATION_HAS_CREATED_CAPTURES_WITH_WEB_RECORDER",b="function"==typeof(null===(F=navigator.mediaDevices)||void 0===F?void 0:F.getDisplayMedia);e.CaptureTypes=void 0,(e.CaptureTypes||(e.CaptureTypes={})).CAPTURE="webm";const v=i.defineMessage({id:"gwLhQ3",defaultMessage:"Screen recording"});var U;!function(e){e[e.FOLDER=0]="FOLDER",e[e.SHARED_FOLDER=1]="SHARED_FOLDER",e[e.TEAM_FOLDER=2]="TEAM_FOLDER",e[e.AUTOMATED_FOLDER=3]="AUTOMATED_FOLDER",e[e.PAPER=4]="PAPER",e[e.PAPER_TEMPLATE=5]="PAPER_TEMPLATE",e[e.PAPER_BINDER=6]="PAPER_BINDER",e[e.SIMPLE_POINTER=7]="SIMPLE_POINTER",e[e.MICROSOFT_WORD=8]="MICROSOFT_WORD",e[e.MICROSOFT_EXCEL=9]="MICROSOFT_EXCEL",e[e.MICROSOFT_POWERPOINT=10]="MICROSOFT_POWERPOINT",e[e.GOOGLE_DOC=11]="GOOGLE_DOC",e[e.GOOGLE_SHEET=12]="GOOGLE_SHEET",e[e.GOOGLE_SLIDE=13]="GOOGLE_SLIDE",e[e.CAPTURE_SCREEN=14]="CAPTURE_SCREEN"}(U||(U={}));const w={[U.FOLDER]:{menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:n.FolderCreationAction.FOLDER},description:i.intl.formatMessage({id:"RW4ijB",defaultMessage:"Folder"}),icon:t.FolderLine}},[U.SHARED_FOLDER]:{condition:({showSharedFolderCreate:e})=>e,menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:n.FolderCreationAction.SHARED_FOLDER},className:t.cx(t.OA_PULSAR_CLASS,t.OAPulsarAction.SHARED_FOLDER),description:i.intl.formatMessage({id:"7nnCz9",defaultMessage:"Shared folder"}),icon:t.AddFolderLine}},[U.TEAM_FOLDER]:{condition:({showTeamFolderCreate:e})=>e,menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:n.FolderCreationAction.TEAM_FOLDER},description:i.intl.formatMessage({id:"mfWC8r",defaultMessage:"New team folder"}),icon:t.TeamLine}},[U.AUTOMATED_FOLDER]:{condition:({showAutomatedFolderCreate:e})=>e,menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:n.FolderCreationAction.AUTOMATED_FOLDER},description:i.intl.formatMessage(f),icon:t.AutomationLine,menuItem:o.React$1.createElement(D,null)}},[U.PAPER]:{condition:({showPaperCreate:e})=>e,menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:t.PaperNewFileTypes.PAPER},description:g,icon:o.React$1.createElement(p,{displayName:g,iconName:"dropbox_paper"})}},[U.PAPER_TEMPLATE]:{condition:({showPaperCreate:e})=>e,menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:t.PaperNewFileTypes.PAPER_TEMPLATE},description:C,icon:o.React$1.createElement(p,{displayName:C,iconName:"dropbox_paper_template"})}},[U.PAPER_BINDER]:{condition:({showBinderCreate:e})=>e,menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:t.PaperNewFileTypes.PAPER_BINDER},description:M,icon:o.React$1.createElement(p,{displayName:M,iconName:"dropbox_paper_binder"})}},[U.SIMPLE_POINTER]:{menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:t.PointerFileTypes.SIMPLE_POINTER},description:S,icon:o.React$1.createElement(p,{displayName:S,iconName:"shortcut"})}},[U.MICROSOFT_WORD]:{menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:t.MicrosoftFileTypes.WORD},description:P,icon:o.React$1.createElement(p,{displayName:P,iconName:"microsoft_docx"})}},[U.MICROSOFT_EXCEL]:{menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:t.MicrosoftFileTypes.EXCEL},description:L,icon:o.React$1.createElement(p,{displayName:L,iconName:"microsoft_xlsx"})}},[U.MICROSOFT_POWERPOINT]:{menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:t.MicrosoftFileTypes.POWERPOINT},description:I,icon:o.React$1.createElement(p,{displayName:I,iconName:"microsoft_pptx"})}},[U.GOOGLE_DOC]:{menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:t.GoogleFileTypes.GOOGLE_DSS_DOC},description:R,icon:o.React$1.createElement(p,{displayName:R,iconName:"google_gdoc"})}},[U.GOOGLE_SHEET]:{menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:t.GoogleFileTypes.GOOGLE_DSS_SHEET},description:T,icon:o.React$1.createElement(p,{displayName:T,iconName:"google_gsheet"})}},[U.GOOGLE_SLIDE]:{menuItem:{value:{type:n.ActionBarActionTypes.CREATE,menuItem:t.GoogleFileTypes.GOOGLE_DSS_SLIDES},description:O,icon:o.React$1.createElement(p,{displayName:O,iconName:"google_gslides"})}},[U.CAPTURE_SCREEN]:{condition:({showCaptureCreate:e})=>e,menuItem:{description:i.intl.formatMessage(v),id:"action-bar-capture-sdk-recording",menuItem:o.React$1.createElement((()=>{const e=o.React$1.useRef(null),n=t.useDispatch(),a=i.useIntl(),r=t.useSelector(l.getRecorderState);return o.React$1.createElement(t.Menu.ActionItem,{ref:e,withLeftAccessory:o.React$1.createElement(t.UIIcon,{src:t.RecordScreenCameraLine}),onClick:()=>c.__awaiter(void 0,void 0,void 0,(function*(){var e;yield E.handleSafariWorkaround(),n(l.openRecorder(y,!0)),t.logWebUserAction({event_name:t.WebUserActionLogEvent.CAPTURE_SDK_FILES_MENU_SCREEN_RECORDING_CLICKED,user_id:null===(e=t.getUser())||void 0===e?void 0:e.id}),t.logEvent(t.PAP_NavigateTo_Capture({actionElement:"create_menu",actionSurface:"browse_screen",destinationSurface:"screen_recording_modal"}))})),disabled:r.active},o.React$1.createElement(t.Text,{color:r.active?"disabled":"standard"},a.formatMessage(v)))}),null),value:{type:n.ActionBarActionTypes.CAPTURE_SCREEN,menuItem:e.CaptureTypes.CAPTURE}}}},G=(e,t)=>e.map((e=>{const t=w[e],{menuItem:o}=t,n=o.description;return Object.assign(Object.assign({},t),{menuItem:Object.assign(Object.assign({},o),{description:n})})})).filter((({condition:e})=>!e||e(t))).map((({menuItem:e})=>e)),W=e=>{const{showOnlyFolderCreation:t}=e,o=(e=>({menuItems:G([U.FOLDER,U.SHARED_FOLDER,U.TEAM_FOLDER,U.AUTOMATED_FOLDER],e)}))(e).menuItems;return t||(o.push(...G([U.CAPTURE_SCREEN],e)),o.push({description:i.intl.formatMessage({id:"oKv5aq",defaultMessage:"Document"}),submenuSections:[{menuItems:G([U.PAPER,U.MICROSOFT_WORD,U.GOOGLE_DOC],e)}]},{description:i.intl.formatMessage({id:"/JpyiR",defaultMessage:"Presentation"}),submenuSections:[{menuItems:G([U.MICROSOFT_POWERPOINT,U.GOOGLE_SLIDE],e)}]},{description:i.intl.formatMessage({id:"9xjlyh",defaultMessage:"Spreadsheet"}),submenuSections:[{menuItems:G([U.MICROSOFT_EXCEL,U.GOOGLE_SHEET],e)}]}),o.push({description:i.intl.formatMessage({id:"rSeA97",defaultMessage:"More"}),submenuSections:[{menuItems:G([U.PAPER_TEMPLATE,U.PAPER_BINDER,U.SIMPLE_POINTER],e)}]})),{label:void 0,menuItems:o}};var h;e.UploadAction=void 0,(h=e.UploadAction||(e.UploadAction={})).UPLOAD_FILES="upload-files",h.UPLOAD_FOLDER="upload-folder";e.AsyncBrowseRecorder=e=>{const{isInsideMyTeamFolderTree:n,isInsideSharedFolder:a,isInsideTeamFolderTree:r,currentNSPath:s}=t.useSelector(t.context),E=t.useSelector(l.getRecorderState),d=t.useSelector(l.getUploadResult),[m,p]=o.reactExports.useState(!0),[_,A]=o.reactExports.useState(!1);o.reactExports.useEffect((()=>{c.__awaiter(void 0,void 0,void 0,(function*(){const o=(yield t.getUserMetadata([N],e.user.id))[N];p(!o)}))}),[e.user]),o.reactExports.useEffect((()=>{d&&d.source===y&&(m?(A(!0),p(!1),t.logWebUserAction({event_name:t.WebUserActionLogEvent.CAPTURE_SDK_FILES_DOWNLOAD_MODAL_SHOWN,user_id:e.user.id})):I())}),[d,e.user]);const R=()=>{t.logWebUserAction({event_name:t.WebUserActionLogEvent.CAPTURE_SDK_FILES_DOWNLOAD_CTA_CLICKED,user_id:e.user.id})},T=()=>{t.setUserMetadata({[N]:!0},e.user.id),A(!1),I()},{storagePath:O,uploadPath:L}=o.reactExports.useMemo((()=>{const o=!n&&!a&&!r,i=t.getUserRoot(t.Viewer.get_viewer(),e.user);return{storagePath:!o||null==s?`${i}/Capture`:window.location.pathname,uploadPath:o&&null!=s?s:"/Capture"}}),[n,a,r,s,e.user]),I=()=>{if(!d)return;const n=`${window.location.origin}${O}?preview=${encodeURIComponent(d.name)}`;t.Snackbar.show(o.React$1.createElement(t.Snackbar,{actionButtonText:i.intl.formatMessage({id:"g2XDDU",defaultMessage:"View recording"}),id:"capture-sdk-files-success",onActionClick:()=>{window.history.pushState({},"",n),t.logWebUserAction({event_name:t.WebUserActionLogEvent.CAPTURE_SDK_FILES_VIEW_RECORDING_CLICKED,user_id:e.user.id}),window.location.reload()},onTimeout:()=>{t.Snackbar.close("capture-sdk-files-success")},timeoutDelayMsForCompleteVariant:5e3,title:i.intl.formatMessage({id:"iZbi1W",defaultMessage:"Created {filename}"},{filename:d.name}),variant:"complete"}))};return E.active&&E.source===y?o.React$1.createElement(o.reactExports.Suspense,{fallback:null},o.React$1.createElement(u.AsyncRecorder,{source:y,uploadPath:L,user:e.user})):_?o.React$1.createElement(o.reactExports.Suspense,{fallback:null},o.React$1.createElement(u.AsyncDownloadCaptureModal,{onClose:T,onConfirm:R,open:_,source:y})):null},e.LongNewFileCreateLabel=_,e.NewFileIcon=p,e.NewGoogleDocsLabel=R,e.NewGoogleSheetsLabel=T,e.NewGoogleSlidesLabel=O,e.NewMicrosoftExcelWorkbookLabel=L,e.NewMicrosoftPowerPointPresentationLabel=I,e.NewMicrosoftWordDocLabel=P,e.NewPaperBinderDocLabel=M,e.NewPaperDocLabel=g,e.NewPaperTemplateLabel=C,e.NewSimplePointerLabel=S,e.PAP_Select_CreateMenu=function(e){return{class:"navigation",action:"select",object:"create_menu",properties:e}},e.PAP_Select_Upload=function(e){return{class:"manual_upload",action:"select",object:"upload",properties:e}},e.ShortNewFileCreateLabel=A,e.canUseRecorder=b,e.getCreateMenu=function(e){const t=[W(e)];return{type:n.ActionBarMenuType.DROPDOWN,menuSections:t}},e.getUploadMenu=function(){const a=function(){if(!d.is_input_webkitdirectory_supported())return;const a=[];return a.push({value:{type:n.ActionBarActionTypes.UPLOAD,menuItem:e.UploadAction.UPLOAD_FILES},description:i.intl.formatMessage({id:"LNFEFg",defaultMessage:"Files"}),icon:o.React$1.createElement(t.UIIcon,{src:t.UploadFileLine})},{value:{type:n.ActionBarActionTypes.UPLOAD,menuItem:e.UploadAction.UPLOAD_FOLDER},description:i.intl.formatMessage({id:"kMDxiK",defaultMessage:"Folder"}),icon:o.React$1.createElement(t.UIIcon,{src:t.UploadFolderLine})}),{menuItems:a}}();if(a)return{type:n.ActionBarMenuType.DROPDOWN,menuSections:[a]}},e.isUploadAction=t=>Boolean(t)&&Object.values(e.UploadAction).includes(t),e.newFileTypeToLogEvent=e=>{switch(e){case t.MicrosoftFileTypes.WORD:return t.WebUserActionLogEvent.FILE_CREATE_WORD;case t.MicrosoftFileTypes.EXCEL:return t.WebUserActionLogEvent.FILE_CREATE_EXCEL;case t.MicrosoftFileTypes.POWERPOINT:return t.WebUserActionLogEvent.FILE_CREATE_POWERPOINT;case t.GoogleFileTypes.GOOGLE_DSS_DOC:return t.WebUserActionLogEvent.FILE_CREATE_GOOGLE_DOC;case t.GoogleFileTypes.GOOGLE_DSS_SHEET:return t.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SHEET;case t.GoogleFileTypes.GOOGLE_DSS_SLIDES:return t.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SLIDES;case t.PaperNewFileTypes.PAPER:return t.WebUserActionLogEvent.FILE_CREATE_PAPER;case t.PaperNewFileTypes.PAPER_TEMPLATE:return t.WebUserActionLogEvent.FILE_CREATE_PAPER_TEMPLATE;case t.PaperNewFileTypes.PAPER_BINDER:return t.WebUserActionLogEvent.FILE_CREATE_BINDER;case t.PointerFileTypes.SIMPLE_POINTER:return t.WebUserActionLogEvent.FILE_CREATE_SIMPLE_POINTER}}}));
//# sourceMappingURL=c_pap-events_navigation_select_create_menu.js-vflwR2s80.map
