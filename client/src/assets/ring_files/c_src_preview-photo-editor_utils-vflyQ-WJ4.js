define(["exports","./e_ui_page_files_router","./c_folder_dialog_folder_picker","./e_edison","./c_core_i18n","./c_core_logging_constants","./c_src_preview-photo-editor_types"],(function(e,t,a,o,l,n,r){"use strict";const s=o.reactExports.createContext({filename:"",onCloseEditor:()=>{},imgSrc:"",readOnly:!0,logEvent:()=>{},logUserAction:()=>{},canEdit:!0,onOpenFeedback:()=>{}});function i(){return o.reactExports.useContext(s)}t.injectInternalStyle("metaserver/static/js/photos/ui/preview_crop_and_rotate/save-copy-modal.module.out.css",(e=>"._save-copy-modal-folder-location_14mlg_1{margin-top:10px}"));const c=({fileName:e,currentPath:r,isModalOpen:s,activeUser:c,onCloseWithoutSaving:d,onSaveACopy:u})=>{const{name:p,ext:m}=t.split_filename(e),{logUserAction:f}=i();o.React$1.useEffect((()=>{null==f||f(n.UserAction.EditVideoSaveCopyClicked)}),[]);const{saveACopyModalTitle:g,closeButtonText:v,fileNameText:_,ariaLabelNewFileNameInput:E,locationText:x,cancelButtonText:y,saveACopyButtonText:C,saveCopyDefaultFileName:M}=function(e,t){const a=l.useIntl();return{saveACopyModalTitle:a.formatMessage({id:"KLayOS",defaultMessage:"Save a copy"}),closeButtonText:a.formatMessage({id:"011TAy",defaultMessage:"Close"}),fileNameText:a.formatMessage({id:"hvxUEY",defaultMessage:"File name"}),ariaLabelNewFileNameInput:a.formatMessage({id:"pu0OCf",defaultMessage:"New name for the copy of the file"}),locationText:a.formatMessage({id:"kMtQkA",defaultMessage:"Location"}),cancelButtonText:a.formatMessage({id:"RRNZ1+",defaultMessage:"Cancel"}),saveACopyButtonText:a.formatMessage({id:"i5qoxU",defaultMessage:"Save copy"}),saveCopyDefaultFileName:a.formatMessage({id:"2VY1Rz",defaultMessage:"{name} (edited).{ext}"},{name:e,ext:t})}}(p,m),[$,h]=o.reactExports.useState(r),[R,S]=o.reactExports.useState(M),T=o.reactExports.useRef(null),k=d,N=o.reactExports.useCallback((()=>{const e="/"===$?"":"/",t=R.endsWith(m)?R:`${R}.${m}`;null==u||u($+e+t)}),[$,R,m,u]),F=o.reactExports.useCallback((e=>{h(e||"/")}),[h]);return s?o.React$1.createElement(t.Modal$1,{open:s,isCentered:!0,shouldCloseOnOverlayClick:!1,withCloseButton:v,onRequestClose:k,className:"save-copy-modal"},o.React$1.createElement(t.Modal$1.Header,{hasBottomSpacing:"title-standard"},o.React$1.createElement(t.Modal$1.Title,null,g)),o.React$1.createElement(t.Modal$1.Body,{hasVerticalSpacing:!1,className:"folder-picker-container__fixed-height"},o.React$1.createElement(t.Text,{variant:"paragraph",size:"small",isBold:!0},_),o.React$1.createElement(t.TextInput,{ref:T,value:R,"aria-label":E,onChange:e=>{S(e.target.value)}}),o.React$1.createElement(t.Text,{variant:"paragraph",size:"small",isBold:!0,className:"_save-copy-modal-folder-location_14mlg_1"},x),o.React$1.createElement(a.FolderPicker,{user:c,apiClient:{getFolderContents:t.getFolderContentsAPIv2},webTimer:t.get_timer(),rootName:t.Viewer.get_role_title(c)||"Dropbox",showFolderSuggestion:!1,initialPath:(null==$?void 0:$.replace("/"+e,""))||"/",canSelectReadonly:!1,onFolderSelected:F,skipFocusOnMount:!0})),o.React$1.createElement(t.Modal$1.Footer,{className:"save-copy-modal-footer"},o.React$1.createElement(t.Button$1,{variant:"opacity",onClick:()=>{null==f||f(n.UserAction.EditSaveCopyCancel),k()}},y),o.React$1.createElement(t.Button$1,{variant:"primary",onClick:N},C))):null};c.displayName="SaveCopyModal";e.Provider=function({children:e,filename:t,onCloseEditor:a,imgSrc:l,readOnly:n,logUserAction:r,logEvent:i,canEdit:c,onOpenFeedback:d}){const u=o.reactExports.useMemo((()=>({filename:t,onCloseEditor:a,imgSrc:l,readOnly:n,logUserAction:r,logEvent:i,canEdit:c,onOpenFeedback:d})),[t,a,l,n,r,i,c,d]);return o.React$1.createElement(s.Provider,{value:u},e)},e.SaveCopyModal=c,e.blobToDataUrl=e=>new Promise((function(t,a){const o=new FileReader;o.onload=function(){t(o.result)},o.onerror=function(e){a(e)},o.readAsDataURL(e)})),e.folderLink=function(e,a,l={}){const n=t.parent_dir(a),r=t.browse_uri_for_fq_path(e,n).toString(),s="/"===n?"Dropbox":n.replace(/\/(.*\/)?/,"");return o.React$1.createElement(t.Link,Object.assign({href:r,isBold:!0},l),s)},e.getMimeType=e=>r.getMimeTypeByExt(e),e.useExternalProps=i}));
//# sourceMappingURL=c_src_preview-photo-editor_utils.js-vflm3GrkI.map
