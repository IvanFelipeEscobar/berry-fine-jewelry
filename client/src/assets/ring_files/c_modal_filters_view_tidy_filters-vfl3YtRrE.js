define(["exports","./e_edison","./e_ui_page_files_router","./c_core_i18n","./c_components_item_truncation_container","./c_form_row_index","./c_folder_dialog_folder_picker_dig","./c_tslib","./c_data_action_creators_index","./c_flows_lib_api","./c_flows_redux_actions","./c_flows_redux_reducer","./c_flows_redux_store"],(function(e,t,a,i,r,s,o,n,l,d,c,u,_){"use strict";var m,y,f,p;e.TidyUpType=void 0,(m=e.TidyUpType||(e.TidyUpType={})).none="none",m.inactive="inactive",m.by_month="by_month",m.by_year="by_year",m.smart_move="smart_move",m.keyphrase="keyphrase",m.custom_filters="custom_filters",m.time_frame_filter="time_frame_filter",e.InactiveSelection=void 0,(y=e.InactiveSelection||(e.InactiveSelection={})).thirty_days="thirty_days",y.ninety_days="ninety_days",e.DateFormatSelection=void 0,(f=e.DateFormatSelection||(e.DateFormatSelection={}))[f.YYYY_MM=0]="YYYY_MM",f[f.YYYY_MM_Month=1]="YYYY_MM_Month",f[f.Month_YYYY=2]="Month_YYYY",e.TidyStateType=void 0,(p=e.TidyStateType||(e.TidyStateType={}))[p.Idle=0]="Idle",p[p.Preview=1]="Preview",p[p.SmartPreview=2]="SmartPreview",p[p.Keyphrase=3]="Keyphrase",p[p.KeyphrasePreview=4]="KeyphrasePreview",p[p.CustomFilters=5]="CustomFilters",p[p.CustomFilterPreview=6]="CustomFilterPreview",p[p.ConfirmOverrideAutomation=7]="ConfirmOverrideAutomation",p[p.ConfirmRemoveAutomation=8]="ConfirmRemoveAutomation",p[p.TimeFrameFilter=9]="TimeFrameFilter",p[p.TimeFrameFilterPreview=10]="TimeFrameFilterPreview",p[p.InactivityFilter=11]="InactivityFilter",p[p.InactivityFilterPreview=12]="InactivityFilterPreview",p[p.CustomFilterFolderSelection=13]="CustomFilterFolderSelection",p[p.KeyphraseFolderSelection=14]="KeyphraseFolderSelection";const T={type:e.TidyStateType.Idle};var g,E,h,v,R,M,S;!function(e){e[e.Generic=0]="Generic",e[e.PartialSuccess=1]="PartialSuccess",e[e.NoMatchingFiles=2]="NoMatchingFiles"}(g||(g={})),e.TidyCustomFiltersType=void 0,(E=e.TidyCustomFiltersType||(e.TidyCustomFiltersType={})).None="None",E.Keyword="Keyword",E.FileExtension="FileExtension",E.Size="Size",e.TidyTimeFrameFolderStructure=void 0,(h=e.TidyTimeFrameFolderStructure||(e.TidyTimeFrameFolderStructure={})).year="year",h.year_month="year_month",h.year_month_day="year_month_day",h.month="month",h.month_day="month_day",h.day="day",e.TidyTimeFrameFolderNamingMonth=void 0,(v=e.TidyTimeFrameFolderNamingMonth||(e.TidyTimeFrameFolderNamingMonth={})).mm="mm",v.mm_yyyy="mm_yyyy",v.yyyy_mm="yyyy_mm",v.month="month",v.month_yyyy="month_yyyy",e.TidyTimeFrameFolderNamingYear=void 0,(R=e.TidyTimeFrameFolderNamingYear||(e.TidyTimeFrameFolderNamingYear={})).yyyy="yyyy",R.yy="yy",e.TidyTimeFrameFolderNamingDay=void 0,(M=e.TidyTimeFrameFolderNamingDay||(e.TidyTimeFrameFolderNamingDay={})).dd="dd",M.dd_day="dd_day",M.day="day",e.TidyTimeFrameDateRule=void 0,(S=e.TidyTimeFrameDateRule||(e.TidyTimeFrameDateRule={})).date_uploaded="date_uploaded",S.date_created="date_created";const A={type:e.TidyUpType.none,activityParams:{inactiveSelection:e.InactiveSelection.thirty_days},byMonthParams:{excludeCurrentMonth:!1,dateFormatSelection:void 0},byYearParams:{excludeCurrentYear:!1},byKeyphraseParams:{keyphrase:void 0,keyphraseDestination:void 0},customFilterParams:{filters:[{id:Date.now(),rules:[{type:e.TidyCustomFiltersType.None}],actions:{destination:void 0}}]},byTimeFrameParams:{folderStructure:e.TidyTimeFrameFolderStructure.month,formatNaming:{monthFormat:e.TidyTimeFrameFolderNamingMonth.yyyy_mm,yearFormat:e.TidyTimeFrameFolderNamingYear.yyyy,dayFormat:e.TidyTimeFrameFolderNamingDay.dd},date_rule:e.TidyTimeFrameDateRule.date_uploaded},previewData:void 0};var F,I;e.TidySpecificActionSurfaceLogValue=void 0,(F=e.TidySpecificActionSurfaceLogValue||(e.TidySpecificActionSurfaceLogValue={})).GROWTH_SNACKBAR_CTA="snackbar",F.MOVE_SNACKBAR_CTA="move_snackbar",F.DESKTOP_ENTRYPOINT="desktop",F.ORGANIZED_HOME_DESKTOP_ENTRYPOINT="desktop_organized_home",F.SNACKBAR_RETRY="from_retry",F.BROWSE_ACTIONS="browse_actions",F.ORGANIZE_WEB_ENTRYPOINT="web_organized_menu",F.IN_FOLDER_ACTIVATION="in_folder_activation",F.DISCOVERY_UPLOAD_SNACKBAR="discovery_upload_snackbar",F.REENGAGEMENT_UPLOAD_SNACKBAR="reengagement_upload_snackbar",F.DISCOVERY_MOVE_SNACKBAR="discovery_move_snackbar",F.REENGAGEMENT_MOVE_SNACKBAR="reengagement_move_snackbar",e.TidyModalWidth=void 0,(I=e.TidyModalWidth||(e.TidyModalWidth={})).SMALL="small",I.STANDARD="standard",I.LARGE="large";const L=[e.TidyTimeFrameFolderStructure.month,e.TidyTimeFrameFolderStructure.year_month,e.TidyTimeFrameFolderStructure.month_day,e.TidyTimeFrameFolderStructure.year_month_day],b=[e.TidyTimeFrameFolderStructure.year,e.TidyTimeFrameFolderStructure.year_month,e.TidyTimeFrameFolderStructure.year_month_day],w=[e.TidyTimeFrameFolderStructure.day,e.TidyTimeFrameFolderStructure.month_day,e.TidyTimeFrameFolderStructure.year_month_day];function N(e){return e}var C;e.ConfidenceLevel=void 0,(C=e.ConfidenceLevel||(e.ConfidenceLevel={}))[C.low=0]="low",C[C.medium=1]="medium",C[C.high=2]="high";const O=["web_browse","desktop_menu","retry","move_snackbar","upload_snackbar","desktop_organized_home","web_organized_menu","automation","web_modal"];function D(e){return O.find((t=>t===(null==e?void 0:e.toLowerCase())))}const P=["yyyy_mm","yyyy_mm_month","month_yyyy"];function U(e){return P.find((t=>t===(null==e?void 0:e.toLowerCase())))}const x=["thirty_days","ninety_days","one_year"];function k(e){return x.find((t=>t===(null==e?void 0:e.toLowerCase())))}const $=["month","year","keyword","inactive","smart_move","custom_filter","time_frame"];function Y(e){return $.find((t=>t===(null==e?void 0:e.toLowerCase())))}const B=["none","apply","remove"];function V(e){return B.find((t=>t===(null==e?void 0:e.toLowerCase())))}const z={automationRuleSetToRuleType(e){var t,a;if(!e.rules||0===e.rules.length||!(null===(a=null===(t=e.rules[0])||void 0===t?void 0:t.action)||void 0===a?void 0:a.action))return;const i=e.rules[0].action.action;return"other"!==i[".tag"]?i[".tag"]:void 0}},K={tidyTypeToApiV2(t){const{type:a,activityParams:i,byMonthParams:r,byYearParams:s,byKeyphraseParams:o,customFilterParams:n,byTimeFrameParams:l}=t;switch(a){case e.TidyUpType.inactive:return{inactive_for:K.inactiveTimespanToApiV2(i.inactiveSelection),".tag":"inactive_request"};case e.TidyUpType.by_month:return{exclude_current:r.excludeCurrentMonth,date_format:K.dateFormatSelectionToApiV2(r.dateFormatSelection),".tag":"by_month_request"};case e.TidyUpType.by_year:return{exclude_current:s.excludeCurrentYear,".tag":"by_year_request"};case e.TidyUpType.keyphrase:return{phrase:o.keyphrase||"",destination:o.keyphraseDestination||"",is_absolute_path:o.isAbsolutePath,".tag":"keyphrase_request"};case e.TidyUpType.smart_move:return{".tag":"smart_move_request"};case e.TidyUpType.custom_filters:return{".tag":"filter_request",filters:n.filters.map(K.customFilterDefinitionToApiV2)};case e.TidyUpType.time_frame_filter:return{".tag":"by_time_frame_request",folder_structure:K.byTimeFrameFilterParamsToApiV2(l),date_rule:{".tag":l.date_rule}};default:return{".tag":"other"}}},byTimeFrameFilterParamsToApiV2:e=>"month"===e.folderStructure?{".tag":"month",format:{".tag":e.formatNaming.monthFormat}}:"year"===e.folderStructure?{".tag":"year",format:{".tag":e.formatNaming.yearFormat}}:"day"===e.folderStructure?{".tag":"day",format:{".tag":e.formatNaming.dayFormat}}:"year_month"===e.folderStructure?{".tag":"year_month",month_format:{".tag":e.formatNaming.monthFormat},year_format:{".tag":e.formatNaming.yearFormat}}:"month_day"===e.folderStructure?{".tag":"month_day",month_format:{".tag":e.formatNaming.monthFormat},day_format:{".tag":e.formatNaming.dayFormat}}:{".tag":"year_month_day",month_format:{".tag":e.formatNaming.monthFormat},year_format:{".tag":e.formatNaming.yearFormat},day_format:{".tag":e.formatNaming.dayFormat}},customFilterRulesToApiV2:e=>({rules:e.map((e=>{var t,a,i;return"Keyword"===e.type?{rule:{".tag":"keyword_filter",keywords:null===(t=e.keywordRule)||void 0===t?void 0:t.keywords}}:"Size"===e.type?{rule:{".tag":"size_filter",sizes:null===(a=e.sizeRule)||void 0===a?void 0:a.sizes}}:{rule:{".tag":"file_type_filter",file_types:null===(i=e.fileExtensionRule)||void 0===i?void 0:i.fileExtensions}}}))}),customFilterDefinitionToApiV2:e=>({filter_rules:K.customFilterRulesToApiV2(e.rules),actions:{actions:[{action:{".tag":"move",destination:e.actions.destination,is_absolute_path:e.actions.is_absolute_path}}]}}),customFilterRulesFromApiV2(t){var a;return(null!==(a=t.rules)&&void 0!==a?a:[]).map((t=>{var a,i,r;return"keyword_filter"===(null===(a=t.rule)||void 0===a?void 0:a[".tag"])&&void 0!==t.rule.keywords?{type:e.TidyCustomFiltersType.Keyword,keywordRule:{keywords:t.rule.keywords}}:"file_type_filter"===(null===(i=t.rule)||void 0===i?void 0:i[".tag"])&&void 0!==t.rule.file_types?{type:e.TidyCustomFiltersType.FileExtension,fileExtensionRule:{fileExtensions:t.rule.file_types}}:"size_filter"===(null===(r=t.rule)||void 0===r?void 0:r[".tag"])&&void 0!==t.rule.sizes?{type:e.TidyCustomFiltersType.Size,sizeRule:{sizes:t.rule.sizes}}:{type:e.TidyCustomFiltersType.None}}))},customFilterDefinitionFromApiV2(e){var t,a,i,r;const s=null!==(t=e.filter_rules)&&void 0!==t?t:{};let o,n=!1;return"move"===(null===(r=null===(i=null===(a=e.actions)||void 0===a?void 0:a.actions)||void 0===i?void 0:i[0].action)||void 0===r?void 0:r[".tag"])&&void 0!==e.actions.actions[0].action.destination&&(o=e.actions.actions[0].action.destination,n=!!e.actions.actions[0].action.is_absolute_path),{id:Date.now(),rules:K.customFilterRulesFromApiV2(s),actions:{destination:o,is_absolute_path:n}}},sourceToDestinationPathFromApplyResult(e){var t;const a=[],i={};for(const t of e.entries)i[t.id]=t;for(const[r,s]of Object.entries(e.tidyPlan))if(s.isSelected&&null!==s.selectedDestinationId&&void 0!==s.selectedDestinationId&&(null===(t=e.destinations[s.selectedDestinationId])||void 0===t?void 0:t.path)&&i[r].filename){const t=i[r].path,o=`${e.destinations[s.selectedDestinationId].path}/${i[r].filename}`;t&&a.push({source_path:t,dest_path:o})}return a},tidyTypeFromApiV2(t){const a=JSON.parse(JSON.stringify(A));switch(t[".tag"]){case"by_month_request":return a.type=e.TidyUpType.by_month,a.byMonthParams.excludeCurrentMonth=t.exclude_current,a.byMonthParams.dateFormatSelection=K.dateFormatSelectionFromApiV2(t.date_format),a;case"by_year_request":return a.type=e.TidyUpType.by_year,a.byYearParams.excludeCurrentYear=t.exclude_current,a;case"inactive_request":return a.type=e.TidyUpType.inactive,a.activityParams.inactiveSelection=K.inactiveTimespanFromApiV2(t.inactive_for),a;case"keyphrase_request":return a.type=e.TidyUpType.keyphrase,a.byKeyphraseParams.keyphrase=t.phrase,a.byKeyphraseParams.keyphraseDestination=t.destination,a.byKeyphraseParams.isAbsolutePath=t.is_absolute_path,a;case"smart_move_request":return a.type=e.TidyUpType.smart_move,a;case"filter_request":return a.type=e.TidyUpType.custom_filters,a.customFilterParams={filters:t.filters?t.filters.map((e=>K.customFilterDefinitionFromApiV2(e))):[]},a;case"by_time_frame_request":return a.type=e.TidyUpType.time_frame_filter,a;default:return a}},tidyTypeToFlowsAPI(e){const t=K.tidyTypeToApiV2(e);return{rules:[{enabled:!0,action:{action:{".tag":"tidy_up",args_json:JSON.stringify(t)}}}]}},tidyTypetoLoggingType(t){const{type:i,activityParams:r,byMonthParams:s,byYearParams:o}=t;let n="",l="";switch(i){case e.TidyUpType.inactive:l="inactive",n=r.inactiveSelection===e.InactiveSelection.thirty_days?"30d":"90d";break;case e.TidyUpType.by_month:l="month",s.excludeCurrentMonth&&(n="excl_current");break;case e.TidyUpType.by_year:l="year",o.excludeCurrentYear&&(n="excl_current");break;case e.TidyUpType.keyphrase:l="keyword";break;case e.TidyUpType.smart_move:l="smart_move";break;case e.TidyUpType.custom_filters:l="custom_filters";break;case e.TidyUpType.time_frame_filter:l="time_frame_filter";break;case e.TidyUpType.none:l="none";break;default:throw a.enforceExhaustive(i)}return{tidyUpRule:l,tidyUpSubRule:n}},inactiveTimespanToApiV2(t){switch(t){case e.InactiveSelection.thirty_days:return{".tag":"thirty_days"};case e.InactiveSelection.ninety_days:return{".tag":"ninety_days"};default:return{".tag":"other"}}},inactiveTimespanFromApiV2(t){switch(t[".tag"]){case"thirty_days":default:return e.InactiveSelection.thirty_days;case"ninety_days":return e.InactiveSelection.ninety_days}},dateFormatSelectionToApiV2(t){switch(t){case e.DateFormatSelection.YYYY_MM:return{".tag":"yyyy_mm"};case e.DateFormatSelection.YYYY_MM_Month:return{".tag":"yyyy_mm_month"};case e.DateFormatSelection.Month_YYYY:return{".tag":"month_yyyy"};default:return}},dateFormatSelectionFromApiV2(t){if(void 0===t)return e.DateFormatSelection.YYYY_MM;switch(t[".tag"]){case"yyyy_mm":default:return e.DateFormatSelection.YYYY_MM;case"yyyy_mm_month":return e.DateFormatSelection.YYYY_MM_Month;case"month_yyyy":return e.DateFormatSelection.Month_YYYY}},previewSelectionToApiV2(e,t){const a=[];for(const i of e){if(i.isRenamed){if((t.get(i.id)||i.files.some((e=>!!t.get(e.id))))&&i.sourcePath&&i.destPath){const e={source_path:i.sourcePath,dest_path:i.destPath,is_folder:!0};a.push(e)}}for(const e of i.files)if(t.get(e.id)){const t={source_path:e.fqPathSrc,dest_path:e.fqPathDest};a.push(t)}}return a},apiV2ToPreviewSelection(e,t){const i={},r=[],s=[];function o(e,t){let a=[];for(let i=0;i<e.length;i++)if(e[i]!==t[i]){a=t.slice(i);break}return a.length>=1?a:t.slice(e.length)}for(const t of e){if(t.is_folder){s.push(t);continue}const e=a.parent_dir(t.dest_path),o=t.dest_path,n={displayName:a.filename(t.dest_path),id:o,fqPathDest:t.dest_path,fqPathSrc:t.source_path};r.push(o),e in i?i[e].push(n):i[e]=[n]}const n=[];for(const[e,r]of Object.entries(i)){const i=a.parent_dir(r[0].fqPathSrc),s=a.parent_dir(r[0].fqPathDest),l=a.inSubDirectory(i,s)?o(i.split("/"),s.split("/")):s.split("/").filter((e=>0!==e.length));0===l.length&&l.push(t);const d={isDir:!0,displayName:l,fqPath:e,files:r,id:e};n.push(d)}for(const e of s){let t=!1;for(const i of n)if(i.fqPath===e.dest_path){i.isRenamed=!0,i.previousName=a.filename(e.source_path),i.newName=a.filename(e.dest_path),i.sourcePath=e.source_path,i.destPath=e.dest_path,t=!0;break}if(!t){const t=e.dest_path,i={isDir:!0,displayName:[""],fqPath:e.dest_path,files:[],isRenamed:!0,previousName:a.filename(e.source_path),newName:a.filename(e.dest_path),sourcePath:e.source_path,destPath:e.dest_path,id:t};r.push(t),n.push(i)}}return{folderHierarchy:n,fileIds:r}},compareTidyRules:(e,t)=>"inactive_request"===e[".tag"]&&"inactive_request"===t[".tag"]?e.inactive_for===t.inactive_for:"by_month_request"===e[".tag"]&&"by_month_request"===t[".tag"]?e.exclude_current===t.exclude_current&&e.date_format===t.date_format:"by_year_request"===e[".tag"]&&"by_year_request"===t[".tag"]?e.exclude_current===t.exclude_current:"keyphrase_request"===e[".tag"]&&"keyphrase_request"===t[".tag"]&&(e.phrase===t.phrase&&e.destination===t.destination&&e.is_absolute_path===t.is_absolute_path),doesCurrentSelectionMatchAutomation(e,t){if(!e)return!1;const a=K.tidyTypeToApiV2(t);return"by_month_request"===a[".tag"]&&"by_month_request"===e[".tag"]||("filter_request"===a[".tag"]&&"filter_request"===e[".tag"]||("by_time_frame_request"===a[".tag"]&&"by_time_frame_request"===e[".tag"]||("keyphrase_request"===a[".tag"]&&"keyphrase_request"===e[".tag"]||K.compareTidyRules(e,a))))},shouldSilentlyReplaceAutomation(e,t){if(!e)return!1;const a=K.tidyTypeToApiV2(t);return!K.compareTidyRules(e,a)&&("by_month_request"===a[".tag"]&&"by_month_request"===e[".tag"])},confidenceLevelFromApi(t){switch(null==t?void 0:t[".tag"]){case"high":return e.ConfidenceLevel.high;case"mid":return e.ConfidenceLevel.medium;default:return e.ConfidenceLevel.low}},confidenceLevelToApi(t){switch(t){case e.ConfidenceLevel.high:return{".tag":"high"};case e.ConfidenceLevel.medium:return{".tag":"mid"};case e.ConfidenceLevel.low:return{".tag":"low"};default:throw a.enforceExhaustive(t)}},tidyTypeToPapType(t){const{type:i,activityParams:r,byMonthParams:s,byYearParams:o}=t;let n,l="";switch(i){case e.TidyUpType.inactive:n=Y("inactive"),l=r.inactiveSelection===e.InactiveSelection.thirty_days?"30d":"90d";break;case e.TidyUpType.by_month:n=Y("month"),s.excludeCurrentMonth&&(l="excl_current");break;case e.TidyUpType.by_year:n=Y("year"),o.excludeCurrentYear&&(l="excl_current");break;case e.TidyUpType.keyphrase:n=Y("keyword");break;case e.TidyUpType.smart_move:n=Y("smart_move");break;case e.TidyUpType.custom_filters:n=Y("custom_filter");break;case e.TidyUpType.time_frame_filter:n=Y("time_frame");break;case e.TidyUpType.none:break;default:throw a.enforceExhaustive(i)}return{tidyUpRule:n,tidyUpSubrule:l}},tidyInactiveRangeToPapType(t){switch(t){case e.InactiveSelection.thirty_days:return k("thirty_days");case e.InactiveSelection.ninety_days:return k("ninety_days");default:throw a.enforceExhaustive(t)}},tidyDateFormatToPapType(t){if(void 0!==t)switch(t){case e.DateFormatSelection.YYYY_MM:return U("yyyy_mm");case e.DateFormatSelection.YYYY_MM_Month:return U("yyyy_mm_month");case e.DateFormatSelection.Month_YYYY:return U("month_yyyy");default:throw a.enforceExhaustive(t)}},tidyAutomationToPapType:(e,t)=>V(t?"apply":e?"remove":"none"),tidySourceToPapType:t=>t===e.TidySpecificActionSurfaceLogValue.DESKTOP_ENTRYPOINT?D("desktop_menu"):t===e.TidySpecificActionSurfaceLogValue.GROWTH_SNACKBAR_CTA||t==e.TidySpecificActionSurfaceLogValue.DISCOVERY_UPLOAD_SNACKBAR||t==e.TidySpecificActionSurfaceLogValue.REENGAGEMENT_UPLOAD_SNACKBAR?D("upload_snackbar"):t===e.TidySpecificActionSurfaceLogValue.MOVE_SNACKBAR_CTA||t==e.TidySpecificActionSurfaceLogValue.DISCOVERY_MOVE_SNACKBAR||t==e.TidySpecificActionSurfaceLogValue.REENGAGEMENT_MOVE_SNACKBAR?D("move_snackbar"):t===e.TidySpecificActionSurfaceLogValue.SNACKBAR_RETRY?D("retry"):t===e.TidySpecificActionSurfaceLogValue.ORGANIZED_HOME_DESKTOP_ENTRYPOINT?D("desktop_organized_home"):D("web_browse")};i.defineMessage({id:"OC4T38",defaultMessage:"Tidy up"});const G=i.defineMessage({id:"FEI6xF",defaultMessage:"Close"}),W=i.defineMessage({id:"StgmB7",defaultMessage:"Cancel"}),H=i.defineMessage({id:"03FNiv",defaultMessage:"Apply"}),q=i.defineMessage({id:"ndSchX",defaultMessage:"Back"}),X=i.defineMessage({id:"PLME/5",defaultMessage:"Dismiss"}),j=i.defineMessage({id:"7aGUDe",defaultMessage:"Preview"});i.defineMessages({HEADER_LABEL:{id:"/IXzI6",defaultMessage:"Choose a rule"},BODY_TEXT:{id:"R7e8cr",defaultMessage:"Organize this content into folders grouped by:"},NEXT_LABEL:{id:"Z2Ie27",defaultMessage:"Next"},PREVIEW_LABEL:{id:"7aGUDe",defaultMessage:"Preview"},KEYPHRASE_LABEL:{id:"rHnW1g",defaultMessage:"Choose keyword"}});const Z=i.defineMessages({PENDING_TEXT_1:{id:"3Cumks",defaultMessage:"Creating folders..."},PENDING_TEXT_2:{id:"rOHuZh",defaultMessage:"This may take a moment."},PENDING_AUTOMATION_REMOVAL:{id:"mK/eth",defaultMessage:"Removing automation..."},PENDING_AUTOMATION_APPLY:{id:"yvx6Ny",defaultMessage:"Applying automation..."},STILL_WORKING_TEXT_1:{id:"xDVihY",defaultMessage:"Moving files..."},STILL_WORKING_TEXT_2:{id:"Fw7phK",defaultMessage:"You can safely go about your work while we finish."}}),J=i.defineMessages({SUCCESS_TEXT:{id:"iszJTE",defaultMessage:"Successfully organized {numFilesTidied, plural, one{# file} other{# files}}."},AUTOMATION_REMOVAL_SUCCESS_TEXT:{id:"4DeEN2",defaultMessage:"Successfully removed automation."},AUTOMATION_APPLY_SUCCESS_TEXT:{id:"NfBNbr",defaultMessage:"Successfully applied automation."}}),Q=i.defineMessages({ERROR_TEXT:{id:"9ma/3b",defaultMessage:"We weren’t able to organize your folder. Try again."},MIXED_SUCCESS_AUTOMATION_SUCCESS:{id:"n50m8S",defaultMessage:"Couldn't apply the rule. Successfully made changes to the automation."},MIXED_SUCCESS_AUTOMATION_FAILURE:{id:"WHUu5h",defaultMessage:"Couldn't make changes to the automation. Successfully applied rule."},AUTOMATION_REMOVAL_FAILURE:{id:"Uh39z5",defaultMessage:"Couldn't remove the automation."},AUTOMATION_APPLICATION_FAILURE:{id:"YoRCK6",defaultMessage:"Couldn't apply the automation."},PARTIAL_SUCCESS_TEXT_1:{id:"6V5H17",defaultMessage:"Organized {numSucceeded, plural, one{# file} other{# files}}."},PARTIAL_SUCCESS_TEXT_2:{id:"YKjtS3",defaultMessage:"{numFailed, plural, one{# file} other{# files}} couldn’t be organized – give it another try."},ALL_CONTENT_ACTIVE_TEXT:{id:"/9yhnT",defaultMessage:"All of your content has been active recently."},ALL_CREATED_CURRENT_MONTH:{id:"yj7SqD",defaultMessage:"All of your content was added to Dropbox this month."},ALL_CREATED_CURRENT_YEAR:{id:"N73kL9",defaultMessage:"All of your content was added to Dropbox this year."},NO_MATCHING_KEYWORD:{id:"P/rv1f",defaultMessage:"We couldn’t find any files containing this keyword."},EMPTY_KEYPHRASE_PREVIEW_BACK:{id:"UzL6C5",defaultMessage:"Try another keyword"},EMPTY_PREVIEW_BACK:{id:"FDsh/B",defaultMessage:"Try another rule"},EMPTY_CUSTOM_FITLER_PREVIEW_BACK:{id:"Yy0gyY",defaultMessage:"Modify filter rules"},NO_MATCHING_FILES_GENERIC:{id:"4zKt1i",defaultMessage:"We couldn’t find any files to organize in this folder."},SNACKBAR_TEXT:{id:"cGFOIN",defaultMessage:"We couldn’t find any files to organize in this folder. Try choosing a different rule."}}),ee=i.defineMessages({MODAL_TITLE_LABEL:{id:"2/YiSD",defaultMessage:"Preview this rule"},MODAL_TITLE_ERROR_LABEL:{id:"mAFYum",defaultMessage:"Couldn’t apply this rule"},DESCRIPTION_TEXT:{id:"dpAMYR",defaultMessage:"You’re about to make the following changes. Uncheck any items you want to exclude from this operation."},AUTOMATION_TOGGLE_LABEL:{id:"eY1+iP",defaultMessage:"Apply rule to every file added to this folder"},AUTOMATION_ON_LABEL:{id:"AXasyS",defaultMessage:"On"},AUTOMATION_OFF_LABEL:{id:"urtNrM",defaultMessage:"Off"}}),te=i.defineMessages({MODAL_TITLE_LABEL:{id:"NqyXrB",defaultMessage:"Smart move"},PREVIEW_PENDING_TEXT_1:{id:"kUAGn3",defaultMessage:"Analyzing folder for Smart Move..."},PREVIEW_PENDING_TEXT_2:{id:"ywWex0",defaultMessage:"This may take a moment."},APPLY_PENDING_TEXT:{id:"hSVEfh",defaultMessage:"Identifying folders..."},CONTENT_TITLE:{id:"+AvtU7",defaultMessage:"Content"},MOVE_TO_TITLE:{id:"LAd/7v",defaultMessage:"Move to:"},ADD_FEEDBACK:{id:"V0ezVH",defaultMessage:"Add feedback"},SHARE_FEEDBACK_PLACEHOLDER:{id:"y0XkHO",defaultMessage:"Share feedback with the team"},ERROR_PATH_NOT_FOUND:{id:"6JUT/e",defaultMessage:"Could not locate a file for organizing"},ERROR_MULTIPLE_CONTAINING_FOLDERS:{id:"gKBmyF",defaultMessage:"Cannot organize more than one folder at a time"},ERROR_NO_CONTAINING_FOLDER:{id:"AGMIp0",defaultMessage:"Cannot organize files without a containing folder"},ERROR_NO_DESTINATIONS_1:{id:"+7w7cI",defaultMessage:"Smart move needs at least one subfolder to suggest moving files into."},ERROR_NO_DESTINATIONS_2:{id:"yXlKn4",defaultMessage:"Create a subfolder or try another multi-file organize rule."},ERROR_CANNOT_MOVE_ENTRY:{id:"bNlw4b",defaultMessage:"Some files are read-only and cannot be moved"},ERROR_LIST_FILES:{id:"cLoDbN",defaultMessage:"There was a problem identifying files to organize"},ERROR_OTHER:{id:"CWZOOV",defaultMessage:"We weren’t able to organize your folder. Try again."},WARNING_TEXT:{id:"kDUNC8",defaultMessage:"This feature is for internal testing only. Be aware that moving files to a different folder may result in different access permissions."},HIGH_CONFIDENCE_SECTION_HEADER:{id:"MEt1EZ",defaultMessage:"Our suggested matches:"},POSSIBLE_MATCHES_SECTION_HEADER:{id:"ZUHtxO",defaultMessage:"Some possible matches:"},LOW_CONFIDENCE_ONLY_SECTION_HEADER:{id:"hl1h7f",defaultMessage:"Choose where you think these files should live:"},BODY_DESCRIPTION:{id:"X7XEUt",defaultMessage:"Here are the suggested locations for your files. Select the ones you want to move."},BODY_DESCRIPTION_NO_SUGGESTIONS:{id:"TJG7hj",defaultMessage:"We couldn’t come up with any suggested matches, but you can choose the correct destination from the dropdowns."},CONTENT_COLUMN_HEADER:{id:"fZA951",defaultMessage:"Current content"},DESTINATIONS_COLUMN_HEADER:{id:"JGXTov",defaultMessage:"Move to"},DESTINATION_PLACEHOLDER:{id:"t0ARxk",defaultMessage:"Choose folder"},ERROR_BANNER:{id:"Ttmxyl",defaultMessage:"Selected files must have a folder destination."},PRIMARY_BUTTON_LABEL:{id:"TW19Cd",defaultMessage:"Move"}}),ae=i.defineMessages({HEADER_LABEL:{id:"YBZvnw",defaultMessage:"Group by keyword"},PREVIEW_LABEL:{id:"7aGUDe",defaultMessage:"Preview"},INPUT_LABEL:{id:"p4yoHO",defaultMessage:"Keyword:"},INPUT_PLACEHOLDER:{id:"nW3umL",defaultMessage:"Type your keyword"},FOLDER_SELECTION_LABEL:{id:"6Zd09J",defaultMessage:"Destination:"},FOLDER_SELECTION_LABEL_GLOBAL:{id:"EK7yLU",defaultMessage:"Move files to:"}}),ie=i.defineMessages({dropdownPlaceholder:{id:"IJxA/7",defaultMessage:"Choose a subfolder…"},noSubfolders:{id:"jOCQJ1",defaultMessage:"It seems like you don’t have any existing subfolders. Try this again once you have at least one subfolder to choose from."},folderSelectionButtonLabel:{id:"mz8m9a",defaultMessage:"Choose folder"},title:{id:"ZXnd4e",defaultMessage:"Move items to…"},defaultFolderSelectionButtonLabel:{id:"7SCfI3",defaultMessage:"Folder name"},folderCreationButtonLabel:{id:"i4621P",defaultMessage:"Create folder"},newFolderButtonLabel:{id:"sw1lp9",defaultMessage:"New folder"},newFolderInputPlaceholderText:{id:"6q3haJ",defaultMessage:"Folder name"},folderCreationTitleLabel:{id:"wduxmO",defaultMessage:"Move files to new folder"},folderNameLabel:{id:"CxQrI0",defaultMessage:"Name"},folderNameLengthError:{id:"FwD8fL",defaultMessage:"Folder name is too long."},folderNameInvalidCharacterError:{id:"FbwsTS",defaultMessage:"Folder names can’t contain: \\ / :"}}),re=i.defineMessages({HEADER_LABEL:{id:"zyqr9m",defaultMessage:"Custom filters"},BODY_LABEL:{id:"TaNu8P",defaultMessage:"Create filters and configure rules to organize content. Filters will be applied to matching content in the order listed."},KEYWORD_EMPTY_INPUT_ERROR_LABEL:{id:"tQYcdG",defaultMessage:"Please enter a keyword."},KEYWORD_INVALID_CHARACTERS_ERROR_LABEL:{id:"0TvUJE",defaultMessage:"Please use letters (a-z), numbers (0-9), and underscores (_)."},KEYWORD_TOO_LONG_ERROR_LABEL:{id:"rlauM0",defaultMessage:"Maximum length for a keyword is 15 characters."},KEYWORD_ALREADY_EXISTS_ERROR_LABEL:{id:"K2iRBi",defaultMessage:"This keyword has already been added to the rule."},SIZE_INVALID_CHARACTERS_ERROR_LABEL:{id:"vjH8Ek",defaultMessage:"Please use numbers (0-9) only."},SIZE_TOO_LARGE_ERROR_LABEL:{id:"EdF6PB",defaultMessage:"Maximum value for a file size filter is 100 GB."},SIZE_INVALID_RANGE_ERROR_LABEL:{id:"wxq54e",defaultMessage:"Minimum value cannot exceed maximum."},FILES_GREATER_THAN_LABEL:{id:"nFLqkw",defaultMessage:"Files greater than"},FILES_SMALLER_THAN_LABEL:{id:"XbA6pf",defaultMessage:"Files smaller than"},ADD_RULE_LABEL:{id:"yjoU9B",defaultMessage:"Add rule"},CREATE_FILTER_LABEL:{id:"XXL0GB",defaultMessage:"Create new filter"},FOLDER_SELECTION_LABEL:{id:"lWzfli",defaultMessage:"Move files to:"},DELETE_FILTER_LABEL:{id:"qA0lf+",defaultMessage:"Delete filter"}}),se=i.defineMessages({header_label:{id:"fSFcZF",defaultMessage:"Organize by time"},body_label:{id:"hcBEFs",defaultMessage:"Group files into subfolders based on the following folder structure."},time_frame_rule_selection_label:{id:"nvWpEL",defaultMessage:"Group by"},time_frame_date_rule_selection_label:{id:"YtpkZb",defaultMessage:"Using"},time_frame_date_date_rule_prompt_label:{id:"YUWPut",defaultMessage:"Date created is not always available for each file."},folder_naming_selection_label:{id:"v1bOOP",defaultMessage:"Folder naming"},year_folders_selection_label:{id:"nrRYNb",defaultMessage:"Year folders"},month_folders_selection_label:{id:"VNIPPz",defaultMessage:"Month folders"},day_folders_selection_label:{id:"PrfGFA",defaultMessage:"Day folders"},preview_label:{id:"7aGUDe",defaultMessage:"Preview"}}),oe=i.defineMessages({date_created:{id:"/z5QOK",defaultMessage:"Date created"},date_uploaded:{id:"hISSJo",defaultMessage:"Date uploaded"}}),ne=i.defineMessages({month:{id:"rMb/VK",defaultMessage:"Month"},year:{id:"LcewkZ",defaultMessage:"Year"},day:{id:"sHbORR",defaultMessage:"Day"}}),le=i.defineMessages({mm:{id:"GdmYyK",defaultMessage:"MM"},mm_yyyy:{id:"MkGMnE",defaultMessage:"MM-YYYY"},yyyy_mm:{id:"NPIdJZ",defaultMessage:"YYYY-MM"},month:{id:"rMb/VK",defaultMessage:"Month"},month_yyyy:{id:"xo2MT1",defaultMessage:"Month YYYY"}}),de=i.defineMessages({yyyy:{id:"IqGaq/",defaultMessage:"YYYY"},yy:{id:"02jpeP",defaultMessage:"YY"}}),ce=i.defineMessages({dd:{id:"8URMRS",defaultMessage:"DD"},dd_day:{id:"Kr9xjy",defaultMessage:"DD Monday"},day:{id:"8Xmwl1",defaultMessage:"Monday"}});i.defineMessages({HEADER_LABEL:{id:"wihZud",defaultMessage:"Let us know what you think"},INPUT_PLACEHOLDER:{id:"u7sQJP",defaultMessage:"Anything goes here!"},MODAL_TEXT:{id:"4IQhQm",defaultMessage:"What can we do to make organizing your files easier?"},SUBMIT_LABEL:{id:"C/HKsS",defaultMessage:"Submit"}});const ue=i.defineMessages({UPDATE_AUTOMATION_HEADER_LABEL:{id:"WvZUJv",defaultMessage:"Replace your existing automation?"},REMOVE_AUTOMATION_HEADER_LABEL:{id:"Mx+XRk",defaultMessage:"Remove your existing automation?"},UPDATE_CONFIRMATION_BODY_LABEL:{id:"R8WlLm",defaultMessage:"Automating this rule will replace this folder’s existing automation on an ongoing basis. Click <strong>{keepExistingButtonLabel}</strong> to apply this new rule only this one time."},REMOVE_CONFIRMATION_BODY_LABEL:{id:"kaTvx4",defaultMessage:"Updating this rule will remove this folder’s existing automation going forward. Click <strong>{keepExistingButtonLabel}</strong> to apply this rule without removing automation."},APPLY_WITHOUT_OVERRIDE_LABEL:{id:"raqLbh",defaultMessage:"Keep existing automation"},APPLY_AND_OVERRIDE_LABEL:{id:"sp7ooC",defaultMessage:"Replace"},APPLY_AND_REMOVE_LABEL:{id:"grjvza",defaultMessage:"Remove"}}),_e=i.defineMessages({UNDO_PENDING:{id:"9yS73d",defaultMessage:"Undoing..."},UNDO_SUCCESS:{id:"vsXQtc",defaultMessage:"Undo successful — removed file grouping."},UNDO_ERROR:{id:"jwcStr",defaultMessage:"Couldn’t remove file grouping."},UNDO_PARTIAL_ERROR_AUTOMATION_SUCCESS:{id:"wc6Thl",defaultMessage:"Undo successfully applied to the automation, but couldn’t undo the file grouping."},UNDO_PARTIAL_ERROR_AUTOMATION_FAILURE:{id:"PQoKpp",defaultMessage:"Undo successfully applied to file grouping, but couldn’t undo the automation."}}),me=i.defineMessage({id:"rlhg66",defaultMessage:"Multi-file organize"}),ye=i.defineMessage({id:"tZjTI1",defaultMessage:"Organize this content into folders grouped by:"}),fe=i.defineMessages({TITLE:{id:"VN2FV7",defaultMessage:"Organize inactive content"},SUBTITLE:{id:"mkBKo9",defaultMessage:"Group together content you haven't engaged with recently"},OPTION_LABEL:{id:"cN4D1q",defaultMessage:"Inactive for"},TIDY_UP_INACTIVE_THIRTY_DAYS:{id:"+7XcHy",defaultMessage:"30 days"},TIDY_UP_INACTIVE_NINETY_DAYS:{id:"XditG3",defaultMessage:"90 days"}}),pe=i.defineMessages({CUSTOM_FILTER_TITLE:{id:"OhBogU",defaultMessage:"Custom filters"},CUSTOM_FILTER_SUBTITLE:{id:"ERkF8C",defaultMessage:"Group based on keywords and file types"},TIME_FRAME_TITLE:{id:"Rc8edF",defaultMessage:"Timeframe"},TIME_FRAME_SUBTITLE:{id:"BJUzKE",defaultMessage:"Group based on a specific timeframe"},INACTIVITY_TITLE:{id:"rxaX/E",defaultMessage:"Inactivity"},INACTIVITY_SUBTITLE:{id:"qd8Pdr",defaultMessage:"Group together content you haven’t engaged with recently"},SMART_MOVE_TITLE:{id:"xB+pkI",defaultMessage:"Smart move"},SMART_MOVE_SUBTITLE:{id:"ThRSey",defaultMessage:"Group files into existing subfolders based on our recommendations"},KEYPHRASE_FILTER_TITLE:{id:"rHq4Oa",defaultMessage:"Keyword"},KEYPHRASE_FILTER_SUBTITLE:{id:"WDRppN",defaultMessage:"Group by specific keywords"}}),Te=i.defineMessage({id:"f9xbnY",defaultMessage:"Year"}),ge=i.defineMessage({id:"oCxF9e",defaultMessage:"Year your content was added to Dropbox"}),Ee=i.defineMessage({id:"n8ISVS",defaultMessage:"Month"}),he=i.defineMessage({id:"/6zLhV",defaultMessage:"Month your content was added to Dropbox"}),ve=({label:e})=>t.React$1.createElement(a.Modal$1.Header,{hasBottomSpacing:"title-standard",className:"tidy-up-modal__header"},t.React$1.createElement(a.Title,null,i.intl.formatMessage(e)));ve.displayName="TidyUpModalHeader";a.injectInternalStyle("metaserver/static/js/tidy_up/modal/filters_view/folder_selection.module.out.css",(e=>"._tidy-custom-filter-folder-selection__dropdown_f17u3_1{margin-bottom:8px;text-overflow:ellipsis}._tidy-custom-filter-folder-selection__dropdown-button_f17u3_6{justify-content:flex-start;width:100%}._tidy-custom-filter-folder-selection__select-item-content_f17u3_11{align-items:center;display:flex;width:250px}._tidy-custom-filter-folder-selection__folder-icon_f17u3_17{margin-right:5px}._tidy-custom-filter-folder-selection__button-text_f17u3_21{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:130px}._tidy-custom-filter-folder-selection__button-container_f17u3_29{display:flex;width:100%}._tidy-custom-filter-folder-selection__no-folder-message_f17u3_34{overflow:hidden;text-align:left;text-overflow:ellipsis;width:300px}._tidy-custom-filter-folder-selection__modal-body_f17u3_41{max-height:320px;min-height:auto}._tidy-custom-filter-folder-selection__new-folder-name-input__error_f17u3_46{margin-bottom:-12px}"));const Re="_tidy-custom-filter-folder-selection__select-item-content_f17u3_11",Me="_tidy-custom-filter-folder-selection__folder-icon_f17u3_17",Se="_tidy-custom-filter-folder-selection__button-text_f17u3_21",Ae="_tidy-custom-filter-folder-selection__modal-body_f17u3_41",Fe="_tidy-custom-filter-folder-selection__new-folder-name-input__error_f17u3_46";const Ie=(e,t,a)=>a.ns("tidy_up").rpc("tidy/check",{async_job_id:e},{subjectUserId:t});function Le(e){return Object.assign(Object.assign({},e),{ns_id_str:e.ns_id.toString()})}function be(e,t,i,r,s){return n.__awaiter(this,void 0,void 0,(function*(){const o=new a.UserApiV2Client;try{const a=yield o.ns("tidy_up_api_proxy").rpc("undo",{source_path:e,moved_files_changesets:i.map(Le),created_directories_changesets:r.map(Le),renamed_directories_changesets:s.map(Le)},{subjectUserId:t}),n=void 0!==a.files_result&&"success"===a.files_result[".tag"],l=!a.folders_result||"success"===a.folders_result[".tag"],d=!a.renamed_folders_result||"success"===a.renamed_folders_result[".tag"];return n&&l&&d}catch(e){return!1}}))}const we=(e,t,a)=>n.__awaiter(void 0,void 0,void 0,(function*(){var i;try{const i=yield e();if("complete"===i[".tag"])return{isError:!1,result:i};if("other"===i[".tag"])return{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"};let r;do{yield new Promise((e=>setTimeout(e,1e3))),r=yield Ie(i.async_job_id,t,a)}while(r&&"in_progress"===r[".tag"]);return"complete"===r[".tag"]?{isError:!1,result:r}:{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}}catch(e){return(null===(i=null==e?void 0:e.error)||void 0===i?void 0:i[".tag"])?{isError:!0,error:e.error,error_summary:e.summary}:{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}}}));function Ne(e){return{class:"tidyup",action:"attempt",object:"tidyup",properties:e}}function Ce(e){return{class:"tidyup",action:"undo",object:"tidyup",properties:e}}const Oe=8e3,De="tidyup-apply-action",Pe=a.getStoreForBrowse(),Ue=_.getStoreForAutomations(),xe=(e,t,a,i)=>d.setupFolderRules(t,i).then((()=>n.__awaiter(void 0,void 0,void 0,(function*(){return Ze(e,t,a,i),!0}))),(()=>n.__awaiter(void 0,void 0,void 0,(function*(){return!1})))),ke=(e,t,a)=>d.deleteFolderRules(t).then((()=>n.__awaiter(void 0,void 0,void 0,(function*(){return Ze(e,t,a,void 0),!0}))),(()=>n.__awaiter(void 0,void 0,void 0,(function*(){return!1})))),$e=(r,s,o,n,l,d,c,u,_)=>{a.WebUserActionLog.log(c,a.WebUserActionLogEvent.TIDY_UP_RESULT_SUCCESS,{ns_id:u,apply_file_count:r,success_file_count:r});const{tidyUpRule:m,tidyUpSubrule:y}=K.tidyTypeToPapType(o);a.logEvent(Ne({actionSurface:n,eventState:"success",tidyupRule:m,tidyupSubrule:y,tidyupAutomationAction:K.tidyAutomationToPapType(l,d),tidyupExcludeCurrentSubrule:o.type===e.TidyUpType.by_month&&o.byMonthParams.excludeCurrentMonth||o.type===e.TidyUpType.by_year&&o.byYearParams.excludeCurrentYear,tidyupTimeInactiveSubrule:K.tidyInactiveRangeToPapType(o.activityParams.inactiveSelection),tidyupDateFormatSubrule:K.tidyDateFormatToPapType(o.byMonthParams.dateFormatSelection),tidyupSource:K.tidySourceToPapType(n)}));const f=i.intl.formatMessage(J.SUCCESS_TEXT,{numFilesTidied:r});a.Snackbar.show(t.React$1.createElement(a.Snackbar,{actionButtonText:_?i.intl.formatMessage({id:"LfSqya",defaultMessage:"Undo"}):void 0,onActionClick:_,timeoutDelayMs:1e4,title:f,variant:"complete",id:De}))},Ye=(e,r)=>{a.Snackbar.show(t.React$1.createElement(a.Snackbar,{actionButtonText:i.intl.formatMessage({id:"3KMB1D",defaultMessage:"Retry"}),onActionClick:r,closeButtonText:i.intl.formatMessage(X),timeoutDelayMs:Oe,title:e,variant:"fail",id:De}))},Be=(t,r,s,o,n,l,d,c,u,_)=>{a.WebUserActionLog.log(d,a.WebUserActionLogEvent.TIDY_UP_RESULT_FAIL,{ns_id:u,apply_file_count:c,success_file_count:0});const{tidyUpRule:m,tidyUpSubrule:y}=K.tidyTypeToPapType(r);a.logEvent(Ne({actionSurface:s,eventState:"failed",tidyupRule:m,tidyupSubrule:y,tidyupAutomationAction:K.tidyAutomationToPapType(o,n),tidyupExcludeCurrentSubrule:r.type===e.TidyUpType.by_month&&r.byMonthParams.excludeCurrentMonth||r.type===e.TidyUpType.by_year&&r.byYearParams.excludeCurrentYear,tidyupTimeInactiveSubrule:K.tidyInactiveRangeToPapType(r.activityParams.inactiveSelection),tidyupDateFormatSubrule:K.tidyDateFormatToPapType(r.byMonthParams.dateFormatSelection),tidyupSource:K.tidySourceToPapType(s)}));const f=i.intl.formatMessage(_?Q.MIXED_SUCCESS_AUTOMATION_SUCCESS:Q.ERROR_TEXT);Ye(f,We(t,l))},Ve=(e,t,a,r,s,o)=>{const n=i.intl.formatMessage(Q.MIXED_SUCCESS_AUTOMATION_FAILURE);Ye(n,!1===t?()=>{je(e,r,s,o)}:()=>{Xe(e,r,s,o)})},ze=(r,s,o,n,l,d,c,u,_,m,y)=>{a.WebUserActionLog.log(_,a.WebUserActionLogEvent.TIDY_UP_RESULT_PARTIAL_FAIL,{ns_id:m,apply_file_count:r+s,success_file_count:r});const{tidyUpRule:f,tidyUpSubrule:p}=K.tidyTypeToPapType(n);a.logEvent(Ne({actionSurface:l,eventState:"failed",tidyupRule:f,tidyupSubrule:p,tidyupAutomationAction:K.tidyAutomationToPapType(d,c),tidyupExcludeCurrentSubrule:n.type===e.TidyUpType.by_month&&n.byMonthParams.excludeCurrentMonth||n.type===e.TidyUpType.by_year&&n.byYearParams.excludeCurrentYear,tidyupTimeInactiveSubrule:K.tidyInactiveRangeToPapType(n.activityParams.inactiveSelection),tidyupDateFormatSubrule:K.tidyDateFormatToPapType(n.byMonthParams.dateFormatSelection),tidyupSource:K.tidySourceToPapType(l)}));const T=i.intl.formatMessage(Q.PARTIAL_SUCCESS_TEXT_1,{numSucceeded:r}),g=i.intl.formatMessage(Q.PARTIAL_SUCCESS_TEXT_2,{numFailed:s}),E=We(o,u);a.Snackbar.show(t.React$1.createElement(a.Snackbar,{actionButtonText:y?i.intl.formatMessage({id:"su+IP9",defaultMessage:"Undo"}):void 0,onActionClick:y,closeButtonText:i.intl.formatMessage({id:"3KMB1D",defaultMessage:"Retry"}),onCloseClick:E,timeoutDelayMs:1e4,title:T+" "+g,variant:"warn",id:De}))},Ke=()=>{const e=i.intl.formatMessage(Q.SNACKBAR_TEXT);a.Snackbar.show(t.React$1.createElement(a.Snackbar,{closeButtonText:i.intl.formatMessage(X),timeoutDelayMs:Oe,title:e,variant:"fail",id:De}))},Ge=(e,r,s,o,d,c,u,_,m)=>()=>n.__awaiter(void 0,void 0,void 0,(function*(){const n=d.filter((e=>"success"===e[".tag"])).length;a.WebUserActionLog.log(s,a.WebUserActionLogEvent.TIDY_UP_UNDO,{type:"precision",num_files_to_undo:n,ns_id:o}),a.logEvent(Ce({actionSurface:r,eventState:"start",numFilesToUndo:n,tidyupUndoType:"precision"})),a.Snackbar.show(t.React$1.createElement(a.Snackbar,{id:De,title:i.intl.formatMessage(_e.UNDO_PENDING),variant:"sync"}));const y=Pe.getState();(a.isCurrentPathRoot(y)?"":a.path$1(y))!==e&&Pe.dispatch(l.setUrl({path:e}));let f=Promise.resolve(void 0);if(void 0!==m){f=null!=z.automationRuleSetToRuleType(m)?xe(s,e,r,m):ke(s,e,r)}const[p,T]=yield Promise.all([be(e,s,c,u,_),f]);p&&!1!==T||(a.WebUserActionLog.log(s,a.WebUserActionLogEvent.TIDY_UP_UNDO_FAIL,{ns_id:o,num_files_to_undo:n,undo_automation_failed:!1===T,undo_tidy_failed:!p}),a.logEvent(Ce({actionSurface:r,eventState:"failed",numFilesToUndo:n,tidyupUndoType:"precision"}))),p?!1!==T?(a.WebUserActionLog.log(s,a.WebUserActionLogEvent.TIDY_UP_UNDO_SUCCESS,{ns_id:o,num_files_to_undo:n}),a.logEvent(Ce({actionSurface:r,eventState:"success",numFilesToUndo:n,tidyupUndoType:"precision"})),a.Snackbar.show(t.React$1.createElement(a.Snackbar,{closeButtonText:i.intl.formatMessage(X),timeoutDelayMs:Oe,title:i.intl.formatMessage(_e.UNDO_SUCCESS),variant:"complete",id:De}))):a.Snackbar.show(t.React$1.createElement(a.Snackbar,{closeButtonText:i.intl.formatMessage(X),timeoutDelayMs:Oe,title:i.intl.formatMessage(_e.UNDO_PARTIAL_ERROR_AUTOMATION_FAILURE),variant:"warn",id:De})):(e=>{const r=i.intl.formatMessage(e?_e.UNDO_PARTIAL_ERROR_AUTOMATION_SUCCESS:_e.UNDO_ERROR);a.Snackbar.show(t.React$1.createElement(a.Snackbar,{closeButtonText:i.intl.formatMessage(X),timeoutDelayMs:Oe,title:r,variant:"warn",id:De}))})(!!T)})),We=(e,t)=>()=>{a.Snackbar.close(De);const i=Pe.getState();(a.isCurrentPathRoot(i)?"":a.path$1(i))!==e&&Pe.dispatch(l.setUrl({path:e})),t()},He=(e,r,s,o)=>{a.Snackbar.show(t.React$1.createElement(a.Snackbar,{actionButtonText:i.intl.formatMessage({id:"3KMB1D",defaultMessage:"Retry"}),onActionClick:o,closeButtonText:i.intl.formatMessage(X),timeoutDelayMs:Oe,title:s,variant:"fail",id:De}))},qe=e=>{a.Snackbar.show(t.React$1.createElement(a.Snackbar,{closeButtonText:i.intl.formatMessage(X),timeoutDelayMs:Oe,title:e,variant:"complete",id:De}))},Xe=(e,r,s,o)=>n.__awaiter(void 0,void 0,void 0,(function*(){a.Snackbar.show(t.React$1.createElement(a.Snackbar,{id:De,title:i.intl.formatMessage(Z.PENDING_AUTOMATION_REMOVAL),variant:"sync"})),yield d.removeFolderRules(r,o).then((()=>{Ze(e,r,s,void 0),qe(i.intl.formatMessage(J.AUTOMATION_REMOVAL_SUCCESS_TEXT))}),(()=>{He(0,0,i.intl.formatMessage(Q.AUTOMATION_REMOVAL_FAILURE),(()=>{Xe(e,r,s,o)}))}))})),je=(e,r,s,o)=>n.__awaiter(void 0,void 0,void 0,(function*(){a.Snackbar.show(t.React$1.createElement(a.Snackbar,{id:De,title:i.intl.formatMessage(Z.PENDING_AUTOMATION_APPLY),variant:"sync"})),yield d.setupFolderRules(r,o).then((()=>{Ze(e,r,s,o),qe(i.intl.formatMessage(J.AUTOMATION_APPLY_SUCCESS_TEXT))}),(()=>{He(0,0,i.intl.formatMessage(Q.AUTOMATION_APPLICATION_FAILURE),(()=>{je(e,r,s,o)}))}))})),Ze=(e,t,i,r)=>{let s;r?r.rules&&r.rules.length>0&&Ue.dispatch(c.mergeUserAutomations([u.convertFolderRuleToAutomation(r.rules[0],t)])):Ue.dispatch(c.removeUserAutomation(t)),r?(s=a.WebUserActionLogEvent.TIDY_UP_AUTOMATION_SET,a.logEvent(function(e){return{class:"tidyup",action:"select",object:"tidyup_automation",properties:e}}({actionSurface:i,tidyupSource:K.tidySourceToPapType(i)}))):(s=a.WebUserActionLogEvent.TIDY_UP_AUTOMATION_REMOVED,a.logEvent({class:"tidyup",action:"remove",object:"tidyup_automation",properties:{actionSurface:i,tidyupSource:K.tidySourceToPapType(i)}})),a.WebUserActionLog.log(e,s,{})},Je=({folderName:e})=>t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement("div",{className:Re},t.React$1.createElement(a.IconContent,{className:Me,height:"24",width:"24",name:"folder-small"}),e?t.React$1.createElement(a.Text,{className:Se},e):t.React$1.createElement(a.Text,{color:"disabled",className:Se},i.intl.formatMessage(ie.defaultFolderSelectionButtonLabel))));Je.displayName="FolderIconAndName";const Qe=({setSelectedDestinationPath:r,selectedDestinationPath:s,isAbsolutePath:n,initialPath:l,onCancel:d,setTidyStateType:c,rootFolderDisplayName:u,isUsedInAutomation:_,handleAutoFolderSelected:m,ruleType:y,currentFolderPath:f})=>{const p=a.getUser(),[T,g]=t.React$1.useState(null!=s?s:l),E=t.React$1.useCallback((t=>{r(t),y===e.TidyUpType.keyphrase?c(e.TidyStateType.Keyphrase):c(e.TidyStateType.CustomFilters)}),[r,c]),[h,v]=t.React$1.useState(!1);if(h)return t.React$1.createElement(et,{selectedFolder:T,onAccept:E,onCancel:()=>v(!1)});const R=n&&s?s:l,M=t.React$1.createElement(o.FolderPicker,{user:p,webTimer:a.get_timer(),onFolderSelected:_?m:e=>{void 0!==e&&g(a.normalize(e))},rootName:u,initialPath:R,canSelectReadonly:!1,apiClient:{getFolderContents:a.getFolderContentsAPIv2},skipFocusOnMount:!0,forceFolderSelectedCallback:!0,size:"small",currentUserPath:f});return _?t.React$1.createElement("div",{className:a.cx("folder-picker-container__fixed-height",Ae)},M):t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement(ve,{label:ie.title}),t.React$1.createElement(a.Modal$1.Body,{className:a.cx("folder-picker-container__fixed-height",Ae)},M),t.React$1.createElement(a.Modal$1.Footer,null,t.React$1.createElement(a.Button$1,{variant:"transparent",onClick:d},i.intl.formatMessage(q)),t.React$1.createElement(a.Button$1,{variant:"opacity",onClick:()=>v(!0)},i.intl.formatMessage(ie.newFolderButtonLabel)),t.React$1.createElement(a.Button$1,{variant:"primary",onClick:()=>{r(T),y===e.TidyUpType.keyphrase?c(e.TidyStateType.Keyphrase):c(e.TidyStateType.CustomFilters)},disabled:f===T},i.intl.formatMessage(ie.folderSelectionButtonLabel))))};Qe.displayName="FolderSelection";const et=({selectedFolder:e,onAccept:r,onCancel:o})=>{const n=({folderName:t})=>{var i;i={pathName:e,folderName:t,user:a.getUser(),checkFSWs:!1,selectCreatedFolder:!1,origin:a.CREATE_FOLDER_ACTION_ORIGIN_TYPE.TIDY_UP_MODAL},Pe.dispatch(l.createFolder(i))},d=t.React$1.useRef(null),[c,u]=t.React$1.useState(""),_=c.length>255?i.intl.formatMessage(ie.folderNameLengthError):function(e){return-1!==e.indexOf("/")||-1!==e.indexOf("\\")||-1!==e.indexOf(":")}(c)?i.intl.formatMessage(ie.folderNameInvalidCharacterError):void 0;return t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement(ve,{label:ie.folderCreationTitleLabel}),t.React$1.createElement(a.Modal$1.Body,null,t.React$1.createElement("div",{className:_?Fe:void 0},t.React$1.createElement(s.FormLabel,{htmlFor:"new_folder_name_input"},i.intl.formatMessage(ie.folderNameLabel)),t.React$1.createElement(a.TextInput,{ref:d,id:"new_folder_name_input",placeholder:i.intl.formatMessage(ie.newFolderInputPlaceholderText),value:c,onChange:e=>u(e.currentTarget.value)}),!!_&&t.React$1.createElement(a.Text,{size:"xsmall",color:"error"},_))),t.React$1.createElement(a.Modal$1.Footer,null,t.React$1.createElement(a.Button$1,{variant:"opacity",onClick:o},i.intl.formatMessage(W)),t.React$1.createElement(a.Button$1,{variant:"primary",disabled:!!_||!c,onClick:()=>{n({folderName:c}),r(a.joinPathWithFileName({fqPath:e,fileName:c}))}},i.intl.formatMessage(ie.folderCreationButtonLabel))))};et.displayName="FolderCreator";const tt=({keyphraseParameters:e,onPreview:r,onCancel:s,onBack:o,setKeyphraseParameters:n,isUsedInAutomationModal:l,onApply:d,skipPreview:c,setTidyStateType:u,rootFolderDisplayName:_})=>{const m=t.React$1.useRef(null),[y,f]=t.reactExports.useState(e.keyphrase),p=((e,a)=>{const[i,r]=t.reactExports.useState(e);return t.reactExports.useEffect((()=>{const t=setTimeout((()=>{r(e)}),a);return()=>{clearTimeout(t)}}),[e,a]),i})(y,300);t.reactExports.useEffect((()=>{p!==e.keyphrase&&n({keyphrase:p})}),[e,n,p]);const T=e.keyphraseDestination,g=!(p&&void 0!==T),E=e=>{"Enter"===e.key&&m.current&&(g?m.current.blur():r())};return l?t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement("div",{className:"tidy-auto-keyphrase-view__text-input"},t.React$1.createElement(a.TextInput,{placeholder:i.intl.formatMessage(ae.INPUT_PLACEHOLDER),onChange:e=>f(e.target.value),value:y,onKeyPress:()=>null,ref:m}),t.React$1.createElement(at,{selectedDestinationPath:T,setTidyStateType:u,rootFolderDisplayName:_}))):t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement(ve,{label:ae.HEADER_LABEL}),t.React$1.createElement(a.Modal$1.Body,null,t.React$1.createElement(a.Text,{className:"tidy-keyphrase-view__input-label",isBold:!0},i.intl.formatMessage(ae.INPUT_LABEL)),t.React$1.createElement(a.TextInput,{placeholder:i.intl.formatMessage(ae.INPUT_PLACEHOLDER),onChange:e=>f(e.target.value),value:y,onKeyPress:E,ref:m}),t.React$1.createElement(at,{selectedDestinationPath:T,setTidyStateType:u,rootFolderDisplayName:_})),t.React$1.createElement(a.Modal$1.Footer,null,t.React$1.createElement(a.Button$1,{variant:"transparent",onClick:o},i.intl.formatMessage(q)),t.React$1.createElement(a.Button$1,{variant:"opacity",onClick:s},i.intl.formatMessage(W)),t.React$1.createElement(a.Button$1,{variant:"primary",onClick:c?d:r,disabled:g},i.intl.formatMessage(c?H:j))))};tt.displayName="TidyUpKeyphraseView";const at=({selectedDestinationPath:r,setTidyStateType:s,rootFolderDisplayName:o})=>t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement(a.Text,{isBold:!0,className:"tidy-keyphrase-view__dropdown-label"},i.intl.formatMessage(ae.FOLDER_SELECTION_LABEL_GLOBAL)),t.React$1.createElement("div",{className:"tidy-keyphrase-view__folder-selection-block"},void 0!==r?t.React$1.createElement("div",{className:"tidy-keyphrase-view__folder-icon-global"},t.React$1.createElement(Je,{folderName:a.filename(r,o)})):t.React$1.createElement(Je,null),t.React$1.createElement(a.Button$1,{variant:"transparent",onClick:()=>{s(e.TidyStateType.KeyphraseFolderSelection)},className:"tidy-keyphrase-view__folder-selection-button"},i.intl.formatMessage(ie.folderSelectionButtonLabel))));at.displayName="DestinationSelectionSection";a.injectInternalStyle("metaserver/static/js/tidy_up/modal/filters_view/tidy_custom_filters.module.out.css",(e=>"._tidy-custom-filters-view__filter-definition_1l8f8_1{border:1px solid var(--color__faint__border);margin-top:var(--spacing__unit--2);padding:var(--spacing__unit--1_5)}._tidy-custom-filters-view__filters_1l8f8_6{max-height:490px;overflow-y:auto}._tidy-custom-filters-view__create-new-filter-container_1l8f8_11{height:18px;padding-top:10.5px}._tidy-custom-filters-view__rule-select-button-text_1l8f8_16{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:138px}._tidy-custom-filters-view__rule-select-button-container_1l8f8_24{display:flex;width:100%}._tidy-custom-filters-view__filter_row_1l8f8_29{display:flex;padding-bottom:var(--spacing__unit--1);padding-top:var(--spacing__unit--1)}._tidy-custom-filters-view__filter_input_1l8f8_35{padding-left:var(--spacing__unit--2);width:290px}._tidy-custom-filters-view__item_container_1l8f8_40{padding-top:var(--spacing__unit--1);width:290px}._tidy-custom-filters-view__chip_1l8f8_45{display:inline-block;padding-right:var(--spacing__unit--0_5)}._tidy-custom-filters-view__file_extension_button_label_1l8f8_50{align-content:flex-start;display:flex;width:250px}._tidy-custom-filters-view__file_extension_submenu_1l8f8_56>div{scrollbar-gutter:stable}._tidy-custom-filters-view__add-rule-button-container_1l8f8_60{display:flex;padding-bottom:var(--spacing__unit--1);padding-left:var(--spacing__unit--0_5)}._tidy-custom-filters-view__folder-selection-container_1l8f8_66{padding-bottom:var(--spacing__unit--1);padding-top:var(--spacing__unit--1)}._tidy-custom-filters-view__folder-selection-label_1l8f8_72{overflow:hidden;padding-right:var(--spacing__unit--1_5);padding-top:5px;text-align:right;white-space:nowrap;width:180px}._tidy-custom-filters-view__folder-selection-dropdown_1l8f8_81{padding-left:var(--spacing__unit--2)}._tidy-custom-filters-view__delete-filter-container_1l8f8_85{display:flex;justify-content:flex-end;margin-right:40px}._tidy-custom-filters-view__size-filter-row_1l8f8_91{align-items:column;display:flex;justify-content:space-between;margin-bottom:10px;width:290px}._tidy-custom-filters-view__size-filter-label_1l8f8_99{font:Atlas Grotesk;font-size:14;height:18px;min-width:138px}._tidy-custom-filters-view__size-filter-input_1l8f8_106{width:80px}._tidy-custom-filters-view__size-filter-unit_1l8f8_110{margin-left:10px;width:60px}._tidy-custom-filters-view__size-filter_error_1l8f8_115{margin-top:-10px}._tidy-custom-filters-view__folder-selection-container_1l8f8_66{display:flex}._tidy-custom-filters-view__folder-selection-block_1l8f8_123{border:1px solid var(--color__faint__border);display:flex;height:32px;padding-left:var(--spacing__unit--1);width:285px}._tidy-custom-filters-view__folder-icon_1l8f8_131{padding-top:3px;width:138px}._tidy-custom-filters-view__folder-selection-button_1l8f8_136{display:flex;justify-content:flex-end;margin-right:10px;padding-top:5px;width:152px}._tidy-custom-filters-view__show_more_class_name_1l8f8_144{cursor:pointer}"));const it="_tidy-custom-filters-view__filter-definition_1l8f8_1",rt="_tidy-custom-filters-view__filters_1l8f8_6",st="_tidy-custom-filters-view__create-new-filter-container_1l8f8_11",ot="_tidy-custom-filters-view__rule-select-button-text_1l8f8_16",nt="_tidy-custom-filters-view__rule-select-button-container_1l8f8_24",lt="_tidy-custom-filters-view__filter_row_1l8f8_29",dt="_tidy-custom-filters-view__filter_input_1l8f8_35",ct="_tidy-custom-filters-view__item_container_1l8f8_40",ut="_tidy-custom-filters-view__chip_1l8f8_45",_t="_tidy-custom-filters-view__file_extension_button_label_1l8f8_50",mt="_tidy-custom-filters-view__file_extension_submenu_1l8f8_56",yt="_tidy-custom-filters-view__add-rule-button-container_1l8f8_60",ft="_tidy-custom-filters-view__folder-selection-container_1l8f8_66",pt="_tidy-custom-filters-view__folder-selection-label_1l8f8_72",Tt="_tidy-custom-filters-view__delete-filter-container_1l8f8_85",gt="_tidy-custom-filters-view__size-filter-row_1l8f8_91",Et="_tidy-custom-filters-view__size-filter-label_1l8f8_99",ht="_tidy-custom-filters-view__size-filter-input_1l8f8_106",vt="_tidy-custom-filters-view__size-filter-unit_1l8f8_110",Rt="_tidy-custom-filters-view__size-filter_error_1l8f8_115",Mt="_tidy-custom-filters-view__folder-selection-block_1l8f8_123",St="_tidy-custom-filters-view__folder-icon_1l8f8_131",At="_tidy-custom-filters-view__folder-selection-button_1l8f8_136",Ft="_tidy-custom-filters-view__show_more_class_name_1l8f8_144";function It(e,t){throw new Error(`${t} (value=${e})`)}const Lt=new Map([["Images",["jpg","jpeg","bmp","png","tif","tiff","gif"]],["Camera files",["raw","raf","dng","nef","cr2","ari","arw","kdc","orf","rw2"]],["Design files",["indd","pct","dds","psd","tga","thm","ai","eps","ps","svg","3dm","3ds","dwg","dwl","dwl2","dwf","dxf","max","ttf","otf","eot","woff","ico","icns","vsd","dgn","cdr","idml","idlk","skp","sketch","hus"]],["Documents",["paper","ppt","pptx","pptm","pps","ppsx","ppsm","xlr","xls","xlsm","xlsx","doc","docx","docm","dotm","dotx","PDF","csv","txt"]],["ebook",["aep","epub","mobi","ibooks","koob","opf"]],["Data developer",["dat","sql","kml","xml","yml","sqlite","sqlite3","mdb","accdb","db","log","sav","dbf","tmp","sdf"]],["Audio",["aif","iff","m3u","m4a","mid","mp3","mpa","wav","wma","aiff","flac","arf"]],["Video",["3gp","asf","avi","flv","m4v","mov","mp4","mpg","srt","swf","vob","wmv","mpeg"]],["Compressed",["zip","rar","7z","gz","tar","bz","bz2"]],["Executable",["cab","exe","dmg","iso","msi","apk","ipa"]]]),bt=new Map([["Images",i.defineMessage({id:"dW3xfE",defaultMessage:"Images"})],["Camera files",i.defineMessage({id:"5nK6pv",defaultMessage:"Camera files"})],["Design files",i.defineMessage({id:"WLsq2k",defaultMessage:"Design files"})],["ebook",i.defineMessage({id:"sIoSkG",defaultMessage:"ebook"})],["Documents",i.defineMessage({id:"Vl9hPf",defaultMessage:"Documents"})],["Data developer",i.defineMessage({id:"8G7ImG",defaultMessage:"Data developer"})],["Audio",i.defineMessage({id:"m+/26v",defaultMessage:"Audio"})],["Video",i.defineMessage({id:"EV9ZNs",defaultMessage:"Video"})],["Compressed",i.defineMessage({id:"LDfQHc",defaultMessage:"Compressed"})],["Executable",i.defineMessage({id:"19V9Ik",defaultMessage:"Executable"})]]),wt=i.defineMessage({id:"2Fjld/",defaultMessage:"Enter keyword"}),Nt=i.defineMessage({id:"B7xr1A",defaultMessage:"Select file extension"}),Ct=i.defineMessages({None:{id:"T+ub8I",defaultMessage:"Select rule"},Keyword:{id:"J9sJT/",defaultMessage:"Keyword"},FileExtension:{id:"XQ8kUV",defaultMessage:"File extension"},Size:{id:"iJDd0n",defaultMessage:"Size"}}),Ot=t.React$1.memo((({selectedFilterType:s,onRuleChange:o,primarySelection:n,options:l,onDeleteRule:d})=>{const[c,u]=t.React$1.useState(s),[_,m]=t.React$1.useState(Ct.None),[y,f]=t.React$1.useState(n);t.React$1.useEffect((()=>{p(c)}),[]),t.React$1.useEffect((()=>{switch(c){case e.TidyCustomFiltersType.Keyword:o({type:c,keywordRule:{keywords:y}});break;case e.TidyCustomFiltersType.FileExtension:o({type:c,fileExtensionRule:{fileExtensions:y}});break;case e.TidyCustomFiltersType.Size:o({type:c,sizeRule:{sizes:y}})}}),[y,c]);const p=t=>{switch(c!==t&&f([]),t){case e.TidyCustomFiltersType.Keyword:u(e.TidyCustomFiltersType.Keyword),m(Ct.Keyword);break;case e.TidyCustomFiltersType.FileExtension:u(e.TidyCustomFiltersType.FileExtension),m(Ct.FileExtension);break;case e.TidyCustomFiltersType.Size:u(e.TidyCustomFiltersType.Size),m(Ct.Size)}};let T=t.React$1.createElement(t.React$1.Fragment,null),g=!0;switch(c){case e.TidyCustomFiltersType.Keyword:T=t.React$1.createElement($t,{keywords:y,setKeywords:f});break;case e.TidyCustomFiltersType.FileExtension:T=t.React$1.createElement(Yt,{selectedFileExtensions:y,setSelectedFileExtensions:f});break;case e.TidyCustomFiltersType.Size:T=t.React$1.createElement(xt,{sizes:y,setSizes:f});break;default:g=!1}return t.React$1.createElement("div",{className:lt},t.React$1.createElement(a.Menu.Wrapper,{matchContainingWidth:!0,onSelection:p},(({getContentProps:e,getTriggerProps:r})=>t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement(a.Button$1,Object.assign({variant:"opacity",withDropdownIcon:!0},r()),t.React$1.createElement("div",{className:nt},t.React$1.createElement(a.Text,{className:ot},i.intl.formatMessage(_)))),t.React$1.createElement(a.Menu.Content,Object.assign({},e()),t.React$1.createElement(a.Menu.Segment,null,l.map((e=>t.React$1.createElement(a.Menu.SelectItem,{key:e,value:e,selected:e===c},i.intl.formatMessage(Ct[e]))))))))),t.React$1.createElement("div",{className:dt},T,T.type!==xt&&t.React$1.createElement("div",{className:ct},t.React$1.createElement(r.ItemTruncationContainerWithoutCss,{containerMaxRows:1,items:y,itemsToMoreTooltipString:Pt,renderItem:Dt(y,f),showMoreClassName:Ft}))),g&&t.React$1.createElement(a.IconButton,{variant:"transparent",onClick:d,"data-testid":"delete-button"},t.React$1.createElement(a.UIIcon,{src:a.DeleteLine})))}));Ot.displayName="TidyCustomFiltersRow";const Dt=(e,i)=>({item:r,ref:s,index:o})=>t.React$1.createElement("div",{className:ut,key:o},t.React$1.createElement(a.InputChip,{key:r,size:"small",ref:s,onDelete:()=>{return t=r,void i(e.filter((e=>e!==t)));var t}},r)),Pt=e=>e.map((e=>e)).join(" ");var Ut;!function(e){e[e.none=0]="none",e[e.invalid_characters=1]="invalid_characters",e[e.too_large=2]="too_large",e[e.invalid_range=3]="invalid_range"}(Ut||(Ut={}));const xt=t.React$1.memo((({sizes:e,setSizes:r})=>{const s=t.React$1.useRef(null),[o,n]=t.React$1.useState(2===e.length?e[0].split("_")[0]:"0"),[l,d]=t.React$1.useState(2===e.length?e[1].split("_")[0]:"0"),[c,u]=t.React$1.useState(2===e.length?e[0].split("_")[1]:"GB"),[_,m]=t.React$1.useState(2===e.length?e[1].split("_")[1]:"GB"),[y,f]=t.React$1.useState(Ut.none),p=(e,t)=>"GB"===t?1024*parseInt(e,10):parseInt(e,10);t.React$1.useEffect((()=>/^[0-9]*$/.test(o)&&/^[0-9]*$/.test(l)?p(o,c)>102400?(r([]),void f(Ut.too_large)):p(l,_)>p(o,c)?(r([]),void f(Ut.invalid_range)):(r([o.toString()+"_"+c,l.toString()+"_"+_]),void f(Ut.none)):(r([]),void f(Ut.invalid_characters))),[y,o,l,c,_]);const T=(e=>{switch(e){case Ut.none:return;case Ut.invalid_characters:return i.intl.formatMessage(re.SIZE_INVALID_CHARACTERS_ERROR_LABEL);case Ut.too_large:return i.intl.formatMessage(re.SIZE_TOO_LARGE_ERROR_LABEL);case Ut.invalid_range:return i.intl.formatMessage(re.SIZE_INVALID_RANGE_ERROR_LABEL);default:It(e)}})(y);return t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement("div",{className:gt},t.React$1.createElement("p",{className:Et},re.FILES_GREATER_THAN_LABEL.defaultMessage),t.React$1.createElement("div",{className:ht},t.React$1.createElement(a.TextInput,{value:l,onChange:e=>{d(e.currentTarget.value)},ref:s,isInvalid:y!==Ut.none,"data-testid":"min-size-input"})),t.React$1.createElement("div",{className:vt},t.React$1.createElement(a.Select,{id:"min-size-unit","data-testid":"size-unit",value:_,onChange:e=>m(e)},t.React$1.createElement(a.Select.Option,{value:"GB"},"GB"),t.React$1.createElement(a.Select.Option,{value:"MB"},"MB")))),t.React$1.createElement("div",{className:gt},t.React$1.createElement("p",{className:Et},re.FILES_SMALLER_THAN_LABEL.defaultMessage),t.React$1.createElement("div",{className:ht},t.React$1.createElement(a.TextInput,{value:o,onChange:e=>{n(e.currentTarget.value)},ref:s,isInvalid:y!==Ut.none,"data-testid":"max-size-input"})),t.React$1.createElement("div",{className:vt},t.React$1.createElement(a.Select,{id:"max-size-unit","data-testid":"size-unit",value:c,onChange:e=>u(e)},t.React$1.createElement(a.Select.Option,{value:"GB"},"GB"),t.React$1.createElement(a.Select.Option,{value:"MB"},"MB")))),y!==Ut.none&&t.React$1.createElement("div",{className:Rt},t.React$1.createElement(a.Text,{size:"xsmall",color:"error"},T)))}));var kt;xt.displayName="TidyUpSizeInput",function(e){e[e.none=0]="none",e[e.no_input=1]="no_input",e[e.invalid_characters=2]="invalid_characters",e[e.too_long=3]="too_long",e[e.already_exists=4]="already_exists"}(kt||(kt={}));const $t=t.React$1.memo((({keywords:e,setKeywords:r})=>{const s=t.React$1.useRef(null),[o,n]=t.React$1.useState(""),[l,d]=t.React$1.useState(kt.none);t.React$1.useEffect((()=>{/^[0-9a-zA-Z_]*$/.test(o)?o.length>15?d(kt.too_long):l===kt.no_input&&0===o.length||(-1===e.indexOf(o)?d(kt.none):d(kt.already_exists)):d(kt.invalid_characters)}),[l,o,e]);const c=(e=>{switch(e){case kt.none:return;case kt.no_input:return i.intl.formatMessage(re.KEYWORD_EMPTY_INPUT_ERROR_LABEL);case kt.invalid_characters:return i.intl.formatMessage(re.KEYWORD_INVALID_CHARACTERS_ERROR_LABEL);case kt.too_long:return i.intl.formatMessage(re.KEYWORD_TOO_LONG_ERROR_LABEL);case kt.already_exists:return i.intl.formatMessage(re.KEYWORD_ALREADY_EXISTS_ERROR_LABEL);default:It(e)}})(l);return t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement(a.TextInput,{placeholder:i.intl.formatMessage(wt),value:o,onChange:e=>n(e.currentTarget.value),onKeyDown:t=>{"Enter"===t.key&&l===kt.none&&(""===o?d(kt.no_input):(r([...e,o]),n("")))},ref:s,isInvalid:l!==kt.none}),l!==kt.none&&t.React$1.createElement(a.Text,{size:"xsmall",color:"error"},c))}));$t.displayName="TidyUpKeywordTextInput";const Yt=t.React$1.memo((({selectedFileExtensions:e,setSelectedFileExtensions:r})=>{const s=t=>{t.target.checked?r([...e,t.target.value]):r(e.filter((e=>e!==t.target.value)))},o=t=>{var a;const i=null!==(a=Lt.get(t.target.value))&&void 0!==a?a:[];if(t.target.checked){const t=new Set([...e,...i]);r(Array.from(t))}else r(e.filter((e=>!i.includes(e))))},n=t=>{var a;const i=null!==(a=Lt.get(t))&&void 0!==a?a:[];let r=0;return i.forEach((t=>{e.includes(t)&&r++})),r>0&&r!==i.length},l=t=>{var a;const i=null!==(a=Lt.get(t))&&void 0!==a?a:[];let r=0;return i.forEach((t=>{e.includes(t)&&r++})),r===i.length};return t.React$1.useEffect((()=>{r(e)}),[e]),t.React$1.useEffect((()=>{r(e)}),[e]),t.React$1.createElement(a.Menu.Wrapper,{hasMaxHeight:336},(({getContentProps:r,getTriggerProps:d})=>t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement(a.Button$1,Object.assign({variant:"opacity",withDropdownIcon:!0},d()),t.React$1.createElement("div",{className:_t},t.React$1.createElement(a.Text,null,i.intl.formatMessage(Nt)))),t.React$1.createElement(a.Menu.Content,Object.assign({},r()),t.React$1.createElement(a.Menu.Segment,null,Array.from(Lt.entries()).map((r=>{var d;const[c,u]=r,_=null!==(d=bt.get(c))&&void 0!==d?d:{};return t.React$1.createElement(a.Menu.Submenu,{id:c,key:c,withTriggerContent:i.intl.formatMessage(_),withLeftAccessory:t.React$1.createElement(a.Checkbox,{checked:l(c),isIndeterminate:n(c),readOnly:!0,tabIndex:-1,value:c,onChange:o}),contentClassName:mt},t.React$1.createElement(a.Menu.Segment,null,u.map((i=>t.React$1.createElement(a.Menu.SelectItem,{key:i,withLeftAccessory:t.React$1.createElement(a.Checkbox,{checked:e.includes(i),readOnly:!0,tabIndex:-1,value:i,onChange:s})},i)))))})))))))}));Yt.displayName="TidyUpFileExtensionSelection";const Bt=[e.TidyCustomFiltersType.FileExtension,e.TidyCustomFiltersType.Keyword,e.TidyCustomFiltersType.Size],Vt=({onPreview:r,onCancel:s,onBack:o,setCustomFilterParameters:n,customFilterParameters:l,setTidyStateType:d,setCustomFilterFolderSelectionIndex:c,rootFolderDisplayName:u,isUsedInAutomation:_,updateLastSetRuleType:m,onApply:y,skipPreview:f})=>{t.React$1.useEffect((()=>{0===l.filters.length&&n({filters:[{id:Date.now(),rules:[{type:e.TidyCustomFiltersType.None}],actions:{destination:void 0}}]})}),[l]);const p=t.React$1.useCallback(((e,t,a,i)=>{const r={id:l.filters[e].id,rules:[...l.filters[e].rules],actions:Object.assign({},l.filters[e].actions)};void 0!==a&&void 0!==t&&(r.rules[t]=a),i&&(r.actions.destination=i),n({filters:l.filters.slice(0,e).concat([r]).concat(l.filters.slice(e+1))})}),[l]),T=()=>l.filters.every((e=>e.rules.every((t=>(t.keywordRule&&t.keywordRule.keywords&&t.keywordRule.keywords.length>0||t.fileExtensionRule&&t.fileExtensionRule.fileExtensions&&t.fileExtensionRule.fileExtensions.length>0||t.sizeRule&&2==t.sizeRule.sizes.length)&&void 0!==e.actions.destination)))),g=t.React$1.useCallback((t=>{const a={id:l.filters[t].id,rules:[...l.filters[t].rules,{type:e.TidyCustomFiltersType.None}],actions:l.filters[t].actions};n({filters:l.filters.slice(0,t).concat([a]).concat(l.filters.slice(t+1))})}),[l]),E=t.React$1.useCallback((()=>{n({filters:[...l.filters,{id:Date.now(),rules:[{type:e.TidyCustomFiltersType.None}],actions:{destination:void 0}}]})}),[l]),h=t.React$1.useCallback(((t,a)=>{const i=l.filters[t].rules;i.splice(a,1);const r={id:l.filters[t].id,rules:0===i.length?[{type:e.TidyCustomFiltersType.None}]:i,actions:0===i.length?{destination:void 0}:l.filters[t].actions};n({filters:l.filters.slice(0,t).concat([r]).concat(l.filters.slice(t+1))}),m(e.TidyCustomFiltersType.None)}),[l,m]),v=t.React$1.useCallback((t=>{const a=Array.from(l.filters);a.splice(t,1),n({filters:a}),m(e.TidyCustomFiltersType.None)}),[l,m]);return _?t.React$1.createElement(Kt,{customFilterParameters:l,addRule:g,addFilter:E,deleteFilter:v,areFiltersValid:T,updateFilter:p,deleteRule:h,rootFolderDisplayName:u,setCustomFilterFolderSelectionIndex:c,setTidyStateType:d,isUsedInAutomation:_,updateLastSetRuleType:m}):t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement(ve,{label:re.HEADER_LABEL}),t.React$1.createElement(a.Modal$1.Body,null,t.React$1.createElement(Kt,{customFilterParameters:l,addRule:g,addFilter:E,deleteFilter:v,areFiltersValid:T,updateFilter:p,deleteRule:h,rootFolderDisplayName:u,setCustomFilterFolderSelectionIndex:c,setTidyStateType:d,isUsedInAutomation:_,updateLastSetRuleType:m})),t.React$1.createElement(a.Modal$1.Footer,null,t.React$1.createElement(a.Button$1,{variant:"transparent",onClick:o},i.intl.formatMessage(q)),t.React$1.createElement(a.Button$1,{variant:"opacity",onClick:s},i.intl.formatMessage(W)),t.React$1.createElement(a.Button$1,{variant:"primary",onClick:f?y:r,disabled:!T()},i.intl.formatMessage(f?H:j))))};Vt.displayName="TidyUpCustomFiltersView";const zt=({filterIndex:a,ruleIndex:i,type:r,updateFilter:s,rule:o,options:n,deleteRule:l,updateLastSetRuleType:d})=>{var c;const u=t.React$1.useCallback((e=>{s(a,i,e),d(e.type)}),[s,d,a,i]);let _=[];switch(r){case e.TidyCustomFiltersType.None:1===n.length&&(r=n[0]);break;case e.TidyCustomFiltersType.Keyword:_=o.keywordRule?o.keywordRule.keywords:[];break;case e.TidyCustomFiltersType.FileExtension:_=o.fileExtensionRule?o.fileExtensionRule.fileExtensions:[];break;case e.TidyCustomFiltersType.Size:_=o.sizeRule?null===(c=o.sizeRule)||void 0===c?void 0:c.sizes:[]}return t.React$1.createElement("div",{key:r},t.React$1.createElement(Ot,{selectedFilterType:r,onRuleChange:u,primarySelection:_,options:n,onDeleteRule:()=>l(a,i),key:r}))};zt.displayName="TidyCustomFilterList";const Kt=({customFilterParameters:r,addRule:s,addFilter:o,deleteFilter:n,areFiltersValid:l,updateFilter:d,deleteRule:c,setTidyStateType:u,setCustomFilterFolderSelectionIndex:_,rootFolderDisplayName:m,isUsedInAutomation:y,updateLastSetRuleType:f})=>t.React$1.createElement(t.React$1.Fragment,null,t.React$1.createElement(a.Text,null,i.intl.formatMessage(re.BODY_LABEL)),t.React$1.createElement("div",{className:y?"":rt},r.filters.map(((o,l)=>t.React$1.createElement("div",{className:it,key:o.id},o.rules.map(((e,a)=>{const i=o.rules.map((e=>e.type)),r=Bt.filter((e=>!i.includes(e)));return t.React$1.createElement(zt,{key:e.type,filterIndex:l,ruleIndex:a,type:e.type,rule:e,updateFilter:d,options:r,deleteRule:c,updateLastSetRuleType:f})})),t.React$1.createElement("div",{className:yt},t.React$1.createElement(a.Button$1,{variant:"transparent",onClick:()=>s(l),disabled:o.rules.length===Bt.length||o.rules.some((t=>t.type===e.TidyCustomFiltersType.None))},i.intl.formatMessage(re.ADD_RULE_LABEL))),!(1===o.rules.length&&o.rules[0].type===e.TidyCustomFiltersType.None)&&t.React$1.createElement("div",{className:ft},t.React$1.createElement("div",{className:pt},t.React$1.createElement(a.Text,{color:"faint"},i.intl.formatMessage(re.FOLDER_SELECTION_LABEL))),t.React$1.createElement("div",{className:Mt},void 0!==o.actions.destination?t.React$1.createElement("div",{className:St},t.React$1.createElement(Je,{folderName:a.filename(o.actions.destination,m)})):t.React$1.createElement(Je,null),t.React$1.createElement(a.Button$1,{variant:"transparent",onClick:()=>{_(l),u(e.TidyStateType.CustomFilterFolderSelection)},className:At},i.intl.formatMessage(ie.folderSelectionButtonLabel)))),(!(1===o.rules.length&&o.rules[0].type===e.TidyCustomFiltersType.None)||r.filters.length>1)&&t.React$1.createElement("div",{className:Tt},t.React$1.createElement(a.Button$1,{variant:"transparent",onClick:()=>n(l)},i.intl.formatMessage(re.DELETE_FILTER_LABEL))))))),t.React$1.createElement("div",{className:st},t.React$1.createElement(a.Button$1,{variant:"transparent",withIconLeft:t.React$1.createElement(a.UIIcon,{src:a.AddCircleLine,role:"presentation"}),onClick:o,disabled:!l()},i.intl.formatMessage(re.CREATE_FILTER_LABEL))));Kt.displayName="CustomFiltersSelection",e.AutomationConversions=z,e.DayRelatedFolderStructure=w,e.FolderSelection=Qe,e.MonthRelatedFolderStructure=L,e.PAP_Attempt_Tidyup=Ne,e.PREVIEW_FILE_LIMIT=100,e.TIDY_CONFIRMATION=ue,e.TIDY_ERROR=Q,e.TIDY_INACTIVE_OPTION=fe,e.TIDY_MODAL_HEADER=me,e.TIDY_MODAL_SUBTITLE=ye,e.TIDY_OPTION_STRINGS=pe,e.TIDY_PENDING=Z,e.TIDY_PREVIEW=ee,e.TIDY_SMART_PREVIEW=te,e.TIDY_TIME_FRAME_FILTER=se,e.TIDY_UP_MODAL_APPLY_LABEL=H,e.TIDY_UP_MODAL_BACK_LABEL=q,e.TIDY_UP_MODAL_CANCEL_LABEL=W,e.TIDY_UP_MODAL_CLOSE_LABEL=G,e.TIDY_UP_MODAL_PREVIEW_LABEL=j,e.TIDY_UP_MONTH_DESCRIPTION=he,e.TIDY_UP_MONTH_SELECTION=Ee,e.TIDY_UP_YEAR_DESCRIPTION=ge,e.TIDY_UP_YEAR_SELECTION=Te,e.TidyConversions=K,e.TidyTimeFrameFolderDateRuleLabels=oe,e.TidyTimeFrameFolderNamingDayLabels=ce,e.TidyTimeFrameFolderNamingMonthLabels=le,e.TidyTimeFrameFolderNamingYearLabels=de,e.TidyTimeFrameFolderStructureLabels=ne,e.TidyUpCustomFiltersView=Vt,e.TidyUpKeyphraseView=tt,e.TidyUpModalHeader=ve,e.YearRelatedFolderStructure=b,e.asyncApplyTidyup=e=>n.__awaiter(void 0,void 0,void 0,(function*(){var r,s,o,l,d,c,u,_;const{currentUserId:m,targetPath:y,namespaceId:f,tidyParameters:p,actionSurface:T,openModalCallback:g,shouldApplyAutomation:E,shouldRemoveAutomation:h,previousAutomationRuleSet:v,sourceToDestinationPaths:R,onSuccess:M,onError:S,initialPendingTextOverride:A}=e;let F=!1;const I=h||E,L=null!=A?A:i.intl.formatMessage(Z.PENDING_TEXT_1),b=i.intl.formatMessage(Z.STILL_WORKING_TEXT_1);a.Snackbar.show(t.React$1.createElement(a.Snackbar,{id:De,title:L,variant:"sync"})),setTimeout((()=>{F||a.Snackbar.update(t.React$1.createElement(a.Snackbar,{id:De,title:b,variant:"sync"}))}),5e3);const w=K.tidyTypeToFlowsAPI(p);let N=Promise.resolve(void 0),C=Promise.resolve(void 0);E?N=xe(m,y,T,w):h&&(C=ke(m,y,T));const O=K.tidyTypeToApiV2(p);let D;D=R?function(e,t,i,r){return n.__awaiter(this,void 0,void 0,(function*(){const s=new a.UserApiV2Client;return we((()=>s.ns("tidy_up").rpc("apply_preview",{rule:i,source_path:t,entries_to_tidy:r,source:"web_modal"},{subjectUserId:e})),e,s)}))}(m,y,O,R):function(e,t,i,r){return n.__awaiter(this,void 0,void 0,(function*(){const s=new a.UserApiV2Client;return we((()=>s.ns("tidy_up").rpc("tidy",{request:r,source_path:t,ns_id:i,source:"web_modal"},{subjectUserId:e})),e,s)}))}(m,y,f,O);const[P,U,x]=yield Promise.all([D,N,C]);if(F=!0,P.isError||P.result.entries.length>0&&P.result.entries.every((e=>"failure"===e[".tag"]))){S&&S(P.error[".tag"]);const e=P.isError?-1:P.result.entries.length;return void Be(y,p,T,E,h,g,m,e,f,!!U||!!x)}if(!1===U||!1===x)return void Ve(m,U,x,y,T,w);const k=P.result.entries,$=k.some((e=>"failure"===e[".tag"])),Y=(null!==(r=P.result.moved_files_changesets)&&void 0!==r?r:[]).length>0||(null!==(s=P.result.created_directories_changesets)&&void 0!==s?s:[]).length>0||(null!==(l=null===(o=P.result.renamed_directories)||void 0===o?void 0:o.changesets)&&void 0!==l?l:[]).length>0?Ge(y,T,m,f,k,null!==(d=P.result.moved_files_changesets)&&void 0!==d?d:[],null!==(c=P.result.created_directories_changesets)&&void 0!==c?c:[],null!==(_=null===(u=P.result.renamed_directories)||void 0===u?void 0:u.changesets)&&void 0!==_?_:[],I?v:void 0):void 0;if($)return void ze(k.filter((e=>"failure"!==e[".tag"])).length,k.filter((e=>"failure"===e[".tag"])).length,y,p,T,E,h,g,m,f,Y);0===k.length?Ke():(M&&M(),$e(k.length,y,p,T,E,h,m,f,Y))})),e.createRequestPreviewDataFn=(e,t)=>{const i=t.replace(/\/$/,"");return r=>n.__awaiter(void 0,void 0,void 0,(function*(){var s,o,n,l,d,c,u,_,m;const y=new a.UserApiV2Client,f=[];try{let t=yield y.ns("files").rpc("list_folder",{path:i},{subjectUserId:e});for(f.push(...t.entries);t.has_more;)t=yield y.ns("files").rpc("list_folder/continue",{cursor:t.cursor},{subjectUserId:e}),f.push(...t.entries)}catch(e){return{error_tag:"list_files"}}const p={},T=[];for(const e of f)"file"===e[".tag"]&&(p[e.id]=e,T.push(e.id));if(0===T.length)return{error_tag:"no_files"};let g;null===(s=r.onPreviewDatafetchListfolderDone)||void 0===s||s.call(r);try{g=yield y.ns("tidy_up").rpc("smart_preview",{request:{".tag":"smart_move_request",entry_ids:T}},{subjectUserId:e})}catch(e){const t=null===(o=null==e?void 0:e.error)||void 0===o?void 0:o[".tag"];if(!t)return{error_tag:"other"};switch(t){case"path":return{error_tag:"path_not_found"};case"multiple_containing_folders":case"no_files":case"no_containing_folder":case"no_destinations":case"cannot_move_entry":case"list_files":return{error_tag:t};default:return{error_tag:"other"}}}const E={};for(const e of null!==(n=g.destinations)&&void 0!==n?n:[])e.name&&(E[e.id]={id:e.id,folderName:e.name,path:`${t}/${e.name}`});const h=[];for(const e of null!==(l=g.entries)&&void 0!==l?l:[])(null===(d=p[e.id])||void 0===d?void 0:d.name)&&e.destination_ids&&e.suggested_destination_id&&h.push({id:e.id,filename:p[e.id].name,allowedDestinationIds:e.destination_ids.map(N),suggestedDestinationId:e.suggested_destination_id,isMlSuggestion:null!==(c=e.is_ml_suggestion)&&void 0!==c?c:null,predictId:null!==(u=e.prediction_id)&&void 0!==u?u:null,score:null!==(_=e.score)&&void 0!==_?_:null,suggestionConfidence:K.confidenceLevelFromApi(e.confidence_interval),path:null!==(m=p[e.id].path_lower)&&void 0!==m?m:null});return{entries:h,destinations:E}}))},e.defaultTidyParameters=A,e.enforceExhaustive=function(e){return e},e.getKeyphrases=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const i=new a.UserApiV2Client;try{return(yield i.ns("tidy_up").rpc("get_keyphrases",{path:t},{subjectUserId:e})).entries}catch(e){return[]}}))},e.getStoredFilters=function(e,t){return n.__awaiter(this,void 0,void 0,(function*(){const i=new a.UserApiV2Client;try{const a=yield i.ns("tidy_up_api_proxy").rpc("get_stored_custom_filters",{folder_path:t},{subjectUserId:e});let r=[];return void 0!==a.filters&&void 0!==a.filters.filters&&(r=a.filters.filters),r}catch(e){return[]}}))},e.initialTidyState=T,e.preview=function(e,t,i){return n.__awaiter(this,void 0,void 0,(function*(){const r=new a.UserApiV2Client;try{return{result:yield r.ns("tidy_up").rpc("preview",{rule:i,source_path:a.normalize(t)},{subjectUserId:e})}}catch(e){return{isError:!0,error:e.error,error_summary:e.summary}}}))},e.throwEnforceExhaustive=It}));
//# sourceMappingURL=c_modal_filters_view_tidy_filters.js-vflpR5YXa.map
