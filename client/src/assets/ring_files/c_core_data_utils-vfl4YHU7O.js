define(["exports","./e_edison","./e_ui_page_files_router","./c_core_data_preview_key","./c_core_types_preview_type"],(function(e,i,t,n,r){"use strict";const o="info_blade",l="transcript_blade",a="comments",u="file_activity",c="previews_ai_plugin",s=[o,u],d=i.React$1.createContext(null);d.displayName="FileViewerContext";const v=()=>i.React$1.useContext(d),f=d.Provider;function g(e){return null!=e&&"entries"in e?e:void 0}function w(e){return e&&"isTruncated"in e?e:void 0}function p(e){return e&&"fitScaleFactor"in e?e:void 0}function P(e,i){return e.rootFileInfo[i]}const _=t.createSelector(P,y,m,((e,i,t)=>{var r;const o=g(t);if(!(null==e?void 0:e.file_id)||!o||!(null==i?void 0:i.currentPath)||0===i.currentPath.length)return null==e?void 0:e.previewKey;const l=n.getSubpath(i.currentPath);return(null===(r=o.entries[l])||void 0===r?void 0:r.isDir)?e.previewKey:n.getPreviewKeyForNestedArchiveFile(e.file_id,l)})),F=(e,i)=>{const t=_(e,i),r=P(e,i);return t&&n.isNestedArchiveFilePreviewKey(t)?void 0:r};function I(e,i){var t;return null===(t=P(e,i))||void 0===t?void 0:t.previewKey}function h(e,i){return i?n.isNestedArchiveFilePreviewKey(i)?S(e.archiveFiles,i):e.previewData[i.serialized]:void 0}function R(e,i){var t,n;return null!==(n=null===(t=h(e,i))||void 0===t?void 0:t.previewType)&&void 0!==n?n:r.PreviewType.Error}function S(e,i){const t=e[i.rootFileId];if(t)return t[i.subpath]}function b(e,i){return i&&e.rivieraData[i.serialized]}function m(e,i){const t=I(e,i);return t&&e.rivieraData[t.serialized]}function D(e,i){return i&&e.fileMetadata[i.serialized]}function T(e,i,t){var n;return t&&(null===(n=e.filePreviewUi[i])||void 0===n?void 0:n[t.serialized])}function y(e,i){const t=P(e,i);return t&&T(e,i,t.previewKey)}function U(e,i){return T(e,i,_(e,i))}function E(e,i){var t,r;const o=I(e,i),l=D(e,o),a=_(e,i);if(!a||!n.isNestedArchiveFilePreviewKey(a))return l;const u=null===(t=g(b(e,o)))||void 0===t?void 0:t.entries[a.subpath];return l&&u&&!u.isDir?{file_name:u.name,file_collection_context:l.file_collection_context,size:null!==(r=u.size)&&void 0!==r?r:0}:l}function C(e,i){return e.fileViewerUi[i]}function V(e,i){const t=C(e,i);return!!(null==t?void 0:t.isFullScreen)}function A(e,i){return i&&e.fileContentMetadata[i.serialized]}function z(e,i){return t.useSelector((t=>e(t,i)))}function B(e,i){return t.useSelector((t=>e(t,i)))}const M=(e,i)=>!e||i===r.PreviewType.Excel;function x(){const{fileViewerId:e,featureConfig:i}=v(),t=z(_,e),r=B(R,t),o=z(V,e),l=n.isRedesign2023Enabled(i);return{fileViewerId:e,previewKey:t,previewType:r,showInverse:l?o:M(o,r),isFullScreen:o,isRedesignEnabled:l}}const L=()=>{const[e,n]=i.React$1.useState();return i.React$1.useEffect((()=>{const e=new t.ResizeObserver((e=>{n(e[0].contentRect)}));return e.observe(document.body),()=>e.disconnect()}),[]),e};var k;e.ToolbarBreakpoint=void 0,(k=e.ToolbarBreakpoint||(e.ToolbarBreakpoint={})).Small="small",k.Medium="medium",k.Large="large";const K=({label:e,onClick:n,icon:r,disabled:o,isOpaque:l})=>{const{showInverse:a}=x();return i.reactExports.createElement(t.IconButton,{variant:l?"opacity":"transparent","aria-label":e,onClick:n,disabled:o,inverse:a},i.reactExports.createElement(t.UIIcon,{src:r}))};K.displayName="ToolbarIcon";const N=i=>void 0===i||i>1024?e.ToolbarBreakpoint.Large:i>768?e.ToolbarBreakpoint.Medium:e.ToolbarBreakpoint.Small;e.AI_PLUGIN_ID=c,e.COMMENTS_PLUGIN_ID=a,e.FILE_ACTIVITY_PLUGIN_ID=u,e.FileViewerContextProvider=f,e.INFO_BLADE_PLUGIN_ID=o,e.PDF_EDITOR_PLUGIN_ID="pdf_edit_plugin",e.TRANSCRIPT_BLADE_PLUGIN_ID=l,e.ToolbarIcon=K,e.filterArchivePreviewRivieraData=g,e.filterAudioVideoFilePreviewUiState=function(e){return e&&"currentTimestamp"in e?e:void 0},e.filterAudioVideoRivieraData=w,e.filterDimensionsFilePreviewUiState=function(e){return e&&"dimensions"in e&&e.dimensions?e:null},e.filterDocFilePreviewUiState=function(e){return e&&"currentPageIndex"in e?e:void 0},e.filterDocPreviewRivieraData=function(e){return null!=e&&"metadata"in e&&"pages"in e?e:void 0},e.filterExcelPreviewUiState=function(e){return e&&"currentTabIndex"in e?e:void 0},e.filterExcelRivieraData=function(e){return e&&"sheets"in e?e:void 0},e.filterLinkfileRivieraData=function(e){return e&&"uri"in e?e:void 0},e.filterZoomableFilePreviewUi=p,e.getArchiveEntryAtPath=function(e,i){const t=e[n.getSubpath(i)],r=i.length>0?i.slice(0,i.length-1):void 0;return{entry:t,parent:r&&e[n.getSubpath(r)]}},e.getArchiveFilesFetchedPreviewMetadata=function(e,i){return!!e[i]},e.getArchiveFilesPreviewMetadata=S,e.getAreToolsHidden=function(e,i){var t,n;const r=C(e,i);return!!((null==r?void 0:r.isFullScreen)?null===(t=null==r?void 0:r.isUiHidden)||void 0===t?void 0:t.fullscreen:null===(n=null==r?void 0:r.isUiHidden)||void 0===n?void 0:n.nonFullscreen)},e.getBrandingInfo=function(e,i){const t=I(e,i);return t&&e.brandingInfo[t.serialized]},e.getClosestSubpath=(e,i)=>{for(let t=i.length;t>=0;t--){const r=i.slice(0,t);if(e[n.getSubpath(r)])return r}return[]},e.getCloudDocEditorUrl=function(e,i){return e.cloudDocsData[i]},e.getCurrentFilePreviewUI=U,e.getCurrentPreviewData=function(e,i){return h(e,_(e,i))},e.getCurrentPreviewKey=_,e.getFileContentMetadata=A,e.getFileMetadata=D,e.getFilePreviewSession=function(e,i){return e.loggingSession[i]},e.getFilePreviewSessionId=function(e,i){var t;return i?null===(t=e.loggingSession[i])||void 0===t?void 0:t.file_preview_session_id:void 0},e.getFilePreviewUi=T,e.getFilePreviewUiData=function(e,i,t){var n;return t&&(null===(n=e.filePreviewUi[i])||void 0===n?void 0:n[t.serialized])},e.getFileViewerUi=C,e.getHasBeenFlipped=function(e,i){const t=C(e,i);return!!(null==t?void 0:t.hasBeenFlipped)},e.getInitialEditAction=function(e,i){var t;return null===(t=e.fileViewerUi[i])||void 0===t?void 0:t.initialEditAction},e.getIsDeleteFileModalOpen=function(e,i){var t;return!!(null===(t=e.fileViewerUi[i])||void 0===t?void 0:t.isDeleteFileModalOpen)},e.getIsEditingVideo=function(e,i){const t=C(e,i);return!!(null==t?void 0:t.isEditingVideo)},e.getIsFullScreen=V,e.getIsPreviewLoading=function(e,i){var t;return!!(null===(t=e.fileViewerUi[i])||void 0===t?void 0:t.isPreviewLoading)},e.getIsTitleBarRenameActive=function(e,i){const t=C(e,i);return!!(null==t?void 0:t.isTitleBarRenameActive)},e.getPreviewMetadata=h,e.getPreviewType=R,e.getPrintUrl=function(e,i){var t,n;const r=I(e,i),o=r&&h(e,r);if(!o)return"";const{content:l}=o;return"image"===(null==l?void 0:l[".tag"])?null!==(t=null==l?void 0:l.full_size_src)&&void 0!==t?t:"":"ssr_doc"===(null==l?void 0:l[".tag"])&&null!==(n=null==l?void 0:l.autoprint_url)&&void 0!==n?n:""},e.getRivieraData=b,e.getRootFile=P,e.getRootFileMetadata=function(e,i){const t=P(e,i);return D(e,null==t?void 0:t.previewKey)},e.getRootPreviewKey=I,e.getRootPreviewUI=y,e.getRootRivieraData=m,e.getScaleFactorFromFilePreviewUi=function(e){return e.zoomScaleFactor||e.fitScaleFactor},e.getSharedLinkInfo=function(e,i){const t=I(e,i);return t&&e.sharedLinkInfo[t.serialized]},e.getToolbarBreakpoint=N,e.getVideoDimensions=function(e,i){const t=A(e,i);if(t&&"video"==t.metadata[".tag"]){const e=t.metadata;if(e.resolution_height&&e.resolution_width)return{width:e.resolution_width,height:e.resolution_height}}return null},e.getVideoRequests=function(e){return e.videoRequests},e.getVideoTranscriptData=function(e,i){var t;return null===(t=w(e.rivieraData[i.serialized]))||void 0===t?void 0:t.transcript},e.getVolumeState=function(e){return e.volume},e.isExcelApiV2MetadataContent=function(e){return void 0!==e&&"excel"===e[".tag"]},e.isExcelPreviewRivieraData=function(e){return null!=e&&"sheets"in e},e.isLeftSidebarPlugin=function(e){return s.includes(e)},e.isPreviewZoomed=function(e,i){const t=U(e,i);if(!t)return!1;const n=p(t);if(null==n)return!1;const{zoomScaleFactor:r,fitScaleFactor:o}=n;return!!r&&r>o},e.isRightRailOpen=function(e,i){var t;return null===(t=e.fileViewerUi[i])||void 0===t?void 0:t.isRightRailOpen},e.isToolbarInverse=M,e.useContentRect=()=>{const[e,n]=i.React$1.useState(null),[r,o]=i.React$1.useState();return i.React$1.useEffect((()=>{if(!e)return;const i=new t.ResizeObserver((e=>o(e[0].contentRect)));return i.observe(e),o(e.getBoundingClientRect()),()=>i.disconnect()}),[e]),{nodeRef:n,contentRect:r,node:e}},e.useFileMetadata=e=>B(D,e),e.useFileViewerContext=v,e.useFileViewerSelector=z,e.useIconsOnlyForToolbar=i=>i===e.ToolbarBreakpoint.Medium||i===e.ToolbarBreakpoint.Small,e.useParameterizedSelector=function(e,...i){return t.useSelector((t=>e(t,...i)))},e.usePreviewKeySelector=B,e.usePreviewState=function(e,i,t){const n=z(E,e),r=z(U,e),o=B(h,i),l=z(C,e),a=z(F,e),u=r&&t(r);if(u&&l)return{fileViewerUiData:l,fileMetadata:n,filePreviewUiData:u,previewMetadata:o,fileInfo:a}},e.useRootFileInfo=e=>z(P,e),e.useRootPreviewKey=e=>{var i;return null===(i=z(P,e))||void 0===i?void 0:i.previewKey},e.useToolbarBreakpoint=()=>{const e=L();return N(null==e?void 0:e.width)},e.useToolbarControlsConfig=x,e.useWindowSize=L}));
//# sourceMappingURL=c_core_data_utils.js-vflhgy4F0.map
