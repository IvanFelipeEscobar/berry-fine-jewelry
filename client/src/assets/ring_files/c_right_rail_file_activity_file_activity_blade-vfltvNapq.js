define(["require","exports","./e_edison","./c_core_i18n","./e_ui_page_files_router","./c_core_notify","./c_icon_file_folder_icon","./c_api_v2_redux_files","./c_tslib","./c_folder_dialog_folder_picker_dig","./c_info_blade_content_metadata_image_metadata","./c_truncate_index","./c_components_approval-forms_approval_metadata","./c_flows_approval_approval_io_client","./c_breadcrumb_index","./c_data_action_creators_index","./c_comments_component_pane","./c_lodash-es_lodash","./c_spectrum_tertiary_link_tertiary_list","./c_sharing_async_share_modal_util","./c_core_browser_detection","./e_core_exception","./c_spectrum_avatar_avatar_initials","./c_spectrum_popover_popover_content","./c_flows_lib_api","./c_components_section_tags_section_preview","./c_flows_utils_async_modal_launchers","./c_flows_redux_selectors","./c_components_flows-icon-button_index","./c_workflow_builder_workflow_actions_action_ui_config","./c_flows_redux_reducer","./c_components_approval-forms_gating_utils","./c_components_approval-forms_url_utils","./c_components_approval-forms_approval_checkbox_in_share","./c_flows_version_change_log_section","./c_comments_data_store","./c_file_activity_component_file_activity_blade","./c_file_activity_data_store"],(function(e,t,a,r,o,s,n,i,l,c,d,p,u,m,g,h,f,_,E,v,C,S,x,b,y,T,k,w,M,R,F,N,O,L,I,P,D,A){"use strict";const B=e=>{const t=e instanceof o.File&&!e.is_dir?e:null;return Boolean(t)},U=e=>{const t=e instanceof o.File&&e.is_dir?e:null;return Boolean(t)},j=e=>{const t=e instanceof o.FileSharedWithMe?e:null;return Boolean(t)},H=e=>e.every(B);const $=({selectedFiles:e,user:t,viewType:r,isSearchMode:s,showMostRecentFilesFirst:n})=>{if(0===e.count())return null;if(1===e.count()){const n=e.first();return a.React$1.createElement("div",{className:"selection-preview-pane__container"},t&&r&&n instanceof o.File&&!n.is_dir?a.React$1.createElement(V,{files:e,key:n.fq_path,user:t,viewType:r,isSearchMode:Boolean(s)}):a.React$1.createElement(W,{file:n,isSearchMode:Boolean(s)}))}if(2===e.count())return a.React$1.createElement("div",{className:"selection-preview-pane__container selection-preview-pane__container-double"},a.React$1.createElement(W,{file:e.get(1)}),a.React$1.createElement(W,{file:e.get(0)}));const i=n?e.slice(e.size-3).reverse():function(e){const t=e.slice(0,3).reverse();if(3===e.count())return t;const a=[];let r=0,s=0;for(let t=0;t<e.count();t++){const n=e.get(t);if(n instanceof o.File&&n.is_dir&&s<2?(s++,a.push(n)):(n instanceof o.FileSharedWithMe||!n.is_dir)&&r<2&&(r++,a.push(n)),3===a.length)break}return a.length<3?t:o.immutableExports.List(a).reverse()}(e);return a.React$1.createElement("div",{className:"selection-preview-pane__container selection-preview-pane__container-multi"},i.map((e=>a.React$1.createElement(W,{file:e,key:e instanceof o.File?e.fq_path:e.filename}))))};$.displayName="SelectionPreviewIcon";const V=({files:t,user:i,viewType:l,isSearchMode:c})=>{const d=a.React$1.createRef(),p=a.React$1.createRef(),[u,m]=a.React$1.useState(!1),[g,h]=a.React$1.useState("top"),f=t.first(),_=f instanceof o.File?o.href_for_file(i,f):f.href,E={user:i,files:t,isSearchMode:c,viewType:l},v=()=>{m(!0)},C=()=>{m(!1)},S=(t,a,r)=>{if(0===t.button){const s=o.hasModifierKey(t);if(s)return void t.stopPropagation();if(t.preventDefault(),t.stopPropagation(),s)return void o.open_tab(a);new Promise((function(t,a){e(["./c_browse_file_actions_action_handlers"],t,a)})).then((function(e){return e.action_handlers_esnext})).then((({handlePreview:e})=>{e(r,o.ActionSourceValue.DETAILS_PANE_PREVIEW)}))}};return a.reactExports.useEffect((()=>{if(d.current){const e=d.current.children[0];if("svg"===(null==e?void 0:e.tagName)){e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e.setAttribute("pointer-events","none");const t=e.querySelector("a"),r=t?t.innerHTML:e.innerHTML;if(""===r)return;a.reactDomExports.render(a.React$1.createElement(o.Link,{xlinkHref:_,dangerouslySetInnerHTML:{__html:s.purify.sanitize(r)},style:{pointerEvents:"all"},ref:p,onMouseEnter:v,onMouseLeave:C,onClick:e=>{S(e,_,E)},tabIndex:-1}),e)}}}),[d,p,_,E]),a.React$1.createElement("div",{className:"selection-preview-pane__icon",ref:d},a.React$1.createElement(o.Tooltip.Control,{triggerRef:p,auto:!0,open:u,placement:g,onChangePlacement:h},r.intl.formatMessage({id:"VbRtEL",defaultMessage:"Preview"})),a.React$1.createElement(n.LargeFileOrFolderIcon,{file:f,iconSize:256,hideBadge:!0,iconDelay:1e3,onPreviewClick:e=>{S(e,_,E)},previewUrl:_}))};V.displayName="SelectionPreviewSingleIcon";const W=({file:e,isSearchMode:t})=>e?a.React$1.createElement("div",{className:"selection-preview-pane__icon"},a.React$1.createElement(n.LargeFileOrFolderIcon,{file:e,iconSize:256,hideBadge:!0,iconDelay:1e3})):a.React$1.createElement("div",{className:"selection-preview-pane__icon"});W.displayName="SelectionPreviewFileIcon";const z=r.intl.formatMessage({id:"+kc9n+",defaultMessage:"Show all"}),K=r.intl.formatMessage({id:"5tvWhA",defaultMessage:"Hide"});o.injectInternalStyle("metaserver/static/js/right_rail/info_blade/info_blade.module.out.css",(e=>"._metadata-container_jx2v5_4:not(:empty){display:flex;flex-direction:column;margin-top:20px}._metadata-row_jx2v5_9{display:flex}._metadata-title_jx2v5_12{display:flex;width:92px}._metadata-data_jx2v5_16{flex:1 1 0;margin-left:var(--spacing__unit--2);min-width:0}._pathbar_jx2v5_23 a{color:var(--color__faint__text)}._section-header_jx2v5_26{margin-bottom:var(--spacing__unit--0_5)}._container_jx2v5_31{display:flex;flex-direction:column;height:100%}._container_jx2v5_31 .file-breadcrumb-link>span{color:var(--color__standard__text)}._icon-container_jx2v5_42{display:flex;justify-content:center}._icon-container_jx2v5_42 .file-icon__preview:focus:not([data-focus-visible-added]){box-shadow:none;margin:0;padding:0}._icon-container_jx2v5_42 .file-icon__preview:focus{box-shadow:inset 0 0 0 3px var(--color__utility__focusring);margin:0;padding:0}._icon-container_jx2v5_42 .selection-preview-pane__icon,._icon-container_jx2v5_42 .selection-preview-pane__icon>a{height:100%;width:100%}._icon-container_jx2v5_42 .selection-preview-pane__icon img,._icon-container_jx2v5_42 .selection-preview-pane__icon svg{padding:0}._icon-container_jx2v5_42 .selection-preview-pane__icon img{border:1px solid var(--color__standard__border);box-sizing:border-box;display:block;filter:none;height:auto;margin:auto;max-height:100%;max-width:100%;width:auto}._icon-container_jx2v5_42 .selection-preview-pane__icon svg{filter:drop-shadow(0 1px 1.5px rgba(23,23,23,.2)) drop-shadow(0 0 1px rgba(23,23,23,.1));height:100%;width:100%}._icon-container_jx2v5_42 .selection-preview-pane__icon svg.mc-icon-template-content--form-large,._icon-container_jx2v5_42 .selection-preview-pane__icon svg.mc-icon-template-content--form_result-large{height:62%;margin:14%;width:62%}._icon-container_jx2v5_42 .selection-preview-pane__container{height:168px;position:relative;width:100%}._icon-container_jx2v5_42 .selection-preview-pane__container .selection-preview-pane__icon{height:100%;width:100%}._icon-container_jx2v5_42 .selection-preview-pane__container-double .selection-preview-pane__icon{align-items:center;display:flex;float:left;height:70%;position:absolute;width:50%}._icon-container_jx2v5_42 .selection-preview-pane__container-double .selection-preview-pane__icon img{margin:unset}._icon-container_jx2v5_42 .selection-preview-pane__container-double .selection-preview-pane__icon svg{transform:scale(1.5);width:unset}._icon-container_jx2v5_42 .selection-preview-pane__container-double .selection-preview-pane__icon:first-child{transform:translate(var(--spacing__unit--2),var(--spacing__unit--2));z-index:2}._icon-container_jx2v5_42 .selection-preview-pane__container-double .selection-preview-pane__icon:nth-child(2){transform:translate(calc(var(--spacing__unit--2)*-1),calc(var(--spacing__unit--2)*-1));z-index:1}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon{height:53%;left:23.5%;position:absolute;top:23.5%;width:53%}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon:first-child{transform:none;z-index:3}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon:nth-child(2){transform:rotate(-22deg);z-index:2}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon:nth-child(3){transform:rotate(22deg);z-index:1}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon svg{height:150%;left:-25%;position:absolute;top:-25%;transform:none;width:150%}._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon svg.mc-icon-template-content--form-large,._icon-container_jx2v5_42 .selection-preview-pane__container-multi .selection-preview-pane__icon svg.mc-icon-template-content--form_result-large{height:93%;left:3.5%;top:3.5%;width:93%}._folder-overview_jx2v5_208{font-family:var(--type__body__small--fontfamily);font-size:var(--type__body__small--fontsize);line-height:var(--type__body__small--lineheight);margin-top:var(--spacing__unit--2)}._folder-overview_jx2v5_208 .folder-overview__border{border-radius:0}._folder-overview_jx2v5_208 .folder-overview__fixed-toolbar-container{margin-left:0;margin-top:0;padding:0;width:100%}._folder-overview_jx2v5_208 .folder-overview__fixed-toolbar-container .cb-last-edit__message-wrapper{color:var(--color__faint__text);font-family:var(--type__body__small--fontfamily);font-size:var(--type__body__small--fontsize);font-weight:var(--type__body__small--fontweight);line-height:var(--type__body__small--lineheight)}._folder-overview_jx2v5_208 .folder-overview__fixed-toolbar-container .cb-last-edit__message-wrapper svg{display:none}._folder-overview_jx2v5_208 .folder-overview__fixed-toolbar-container .cb-last-edit__message-wrapper .cb-last-edit__message{margin-left:0}._folder-overview_jx2v5_208 .folder-overview__fixed-toolbar-container .folder-overview__inline-readonly-icon{display:none}._folder-overview_jx2v5_208 .folder-overview__description--placeholder{color:var(--color__faint__text);font-family:var(--type__body__small--fontfamily);font-size:var(--type__body__small--fontsize);font-weight:var(--type__body__small--fontweight);line-height:var(--type__body__small--lineheight)}._folder-overview_jx2v5_208 .folder-overview__description--placeholder>span{border-radius:0;margin-right:0;padding:0}._folder-overview-tooltip-anchor_jx2v5_270{transform:translateY(9px)}._tooltip-button_jx2v5_274{align-items:flex-end;display:flex;flex-direction:column}"));const G="_metadata-container_jx2v5_4",q="_metadata-row_jx2v5_9",Y="_metadata-title_jx2v5_12",Z="_metadata-data_jx2v5_16",Q="_pathbar_jx2v5_23",J="_section-header_jx2v5_26",X="_container_jx2v5_31",ee="_icon-container_jx2v5_42",te="_folder-overview_jx2v5_208",ae=({title:e,data:t})=>a.reactExports.createElement("div",{className:q},a.reactExports.createElement("div",{className:Y},"string"==typeof e?a.reactExports.createElement(o.Text,{size:"small",variant:"paragraph",color:"faint"},e):e),a.reactExports.createElement("div",{className:Z},t));ae.displayName="InfoBladeMetadataRow";const re=new o.HiveLogger,oe=({value:e})=>{const{onChangePlacement:t,placement:r}=u.useTooltipPlacement();return a.React$1.createElement(o.Text,{variant:"paragraph",size:"small"},a.React$1.createElement(p.Truncate,{tooltipControlProps:{placement:r,openDelay:500,onChangePlacement:t,maxWidth:210},lines:3},e))},se=o.requireCssWithComponent((({file:e,user:t})=>{const[s,n]=a.React$1.useState({}),[i,l]=a.React$1.useState(!1);if(a.React$1.useEffect((()=>{((e,t)=>new o.DefaultUserApiV2Client(e).ns("files").rpc("get_file_content_metadata",{file_path_or_id:t},{}).then((({metadata:e})=>e&&"image"===e[".tag"]?e:{})))(t,e.file_id).then((e=>n(e))).catch((()=>n({})))}),[e.file_id]),!s)return a.React$1.createElement(a.React$1.Fragment,null);const c=d.getImageSpecificDataFields(Object.assign(Object.assign({},s),{".tag":"image"}),r.intl).filter((e=>!!e.value)).map((e=>a.React$1.createElement(ae,{key:e.name,title:e.name,data:a.React$1.createElement(oe,{value:e.value})}))),p=c.length>5,u=i?K:z,m=i?c:c.slice(0,5);return a.React$1.createElement("div",{className:"rr-mi"},...m,p&&a.React$1.createElement(o.Button$1,{size:"small",className:"rr-mi-expand-button",variant:"transparent",onClick:()=>{i?(e=>{re.log(new o.WebUserActionRow({user_id:e.id,event_name:o.WebUserActionLogEvent.MEDIA_FILTERS_HIDE_EXTRA_INFO,extra:{right_sidebar_state:"opened",entity_type:"file"}}))})(t):((e=>{re.log(new o.WebUserActionRow({user_id:e.id,event_name:o.WebUserActionLogEvent.MEDIA_FILTERS_SHOW_ALL_INFO,extra:{right_sidebar_state:"opened",entity_type:"file"}}))})(t),o.UserSurvey.trackEvent("organized_search_click_show_all","right_rail")),l(!i)}},u))}),["/static/metaserver/static/css/media_filters/media_information-vflj211H8.css"]),ne="https://www.dropbox.com/backup/all?_source=breadcrumb";function ie(e,t){return a=>{0===a.button&&(a.altKey||a.ctrlKey||a.metaKey||a.shiftKey)||(a.preventDefault(),t(e))}}const le=a.reactExports.memo((e=>{var{basePath:t,path:s,size:n,user:i,useFullPath:c,isForCurrentPath:d,setUrl:p}=e,u=l.__rest(e,["basePath","path","size","user","useFullPath","isForCurrentPath","setUrl"]);const m=o.useSelector(o.backups);if(!t&&!(null!==m))return null;const h=t?o.normalize(o.parent_dir(t)):"",f=o.normalize(s).replace(h,""),_=o.parent_dirs(f).reverse().map((e=>h+e));return c&&""!==f&&_.push(h+f),a.reactExports.createElement(g.Breadcrumb,Object.assign({size:n,isRootOverflow:!0},u),a.reactExports.createElement(g.Breadcrumb.Link,{key:"breadcrumb-backup",href:ne,isCurrentPath:!1,onClick:ie(ne,o.redirect),className:"file-breadcrumb-link"},a.reactExports.createElement(r.FormattedMessage,{id:"96Ymix",defaultMessage:"Backups"})),_.map(((e,t)=>{var r;const s=d&&t===_.length-1,n=s?void 0:o.browse_uri_for_fq_path(i,e).toString(),l=s?void 0:ie(e,p),c=null==m?void 0:m.find((t=>t.fqPath===e)),u=0===t,h=o.isBackupBrowse()&&u?c?null!==(r=c.displayName)&&void 0!==r?r:null==c?void 0:c.name:"":o.getDisplayedFilename(o.filename(e));return a.reactExports.createElement(g.Breadcrumb.Link,{key:o.filename(e),href:n,isCurrentPath:s,onClick:l,className:"file-breadcrumb-link","data-testid":"file-breadcrumb-link"},h)})))}));le.displayName="BackupBreadcrumb";const ce=()=>{const e=r.useIntl();return a.reactExports.createElement(ae,{title:e.formatMessage({id:"Et1Afo",defaultMessage:"State"}),data:a.reactExports.createElement(o.Text,{variant:"paragraph",size:"small"},e.formatMessage({id:"9n8qGi",defaultMessage:"Deleted"}))})};ce.displayName="StatusDeletedRow";const de=({file:e,user:t,isSelection:s,isSearchMode:n,setUrl:i,showApproval:l,navigateToBlade:d,showHeader:p=!1,showMediaDetails:g=!1,isInsideBackup:h,backupFolderPath:f,lastBackupTime:_})=>{const E=r.useIntl();let v="";h&&U(e)&&(v=_?o.format_date_timezone_offset(new Date(.001*_),o.localized_datetime_format):"--");const C=j(e)?null:e.fq_path,S=a.reactExports.useMemo((()=>C?a.reactExports.createElement(ae,{title:h?E.formatMessage({id:"/7OiQL",defaultMessage:"Location"}):E.formatMessage({id:"vRjK3h",defaultMessage:"Saved in"}),data:h?a.reactExports.createElement(le,{className:Q,size:"small",path:C,user:t,useFullPath:!1,isForCurrentPath:!n&&s,setUrl:i,key:C,basePath:f}):a.reactExports.createElement(c.FileBreadcrumb,{className:Q,size:"small",path:C,user:t,useFullPath:!1,isForCurrentPath:!n&&s,setUrl:i,key:C})}):null),[f,C,E,h,n,s,i,t]);return U(e)&&"/"===e.fq_path?null:a.reactExports.createElement(a.reactExports.Fragment,null,p&&a.reactExports.createElement(o.Text,{variant:"paragraph",size:"small",isBold:!0,className:J},E.formatMessage({id:"sWbsHy",defaultMessage:"Properties"})),S,!j(e)&&e.isDeleted&&a.reactExports.createElement(ce,null),(e=>!(e.is_cloud_doc&&0===e.bytes)&&(j(e)||B(e)&&!e.isDeleted))(e)&&a.reactExports.createElement(ae,{title:E.formatMessage({id:"7+ns4J",defaultMessage:"Size"}),data:a.reactExports.createElement(o.Text,{variant:"paragraph",size:"small"},e.size)}),a.reactExports.createElement(ae,{title:h?E.formatMessage({id:"EjOYMM",defaultMessage:"Last backup"}):E.formatMessage({id:"R3SV35",defaultMessage:"Modified"}),data:a.reactExports.createElement(o.Text,{variant:"paragraph",size:"small"},""===v?e.ago:v)}),!U(e)&&a.reactExports.createElement(ae,{title:E.formatMessage({id:"/m87Qb",defaultMessage:"Type"}),data:a.reactExports.createElement(o.Text,{variant:"paragraph",size:"small"},B(e)?o.File.getCategoryDescription(e,void 0,!0):o.FileSharedWithMe.getCategoryDescription(e))}),l&&d&&a.reactExports.createElement(u.ApprovalMetadata,{fileId:e.file_id,getApprovalStatus:e=>m.getFileApprovalStatus(t.id,e),onClick:()=>d("comments"),InfoBladeRowComponent:ae,logger:a=>o.logApprovalActions({user_id:t.id,event_name:o.WebUserActionLogEvent.RIGHT_RAIL_APPROVAL_STATUS_CLICK,action_surface:o.ActionSurfaceLogValue.RIGHT_SIDEBAR,file_id:e.file_id,file_extension:e.ext,approval_status:a})}),g&&B(e)&&a.reactExports.createElement(se,{file:e,user:t}))};de.displayName="SingleFileMetadata";const pe=({files:e})=>e.every((e=>!j(e)&&e.isDeleted))?a.reactExports.createElement(ce,null):null;pe.displayName="MultiFileMetadata";const ue=e=>{var{files:t}=e,r=l.__rest(e,["files"]);const o=1===t.size?a.reactExports.createElement(de,Object.assign({},r,{file:t.first()})):t.size>1&&a.reactExports.createElement(pe,{files:t});return o?a.reactExports.createElement("div",{className:G},o):null};ue.displayName="InfoBladeMetadata";class me extends f.BaseLayer{constructor(e){super(),this.options=e}triggerInit(e){const t=e.status.folderOverview.editorState;e.innerProps.prevStatus.folderOverview.editorState!==t&&(e.triggers.draft.init(null),e.triggers.draft.change(t))}callOnContentChange(e){const t=e.innerProps.value;this.options.onEditorStateChange(t)}handleTabIndent(e){const{innerProps:{evt:t}}=e,a=e.innerProps.value;if(9===t.which&&e.status.accessibility.captureTab){const e=f.Draft.RichUtils.onTab(t,a,4);if(t.preventDefault(),e!==a)return e}}}l.__decorate([f.plug(f.intoFolderOverview.folderOverview)],me.prototype,"triggerInit",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.change.update.editorState)],me.prototype,"callOnContentChange",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.key.update.editorState)],me.prototype,"handleTabIndent",null);class ge extends f.BaseLayer{constructor(e){super(),this.options=e}updateLinkPrompt(e){return e.innerProps.evt}maybeCreateLinkOnPaste(e){const t=e.innerProps.evt.trim();return f.isValidURL(t)?this.createLinkInEditorState(Object.assign(Object.assign({},e),{innerProps:Object.assign(Object.assign({},e.innerProps),{evt:t})})):e.status.draft.editorState}createLink(e){const t=e.innerProps.evt.trim();return this.createLinkInEditorState(Object.assign(Object.assign({},e),{innerProps:Object.assign(Object.assign({},e.innerProps),{evt:t})})),null}createLinkInEditorState(e){const t=e.innerProps.evt.trim(),a=e.status.draft.editorState;let r=a.getCurrentContent(),o=a.getSelection();o.isCollapsed()&&(r=f.Draft.Modifier.insertText(r,o,t),o=o.merge({focusOffset:o.getStartOffset()+t.length}));const s=r.createEntity("LINK","MUTABLE",{url:t}),n=s.getLastCreatedEntityKey(),i=f.Draft.EditorState.set(a,{currentContent:s});let l=f.Draft.RichUtils.toggleLink(i,o,n),c=l.getSelection();const d=c.getFocusOffset()<c.getAnchorOffset()?c.getAnchorOffset():c.getFocusOffset();return c=c.merge({anchorOffset:d,focusOffset:d}),l=f.Draft.EditorState.forceSelection(l,c),e.triggers.draft.change(l),l}openLink(e){this.options.onOpenLink(e.innerProps.evt)}addDecoratorsOnChange(e){const{value:t}=e.innerProps;return[...t,{strategy:function(e,t,a){e.findEntityRanges((function(e){const t=e.getEntity();return null!==t&&"LINK"===a.getEntity(t).getType()}),t)},props:{readOnly:e.status.draft.readOnly,onOpenLink:e.triggers.hyperlink.openLink},component:f.LinkSpanComponent}]}handleKeyCommand(e){const{evt:t}=e.innerProps;"create-link"===t&&e.triggers.hyperlink.updateLinkPromptProps({top:0,left:0})}}l.__decorate([f.plug(f.intoFolderOverview.hyperlink.on.updateLinkPromptProps.update.linkPromptProps)],ge.prototype,"updateLinkPrompt",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.pasteText.update.editorState)],ge.prototype,"maybeCreateLinkOnPaste",null),l.__decorate([f.plug(f.intoFolderOverview.hyperlink.on.createLink.update.linkPromptProps)],ge.prototype,"createLink",null),l.__decorate([f.plug(f.intoFolderOverview.hyperlink.on.openLink)],ge.prototype,"openLink",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.init.update.decorators)],ge.prototype,"addDecoratorsOnChange",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.keyCommand)],ge.prototype,"handleKeyCommand",null);class he extends f.BaseLayer{hidePlaceholderWhenContentEmpty(e){const t=e.innerProps.evt.getCurrentContent(),a=!t.hasText()&&"unstyled"===t.getBlockMap().first().getType();e.triggers.globalStyle.setClassName({className:"empty-content",value:a})}updateClassNames(e){const t=e.status.globalStyle.classNames,{className:a,value:r}=e.innerProps.evt;return t[a]=r,t}}l.__decorate([f.plug(f.intoFolderOverview.draft.on.change)],he.prototype,"hidePlaceholderWhenContentEmpty",null),l.__decorate([f.plug(f.intoFolderOverview.globalStyle.on.setClassName.update.classNames)],he.prototype,"updateClassNames",null);const fe=(e,t)=>f.Draft.Modifier.setBlockType(e,f.Draft.SelectionState.createEmpty(t),"unordered-list-item"),_e=(e,t)=>f.Draft.Modifier.setBlockType(e,f.Draft.SelectionState.createEmpty(t),"ordered-list-item"),Ee=(e,t,a)=>{const r=f.Draft.Modifier.setBlockType(e,f.Draft.SelectionState.createEmpty(t),"task-block");return f.Draft.Modifier.setBlockData(r,f.Draft.SelectionState.createEmpty(t),{checked:a})},ve={"-":fe,"—":fe,"--":fe,"*":fe,"1.":_e,"1)":_e,"1.)":_e,"[]":(e,t)=>Ee(e,t,!1),"[ ]":(e,t)=>Ee(e,t,!1),"[x]":(e,t)=>Ee(e,t,!0)};class Ce extends f.BaseLayer{constructor(e=ve){super(),this.prefixFormatMap=e}handleSpaceAndTriggerFormat(e){const{innerProps:{evt:t,value:a}}=e,r=a.getSelection(),o=a.getCurrentContent(),s=o.getBlockMap().get(r.getStartKey());if(s&&32===t.which){const e=s.getText().slice(0,r.getStartOffset());if(e in this.prefixFormatMap){const r=s.getKey(),n=this.prefixFormatMap[e],i=f.Draft.SelectionState.createEmpty(r).merge({anchorOffset:0,focusOffset:e.length}),l=n(f.Draft.Modifier.removeRange(o,i,"backward"),r);t.preventDefault();const c=f.Draft.EditorState.push(a,l,"change-block-type");return f.Draft.EditorState.forceSelection(c,f.Draft.SelectionState.createEmpty(r))}}}}l.__decorate([f.plug(f.intoFolderOverview.draft.on.key.update.editorState)],Ce.prototype,"handleSpaceAndTriggerFormat",null);const Se=(e,{container:t})=>{const{block:s,offsetKey:n,blockProps:i,blockProps:{onToggleChecked:l}}=e,c=t.getStatus().draft.readOnly,d=r.useIntl(),p=a.reactExports.useCallback((e=>{c||(e.stopPropagation(),e.preventDefault())}),[c]),u=a.reactExports.useCallback((e=>{c||(l(),e.stopPropagation(),e.preventDefault())}),[c,l]),m=a.reactExports.useCallback((e=>{c||(e.stopPropagation(),e.preventDefault())}),[c]),g=0===s.getLength(),h=o.cx(f.classes.taskBlock,{[f.classes.checked]:i.checked,[f.classes.readonly]:c,[f.classes.emptyBlock]:g});return a.reactExports.createElement("div",{className:h,"data-offset-key":n,"data-key":s.getKey()},a.reactExports.createElement("div",{suppressContentEditableWarning:!0,contentEditable:!1},a.reactExports.createElement("div",{className:f.classes.taskBlockClickableDiv,onMouseUp:u,onClick:m,onMouseDown:p}),a.reactExports.createElement(o.Checkbox,{className:f.classes.taskBlockCheckbox,checked:i.checked}),g?a.reactExports.createElement("div",{className:o.cx(f.classes$1.scCommentEditorPlaceholder,f.classes.taskPlaceholder)},d.formatMessage({id:"NPxYv8",defaultMessage:"Create a to-do and assign it @someone"})):null),a.reactExports.createElement("div",{className:"checkable-list-item-block__text"},a.reactExports.createElement(f.Draft.EditorBlock,Object.assign({},e))))};Se.displayName="TaskComponent",Se.contextTypes={container:o.PropTypes.object};class xe extends f.BaseLayer{constructor(e){super(),this.taskOptions=e}toggleTaskBlock(e){const{editorState:t}=e.status.draft,a=t.getCurrentContent(),r=f.getSelectedBlocksList(t),o={};r.forEach((e=>{if(e){const t=e.getKey(),a=e.removeIn(["data","checked"]),r="task-block"!==e.get("type")?"task-block":"unstyled";o[t]=a.set("type",r)}}));const s=a.getBlockMap().merge(o),n=f.Draft.EditorState.push(t,a.merge({blockMap:s}),"change-block-type");e.triggers.draft.change(n)}setTaskState(e){const{key:t,checked:a}=e.innerProps.evt,r=e.status.draft.editorState;e.triggers.draft.change(f.mergeBlockDataByKey(r,t,{checked:a},!1)),this.taskOptions.onTaskChecked(t,a)}addBlockFn(e){const{value:t}=e.innerProps;return Object.assign(Object.assign({},t),{"task-block":t=>{const a=t.getData().get("checked");return{component:Se,props:{onToggleChecked:()=>{e.triggers.task.setTaskState({checked:!a,key:t.getKey()})},checked:a}}}})}}l.__decorate([f.plug(f.intoFolderOverview.task.on.toggleTaskBlock)],xe.prototype,"toggleTaskBlock",null),l.__decorate([f.plug(f.intoFolderOverview.task.on.setTaskState)],xe.prototype,"setTaskState",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.init.update.blockRenderers)],xe.prototype,"addBlockFn",null);class be extends f.BaseLayer{setCaptureTabIndent(e){return e.innerProps.evt}handleTabIndent(e){const{innerProps:{evt:t}}=e;"Escape"===t.key?e.triggers.accessibility.setCaptureTab(!1):9!==t.which&&(e.status.accessibility.captureTab||e.triggers.accessibility.setCaptureTab(!0))}}function ye(e){return(!!e.hyperlink.linkPromptProps||e.draft.isFocused||!!e.mentionShareFlow.popupProps)&&!e.draft.readOnly}l.__decorate([f.plug(f.intoFolderOverview.accessibility.on.setCaptureTab.update.captureTab)],be.prototype,"setCaptureTabIndent",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.key)],be.prototype,"handleTabIndent",null);class Te extends f.BaseLayer{onDraftChange(e){const t=e.innerProps.evt,a=f.getSelectionInlineStyle(t),r=f.getSelectionBlockTypes(t),o={bold:a.BOLD,strikethrough:a.STRIKETHROUGH,italic:a.ITALIC,task:"task-block"===r,orderedList:"ordered-list-item"===r,unorderedList:"unordered-list-item"===r};e.triggers.fixedToolbar.updateActiveFormatting(o)}onDraftFocus(e){this.updateToolbarVisibility(e.status,e.triggers)}onDraftBlur(e){this.updateToolbarVisibility(e.status,e.triggers)}updateToolbarVisibility(e,t){t.globalStyle.setClassName({className:"fixed-toolbar-visible",value:ye(e)})}updateActiveFormatting(e){return e.innerProps.evt}handleKeyCommand(e){const{evt:t,value:a}=e.innerProps;return"strikethrough"===t?f.Draft.RichUtils.toggleInlineStyle(a,"STRIKETHROUGH"):void 0}}l.__decorate([f.plug(f.intoFolderOverview.draft.on.change)],Te.prototype,"onDraftChange",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.focus)],Te.prototype,"onDraftFocus",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.blur)],Te.prototype,"onDraftBlur",null),l.__decorate([f.plug(f.intoFolderOverview.fixedToolbar.on.updateActiveFormatting.update.activeFormatting)],Te.prototype,"updateActiveFormatting",null),l.__decorate([f.plug(f.intoFolderOverview.draft.on.keyCommand.update.editorState)],Te.prototype,"handleKeyCommand",null);const ke={draft:f.DraftNames,folderOverview:f.FolderOverviewNames,macro:f.MacroNames,mentionSuggestions:f.MentionSuggestionNames,suggestion:f.SuggestionSelectionNames,fixedToolbar:f.FixedToolbarNames,hyperlink:f.HyperlinkNames,globalStyle:f.GlobalStyleNames,task:f.TaskNames,mentionShareFlow:f.MentionShareFlowNames,accessibility:f.AccessibilityNames},we=()=>{};class Me extends f.EditorContainer{get scopeNames(){return ke}getLayerProps(e){const{mentionShareFlowHandlers:t=f.DefaultMentionShareFlowHandlers,onOpenLink:a=we,onEditorStateChange:r=we,onMentionsQueryUpdated:o=we,onTaskChecked:s=we,hideAllToolbars:n=!1,onToolbarDone:i=we}=e;return{mentionShareFlowHandlers:t,onOpenLink:a,onEditorStateChange:r,onMentionsQueryUpdated:o,onTaskChecked:s,hideAllToolbars:n,onToolbarDone:i}}mapPropsToLayers(e){const{mentionShareFlowHandlers:t,onOpenLink:a,onEditorStateChange:r,onMentionsQueryUpdated:o,onTaskChecked:s,hideAllToolbars:n}=this.getLayerProps(e);return[new f.InteractionLayer,new f.TextLayer,new f.StyleLayer,new he,new ge({onOpenLink:a}),new f.MentionsEntityLayer,new f.MentionsMacroLayer({onMentionsQueryUpdated:o}),new xe({onTaskChecked:s}),new Ce,!n&&new Te,new f.SuggestionLayer,new f.MentionShareFlowLayer(t),new me({onEditorStateChange:r}),new f.UpdateLayer,new be].filter((e=>!!e))}createDefaultStatus(){const e=f.createDefaultStatus(this.scopeNames);return Object.assign(Object.assign({},e),{draft:Object.assign(Object.assign({},e.draft),{readOnly:!!this.props.readOnly}),accessibility:{captureTab:!1}})}mapPropsToUpdates(e,t){let a={};const r=!!e.readOnly||!!t.mentionShareFlow.popupProps;return e.editorState!==t.folderOverview.editorState&&(a=Object.assign(Object.assign({},a),{folderOverview:Object.assign(Object.assign({},t.folderOverview),{editorState:e.editorState})})),r!==t.draft.readOnly&&(a=Object.assign(Object.assign({},a),{draft:Object.assign(Object.assign({},t.draft),{editorState:e.editorState?e.editorState:t.draft.editorState,readOnly:r})})),e.mentionsMatches!==t.mentionSuggestions.userMap&&(a=Object.assign(Object.assign({},a),{mentionSuggestions:Object.assign(Object.assign({},t.mentionSuggestions),{userMap:e.mentionsMatches||{}})})),a}}const Re=({className:e,children:t},{container:r})=>{const s=r.getStatus().globalStyle.classNames,n=o.cx(e,s);return a.reactExports.createElement("div",{className:n},t)};Re.displayName="GlobalStyleComponent",Re.contextTypes={container:o.PropTypes.object};class Fe extends a.reactExports.Component{constructor(){super(...arguments),this.popoverContainerRef=null,this.cachedPosition=null,this.setPopoverContainerRef=e=>{this.popoverContainerRef=e}}getPosition(){const{scrollClassName:e}=this.props;if(!this.popoverContainerRef)return null;const t=f.getOffsetParent(this.popoverContainerRef,e);if(!t)return null;const a=this.props.computeTargetPosition(t);if(!this.popoverContainerRef||!a)return null;const r=t.getBoundingClientRect(),o=Math.round(a.left+a.width/2-r.left),s=10+this.props.popoverWidth/2,n=Math.min(Math.max(o,s),r.width-s),i={top:a.top-r.top,left:this.props.limitedWidth?0:n};return this.cachedPosition=i,i}getCachedPosition(){return this.cachedPosition}render(){const e=this.getPosition(),t=o.cx(f.classes.scPopover,this.props.className),r=this.props.isVisible&&e?a.reactExports.createElement("div",{className:t,style:e},this.props.children):null;return a.reactExports.createElement("div",{className:"sc-popover-container",ref:this.setPopoverContainerRef},a.reactExports.createElement(Ne,{transitionName:"popover"},r))}}Fe.displayName="PopoverComponent";class Ne extends a.reactExports.Component{constructor(e){super(e),this.state={leave:!1,enter:!1,children:null}}cloneChildrenWithClass(e,t){return a.reactExports.cloneElement(e,Object.assign(Object.assign({},e.props),{className:o.cx(e.props.className,t)}))}UNSAFE_componentWillReceiveProps(e){this.props.children&&!e.children?this.setState({leave:!0,enter:!1,children:this.props.children}):e.children&&!this.props.children&&this.setState({leave:!1,enter:!0})}render(){let e="",t=this.props.children;return this.state.leave&&(e=`${this.props.transitionName}-leave`,this.delayedResetTransitionState(),t=this.state.children),this.state.enter&&(e=`${this.props.transitionName}-enter`,this.delayedResetTransitionState()),t?this.cloneChildrenWithClass(t,e):null}delayedResetTransitionState(){this.resetTransitionStateTimeout&&clearTimeout(this.resetTransitionStateTimeout),this.resetTransitionStateTimeout=setTimeout((()=>{this.setState({leave:!1,enter:!1})}),200)}}Ne.displayName="TransitionGroup";const Oe=({getCustomTitle:e,getCustomMessage:t,shareableResourceName:s,scrollClassName:n,limitedWidth:i},{container:l,scope:c})=>{const d=r.useIntl(),p=a.reactExports.useCallback((e=>{const t=l.getStatus().mentionShareFlow.popupProps,a=t&&t.mentionKey;if(!a)return null;const r=e.querySelectorAll(`[data-entity-key="${a}"]`)[0];return r?r.getBoundingClientRect():null}),[l]),u=a.reactExports.useCallback((()=>{l.getTriggers(c).mentionShareFlow.updatePopupProps(null)}),[l,c]),m=a.reactExports.useCallback((()=>{u();const e=l.getStatus().draft.editorState,t=f.Draft.EditorState.forceSelection(e,e.getSelection());l.getTriggers(c).draft.change(t)}),[u,l,c]),g=a.reactExports.useCallback((()=>{const e=l.getStatus().mentionShareFlow.popupProps;e&&l.getTriggers(c).mentionShareFlow.onShare(e),u()}),[u,l,c]),{popupProps:h}=l.getStatus().mentionShareFlow,_=(E=h)&&E.user?E.user.name.public||E.user.email:E&&"email"===E.mentionData.type?E.mentionData.identifier:"";var E;const v=e?e(d,_,s):d.formatMessage({id:"PPnGE0",defaultMessage:"Share folder with {user_name}?"},{user_name:_}),C=t?t(d,_):d.formatMessage({id:"d8Nac1",defaultMessage:"{user_name} is not yet a member of “{folder_name}”. If you don’t share this folder, they won’t be able to view its content"},{user_name:_,folder_name:s}),S=!!h;return a.reactExports.createElement(Fe,{popoverWidth:300,className:f.classes.scMentionSharePopover,scrollClassName:n,limitedWidth:i,computeTargetPosition:p,isVisible:S},a.reactExports.createElement("div",{className:f.classes.popupTitle},v),a.reactExports.createElement("div",{className:f.classes.popupMessage},C),a.reactExports.createElement("div",{className:f.classes.buttonContainer},a.reactExports.createElement(o.Button,{className:f.classes.cancelButton,variant:"secondary",onClick:m},d.formatMessage({id:"pv7yxv",defaultMessage:"Cancel"})),a.reactExports.createElement(o.Button,{variant:"primary",onClick:g},d.formatMessage({id:"BZwQbv",defaultMessage:"Continue"}))))};var Le;Oe.displayName="MentionSharePopover",Oe.contextTypes={container:o.PropTypes.object,scope:o.PropTypes.object},function(e){e.BOLD="BOLD",e.ITALIC="ITALIC",e.STRIKE_THROUGH="STRIKE_THROUGH",e.UNORDERED_LIST="UNORDERED_LIST",e.ORDERED_LIST="ORDERED_LIST",e.LINK="LINK",e.MENTION="MENTION",e.TASK="TASK",e.ONBOARDING="ONBOARDING"}(Le||(Le={}));const Ie={[Le.BOLD]:a.reactExports.createElement("svg",{viewBox:"0 0 20 20"},a.reactExports.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},a.reactExports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.515 5.875H7.875V17.6H12.17C13.3345 17.6 14.425 17.4117 15.2276 16.8818C16.0395 16.3458 16.54 15.4715 16.54 14.145C16.54 12.8378 15.6664 11.7421 14.3952 11.3592C14.8878 11.1875 15.2948 10.9225 15.5958 10.5634C15.9778 10.1079 16.18 9.51165 16.18 8.79C16.18 7.81243 15.767 7.07728 15.0952 6.59064C14.4281 6.10747 13.5147 5.875 12.515 5.875ZM9.52 10.705V7.25H12.44C13.0619 7.25 13.5709 7.38573 13.9217 7.657C14.2673 7.92431 14.475 8.33528 14.475 8.925C14.475 9.62281 14.2109 10.0582 13.8157 10.3252C13.4122 10.5976 12.8562 10.705 12.26 10.705H9.52ZM9.52 16.225V12.11H12.065C12.9643 12.11 13.6581 12.2484 14.1242 12.5562C14.5802 12.8573 14.835 13.3319 14.835 14.055C14.835 14.8889 14.5721 15.4202 14.1281 15.7489C13.6764 16.0833 13.0152 16.225 12.185 16.225H9.52Z"}))),[Le.ITALIC]:a.reactExports.createElement("svg",{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},a.reactExports.createElement("path",{d:"M10.75 17.75H9L12.5 5.75H14.25L10.75 17.75Z"})),[Le.STRIKE_THROUGH]:a.reactExports.createElement("svg",{viewBox:"0 0 20 20"},a.reactExports.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},a.reactExports.createElement("path",{d:"M10.1060324,10 L8.51882081,10 C8.46159424,9.74866009 8.435,9.48434783 8.435,9.21 C8.435,7.35 9.965,6 12.32,6 C14.75,6 16.01,7.29 16.115,9.24 L14.69,9.24 C14.555,8.115 13.91,7.11 12.305,7.11 C10.745,7.11 9.905,7.995 9.905,9.09 C9.905,9.44281227 9.9693552,9.74481781 10.1060324,10 Z M16.361,13.5 C16.4288,13.7826 16.46,14.088 16.46,14.415 C16.46,16.515 15.035,17.865 12.29,17.865 C9.635,17.865 8.12,16.44 8,14.415 L9.455,14.415 C9.62,15.645 10.475,16.74 12.32,16.74 C14.36,16.74 15.035,15.75 15.035,14.535 C15.035,14.1387272 14.9484809,13.7905206 14.7542791,13.5 L16.361,13.5 Z",id:"S-2"}),a.reactExports.createElement("polygon",{id:"Line-2",fillRule:"nonzero",points:"5 12.5 5 11 20 11 20 12.5"}))),[Le.UNORDERED_LIST]:a.reactExports.createElement("svg",{viewBox:"0 0 20 20"},a.reactExports.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},a.reactExports.createElement("path",{d:"M9,17 L9,15.5 L19.5,15.5 L19.5,17 L9,17 Z M9,12.5 L9,11 L19.5,11 L19.5,12.5 L9,12.5 Z M9,8 L9,6.5 L19.5,6.5 L19.5,8 L9,8 Z",id:"Icon-Fill",fillRule:"nonzero"}),a.reactExports.createElement("circle",{id:"Oval-2",cx:"5.5",cy:"7.25",r:"1.5"}),a.reactExports.createElement("circle",{id:"Oval-2",cx:"5.5",cy:"11.75",r:"1.5"}),a.reactExports.createElement("circle",{id:"Oval-2",cx:"5.5",cy:"16.25",r:"1.5"}))),[Le.ORDERED_LIST]:a.reactExports.createElement("svg",{viewBox:"0 0 20 20"},a.reactExports.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},a.reactExports.createElement("path",{d:"M9,17 L9,15.5 L19.5,15.5 L19.5,17 L9,17 Z M9,12.5 L9,11 L19.5,11 L19.5,12.5 L9,12.5 Z M9,8 L9,6.5 L19.5,6.5 L19.5,8 L9,8 Z",id:"Icon-Fill",fillRule:"nonzero"}),a.reactExports.createElement("circle",{id:"Oval-2",cx:"5.75",cy:"11.75",r:"1"}),a.reactExports.createElement("text",{id:"1",fontFamily:"AtlasGrotesk-Black, Atlas Grotesk",fontSize:"5px",fontWeight:"700"},a.reactExports.createElement("tspan",{x:"4.42",y:"9"},"1")),a.reactExports.createElement("text",{id:"3",fontFamily:"AtlasGrotesk-Black, Atlas Grotesk",fontSize:"5px",fontWeight:"700"},a.reactExports.createElement("tspan",{x:"3.845",y:"18.25"},"3")))),[Le.LINK]:a.reactExports.createElement("svg",{viewBox:"0 0 20 20"},a.reactExports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.5858 13.636L7.93936 13.2825L6.87869 12.2218L6.52514 12.5754C5.15831 13.9422 5.15831 16.1583 6.52514 17.5251C7.89198 18.892 10.1081 18.892 11.4749 17.5251L13.5962 15.4038C14.963 14.037 14.963 11.8209 13.5962 10.4541L12.5355 11.5147C13.3166 12.2958 13.3166 13.5621 12.5355 14.3431L10.4142 16.4645C9.63318 17.2455 8.36685 17.2455 7.5858 16.4645C6.80475 15.6834 6.80475 14.4171 7.5858 13.636ZM16.0711 7.97918C15.29 7.19814 14.0237 7.19814 13.2427 7.97918L11.1213 10.1005C10.3403 10.8816 10.3403 12.1479 11.1213 12.9289L10.0607 13.9896C8.69384 12.6228 8.69384 10.4067 10.0607 9.03985L12.182 6.91852C13.5488 5.55169 15.7649 5.55169 17.1317 6.91852C18.4986 8.28536 18.4986 10.5014 17.1317 11.8683L16.7782 12.2218L15.7175 11.1612L16.0711 10.8076C16.8521 10.0266 16.8521 8.76023 16.0711 7.97918Z"})),[Le.MENTION]:a.reactExports.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},a.reactExports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.2598 4.875C10.0768 4.875 8.22867 5.63069 6.92609 6.9456C5.6236 8.26042 4.875 10.1259 4.875 12.3301C4.875 14.6028 5.60277 16.4717 6.91594 17.7725C8.22898 19.0732 10.1151 19.7939 12.4092 19.7939C13.5268 19.7939 14.6046 19.6345 15.4118 19.3565L15.4961 19.3274V17.9357L15.3188 18.0173C15.0586 18.1371 14.6379 18.2405 14.1252 18.3136C13.6152 18.3863 13.0234 18.4277 12.4268 18.4277C10.5731 18.4277 9.06 17.8328 8.01062 16.7866C6.96128 15.7405 6.36426 14.2318 6.36426 12.3828C6.36426 8.78842 8.78499 6.23242 12.1455 6.23242C13.8778 6.23242 15.3272 6.76702 16.3421 7.6823C17.3559 8.59665 17.9443 9.89817 17.9443 11.4512C17.9443 12.5209 17.7678 13.3891 17.4636 13.9849C17.1602 14.5791 16.7408 14.8857 16.25 14.8857C15.957 14.8857 15.7437 14.8027 15.6039 14.6647C15.4643 14.5269 15.3818 14.3185 15.3818 14.0352V8.75098H13.8047V9.70451C13.4001 9.00402 12.6193 8.58398 11.7324 8.58398C10.7944 8.58398 9.99484 8.97403 9.43186 9.6425C8.87017 10.3094 8.54883 11.2471 8.54883 12.3389C8.54883 13.4771 8.86255 14.441 9.42086 15.1229C9.9809 15.8069 10.7811 16.1992 11.7324 16.1992C12.7503 16.1992 13.5568 15.7259 13.9781 14.8715C14.1751 15.7126 14.9989 16.2783 16.0039 16.2783C17.0573 16.2783 17.9207 15.8021 18.5165 14.9576C19.1093 14.1171 19.4336 12.9181 19.4336 11.4688C19.4336 9.52831 18.6973 7.8771 17.4277 6.71186C16.1588 5.54736 14.365 4.875 12.2598 4.875ZM10.2051 12.374C10.2051 11.6217 10.3751 11.0388 10.6739 10.647C10.9693 10.2595 11.3993 10.0469 11.9521 10.0469C12.5136 10.0469 12.967 10.2682 13.2828 10.6625C13.6009 11.0596 13.7871 11.6424 13.7871 12.374C13.7871 13.1053 13.5989 13.6903 13.2775 14.0897C12.9583 14.4864 12.5004 14.71 11.9346 14.71C11.3966 14.71 10.9705 14.4943 10.6754 14.1027C10.3771 13.7071 10.2051 13.1214 10.2051 12.374Z"})),[Le.TASK]:a.reactExports.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},a.reactExports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.8 6.5H14.2C15.0648 6.5 15.6232 6.50117 16.0482 6.53589C16.4557 6.56918 16.6068 6.6257 16.681 6.66349C16.9632 6.8073 17.1927 7.03677 17.3365 7.31901C17.3743 7.39318 17.4308 7.54426 17.4641 7.95175C17.4988 8.37676 17.5 8.93517 17.5 9.8V14.2C17.5 15.0648 17.4988 15.6232 17.4641 16.0482C17.4308 16.4557 17.3743 16.6068 17.3365 16.681C17.1927 16.9632 16.9632 17.1927 16.681 17.3365C16.6068 17.3743 16.4557 17.4308 16.0482 17.4641C15.6232 17.4988 15.0648 17.5 14.2 17.5H9.8C8.93517 17.5 8.37676 17.4988 7.95175 17.4641C7.54426 17.4308 7.39318 17.3743 7.31901 17.3365C7.03677 17.1927 6.8073 16.9632 6.66349 16.681C6.6257 16.6068 6.56918 16.4557 6.53589 16.0482C6.50117 15.6232 6.5 15.0648 6.5 14.2V9.8C6.5 8.93517 6.50117 8.37676 6.53589 7.95175C6.56918 7.54426 6.6257 7.39318 6.66349 7.31901C6.8073 7.03677 7.03677 6.8073 7.31901 6.66349C7.39318 6.6257 7.54426 6.56918 7.95175 6.53589C8.37676 6.50117 8.93517 6.5 9.8 6.5ZM5 9.8C5 8.11984 5 7.27976 5.32698 6.63803C5.6146 6.07354 6.07354 5.6146 6.63803 5.32698C7.27976 5 8.11984 5 9.8 5H14.2C15.8802 5 16.7202 5 17.362 5.32698C17.9265 5.6146 18.3854 6.07354 18.673 6.63803C19 7.27976 19 8.11984 19 9.8V14.2C19 15.8802 19 16.7202 18.673 17.362C18.3854 17.9265 17.9265 18.3854 17.362 18.673C16.7202 19 15.8802 19 14.2 19H9.8C8.11984 19 7.27976 19 6.63803 18.673C6.07354 18.3854 5.6146 17.9265 5.32698 17.362C5 16.7202 5 15.8802 5 14.2V9.8ZM11.8047 15.2569L16.2201 9.04361L14.7936 8.02989L10.9883 13.3847L9.27059 11.6089L8.01273 12.8256L10.4626 15.3583C10.6434 15.5453 10.8981 15.6421 11.1575 15.6225C11.4169 15.6029 11.6541 15.4689 11.8047 15.2569Z"})),[Le.ONBOARDING]:a.reactExports.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},a.reactExports.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.5 9.3951C8.5 7.45942 10.1803 6 12 6C13.8197 6 15.5 7.45942 15.5 9.3951C15.5 10.1162 15.3858 10.5218 15.2719 10.7766C15.154 11.0406 14.9943 11.2449 14.7109 11.567C14.6867 11.5944 14.6611 11.6232 14.6344 11.6534C14.368 11.9536 13.9833 12.3871 13.6745 12.9559C13.4312 13.404 13.2459 13.9082 13.1317 14.5H10.8692C10.7557 13.9057 10.5718 13.3985 10.3317 12.9472C10.0215 12.3642 9.63604 11.9208 9.36525 11.6093L9.36525 11.6093L9.29819 11.532C9.00841 11.1967 8.84514 10.9872 8.72526 10.7222C8.61177 10.4714 8.5 10.0814 8.5 9.3951ZM12 4.5C9.45933 4.5 7 6.52747 7 9.3951C7 11.1702 7.60617 11.8698 8.22154 12.5801C8.79806 13.2455 9.38265 13.9202 9.48444 15.4973C9.50222 15.7729 9.72386 16 10 16H14C14.2761 16 14.4977 15.7728 14.5156 15.4972C14.6167 13.9388 15.192 13.2877 15.7636 12.641C16.3841 11.9389 17 11.242 17 9.3951C17 6.52747 14.5407 4.5 12 4.5ZM9.5 18V17.5H14.5V18C14.5 19 13.108 19.5 12 19.5C10.892 19.5 9.5 19 9.5 18Z",fill:"black"}))},Pe=({key:e,intl:t,addAlt:a=!1,isMac:r})=>r?a?t.formatMessage({id:"pZ5e/J",defaultMessage:"⌘ + opt + {key}"},{key:e}):t.formatMessage({id:"3lp5F0",defaultMessage:"⌘ + {key}"},{key:e}):a?t.formatMessage({id:"4OVYKA",defaultMessage:"ctrl + alt + {key}"},{key:e}):t.formatMessage({id:"yi7qcS",defaultMessage:"ctrl + {key}"},{key:e}),De=({icon:e})=>Ie[e];De.displayName="ToolbarIcon";const Ae=({message:e,shortcut:t})=>a.reactExports.createElement("div",{className:f.classes.scToolbarButtonTooltipContent},a.reactExports.createElement("div",{className:f.classes.scToolbarButtonTooltipContentMessage},e),t&&a.reactExports.createElement("div",{className:f.classes.scToolbarButtonTooltipContentShortcut},t));Ae.displayName="TooltipContent";const Be=({shortcut:e})=>a.reactExports.createElement("div",null,e);Be.displayName="AccelShortcut";const Ue=({macro:e})=>{const t=r.useIntl();return a.reactExports.createElement("div",null,a.reactExports.createElement("span",null,e),a.reactExports.createElement("span",null," "),a.reactExports.createElement("span",null,t.formatMessage({id:"u28O+d",defaultMessage:"space"})))};Ue.displayName="MacroShortcut";const je=()=>a.reactExports.createElement("div",{className:f.classes.toolbarDivider});je.displayName="ToolbarDivider";const He=()=>a.reactExports.createElement("div",{className:f.classes.toolbarSpacer});function $e(e,t=""){return o.cx(f.classes.toolbarButton,{[f.classes.toolbarButtonActive]:e,[t]:!!t})}He.displayName="ToolbarSpacer";const Ve=({triggers:e,isMac:t,active:s})=>{const n=r.useIntl(),i=a.reactExports.useRef(null),[l,c]=a.reactExports.useState(!1),d=a.reactExports.useCallback((t=>{t.stopPropagation(),e.draft.keyCommand("bold")}),[e]),p=a.reactExports.createElement(Be,{shortcut:Pe({key:"B",intl:n,isMac:t})}),u=a.reactExports.createElement(Ae,{message:n.formatMessage({id:"fJCjRe",defaultMessage:"Bold"}),shortcut:p});return a.reactExports.createElement("div",{className:$e(s,"toolbar-button-bold"),key:"bold",onClick:d,"aria-label":n.formatMessage({id:"fJCjRe",defaultMessage:"Bold"}),role:"button"},a.reactExports.createElement("div",{onMouseOver:()=>c(!0),onMouseLeave:()=>c(!1),ref:i},a.reactExports.createElement(De,{icon:Le.BOLD})),a.reactExports.createElement(o.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:l,triggerRef:i},u))};Ve.displayName="ToolbarBoldButton";const We=({triggers:e,isMac:t,active:s})=>{const n=r.useIntl(),i=a.reactExports.useRef(null),[l,c]=a.reactExports.useState(!1),d=a.reactExports.useCallback((t=>{t.stopPropagation(),e.draft.keyCommand("italic")}),[e]),p=a.reactExports.createElement(Be,{shortcut:Pe({key:"I",intl:n,isMac:t})}),u=a.reactExports.createElement(Ae,{message:n.formatMessage({id:"vlkaFK",defaultMessage:"Italic"}),shortcut:p});return a.reactExports.createElement("div",{role:"button","aria-label":n.formatMessage({id:"vlkaFK",defaultMessage:"Italic"}),className:$e(s,"toolbar-button-italic"),key:"italic",onClick:d},a.reactExports.createElement("div",{onMouseOver:()=>c(!0),onMouseLeave:()=>c(!1),ref:i},a.reactExports.createElement(De,{icon:Le.ITALIC})),a.reactExports.createElement(o.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:l,triggerRef:i},u))};We.displayName="ToolbarItalicButton";const ze=({triggers:e,shortcutEnabled:t,isMac:s,active:n,state:i})=>{const l=r.useIntl(),c=a.reactExports.useRef(null),[d,p]=a.reactExports.useState(!1),u=a.reactExports.useCallback((t=>{t.stopPropagation(),e.draft.change(f.Draft.RichUtils.toggleInlineStyle(i,"STRIKETHROUGH"))}),[i,e]),m=t?a.reactExports.createElement(Be,{shortcut:Pe({key:"S",addAlt:!0,intl:l,isMac:s})}):null,g=a.reactExports.createElement(Ae,{message:l.formatMessage({id:"UgH/WV",defaultMessage:"Strikethrough"}),shortcut:m});return a.reactExports.createElement("div",{role:"button","aria-label":l.formatMessage({id:"UgH/WV",defaultMessage:"Strikethrough"}),className:$e(n,"toolbar-button-strike-through"),key:"strikethrough",onClick:u},a.reactExports.createElement("div",{onMouseOver:()=>p(!0),onMouseLeave:()=>p(!1),ref:c},a.reactExports.createElement(De,{icon:Le.STRIKE_THROUGH})),a.reactExports.createElement(o.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:d,triggerRef:c},g))};ze.displayName="ToolbarStrikeThroughButton";const Ke=({state:e,active:t,triggers:s})=>{const n=r.useIntl(),i=a.reactExports.useRef(null),[l,c]=a.reactExports.useState(!1),d=a.reactExports.useCallback((t=>{t.stopPropagation(),s.draft.change(f.Draft.RichUtils.toggleBlockType(e,"unordered-list-item"))}),[e,s]),p=a.reactExports.createElement(Ae,{message:n.formatMessage({id:"QVI2zd",defaultMessage:"Start bulleted list"}),shortcut:a.reactExports.createElement(Ue,{macro:"-"})});return a.reactExports.createElement("div",{role:"button","aria-label":n.formatMessage({id:"QVI2zd",defaultMessage:"Start bulleted list"}),className:$e(t,"toolbar-button-unordered-list"),key:"ul",onClick:d},a.reactExports.createElement("div",{onMouseOver:()=>c(!0),onMouseLeave:()=>c(!1),ref:i},a.reactExports.createElement(De,{icon:Le.UNORDERED_LIST})),a.reactExports.createElement(o.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:l,triggerRef:i},p))};Ke.displayName="ToolbarUnorderedListButton";const Ge=({state:e,triggers:t,active:s})=>{const n=r.useIntl(),i=a.reactExports.useRef(null),[l,c]=a.reactExports.useState(!1),d=a.reactExports.useCallback((a=>{a.stopPropagation(),t.draft.change(f.Draft.RichUtils.toggleBlockType(e,"ordered-list-item"))}),[e,t]),p=a.reactExports.createElement(Ae,{message:n.formatMessage({id:"qBpbaD",defaultMessage:"Start numbered list"}),shortcut:a.reactExports.createElement(Ue,{macro:"1."})});return a.reactExports.createElement("div",{role:"button","aria-label":n.formatMessage({id:"qBpbaD",defaultMessage:"Start numbered list"}),className:$e(s,"toolbar-button-ordered-list"),key:"ol",onClick:d},a.reactExports.createElement("div",{onMouseOver:()=>c(!0),onMouseLeave:()=>c(!1),ref:i},a.reactExports.createElement(De,{icon:Le.UNORDERED_LIST})),a.reactExports.createElement(o.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:l,triggerRef:i},p))};Ge.displayName="ToolbarOrderedListButton";const qe=({triggers:e,active:t})=>{const s=r.useIntl(),n=a.reactExports.useRef(null),[i,l]=a.reactExports.useState(!1),c=a.reactExports.useCallback((t=>{t.stopPropagation(),e.draft.insertMacro("@")}),[e]),d=a.reactExports.createElement(Ae,{message:s.formatMessage({id:"6elmWe",defaultMessage:"Mention someone"}),shortcut:s.formatMessage({id:"fN3cwA",defaultMessage:"@someone"})});return a.reactExports.createElement("div",{role:"button","aria-label":s.formatMessage({id:"6elmWe",defaultMessage:"Mention someone"}),className:$e(t,"toolbar-button-mention"),key:"mention",onClick:c},a.reactExports.createElement("div",{onMouseOver:()=>l(!0),onMouseLeave:()=>l(!1),ref:n},a.reactExports.createElement(De,{icon:Le.MENTION})),a.reactExports.createElement(o.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:i,triggerRef:n},d))};qe.displayName="ToolbarMentionButton";const Ye=({onDone:e,active:t})=>{const o=r.useIntl();return a.reactExports.createElement("div",{role:"button","aria-label":o.formatMessage({id:"HGK/k8",defaultMessage:"Done"}),className:$e(t,f.classes.toolbarButtonDone),key:"done",onClick:e},o.formatMessage({id:"HGK/k8",defaultMessage:"Done"}))};Ye.displayName="ToolbarDoneButton";const Ze=({active:e,triggers:t})=>{const s=r.useIntl(),n=a.reactExports.useRef(null),[i,l]=a.reactExports.useState(!1),c=a.reactExports.useCallback((e=>{t.task.toggleTaskBlock(null),e.stopPropagation()}),[t]),d=a.reactExports.createElement(Ae,{message:s.formatMessage({id:"ALfhls",defaultMessage:"Create to-do"}),shortcut:a.reactExports.createElement(Ue,{macro:"[]"})});return a.reactExports.createElement("div",{role:"button","aria-label":s.formatMessage({id:"ALfhls",defaultMessage:"Create to-do"}),className:$e(e,"toolbar-button-task"),key:"task",onClick:c},a.reactExports.createElement("div",{onMouseOver:()=>l(!0),onMouseLeave:()=>l(!1),ref:n},a.reactExports.createElement(De,{icon:Le.TASK})),a.reactExports.createElement(o.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:i,triggerRef:n},d))};Ze.displayName="ToolbarTaskButton";const Qe=({active:e,onClick:t,shortcutEnabled:s,isMac:n})=>{const i=r.useIntl(),l=a.reactExports.useRef(null),[c,d]=a.reactExports.useState(!1),p=s?a.reactExports.createElement(Be,{shortcut:Pe({key:"K",intl:i,isMac:n})}):null,u=a.reactExports.createElement(Ae,{message:i.formatMessage({id:"WMGEFi",defaultMessage:"Create link"}),shortcut:p});return a.reactExports.createElement("div",{role:"button","aria-label":i.formatMessage({id:"WMGEFi",defaultMessage:"Create link"}),className:$e(e,"toolbar-button-link"),key:"link",onClick:t},a.reactExports.createElement("div",{onMouseOver:()=>d(!0),onMouseLeave:()=>d(!1),ref:l},a.reactExports.createElement(De,{icon:Le.LINK})),a.reactExports.createElement(o.Tooltip.Control,{className:f.classes.scToolbarTooltip,placement:"top",open:c,triggerRef:l},u))};Qe.displayName="ToolbarOpenLinkButton";const Je=({children:e})=>{const t=r.useIntl(),o=a.reactExports.useCallback((e=>{e.stopPropagation(),e.preventDefault()}),[]);return a.reactExports.createElement("div",{className:f.classes.scToolbarComponent,role:"group","aria-label":t.formatMessage({id:"El6O0Q",defaultMessage:"toolbar"}),onMouseDown:o,key:"toolbar"},e)};Je.displayName="ToolbarComponent";const Xe=({focusEditor:e},{container:t,scope:r})=>{const o=a.reactExports.useRef(),s=a.reactExports.useCallback((e=>{var a;(null===(a=o.current)||void 0===a?void 0:a.contains(null==e?void 0:e.target))||t.getTriggers(r).hyperlink.updateLinkPromptProps(null)}),[t,r]);a.reactExports.useEffect((()=>(document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s))),[s]);const n=a.reactExports.useCallback((a=>{e(),t.getTriggers(r).hyperlink.createLink(a)}),[t,r,e]),i=a.reactExports.useCallback((e=>{o.current=e}),[]),l=t.getStatus().hyperlink.linkPromptProps;return a.reactExports.createElement(et,{onSubmit:n,linkProps:l,containerRef:i})};Xe.displayName="LinkPromptComponent",Xe.contextTypes={container:o.PropTypes.object,scope:o.PropTypes.object};class et extends a.reactExports.Component{constructor(e){super(e),this.inputRef=null,this.onEnterKey=e=>{13===(e.which||e.keyCode)&&this.canSubmit()&&(e.stopPropagation(),e.preventDefault(),this.props.onSubmit(this.state.inputValue))},this.onInputChange=e=>{this.setState({inputValue:e.currentTarget.value})},this.onCreateButtonClick=e=>{this.canSubmit()&&(this.props.onSubmit(this.state.inputValue),e.stopPropagation())},this.canSubmit=()=>!!this.state.inputValue,this.setInputRef=e=>{this.inputRef=e},this.state={inputValue:""}}UNSAFE_componentWillUpdate(e){const t=!!this.props.linkProps,a=!!e.linkProps;!t&&a&&this.componentWillShow()}componentDidUpdate(e){const t=!!this.props.linkProps,a=!!e.linkProps;t&&!a&&this.componentDidShow()}componentWillShow(){this.setState({inputValue:""})}componentDidShow(){this.inputRef&&this.inputRef.focus()}render(){if(!this.props.linkProps)return null;const{top:e,left:t}=this.props.linkProps,r={top:e,left:t};return a.reactExports.createElement("div",{className:f.classes.scLinkPrompt,style:r,ref:this.props.containerRef,key:"linkprompt"},a.reactExports.createElement("input",{className:f.classes.linkPromptInput,ref:this.setInputRef,onKeyPress:this.onEnterKey,placeholder:"Enter link URL",value:this.state.inputValue,onChange:this.onInputChange}),a.reactExports.createElement(o.Button$1,{className:f.classes.submitButton,variant:"opacity",size:"small",disabled:!this.canSubmit(),onClick:this.onCreateButtonClick},"Create"))}}et.displayName="LinkPromptInput";const tt=({isVisible:e,getScrollContainerEl:t,toolbarHeightWithMargin:r,toolbarTopMargin:s,getEditorContainerEl:n,triggers:i,activeFormatting:l,editorState:c,isMac:d,limitedWidth:p,onDone:u,focusEditor:m})=>{var g;const h=a.reactExports.useRef(),[_,E]=a.reactExports.useState({toolbarScrollState:"scroll",top:0,left:0,width:0}),v=a.reactExports.useCallback((()=>{var e;return"HTML"===(null===(e=h.current)||void 0===e?void 0:e.nodeName)}),[]),C=a.reactExports.useCallback((()=>{const e=n();if(!e)return;const t=e.getBoundingClientRect(),a=v()||!h.current?0:h.current.getBoundingClientRect().top,o=((e,t,a,r,o)=>{let s="scroll";const n=a-r;return n>o-e?s="hide":n+t>0&&(s="dock"),s})(r,s,a,t.top,t.height);E({toolbarScrollState:o,top:a+s,left:t.left,width:t.width})}),[n,v,s,r]),S=a.reactExports.useCallback((()=>{e&&h.current&&C()}),[e,C]);a.reactExports.useEffect((()=>(e&&x(),()=>{h.current&&h.current.removeEventListener("scroll",S)})),[e]);const x=a.reactExports.useCallback((()=>{h.current=null==t?void 0:t(),v()?(document.removeEventListener("scroll",S),document.addEventListener("scroll",S)):h.current&&(h.current.removeEventListener("scroll",S),h.current.addEventListener("scroll",S)),C()}),[C,S,v,t]),b=a.reactExports.useCallback((e=>{i.hyperlink.updateLinkPromptProps({top:0,left:0}),e.preventDefault(),e.stopPropagation()}),[i]),y="dock"===_.toolbarScrollState,T=e&&"hide"!==_.toolbarScrollState,k=y?{top:_.top,left:_.left,position:"fixed",width:_.width}:{},w=o.cx(f.classes.scFolderOverviewFixedToolbar,{[f.classes.docked]:y,"limited-width":p}),M=a.reactExports.createElement("div",{className:w,style:k},a.reactExports.createElement(Je,null,a.reactExports.createElement(Ve,{active:l.bold,triggers:{draft:i.draft},isMac:d}),a.reactExports.createElement(We,{active:l.italic,triggers:{draft:i.draft},isMac:d}),a.reactExports.createElement(ze,{active:l.strikethrough,shortcutEnabled:!0,state:c,triggers:{draft:i.draft},isMac:d}),a.reactExports.createElement(Qe,{shortcutEnabled:!0,onClick:b,isMac:d}),!p&&a.reactExports.createElement(je,{key:"-1"}),a.reactExports.createElement(Ze,{active:l.task,triggers:{draft:i.draft,task:i.task}}),a.reactExports.createElement(Ke,{active:l.unorderedList,state:c,triggers:{draft:i.draft}}),a.reactExports.createElement(Ge,{active:l.orderedList,state:c,triggers:{draft:i.draft}}),a.reactExports.createElement(qe,{triggers:{draft:i.draft}}),!p&&a.reactExports.createElement(a.reactExports.Fragment,null,a.reactExports.createElement(He,{key:"-"}),",",a.reactExports.createElement(je,{key:"-2"}),",",a.reactExports.createElement(Ye,{onDone:u}),","),a.reactExports.createElement(Xe,{focusEditor:m}))),R=h&&(null===(g=h.current)||void 0===g?void 0:g.offsetParent)?h.current.offsetParent:document.body,F=y&&h&&R?a.reactDomExports.createPortal(M,R):M;return T?a.reactExports.createElement("span",null,F):null};tt.displayName="FixedToolbarElement";const at=(e,{container:t,scope:r})=>{const o=t.getStatus(),{fixedToolbar:{activeFormatting:s},draft:{editorState:n}}=o,i=ye(o);return a.reactExports.createElement(tt,Object.assign({activeFormatting:s,editorState:n,isVisible:i,triggers:t.getTriggers(r)},e))};at.displayName="FixedToolbarComponent",at.contextTypes={container:o.PropTypes.object,scope:o.PropTypes.object};const rt={id:"FOLDER_OVERVIEW_MENTION_MATCHES_PLACEHOLDER",defaultMessage:"@mention someone to share this Space with them.",description:"Placeholder message in suggestions dropdown when user starts mention in Space overview editor"},ot=(e,t,a)=>e.formatMessage({id:"FOLDER_OR_FILE_OVERVIEW_MENTION_POPOVER_TITLE",defaultMessage:"Share “{shareable_resource_name}” with {user_name}?"},{shareable_resource_name:a,user_name:t}),st=(e,t)=>e.formatMessage({id:"FOLDER_OVERVIEW_MENTION_POPOVER_MESSAGE",defaultMessage:"Share this folder with {user_name} so they can view its overview."},{user_name:t}),nt=(e,t)=>e.formatMessage({id:"FILE_OVERVIEW_MENTION_POPOVER_MESSAGE",defaultMessage:"Share this file with {user_name} so they can view its overview."},{user_name:t});class it extends a.reactExports.Component{constructor(){super(...arguments),this.editorContainerRef=a.reactExports.createRef(),this.awaitingMouseUp=!1,this.getEditorContainerRef=()=>this.editorContainerRef.current,this.setEditorRef=e=>{var t,a;null===(a=(t=this.props).setEditorRef)||void 0===a||a.call(t,e),this.editorRef=e},this.blurEditor=()=>{var e;null===(e=this.editorRef)||void 0===e||e.blur()},this.focusEditor=()=>{var e;null===(e=this.editorRef)||void 0===e||e.focus()},this.dismissToolbar=()=>{this.focusEditor(),this.blurEditor(),this.props.onToolbarDone&&this.props.onToolbarDone()},this.handleFocus=e=>{if("mousedown"===e.type)return this.awaitingMouseUp=!0,!1;if("mouseup"===e.type)this.awaitingMouseUp=!1;else if("focus"===e.type)return!this.awaitingMouseUp;return!0},this.customKeyBinding=e=>{const{isMac:t}=this.props,a=t&&e.metaKey||!t&&e.ctrlKey;switch(e.keyCode){case 83:return a&&e.altKey?"strikethrough":null;case 75:return a&&!e.altKey?"create-link":null;default:return f.Draft.getDefaultKeyBinding(e)}}}renderDraftEditor(){const{annotation:e,intl:t,placeholder:r}=this.props,o=Object.assign({spellCheck:!0,a11yEditorLabel:t.formatMessage({id:"Nv8qgA",defaultMessage:"Type notes, list, to-dos, and links here"}),annotation:e,shouldFocus:this.props.shouldFocus,customKeyBinding:this.customKeyBinding,handleFocus:this.handleFocus,placeholder:r,className:f.classes.scFolderOverviewDraft},f.DraftComponent.defaultProps);return a.reactExports.createElement(f.DraftComponent,Object.assign({},o,{setRef:this.setEditorRef}))}render(){const{className:e,readOnly:t,shareableResourceName:s,limitedWidth:n,getToolbarScrollContainerEl:i,hideAllToolbars:l,isFileOverview:c,isMac:d,intl:p}=this.props,u="number"==typeof this.props.toolbarHeightWithMargin?this.props.toolbarHeightWithMargin:48,m=f.classes.scFolderOverviewInteractionContainer,g=o.cx(e,f.classes.scFolderOverviewEditor,{[f.classes.folderOverviewLimitedWidth]:!!n});return a.reactExports.createElement(r.Provider,{value:p},a.reactExports.createElement("div",{className:g,ref:this.editorContainerRef},a.reactExports.createElement(Me,Object.assign({},this.props),a.reactExports.createElement(Re,{className:"sc-folder-overview-inner"},a.reactExports.createElement("div",{className:m},!l&&a.reactExports.createElement(at,{limitedWidth:!!n,toolbarHeightWithMargin:u,toolbarTopMargin:this.props.toolbarTopMargin||0,onDone:this.dismissToolbar,focusEditor:this.focusEditor,getEditorContainerEl:this.getEditorContainerRef,getScrollContainerEl:i,isMac:d}),this.renderDraftEditor(),!t&&a.reactExports.createElement("div",null,a.reactExports.createElement(f.ActiveMacroChromeComponent,{scrollClassName:m,placeholderMessage:c?void 0:rt}),s&&a.reactExports.createElement(Oe,{scrollClassName:m,limitedWidth:n,shareableResourceName:s,getCustomTitle:ot,getCustomMessage:c?nt:st})))))))}}it.displayName="FolderOverviewEditor";const lt=()=>a.React$1.createElement("div",{className:"folder-overview__description--placeholder"},a.React$1.createElement("span",null,h.DESCRIPTION_PLACEHOLDER_RIGHT_RAIL)),ct={addLoadedComponent:h.addLoadedComponent,updateFolderData:h.updateFolderDataCache,saveDescriptionDraft:h.saveDescriptionDraft,setDescriptionHasFocus:h.setDescriptionHasFocus};class dt extends a.React$1.PureComponent{constructor(e){super(e),this.linkPromptHasFocus=()=>!(!document.activeElement||"link-prompt-input"!==document.activeElement.className),this.immediatelySaveDescriptionDraft=()=>{this.delayedSaveDescriptionDraft.cancel(),this.throttledUpdateDescription.cancel(),this.handleDescriptionUpdated(),this.saveDescriptionDraft()},this.saveDescriptionDraft=()=>{const{hasUnsavedDraft:e,saveDescriptionDraft:t,folderFileId:a,componentNamespace:r,user:s}=this.props;e&&(t({folderFileId:a,componentNamespace:r}),h.logFolderOverviewAction(o.WebUserActionLogEvent.FOLDER_OVERVIEW_DESCRIPTION_SAVE,s.id,null,{action_surface:this.loggingActionSurface,retrieval_source:this.loggingRetrievalSource}))},this.handleBeforeUnload=e=>{this.immediatelySaveDescriptionDraft(),this.props.hasUnsavedDraft&&(e.preventDefault(),e.returnValue="")},this.handleDescriptionMention=e=>"email"===e.type&&e.identifier===this.props.user.email||"id"===e.type&&e.identifier===this.props.user.id.toString()?Promise.resolve({mentionedUserHasAccess:!0,shouldShowSharePopup:!1}):this.props.user.cdm_tmf_path&&o.paths_are_equal(this.props.user.cdm_tmf_path,this.props.path)?(o.Snackbar.fail(h.ERROR_SHARE_MEMBER_FOLDER,"folder-overview-mention"),Promise.resolve({mentionedUserHasAccess:!1,shouldShowSharePopup:!1})):h.getFolderAccess({userId:this.props.user.id,sharedFolderId:this.props.sharedFolderId,accountEmail:"email"===e.type?e.identifier:void 0,accountId:"id"===e.type?e.identifier:void 0}).then((e=>({mentionedUserHasAccess:e.has_access,shouldShowSharePopup:!e.has_access}))).catch((e=>{const t=this.props.canShareFolder;return t||o.Snackbar.fail(h.ERROR_SHARE_NO_PERMISSION,"folder-overview-mention"),{mentionedUserHasAccess:!1,shouldShowSharePopup:t}})),this.handleDescriptionShare=(e,t,a,r)=>{v.asyncShowPrefilledShareModal({user:this.props.user,sharePrefillEmails:[e.identifier],content:{fqPath:this.props.sharedFolderPath,isFolder:!0},extras:{onSuccessSharing:()=>{this.handleDescriptionMention(e).then((({mentionedUserHasAccess:e})=>e&&r()))},recipientMessage:this.generateShareMessage(t),origin:o.SHARE_ACTION_ORIGIN_TYPE.GRANT_ACCESS}})},this.generateShareMessage=e=>this.props.sharedFolderPath&&!o.paths_are_equal(this.props.sharedFolderPath,this.props.path)?e&&e.length?r.intl.formatMessage(h.SHARING_MODAL_MESSAGE_PARENT_FOLDER,{user_name:e,folder_name:o.pathFromSharingFolder(this.props.sharedFolderPath,this.props.path)}):r.intl.formatMessage(h.SHARING_MODAL_MESSAGE_PARENT_FOLDER_NO_NAME,{folder_name:o.pathFromSharingFolder(this.props.sharedFolderPath,this.props.path)}):e&&e.length?r.intl.formatMessage(h.SHARING_MODAL_MESSAGE_SAME_FOLDER,{user_name:e}):h.SHARING_MODAL_MESSAGE_SAME_FOLDER_NO_NAME,this.stateFromProps=e=>{try{return{editorState:e.content?f.Draft.EditorState.createWithContent(f.Draft.convertFromRaw(e.content)):f.Draft.EditorState.createEmpty()}}catch(t){return S.reportException({err:t,tags:["folder-overview","browse"],severity:"user-error",exc_extra:{description:e.content}}),{editorState:f.Draft.EditorState.createEmpty()}}},this.handleDescriptionUpdated=()=>{let e;const t=f.Draft.convertToRaw(this.state.editorState.getCurrentContent()),a=o.isEmptyDescription(t);!this.props.content&&a||(e=t),this.props.updateFolderData({fileId:this.props.folderFileId,folderData:{descriptionDraft:e&&!a?JSON.stringify(e):""}}),this.delayedSaveDescriptionDraft()},this.handleEditorStateChange=e=>{if(this.props.isReadOnly)return;const t=e.getSelection().getHasFocus()||this.linkPromptHasFocus(),a=this.props.descriptionHasFocus,r=this.state.editorState.getCurrentContent()!==e.getCurrentContent();this.props.setDescriptionHasFocus({componentNamespace:this.props.componentNamespace,descriptionHasFocus:t,folderFileId:this.props.folderFileId}),this.setState({editorState:e}),!t&&a?this.immediatelySaveDescriptionDraft():r&&this.throttledUpdateDescription()},this.handleOpenLink=e=>{o.safe_open_tab_and_redirect(e)},this.handleMentionsQueryUpdated=e=>{this.mentionsApi&&(e.trim().length?this.mentionsApi.query(e,(e=>{this.setState({mentionsQueryCache:this.fixNamesForMentionsQueryCache(e)})})):this.setState({mentionsQueryCache:this.fixNamesForMentionsQueryCache(this.mentionsApi.getMatchesWithStarterSuggestions())}))},this.fixNamesForMentionsQueryCache=e=>{const t={};return Object.keys(e).forEach((a=>{t[a]=e[a].map((e=>Object.assign(Object.assign({},e),{name:Object.assign(Object.assign({},e.name),{public:e.name.display||e.name.public})})))})),t},this.handleShare=(e,t,a)=>{const r=e.identifier;this.handleDescriptionShare(e,this.getNameFromMentionsCache(r),t,a)},this.getNameFromMentionsCache=e=>{const t=Object.keys(this.state.mentionsQueryCache);for(const a of t)for(const t of this.state.mentionsQueryCache[a])if(t.email===e)return t.name.display;return""},this.shouldShowPlaceholder=()=>{if(this.props.shouldHidePlaceholder)return!1;const{editorState:e}=this.state,t=e.getCurrentContent();return!t.hasText()&&"unstyled"===t.getFirstBlock().getType()&&!e.getSelection().getHasFocus()},this.setEditorRef=e=>{this.editorRef=e},this.handlePlaceholderContainerClick=e=>{var t;e.preventDefault(),e.stopPropagation(),null===(t=this.editorRef)||void 0===t||t.focus()},this.getToolbarScrollContainerEl=()=>null,this.handleTaskChecked=(e,t)=>{this.props.setDescriptionHasFocus({componentNamespace:this.props.componentNamespace,descriptionHasFocus:!0,folderFileId:this.props.folderFileId}),t&&h.logFolderOverviewAction(o.WebUserActionLogEvent.FOLDER_OVERVIEW_TASK_COMPLETED,this.props.user.id,null,h.makeOverviewResourceExtras({folderFileId:this.props.folderFileId,retrievalSource:this.loggingRetrievalSource,action_surface:this.loggingActionSurface,loggingFileId:this.props.loggingFileId})),this.immediatelySaveDescriptionDraft()},this.state=this.stateFromProps(e),this.delayedSaveDescriptionDraft=_.debounce(this.saveDescriptionDraft,h.DESCRIPTION_SAVE_DELAY_MS),this.throttledUpdateDescription=_.throttle(this.handleDescriptionUpdated,100),e.isReadOnly||(this.mentionsApi=u.mentionsApi(e.user,!0))}componentDidMount(){this.props.addLoadedComponent({componentNamespace:this.props.componentNamespace,component:"draftjs"}),window.addEventListener("beforeunload",this.handleBeforeUnload)}UNSAFE_componentWillReceiveProps(e){(!o.paths_are_equal(e.path,this.props.path)&&(e.folderFileId||e.folderNsId)||!this.props.folderNsId&&!this.props.folderFileId&&e.folderNsId)&&this.immediatelySaveDescriptionDraft(),e.descriptionKey===this.props.descriptionKey||this.state.editorState.getSelection().getHasFocus()||this.linkPromptHasFocus()||this.setState(this.stateFromProps(e)),this.mentionsApi||e.isReadOnly||(this.mentionsApi=u.mentionsApi(this.props.user))}componentWillUnmount(){window.removeEventListener("beforeunload",this.handleBeforeUnload),this.props.hasUnsavedDraft&&this.immediatelySaveDescriptionDraft()}get loggingRetrievalSource(){return"search-sidebar"===this.props.componentNamespace?o.RetrievalSourceValue.SEARCH:o.RetrievalSourceValue.BROWSE}get loggingActionSurface(){return"BROWSE"===this.props.componentNamespace?o.ActionSurfaceLogValue.CENTER_PANE:o.ActionSurfaceLogValue.RIGHT_SIDEBAR}render(){const{isReadOnly:e,author:t}=this.props,{editorState:s}=this.state,n=this.shouldShowPlaceholder();return a.React$1.createElement("div",{className:"folder-overview__description-container"},e&&a.React$1.createElement(E.IconAction,{name:"permissions",className:"folder-overview__inline-readonly-icon"}),a.React$1.createElement("div",{className:o.cx("folder-overview__fixed-toolbar",{"folder-overview__description":!0,"folder-overview__placeholder":n}),onClick:n?this.handlePlaceholderContainerClick:_.noop},n&&!e&&a.React$1.createElement(lt,null),a.React$1.createElement(it,{author:t,intl:r.intl,editorState:s,readOnly:e,onEditorStateChange:this.handleEditorStateChange,onOpenLink:this.handleOpenLink,onMentionsQueryUpdated:this.handleMentionsQueryUpdated,mentionShareFlowHandlers:{onMention:this.handleDescriptionMention,onShare:this.handleShare},mentionsMatches:this.state.mentionsQueryCache,shareableResourceName:this.props.sharedFolderName,setEditorRef:this.setEditorRef,getToolbarScrollContainerEl:this.getToolbarScrollContainerEl,limitedWidth:!0,toolbarHeightWithMargin:0,toolbarTopMargin:this.props.toolbarTopMargin,isMac:C.mac,hideAllToolbars:C.iOS||this.props.hideAllToolbars,onTaskChecked:this.handleTaskChecked})))}}dt.displayName="FolderOverviewDescriptionComponent";const pt=o.connect((()=>{const e=h.makeSharedFolderPathSelector(),t=h.makeFolderFileIdSelector(),a=h.makeFolderNsIdSelector(),r=h.makeSharedFolderIdSelector(),o=h.makeDescriptionContentSelector(),s=h.makeLoggingFileIdSelector(),n=h.makeDescriptionHasFocusSelector(),i=h.makeSharedFolderNameSelector(),l=h.makeHasUnsavedDescriptionDraftSelector();return(c,d)=>({user:h.user(c),author:h.descriptionAuthorSelector(c),folderFileId:t(c,d),folderNsId:a(c,d),sharedFolderId:r(c,d),sharedFolderPath:e(c,d),content:o(c,d),sharedFolderName:i(c,d),hasUnsavedDraft:l(c,d),descriptionHasFocus:n(c,d),loggingFileId:s(c,d)})}),ct)(dt);function ut(){return a.React$1.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.React$1.createElement("g",{clipPath:"url(#clip0)"},a.React$1.createElement("circle",{cx:"8",cy:"7.5",r:"6.25",stroke:"#A5A9AF",strokeWidth:"1.5"}),a.React$1.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.5 4H7V7V7.5V8.5H11V7H8.5V4Z",fill:"#A5A9AF"})),a.React$1.createElement("defs",null,a.React$1.createElement("clipPath",{id:"clip0"},a.React$1.createElement("rect",{width:"16",height:"16",fill:"white"}))))}function mt(){return a.React$1.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.React$1.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20 12C20 16.4183 16.4183 20 12 20C7.58172 20 4 16.4183 4 12C4 7.58172 7.58172 4 12 4C16.4183 4 20 7.58172 20 12ZM11.25 12.75L11 8.2501L13 8.25L12.75 12.75H11.25ZM11.0001 14.75C11.0001 14.1977 11.4478 13.75 12.0001 13.75C12.5524 13.75 13.0001 14.1977 13.0001 14.75C13.0001 15.3023 12.5524 15.75 12.0001 15.75C11.4478 15.75 11.0001 15.3023 11.0001 14.75Z",fill:"#FF8E21"}))}class gt extends a.React$1.PureComponent{constructor(e){super(e),this.renderAvatar=(e,t)=>{const r=e.toUpperCase(),o=t?a.React$1.createElement(x.Avatar,{size:40,src:t,variant:"normal"}):a.React$1.createElement(x.AvatarInitials,{avatarSize:40,backgroundColor:x.avatarColorForUserIdentifier(r),variant:"normal"},r);return a.React$1.createElement("div",{className:"cb-last-edit__avatar-wrapper"},a.React$1.createElement("div",{className:"cb-last-edit__avatar-clipping-circle"}),a.React$1.createElement(mt,null),o)}}renderConflictPopover(){const{conflictPopup:e}=this.props;if(!e)return null;const{title:t,message:r,dismissButtonLabel:s,userInitials:n,userPhotoUrl:i,onDismissHandler:l,position:c,popoverContentRef:d}=e;return a.React$1.createElement(b.Popover,{className:"cb-conflict-popover"},a.React$1.createElement(b.PopoverContent,{className:"cb-conflict-popover-content",position:c,isRevealed:!0},a.React$1.createElement(a.React$1.Fragment,null,a.React$1.createElement("div",{className:"cb-conflict-popover-content__inner-wrapper",ref:d,tabIndex:-1},this.renderAvatar(n,i),a.React$1.createElement("div",{className:"cb-conflict-popover__text-wrapper"},a.React$1.createElement("div",{className:"cb-conflict-popover__title"},t),a.React$1.createElement("div",{className:"cb-conflict-popover__message"},r))),a.React$1.createElement(o.Button,{className:"cb-conflict-popover__dismiss-button",variant:"secondary",onClick:l},s))))}render(){const{lastEditMessage:e,userEditingMessage:t,isEditorFocused:r}=this.props,o=!!t&&r;return a.React$1.createElement("div",{className:"cb-last-edit"},a.React$1.createElement("div",{className:"cb-last-edit__message-wrapper"},!o&&a.React$1.createElement(ut,null),a.React$1.createElement("div",{className:"cb-last-edit__message"},o?t:e)),this.renderConflictPopover())}}gt.displayName="LastEditComponent";const ht={reloadDescription:h.reloadDescription};class ft extends a.React$1.PureComponent{constructor(e){super(e),this.stateFromProps=(e=this.props)=>({message:this.createMessage(e),conflictPopup:this.createConflictPopup(e)}),this.onTimeout=()=>{this.setState(this.stateFromProps()),this.updateTimer=setTimeout(this.onTimeout,3e4)},this.createMessage=e=>{if(!e.lastModifiedTime||e.isFolderOverviewEmpty)return"";const t=o.ago(1e3*e.lastModifiedTime,!1);return e.isFolderOverviewEmpty?e.lastModifiedUserId===e.user.account_id?r.intl.formatMessage(h.DESCRIPTION_LAST_EDIT_EMPTY_YOU,{time_ago:t}):e.lastModifiedUser?r.intl.formatMessage(h.DESCRIPTION_LAST_EDIT_EMPTY,{time_ago:t,name:e.lastModifiedUser.name.display_name}):"":e.lastModifiedUserId===e.user.account_id?r.intl.formatMessage(h.DESCRIPTION_LAST_EDIT_YOU,{time_ago:t}):e.lastModifiedUser?r.intl.formatMessage(h.DESCRIPTION_LAST_EDIT,{time_ago:t,name:e.lastModifiedUser.name.display_name}):""},this.handleLastEditDismiss=()=>{this.props.reloadDescription({folderFileId:this.props.folderFileId,componentNamespace:this.props.componentNamespace})},this.createConflictPopup=e=>{if(e.descriptionSaveState===o.DescriptionSaveState.CONFLICT){if(e.lastModifiedUserId===e.user.account_id)return{title:h.CONFLICT_POPUP_TITLE_YOU,message:h.CONFLICT_POPUP_CONTENT_YOU,dismissButtonLabel:h.CONFLICT_POPUP_BUTTON,onDismissHandler:this.handleLastEditDismiss,userInitials:o.userInitials(e.user),userPhotoUrl:e.user.photo_url};if(e.lastModifiedUser)return{title:r.intl.formatMessage(h.CONFLICT_POPUP_TITLE,{user:e.lastModifiedUser.name.display_name}),message:h.CONFLICT_POPUP_CONTENT,dismissButtonLabel:h.CONFLICT_POPUP_BUTTON,onDismissHandler:this.handleLastEditDismiss,userInitials:o.userInitials(e.lastModifiedUser),userPhotoUrl:e.lastModifiedUser.profile_photo_url}}},this.state=this.stateFromProps(e)}componentDidMount(){this.updateTimer=setTimeout(this.onTimeout,3e4)}componentWillUnmount(){clearTimeout(this.updateTimer)}UNSAFE_componentWillReceiveProps(e){this.setState(this.stateFromProps(e))}render(){return!this.state.message||this.props.descriptionHasFocus?null:a.React$1.createElement(gt,{lastEditMessage:this.state.message,conflictPopup:this.state.conflictPopup,isEditorFocused:this.props.descriptionHasFocus,userEditingMessage:h.FOLDER_OVERVIEW_EDITOR_EDITING})}}ft.displayName="FolderOverviewLastEditComponent";const _t=o.connect((()=>{const e=h.makeFolderFileIdSelector(),t=h.makeLastModifiedTimeSelector(),a=h.makeLastModifiedUserSelector(),r=h.makeLastModifiedUserIdSelector(),o=h.makeDescriptionSaveStateSelector(),s=h.makeIsFolderOverviewEmptySelector(),n=h.makeDescriptionHasFocusSelector();return(i,l)=>({user:h.user(i),folderFileId:e(i,l),lastModifiedTime:t(i,l),lastModifiedUser:a(i,l),lastModifiedUserId:r(i,l),descriptionSaveState:o(i,l),isFolderOverviewEmpty:s(i,l),descriptionHasFocus:n(i,l)})}),ht)(o.requireCssWithComponent(ft,["/static/typescript/component_libraries/spaces-components/src/index-vflqS-4WW.css"])),Et={fetchDataForFolder:h.fetchDataForFolder,reloadDescription:h.reloadDescription};class vt extends a.React$1.PureComponent{constructor(){super(...arguments),this.handleLiveUpdate=({type:e})=>{"description"===e&&this.props.reloadDescription({folderFileId:this.props.folderFileId,componentNamespace:this.props.componentNamespace})}}componentDidMount(){this.props.fetchDataForFolder({path:this.props.path,nsId:this.props.nsId,componentNamespace:this.props.componentNamespace,fetchContentReferences:!0}),h.folderOverviewLiveUpdateManager.addListener("update",this.handleLiveUpdate)}componentWillUnmount(){h.folderOverviewLiveUpdateManager.removeListener("update",this.handleLiveUpdate),h.folderOverviewLiveUpdateManager.stop()}render(){return a.React$1.createElement("div",{className:o.cx({"folder-overview":!0,"folder-overview--loading":!this.props.haveAllComponentsLoaded||this.props.hasFailedToLoad,"folder-overview__fixed-toolbar-container":!0,"folder-overview__border":this.props.descriptionHasFocus})},a.React$1.createElement(pt,{path:this.props.path,componentNamespace:this.props.componentNamespace,isReadOnly:this.props.isReadOnly||!this.props.descriptionFormatValid,descriptionKey:[this.props.folderFileId,this.props.descriptionBaseRevision].join("-"),canShareFolder:this.props.canShareFolder}),a.React$1.createElement(_t,{path:this.props.path,componentNamespace:this.props.componentNamespace}))}}vt.displayName="SidebarFolderOverviewController";const Ct=o.connect((()=>{const e=h.makeHaveAllComponentsLoadedSelector(),t=h.makeHasFailedToLoadSelector(),a=h.makeFolderFileIdSelector(),r=h.makeDescriptionBaseRevisionSelector(),o=h.makeDescriptionHasFocusSelector(),s=h.makeDescriptionFormatValidSelector(),n=h.makeDoesFolderOverviewExistSelector();return(i,l)=>({user:h.user(i),haveAllComponentsLoaded:e(i,l),hasFailedToLoad:t(i,l),folderFileId:a(i,l),descriptionBaseRevision:r(i,l),descriptionFormatValid:s(i,l),descriptionHasFocus:o(i,l),doesFolderOverviewExist:n(i,l)})}),Et)(vt),St=o.requireCssWithComponent(Ct,["/static/metaserver/static/css/browse/folder_overview-vfldbusgW.css","/static/typescript/libraries/comments2/src/index-vfljiK9YC.css"]),xt="auto-tagging-awareness-snackbar-id",bt=t=>{const{files:s,tag:n,isBulkTagging:i,numFilesTagged:l,user:c,onAutoTag:d,actionSurface:p}=t,u=i?"bulk_tagging":"single_file",m=s[0],g=i?r.intl.formatMessage({id:"5Na01D",defaultMessage:"{numFilesTagged} files tagged. Want to auto-tag future files in this folder <b>#{tag}</b>, too?"},{tag:n,numFilesTagged:l,b:e=>a.React$1.createElement(o.Text,{isBold:!0,color:"inherit"},e)}):r.intl.formatMessage({id:"80mH7x",defaultMessage:"Tagged {folderName}. Want to auto-tag current and future files in this folder <b>#{tag}</b>, too?"},{tag:n,folderName:o.getFilename(m),b:e=>a.React$1.createElement(o.Text,{isBold:!0,color:"inherit"},e)}),h={actions:[{icon:o.AutomationLine,name:"create_auto_tag",text:r.intl.formatMessage({id:"zz4WkW",defaultMessage:"Auto-tag #{tag}"},{tag:n}),onClick:()=>{new Promise((function(t,a){e(["./c_flows_redux_reducer"],t,a)})).then((function(e){return e.api_helpers_esnext})).then((e=>{const t=i&&m.is_dir?o.parent_dir(m.fq_path):m.fq_path,a=e.updateFolderRule({fqPath:t,actions:[{actionType:"tag",data:{tags:[n]}}],enabled:!0,trigger:e.DEFAULT_CLIENT_FOLDER_TRIGGER});return o.logAutoTagSnackbarAction(c.id,m,n,"auto_tag_folder",u,p),o.Snackbar.close(xt),a.then((()=>{!i&&m.is_dir&&d(),o.Snackbar.complete(r.intl.formatMessage({id:"Nazzhm",defaultMessage:"Automation added to folder."}))}),(e=>{o.Snackbar.fail(r.intl.formatMessage({id:"0cONZO",defaultMessage:"Couldn't add automation to folder"}))}))}))}},{name:"show_me_how",text:r.intl.formatMessage({id:"S+oEom",defaultMessage:"Show me how"}),onClick:()=>{o.logAutoTagSnackbarAction(c.id,m,n,"open_help_center",u,p),o.open_tab("//help.dropbox.com/files-folders/sort-preview/dropbox-tags")}},{name:"do_this_later",text:r.intl.formatMessage({id:"4yWOzK",defaultMessage:"Do this later"}),onClick:()=>{o.logAutoTagSnackbarAction(c.id,m,n,"close",u,p),o.Snackbar.close(xt)}}],helperText:g,clickHandlerArgs:{userId:c.id,filePath:m.fq_path}};return o.Snackbar.show(a.React$1.createElement(o.Snackbar,{title:"",variant:"complete",id:xt,richSnackbarProps:h}))};const yt=t=>{const{user:a,files:s,selectedTag:n,isSearchMode:i,isAutoTaggingEnabled:c,autoTaggingAwarenessVariant:d,autoTagFolderContents:p,allFilesSelected:u,hasMoreFiles:m,actionSurface:g,dispatch:f}=t,_=o.trimHashtags(n).toLowerCase(),E=()=>yt({user:a,files:s,selectedTag:_,isSearchMode:i,isAutoTaggingEnabled:c,autoTaggingAwarenessVariant:d,autoTagFolderContents:!0,allFilesSelected:u,hasMoreFiles:m,actionSurface:g,dispatch:f});!function(e){if(1===e.length){const t=o.File.getCategoryDescription(e[0]);if("Image"===t)return void o.UserSurvey.trackEvent("add_tag_to_image","right_rail");if("Document"===t)return void o.UserSurvey.trackEvent("add_tag_to_document","right_rail")}o.UserSurvey.trackEvent("add_tag","right_rail")}(s),f(o.addTagToFiles({user:a,files:s,tag:_,onPartialError:e=>{const t=o.createSelection(e.map((e=>e.fq_path)));f(i?o.setSelection({selection:t,skipLogging:!0}):h.setSelection({selection:t,skipLogging:!0}))},onSuccess:(t,i,p)=>{const h=s[0],f=t&&h.is_dir?o.parent_dir(h.fq_path):h.fq_path,v=()=>l.__awaiter(void 0,void 0,void 0,(function*(){if(p)return!0;const e=yield y.getFolderRules(f);return!!(null==e?void 0:e.get_rule_result)&&"folder_rule_set"===e.get_rule_result[".tag"]}));d&&"OFF"!==d&&new Promise((function(t,a){e(["./c_stormcrow_stormcrow_exposure_logger"],t,a)})).then((({StormcrowExposureLogger:e})=>{(new e).logExposure("auto_tag_awareness",d,null==a?void 0:a.id)})),t||p?l.__awaiter(void 0,void 0,void 0,(function*(){c&&u&&!m&&f.length>1&&!(yield v())?bt({files:s,tag:_,isBulkTagging:t,numFilesTagged:i,user:a,onAutoTag:E,actionSurface:g}):o.Snackbar.complete(r.intl.formatMessage({id:"GxQj59",defaultMessage:"Tagged {numOfSuccesses} files or folders #{selectedTag}."},{numOfSuccesses:i,selectedTag:n}),"add-tag-bulk")})):l.__awaiter(void 0,void 0,void 0,(function*(){1===s.length&&c&&h.is_dir&&h.fq_path.length>1&&((yield v())||bt({files:s,tag:_,isBulkTagging:t,numFilesTagged:1,user:a,onAutoTag:E,actionSurface:g}))}))},autoTagFolderContents:p||!1,actionSurface:g}))},Tt=({files:e,user:t,isSearchMode:r,isAutoTaggingEnabled:s,autoTaggingAwarenessVariant:n,actionSurface:i,userSurveyEventSurface:l})=>{const c=o.useDispatch(),d=o.useSelector((e=>r?o.allFilesSelected(e):o.allFilesSelected$1(e))),p=o.useSelector((e=>r?!!o.hasMoreResults(e):o.browseLoadingState(e)===o.LoadingState.LOADED)),u={onSelection:a=>{yt({user:t,files:e,selectedTag:a,isSearchMode:r,isAutoTaggingEnabled:s,autoTaggingAwarenessVariant:n,autoTagFolderContents:!1,allFilesSelected:d,hasMoreFiles:p,actionSurface:i,dispatch:c})},onTagDelete:a=>{c(o.removeTagFromFiles({user:t,files:e,tag:a,actionSurface:i}))},fetchAllTagsSuggestions:({user:e})=>{c(o.fetchAllTagsSuggestions({user:e}))},allTagsSuggestions:o.useSelector(o.selectAllTagsSuggestions)};return a.reactExports.createElement(T.TagsContext.Provider,{value:u},a.reactExports.createElement("div",{className:T.classes.reduxContainer},a.reactExports.createElement(T.TagsSection,{user:t,files:e,actionSurface:i,userSurveyEventSurface:l})))};Tt.displayName="TagsSectionRedux";o.injectInternalStyle("metaserver/static/js/right_rail/flows/automations_section.module.out.css",(e=>"._automations-section__container_1dhq2_1{display:flex;flex-direction:column;margin-top:20px}._automations-section__header_1dhq2_7{display:flex;flex-direction:row;justify-content:space-between}._automations-section__scheduled-trigger_1dhq2_13:hover{text-decoration:underline}"));const kt={automationsSectionContainer:"_automations-section__container_1dhq2_1",automationsSectionHeader:"_automations-section__header_1dhq2_7",automationsSectionScheduledTrigger:"_automations-section__scheduled-trigger_1dhq2_13"},wt=({onEdit:e,inherited:t})=>{const{header:r,settings:s,inheritedSettings:n}=Lt(),i=t?n:s;return a.React$1.createElement("div",{className:kt.automationsSectionHeader},a.React$1.createElement(o.Text,{variant:"paragraph",size:"small",isBold:!0},r),a.React$1.createElement(M.FlowsIconButton,{className:"automations-section__edit-button",icon:o.AutomationLine,onClick:e,size:"small",tooltip:{title:i,id:"tooltip-settings"},ariaLabel:i}))};wt.displayName="AutomationsSectionHeader";const Mt=({folder:e,user:t,setUrl:r})=>{const s=Lt(),n=o.useSelector(w.getUserAutomationWithInheritance(e.fq_path));if(!n)return null;const i=[];if(n.actions.forEach((e=>{const t=R.loadWorkflowActionUi(e.actionType);t&&i.push(t)})),n.actions.length!==i.length)return null;const l=n.trigger,c="scheduled"===l.triggerType?a.React$1.createElement(Ft,{trigger:l}):a.React$1.createElement(Nt,{trigger:l}),d=F.isInherited(n)?n.inheritedFromFqPath:e.fq_path;return a.React$1.createElement("div",{className:kt.automationsSectionContainer},a.React$1.createElement(wt,{inherited:F.isInherited(n),onEdit:()=>k.asyncLaunchWorkflowBuilder({operation:"edit",folderFqPath:d,surface:"browse"})}),F.isInherited(n)&&a.React$1.createElement(ae,{title:s.source,data:a.React$1.createElement(Rt,{automation:n,user:t,setUrl:r})}),a.React$1.createElement(ae,{title:s.trigger,data:c}),a.React$1.createElement(ae,{title:s.action,data:a.React$1.createElement(Ot,{actionUiConfigs:i})}))};function Rt({automation:e,user:t,setUrl:r}){return a.React$1.createElement(c.FileBreadcrumb,{size:"small",path:e.inheritedFromFqPath,user:t,useFullPath:!0,isForCurrentPath:!1,setUrl:r})}function Ft({trigger:e}){const t=Lt(),r=M.getFullRRuleStringForTooltip(e),s=a.React$1.createElement("span",{className:o.cx({[kt.automationsSectionScheduledTrigger]:!!r})},M.getFrequencyString(e));return a.React$1.createElement(o.Text,{variant:"paragraph",size:"small"},r?a.React$1.createElement(o.Tooltip,{placement:"top-start",title:r},s):s,a.React$1.createElement("span",null,", ",t.triggerScheduled))}function Nt({trigger:e}){const t=Lt();return a.React$1.createElement(o.Text,{variant:"paragraph",size:"small"},t.triggerFileAdd)}function Ot({actionUiConfigs:e}){const{fewActionsLabel:t,manyActionsLabel:r}=Lt(),s=e.map((e=>e.rightRailTitle));return a.React$1.createElement(o.Text,{variant:"paragraph",size:"small"},s.length>3?r(s):t(s))}function Lt(){return{header:r.intl.formatMessage({id:"lVqDZn",defaultMessage:"Automations"}),trigger:r.intl.formatMessage({id:"L02EQa",defaultMessage:"When"}),triggerFileAdd:r.intl.formatMessage({id:"TEHGSR",defaultMessage:"Files are added to this folder"}),triggerScheduled:r.intl.formatMessage({id:"QmXlPG",defaultMessage:"files in this folder"}),action:r.intl.formatMessage({id:"RI/Q2m",defaultMessage:"Then"}),source:r.intl.formatMessage({id:"dD1r+k",defaultMessage:"Source"}),settings:r.intl.formatMessage({id:"RI/XND",defaultMessage:"Automation settings"}),inheritedSettings:r.intl.formatMessage({id:"JYuuqg",defaultMessage:"View automation settings of the source folder"}),fewActionsLabel:e=>r.intl.formatList(e),manyActionsLabel:e=>r.intl.formatMessage({id:"nsyNyU",defaultMessage:"{action1}, {action2}, {action3}, and +{count}"},{action1:e[0],action2:e[1],action3:e[2],count:e.length-3})}}Mt.displayName="AutomationsSection";const It=({user:e,files:t})=>null,Pt=a.reactExports.memo((({files:e,user:t,viewType:s,isSearchMode:n,isSelection:l,id:c,setUrl:d,manualTaggingVariant:p,flowsAutomatedFolderUiVariant:m,flowsAutoTagUiVariant:g,autoTaggingAwarenessVariant:f,flowsApprovalVariant:_,isInsideBackup:E,backupFolderPath:v,navigateToBlade:C,flowsVersionControlVariant:S,lastBackupTime:x,structuredTaggingVariant:b})=>{const y=r.useIntl(),T=e.get(0),k=e.toArray().filter((e=>(B(e)||U(e))&&!e.isDeleted)),w=k.length>0&&!E&&(o.isBulkTaggingEnabled(p)||o.isTaggingEnabled(p)&&1===k.length),M=1===k.length&&t.is_team&&h.areStructuredTagsEnabled(b),R=1===e.size&&T&&(B(F=T)&&o.File.getCategoryDescription(F)===o.FileTypeCategoryTranslations.IMAGE);var F;return a.reactExports.createElement(i.RightRail.Blade,{withTitle:y.formatMessage({id:"AP9nbK",defaultMessage:"Info"}),withIcon:a.reactExports.createElement(o.UIIcon,{src:o.InfoLine}),id:c},a.reactExports.createElement("div",{className:X},a.reactExports.createElement("div",{className:ee},a.reactExports.createElement($,{selectedFiles:e,user:t,viewType:s,isSearchMode:n,showMostRecentFilesFirst:!0})),M&&a.reactExports.createElement(It,{user:t,files:k}),w&&a.reactExports.createElement(Tt,{files:k,user:t,isSearchMode:n,isAutoTaggingEnabled:o.isAutoTaggingEnabled(p,m,g,f),autoTaggingAwarenessVariant:f,actionSurface:"right_pane",userSurveyEventSurface:"right_rail"}),a.reactExports.createElement(ue,{files:e,user:t,isSelection:l,isSearchMode:n,setUrl:d,showHeader:w,showMediaDetails:R,showApproval:N.isApprovalEnabled(_),isInsideBackup:E,backupFolderPath:v,navigateToBlade:C,lastBackupTime:x}),1===e.size&&T&&U(T)&&!o.File.isNoAccessSharedFolder(T)&&a.reactExports.createElement(a.reactExports.Fragment,null,m&&a.reactExports.createElement(Mt,{folder:T,user:t,setUrl:d}),a.reactExports.createElement("div",{className:te},a.reactExports.createElement(St,{key:T.fq_path,path:T.fq_path,componentNamespace:"SIDEBAR",isReadOnly:!o.canEditOverviewForFile(T),canShareFolder:!o.File.isNoAccessSharedFolder(T)}))),u.isVersioningMVPEnabled(S)&&T&&1===e.size&&a.reactExports.createElement(I.ChangeLogSection,{fileId:T.file_id,user:t})))}));Pt.displayName="InfoBlade";const Dt=a.reactExports.memo((({id:e})=>{const t=r.useIntl();return a.reactExports.createElement(i.RightRail.CollapsedBladeIcon,{id:e,withIcon:a.reactExports.createElement(o.UIIcon,{src:o.InfoLine,"aria-label":t.formatMessage({id:"pbG2K9",defaultMessage:"Open information panel"})}),tooltip:t.formatMessage({id:"+PrmmG",defaultMessage:"Info"})})}));Dt.displayName="CollapsedInfoBladeButton";const At={Blade:e=>a.reactExports.createElement(Pt,Object.assign({},e)),CollapsedButton:e=>a.reactExports.createElement(Dt,Object.assign({},e)),isBladeSupported:e=>!0},Bt=a.React$1.createContext(void 0);const Ut=a.React$1.memo((e=>a.React$1.createElement(f.Comment,Object.assign({},e))));function jt({fileId:e}){const t=o.useDispatch();a.reactExports.useEffect((()=>{t(P.listCommentsAction({arg:{include_permissions:!0,stream:{identifier:{".tag":"file_path_or_id",file_path_or_id:e},type:{".tag":"file"}}}}))}),[e,t])}function Ht({fileId:e}){const t=o.useDispatch(),{commentBladeId:r}=function(){const e=a.reactExports.useContext(Bt);if(!e)throw new Error("BasicCommentsBladeContext should be provided");return e}();a.reactExports.useEffect((()=>{t(P.deactivateAllThreads({fileViewerId:r})),t(P.focusThread(r,null))}),[e,t,r])}Ut.displayName="BaseComment";const $t={showApproval:!1,approvalIOClient:void 0},Vt=a.React$1.memo((({fileId:e,id:t,intl:r,onClickAnnotation:s,approvalIOClient:n,user:i})=>{const l=function({fileId:e}){switch(o.useSelector((t=>P.getAnnotationType(t,e)))){case"audio":case"video":return e=>a.React$1.createElement(f.TimeCodedComment,Object.assign({},e));case"document":return e=>a.React$1.createElement(f.NumberedComment,Object.assign({},e));default:return e=>a.React$1.createElement(Ut,Object.assign({},e))}}({fileId:e});return jt({fileId:e}),Ht({fileId:e}),function(){const e=o.useDispatch();a.reactExports.useEffect((()=>{e(P.getStickersAction({arg:void 0}))}),[])}(),a.React$1.createElement(P.CommentsBlade,{id:t,intl:r,fileId:e,approvalIOClient:n},a.React$1.createElement(f.CommentsBladePane,{commentsBladeId:t,intl:r,commentFactory:l,config:Object.assign(Object.assign({},$t),{approvalIOClient:n,showApproval:Boolean(null==n?void 0:n.getUserExperiments().flows_approval_flow_enabled)}),fileId:e,user:i,className:P.classes.baseCommentsPaneBlade,onClickAnnotation:s,approvalIOClient:n}))}));Vt.displayName="BasicCommentsBladePaneWrapper";const Wt=a.React$1.memo((({fileId:e,id:t,intl:r})=>(jt({fileId:e}),a.React$1.createElement(P.CollapsedCommentsBladeButton,{id:t,intl:r,fileId:e}))));Wt.displayName="CollapsedBladeButton";const zt=o.defaultMemoize(((e,t)=>{const r=u.makeComments2Client(e),s=new o.DefaultUserApiV2Client(e);return((e,t,r)=>{const s=P.makeStore(e);return{Blade:a.React$1.memo((n=>{const{id:i}=n,l=a.reactExports.useMemo((()=>({apiV2Client:e.apiv2ClientBase,commentBladeId:i})),[i]);return a.React$1.createElement(o.Provider,{store:s},a.React$1.createElement(Bt.Provider,{value:l},a.React$1.createElement(Vt,Object.assign({},n,{user:t,approvalIOClient:r}))))})),CollapsedButton:a.React$1.memo((t=>{const{id:r,intl:n,fileId:i}=t,l=a.reactExports.useMemo((()=>({apiV2Client:e.apiv2ClientBase,commentBladeId:r})),[r]);return a.React$1.createElement(o.Provider,{store:s},a.React$1.createElement(Bt.Provider,{value:l},a.React$1.createElement(Wt,{id:r,intl:n,fileId:i})))}))}})(Object.assign(Object.assign({},r),{apiv2ClientBase:s,logger:e=>{t({eventName:o.WebUserActionLogEvent.BROWSE_COMMENT_ACTION,extra:{action:e.event}})}}),u.dbxUserToIUser(e),r.approvalIOClient)})),Kt=e=>{return 1===e.files.size&&(t=e.files.first(),B(t)&&!t.isDeleted&&!(null===(a=t.per_node_metadata)||void 0===a?void 0:a.link_node)||j(e.files.first()))&&!!e.files.first().file_id&&!e.files.first().is_cloud_doc;var t,a},Gt=a.reactExports.memo((e=>{const{id:t,user:o,files:s,onClickAnnotation:n,onLogEvent:i}=e,l=r.useIntl();if(!Kt(e))return null;const{Blade:c}=zt(o,i);return a.reactExports.createElement(c,{id:t,intl:l,fileId:s.first().file_id,onClickAnnotation:n})}));Gt.displayName="Blade";const qt=a.reactExports.memo((e=>{const{id:t,files:o,user:s,onLogEvent:n}=e,i=r.useIntl();if(!Kt(e))return null;const{CollapsedButton:l}=zt(s,n);return a.reactExports.createElement(l,{id:t,intl:i,fileId:o.first().file_id})}));qt.displayName="CollapsedButton";const Yt={CollapsedButton:qt,Blade:Gt,isBladeSupported:Kt},Zt=A.makeStore({apiV2Client:new o.UserApiV2Client}),Qt={[D.FilterUserEvent.SELECT_ALL_HISTORY_TYPE]:o.WebUserActionLogEvent.SELECT_ALL_HISTORY_TYPE,[D.FilterUserEvent.CLEAR_SELECT_HISTORY_TYPE]:o.WebUserActionLogEvent.CLEAR_SELECT_HISTORY_TYPE,[D.FilterUserEvent.SELECT_HISTORY_TYPE]:o.WebUserActionLogEvent.SELECT_HISTORY_TYPE,[D.FilterUserEvent.UNSELECT_HISTORY_TYPE]:o.WebUserActionLogEvent.UNSELECT_HISTORY_TYPE},Jt=e=>1===e.files.size&&H(e.files)&&!e.files.first().isDeleted&&!!e.files.first().file_id&&!e.files.first().is_in_vault_folder,Xt=({files:e,id:t,user:s,handleVersionHistory:n,onLogEvent:i})=>{const l=r.useIntl(),c=a.reactExports.useCallback((e=>{i({eventName:Qt[e]})}),[i]),d=a.reactExports.useCallback((()=>n(s,e)),[n,s,e]),p=!((u=e.first()).isDeleted||u.is_unmounted||u.is_cloud_doc&&o.isPointerByExtension(u.ns_path)||(null===(m=u.per_node_metadata)||void 0===m?void 0:m.link_node));var u,m;const g=a.reactExports.useMemo((()=>p?{enabled:!0,onVersionHistoryClicked:d}:{enabled:!1}),[p,d]);return a.reactExports.createElement(D.FileActivityBlade,{id:t,fileId:e.first().file_id,user:s,versionHistory:g,rootNamespaceName:o.Viewer.get_root_name(s),logFilterChange:c,intl:l})};Xt.displayName="BladeWithoutStore";const ea=e=>{const{id:t}=e,o=r.useIntl();return Jt(e)?a.reactExports.createElement(D.CollapsedFileActivityBladeButton,{id:t,intl:o}):null};ea.displayName="CollapsedButton";const ta=e=>{const{files:t}=e;return Jt(e)&&H(t)?a.reactExports.createElement(o.Provider,{store:Zt},a.reactExports.createElement(Xt,Object.assign({},e,{files:t}))):null};ta.displayName="Blade";const aa={Blade:ta,CollapsedButton:ea,isBladeSupported:Jt};t.BackupBreadcrumb=le,t.CommentsBladeUI=Yt,t.FileActivityBladeUI=aa,t.InfoBladeUI=At,t.enhanceBladeUI=function(e,t){return{Blade:r=>{const o=t(r),{Blade:s}=e;return a.reactExports.createElement(s,Object.assign({},r,o))},CollapsedButton:r=>{const o=t(r),{CollapsedButton:s}=e;return a.reactExports.createElement(s,Object.assign({},r,o))},isBladeSupported:t=>e.isBladeSupported(t)}},t.isBladeDirectory=U,t.isListBladeDirectory=e=>e.every((e=>U(e)))}));
//# sourceMappingURL=c_right_rail_file_activity_file_activity_blade.js-vflo2m8eV.map
