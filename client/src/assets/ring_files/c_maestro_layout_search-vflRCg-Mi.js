define(["require","exports","./c_tslib","./e_ui_page_files_router","./e_edison","./c_spectrum_media_table_skeleton","./c_core_exception_info","./c_core_i18n","./c_spectrum_vertically_fixed","./e_core_exception"],(function(e,t,a,r,s,i,n,o,c,l){"use strict";const d=e=>{const[t,a]=s.reactExports.useState((e=>"undefined"!=typeof window&&window.matchMedia(e).matches)(e));return s.reactExports.useEffect((()=>{let t=!0;const r=window.matchMedia(e),s=()=>{t&&a(!!r.matches)};try{r.addEventListener("change",s)}catch(e){r.addListener(s)}return a(r.matches),()=>{t=!1;try{r.addEventListener("change",s)}catch(e){r.addListener(s)}}}),[e]),t};class h extends s.React$1.Component{render(){const e=this.props,{responsive:t}=e,r=a.__rest(e,["responsive"]),i=t&&t.isResponsive?"div":c.VerticallyFixed;return s.React$1.createElement(i,r)}}h.displayName="VerticallyFixedWrapper";const p=()=>{const[e,t]=s.React$1.useState(!(!document||!document.documentElement)&&document.documentElement.classList.contains("maestro--responsive"));return{isResponsive:e,isMatchedMedium:d("(min-width: 736px)"),isMatchedLarge:d("(min-width: 1025px)")}};class m extends s.React$1.Component{renderSearchBar(){const{searchVariant:e}=this.props;if(this.props.user){if(this.props.overrideSearchBar)return this.props.overrideSearchBar;switch(e){case"minimal":return s.React$1.createElement(r.MinimalSearchInput,{user:this.props.user});case"full-page":return s.React$1.createElement(r.GlobalHeaderSearchInputPortalTarget,null);case void 0:case null:return null;default:r.enforceExhaustive(e)}}return null}render(){return this.renderSearchBar()}}m.defaultProps={searchVariant:"minimal",isSearchBarExpanded:!1,currentPath:"/"},m.displayName="TopMenuContainerWithoutCSS";const u=r.requireCssWithComponent(m,["/static/metaserver/static/css/pagelet-vflQZ-elc.css"]);r.injectInternalStyle("metaserver/static/js/maestro/layout/header_campaigns.module.out.css",(e=>"._above-maestro-content-campaign-slot-wrapper_elq3x_1{padding:var(--spacing__base_unit)}"));const R="_above-maestro-content-campaign-slot-wrapper_elq3x_1";class S extends s.React$1.Component{constructor(){super(...arguments),this.state={deferSearchRenderToGlobalHeader:r.shouldUseReactRouter()}}getRelevantSearchPropsForGlobalHeader(){return{searchVariant:this.props.searchVariant,overrideSearchBar:this.props.overrideSearchBar||this.state.deferSearchRenderToGlobalHeader?s.React$1.createElement(u,Object.assign({},this.props)):void 0,shouldLoadSearchInGH:this.state.deferSearchRenderToGlobalHeader}}componentDidMount(){r.shouldUseReactRouter()||(r.globalHeaderBufferedEventEmitter.on(r.SEARCH_REQUEST_PROPS,(()=>{this.setState({deferSearchRenderToGlobalHeader:!0})})),r.globalHeaderBufferedEventEmitter.emit(r.SEARCH_SET_PROPS,this.getRelevantSearchPropsForGlobalHeader()))}componentDidUpdate(e,t){(r.shouldUseReactRouter()||e.isSearching===this.props.isSearching&&e.isSearchBarExpanded===this.props.isSearchBarExpanded)&&t.deferSearchRenderToGlobalHeader===this.state.deferSearchRenderToGlobalHeader||r.globalHeaderBufferedEventEmitter.emit(r.SEARCH_SET_PROPS,this.getRelevantSearchPropsForGlobalHeader())}componentWillUnmount(){r.shouldUseReactRouter()||r.globalHeaderBufferedEventEmitter.removeListener(r.SEARCH_REQUEST_PROPS)}render(){const e=this.props,{chromeClass:t,useMaestroPortal:i}=e,n=a.__rest(e,["chromeClass","useMaestroPortal"]);return i?s.React$1.createElement(s.React$1.Fragment,null,s.React$1.createElement(r.MaestroPortal,{element:r.MaestroPortalElement.TITLE,chromeClass:t},s.React$1.createElement(r.CampaignSlot,{slotId:"above_maestro_content",wrapperClassName:R}),s.React$1.createElement(g,{className:this.props.titleClass},n.title))):s.React$1.createElement("header",{className:"maestro-header page-header__shadow"},s.React$1.createElement(h,{className:"page-header",responsive:this.props.responsive},s.React$1.createElement(g,{className:this.props.titleClass},n.title)))}}S.defaultProps={isSearchBarExpanded:!1},S.displayName="PageletMaestroHeaderWithoutCSS";const g=({className:e,children:t})=>s.React$1.createElement("div",{className:r.cx("page-header__title",e)},s.React$1.createElement(r.UserEducationEffect,{containerName:"PageletMaestroHeader",name:"Title",useSpan:!1},t));g.displayName="MaestroHeaderTitleWithUE";const E=r.requireCssWithComponent(S,["/static/metaserver/static/css/dig-components/index.web-vflGcQt8W.css","/static/metaserver/static/css/maestro_layout-vflM__M56.css"]);class v extends s.React$1.Component{constructor(e){super(e),this.state={}}render(){return s.React$1.createElement(h,{responsive:this.props.responsive,className:"maestro-secondary-sidebar"},this.props.children)}}v.displayName="MaestroSecondarySidebar";const _=({actionSidebarRegion:e,responsive:t,sidebarClass:a,useRightRail:i})=>s.React$1.createElement(s.React$1.Fragment,null,e&&(i?s.React$1.createElement("div",{className:"maestro-secondary-sidebar-v2"},"function"==typeof e?e(t):e):s.React$1.createElement("div",{className:r.cx(["maestro-secondary-sidebar__shadow",a]),role:"complementary","aria-label":"sidebar"},s.React$1.createElement(v,{responsive:t},"function"==typeof e?e(t):e))));_.displayName="SidebarRegion";const b=({user:e,titleRegion:t,titleClass:a,chromeClass:i,embeddedAppRegion:n,searchBarProps:o,useMaestroPortal:c,actionSidebarRegion:l,useRightRail:d,useModernSearchDropdown:h,sidebarClass:m,scrollHandler:u})=>{const R=p(),S=c,g=!c;return s.React$1.createElement("div",{className:r.cx(["maestro-chrome",i])},(g||S)&&s.React$1.createElement(E,Object.assign({user:e,title:"function"==typeof t?t(R):t,titleClass:a,chromeClass:i,responsive:R},o||{},{useMaestroPortal:c,useModernSearchDropdown:h})),S&&s.React$1.createElement(r.MaestroPortal,{element:r.MaestroPortalElement.SIDEBAR,chromeClass:r.cx(["maestro-sidebar-chrome",i])},s.React$1.createElement(_,{actionSidebarRegion:l,useRightRail:d,responsive:R,sidebarClass:m})),s.React$1.createElement(r.MaestroPortal,{element:r.MaestroPortalElement.CONTENT,chromeClass:r.cx(["maestro-content-chrome",i]),scrollHandler:u},s.React$1.createElement("div",{className:"maestro-app"},s.React$1.createElement("div",{className:"maestro-app-content"},"function"==typeof n?n(R):n),!S&&s.React$1.createElement(_,{actionSidebarRegion:l,useRightRail:d,responsive:R}))))},f={},$=r.Loadable({loader:()=>a.__awaiter(void 0,void 0,void 0,(function*(){const{SearchRightRail:t}=yield new Promise((function(t,a){e(["./c_single_page_search_right_rail"],t,a)}));return t}))}),C=e=>s.React$1.createElement($,Object.assign({},e));C.displayName="AsyncSearchRightRail";const P=r.Loadable({loader:()=>a.__awaiter(void 0,void 0,void 0,(function*(){const[{SearchView:t}]=yield Promise.all([new Promise((function(t,a){e(["./c_search_search_results_view"],t,a)})).then((function(e){return e.view_esnext}))]);return t})),loading:({inputBox:e})=>e.current&&e.current.value?s.React$1.createElement(i.MediaTableSkeleton,{numRows:15}):null,loadError:()=>s.React$1.createElement("div",null,o.intl.formatMessage({id:"V2lejD",defaultMessage:"Something went wrong. Please reload the page."}))});class x extends s.React$1.PureComponent{constructor(e){super(e),this.handleSearchExit=()=>{this.setState({isSearching:!1})},this.handleSearchEnter=()=>{this.setState({isSearching:!0})},this.renderSearchSidebar=e=>s.React$1.createElement(C,{responsive:e}),this.renderEmbeddedApp=e=>[this.inSearchMode?s.React$1.createElement(P,{key:"search",user:this.props.user,responsive:e,inputBox:this.state.inputBox}):null,s.React$1.createElement("div",{style:{display:this.inSearchMode?"none":void 0},key:"app"},"function"==typeof this.props.embeddedAppRegion?this.props.embeddedAppRegion(e,!this.inSearchMode):this.props.embeddedAppRegion)],this.state={isSearching:e.searchBarProps&&e.searchBarProps.isSearching||!1,inputBox:s.React$1.createRef()}}get inSearchMode(){return this.props.searchBarProps&&"full-page"===this.props.searchBarProps.searchVariant&&this.props.user&&this.state.isSearching}render(){const{actionSidebarRegion:e,searchBarProps:t,titleRegion:a,useRightRailOutsideSearch:i,wideSecondarySidebar:o,user:c}=this.props,d=this.inSearchMode||i,h=r.cx({"maestro-chrome--search":!0,"maestro-chrome--search-active":this.inSearchMode,"exp-details-pane-variants":this.inSearchMode&&o,"maestro-chrome--right-rail":d},this.props.chromeClass),p=null==t?void 0:t.searchVariant;var m,u;"full-page"!==p&&(m="SearchChromeNotFullPageVariant",u=["SearchChrome called without full-page search variant",{severity:n.SEVERITY.NONCRITICAL,tags:["unified-search"],exc_extra:{search_variant:p}}],f[m]||(f[m]=!0,l.reportStack(...u)));const R={inputBoxRef:this.state.inputBox,isActive:this.inSearchMode,onSearchEnter:this.handleSearchEnter,onSearchExit:this.handleSearchExit},S=s.React$1.createElement(b,Object.assign({},this.props,{actionSidebarRegion:this.inSearchMode?this.renderSearchSidebar:e,titleRegion:a,searchBarProps:Object.assign(Object.assign(Object.assign({},t||{}),{isSearching:this.state.isSearching}),R),useRightRail:d,embeddedAppRegion:this.renderEmbeddedApp,titleClass:"page-header__title--search",chromeClass:h}));return c?s.React$1.createElement(r.SearchProvider,{userId:c.id,searchInputProps:R},S):S}}x.displayName="SearchChrome",t.AsyncSearchRightRail=C,t.MaestroChrome=b,t.MaestroHeaderTitle=({children:e})=>s.React$1.createElement(r.Title,{className:"page-header__heading",tagName:"h1"},e),t.SearchChrome=x,t.useResponsiveProps=p}));
//# sourceMappingURL=c_maestro_layout_search.js-vflJU-l-P.map
