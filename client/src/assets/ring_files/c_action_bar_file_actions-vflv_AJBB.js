define(["require","exports","./c_src_simple-action-bar_action_bar_types","./e_ui_page_files_router","./c_sharing_gating_util","./c_unity_check_file_cache","./c_unity_features","./c_browse_file_actions_action_handlers","./c_action_bar_action_bar_strings","./e_edison","./c_flows_utils_async_modal_launchers","./c_core_i18n","./c_flows_redux_store","./c_flows_redux_selectors","./c_action_bar_action_bar_constants","./c_tslib","./c_file_actions_portable_copy","./c_ui_async_overquota_modal_controller","./c_browse_actions","./c_browse_tts","./c_file_actions_portable_select_destination","./c_core_browser_detection","./c_pap-events_navigation_navigate_to_edit","./c_flows_conversions_conversion_actions","./c_workflow_builder_workflow_actions_action_ui_config","./c_cloud_docs_gdd_migration_gdd_ui_blocking","./c_lodash-es_lodash","./c_files_view_file_actions_file_from_metadata","./c_history","./c_data_action_creators_index","./c_file_uploader_utils","./c_growth_ui_teams_web_actions_logger_events","./c_sharing_browse_exports","./c_core_notify","./c_sharing_wizard_async_wizard_modals","./c_sharing_async_share_modal_util","./c_file_actions_portable_move","./c_file_store_utils","./c_extensions_extensions_menu_component_v2","metaserver/static/js/modules/constants/reel","./c_components_approval-forms_url_utils","./c_flows_conversions_convert","./c_components_spacer_index","./c_files_view_files_view_logging","./c_components_approval-forms_gating_utils","./c_components_approval-forms_approval_checkbox_in_share","./c_pap-events_previews_select_share_menu","./c_extensions_split_share_button","./e_core_exception","./c_core_exception_info","./c_integrations_data_selectors","./c_shallow_equal","./c_flows_approval_approval_request_modal","./c_flows_approval_approval_io_client","./c_components_saver_modal_index","./c_file_actions_strings","./c_hive_schemas_web-modal-activity","./c_sync_everything_strings","./c_sync_everything_hive_logger","./c_conversions_actions_unzip","./c_utils_contacts_tokenizer_contacts_tokenizer_util","./c_src_utils_logging"],(function(e,t,o,i,n,r,s,a,c,l,d,_,u,A,p,S,E,T,O,f,I,F,g,R,y,m,N,L,v,h,C,b,w,B,D,M,P,U,x,W,G,V,k,H,q,K,Y,Q,$,j,z,Z,J,X,ee,te,oe,ie,ne,re,se,ae){"use strict";function ce(e,t){let o=!1,i=null;function n(){const n=t.apply(null,arguments);return o&&(i===n||e(i,n))||(o=!0,i=n),i}var r,s;return r=t,s=n,Object.defineProperties(s,{length:{value:r.length}}),n}var le;t.ActionBarSelectionType=void 0,(le=t.ActionBarSelectionType||(t.ActionBarSelectionType={}))[le.NONE=0]="NONE",le[le.VAULT=1]="VAULT",le[le.FOLDER=2]="FOLDER",le[le.FILE=3]="FILE",le[le.MULTIPLE=4]="MULTIPLE",le[le.BACKUP_CONTENT=5]="BACKUP_CONTENT",le[le.BACKUP_FOLDER=6]="BACKUP_FOLDER";const de=(e,t)=>t.isSearchMode,_e=(e,t)=>t.actionSurface,ue=(e,t)=>t.userSelector(e),Ae=(e,t)=>t.selectedFilesSelector(e),pe=(e,t)=>t.contextSelector(e),Se=(e,t)=>t.currentFolderInfo(e),Ee=(e,t)=>i.selectViewType(e,{instanceId:t.isSearchMode?i.SEARCH_FILES_VIEW_ID:i.BROWSE_FILES_VIEW_ID}),Te=(e,t)=>t.overQuotaDataSelector(e),Oe=(e,t)=>t.experimentSelector(e),fe=(e,t)=>Boolean(t.isCreatingSharedLinkSelector),Ie=(e,t)=>t.isInsideBackupFolder(e),Fe=(e,t)=>t.isSelectedBackupFolder(e),ge=(e,t,o)=>t.backupInfoByFile(e)(o),Re=(e,t)=>{const o=Ae(e,t),i=pe(e,t).currentFQPath;return o.isEmpty()?((e,t,o)=>t.backupInfoByPath(e)(o))(e,t,i):ge(e,t,o.first())},ye=i.createSelector(Ae,Ie,Fe,((e,o,n)=>n?t.ActionBarSelectionType.BACKUP_FOLDER:o?t.ActionBarSelectionType.BACKUP_CONTENT:0===e.count()?t.ActionBarSelectionType.NONE:e.some((e=>e.type===i.FileTypes.VAULT_FOLDER))?t.ActionBarSelectionType.VAULT:1===e.count()?e.first().is_dir?t.ActionBarSelectionType.FOLDER:t.ActionBarSelectionType.FILE:t.ActionBarSelectionType.MULTIPLE)),me=i.createSelector(ue,(e=>n.GoldenGate.hasContentManagerAndSuperAdmin(e.id))),Ne=i.createSelector(ue,(e=>n.GoldenGate.hasNewOwnershipModel(e.id))),Le=i.createSelector(Ae,(e=>{const t=e.first();return e.some((e=>e.is_unmounted||e.ns_id!==t.ns_id))})),ve=i.createSelector(Ae,(e=>e.some((e=>i.File.isNoAccessSharedFolder(e))))),he=i.createSelector(Ae,(e=>e.some((e=>e.type===i.FileTypes.SANDBOX)))),Ce=i.createSelector(Ae,(e=>e.some((e=>e.is_cloud_doc&&e instanceof i.FileSharedWithMe)))),be=i.createSelector(Ae,(e=>e.some((e=>e.is_cloud_doc)))),we=i.createSelector(Ae,(e=>{var t,o;return e.size>1||(null===(t=e.first())||void 0===t?void 0:t.is_dir)||""!==(null===(o=e.first())||void 0===o?void 0:o.href)})),Be=i.createSelector(Ae,Ie,((e,t)=>t?!!e.count()&&e.every((e=>e.isDeleted)):e.every((e=>e.isDeleted||e.is_unmounted)))),De=i.createSelector(Ae,(e=>e.some((e=>e.type===i.FileTypes.FAMILY_SHARED_FOLDER)))),Me=i.createSelector(Ae,(e=>e.some((e=>e instanceof i.FileSharedWithMe)))),Pe=i.createSelector(Ae,(e=>e.every((e=>!e.isDeleted&&!e.is_unmounted)))),Ue=i.createSelector(Ae,(e=>0===e.count())),xe=i.createSelector(Ae,pe,((e,t)=>t.permanentDeletionDisabledStateByNSID[t.currentNSID]||!1)),We=i.createSelector(Ae,(e=>e.some((e=>{var t;return!!(null===(t=e.per_node_metadata)||void 0===t?void 0:t.link_node)})))),Ge=i.createSelector(Ae,(e=>e.some((e=>{var t;return!!(null===(t=e.per_node_metadata)||void 0===t?void 0:t.suppress_delete)})))),Ve=i.createSelector(Ae,(e=>e.some((e=>{var t;return!!(null===(t=e.per_node_metadata)||void 0===t?void 0:t.suppress_move)})))),ke=i.createSelector(Ae,(e=>e.some((e=>{var t,o;return!!(null===(t=e.per_node_metadata)||void 0===t?void 0:t.suppress_ns_partition)||!!(null===(o=e.per_node_metadata)||void 0===o?void 0:o.suppress_shared_link)})))),He=i.createSelector(Ae,(e=>e.some((e=>{var t,o;return!!(null===(t=null==e?void 0:e.per_node_metadata)||void 0===t?void 0:t.device_info)&&!!(null===(o=null==e?void 0:e.per_node_metadata)||void 0===o?void 0:o.suppress_delete)})))),qe=i.createSelector(Ae,pe,((e,t)=>e.some((e=>!i.File.canViewFileMembers(e,t))))),Ke=i.createSelector(Ae,(e=>e.every((e=>null==e.fetchFolderSizesStatus)))),Ye=i.createSelector(Ae,(e=>e.every((e=>e.type===i.FileTypes.FILE)))),Qe=i.createSelector(Ae,(e=>e.every((e=>e.is_dir)))),$e=i.createSelector(Ae,pe,((e,t)=>t.isCurrentPathWriteable())),je=i.createSelector(Ae,pe,((e,t)=>t.isCurrentPathWriteable()&&!e.some((e=>e.read_only)))),ze=i.createSelector(Ae,(e=>1===e.count())),Ze=i.createSelector(Ae,(e=>1===e.count()&&!e.first().is_dir)),Je=i.createSelector(Ae,(e=>1===e.count()&&e.first().is_dir)),Xe=i.createSelector(Ae,(e=>e.some((e=>e.type===i.FileTypes.TEAM_MEMBER_FOLDER)))),et=i.createSelector(Ae,(e=>e.some((e=>e.type===i.FileTypes.TEAM_SHARED_FOLDER)))),tt=i.createSelector(Ae,(e=>e.some((e=>e.type===i.FileTypes.VAULT_FOLDER)))),ot=(e,t,o)=>t.flowsUserAutomation(o)(e),it=(e,t)=>{const o=Ae(e,t).first(),i=Se(e,t);return o&&ot(e,t,o.fq_path)||!o&&i&&ot(e,t,i.fq_path)||void 0},nt=i.createSelector(ue,pe,((e,t)=>e.is_cdm_member&&"/"===t.currentFQPath)),rt=i.createSelector(Ae,(e=>{const t=e.toArray().map((e=>e.fq_path));return i.inSameDirectory(t)})),st=i.createSelector(i.expSuggestedWorkflowsVariant,Ae,Ze,((e,t,o)=>o&&".pdf"===t.first().ext&&["V1","V2"].includes(e))),at=(e,t)=>t.rightRailCollapsedState(e),ct=i.createSelector(ue,Ae,Ee,de,_e,((e,t)=>t.actionSource),pe,at,Se,((e,t)=>t.requestId),((e,t)=>t.resultList),((e,t)=>t.hasMoreResults),((e,t,o,i,n,r,s,a,c,l,d,_)=>({user:e,files:t,isSearchMode:i,viewType:o,resultList:d,requestId:l,hasMoreResults:_,actionSurface:n,actionSource:r,context:s,rightRailState:a?"collapsed":"opened",currentFolderInfo:c}))),lt=i.createSelector(ye,(e=>pt[e])),dt=(e,t,i=!1)=>{const n={};if(n.alwaysInOverflow=e.alwaysInOverflow,n.expSuggestedWorkflowsActions=e.expSuggestedWorkflowsActions,!t){const e=[];i?e.push(o.ActionBarActionTypes.SHARE_COPY_LINK,o.ActionBarActionTypes.SHARE_MODAL):e.push(o.ActionBarActionTypes.SHARE_MODAL,o.ActionBarActionTypes.SHARE_COPY_LINK,o.ActionBarActionTypes.ADD_TO_COLLECTION),n.alwaysAtTopLevel=e}return n},_t=i.createSelector(ye,Fe,((e,t)=>dt(pt[e],t,!1))),ut=i.createSelector(ye,(e=>dt(pt[e],!0,!1))),At=i.createSelector(ye,(e=>St[e])),pt={[t.ActionBarSelectionType.NONE]:{},[t.ActionBarSelectionType.FILE]:{atTopLevelIfSpace:[o.ActionBarActionTypes.DOWNLOAD,o.ActionBarActionTypes.OPEN,o.ActionBarActionTypes.DELETE,o.ActionBarActionTypes.ADD_TO_COLLECTION,o.ActionBarActionTypes.RESTORE,o.ActionBarActionTypes.PERMANENT_DELETE,o.ActionBarActionTypes.VAULT_LOCK,o.ActionBarActionTypes.VAULT_UNLOCK,o.ActionBarActionTypes.CONVERT_TO_ARCHIVE],alwaysInOverflow:[[o.ActionBarActionTypes.SHARE,o.ActionBarActionTypes.SHARE_COPY_LINK,o.ActionBarActionTypes.MANAGE_PERMISSIONS,o.ActionBarActionTypes.DOWNLOAD,o.ActionBarActionTypes.OPEN_IN_REPLAY,o.ActionBarActionTypes.EDIT_IMAGE,o.ActionBarActionTypes.EDIT_PDF,o.ActionBarActionTypes.OPEN,o.ActionBarActionTypes.SEND_FOR_SIGNATURE,o.ActionBarActionTypes.REQUEST_APPROVAL,o.ActionBarActionTypes.SELF_SIGN_ACTION,o.ActionBarActionTypes.SAVE_AS],[o.ActionBarActionTypes.DELETE,o.ActionBarActionTypes.RESTORE,o.ActionBarActionTypes.PERMANENT_DELETE,o.ActionBarActionTypes.REMOVE,o.ActionBarActionTypes.RENAME,o.ActionBarActionTypes.MOVE,o.ActionBarActionTypes.COPY],[o.ActionBarActionTypes.ADD_TO_COLLECTION,o.ActionBarActionTypes.STAR,o.ActionBarActionTypes.UNSTAR,o.ActionBarActionTypes.PIN_TO,o.ActionBarActionTypes.PIN_TO_ROOT,o.ActionBarActionTypes.UNPIN],[o.ActionBarActionTypes.VERSION_HISTORY,o.ActionBarActionTypes.FILE_LOCK,o.ActionBarActionTypes.FILE_UNLOCK,o.ActionBarActionTypes.FILE_REQUEST_UNLOCK]]},[t.ActionBarSelectionType.FOLDER]:{atTopLevelIfSpace:[o.ActionBarActionTypes.DOWNLOAD,o.ActionBarActionTypes.OPEN,o.ActionBarActionTypes.DELETE,o.ActionBarActionTypes.RESTORE,o.ActionBarActionTypes.PERMANENT_DELETE,o.ActionBarActionTypes.CONVERT_TO_ARCHIVE],alwaysInOverflow:[[o.ActionBarActionTypes.SHARE,o.ActionBarActionTypes.SHARE_COPY_LINK,o.ActionBarActionTypes.MANAGE_PERMISSIONS,o.ActionBarActionTypes.OPEN,o.ActionBarActionTypes.DOWNLOAD,o.ActionBarActionTypes.EDIT_FOLDER_AUTOMATION,o.ActionBarActionTypes.ADD_FOLDER_AUTOMATION],[o.ActionBarActionTypes.DELETE,o.ActionBarActionTypes.RENAME,o.ActionBarActionTypes.MOVE,o.ActionBarActionTypes.COPY],[o.ActionBarActionTypes.STAR,o.ActionBarActionTypes.UNSTAR,o.ActionBarActionTypes.UNPIN,o.ActionBarActionTypes.PIN_TO,o.ActionBarActionTypes.PIN_TO_ROOT],[o.ActionBarActionTypes.SPACES_REDIRECT,o.ActionBarActionTypes.FOLLOW,o.ActionBarActionTypes.FOLLOWING,o.ActionBarActionTypes.TIDY_UP,o.ActionBarActionTypes.REQUEST_FILES,o.ActionBarActionTypes.REWIND]]},[t.ActionBarSelectionType.MULTIPLE]:{atTopLevelIfSpace:[o.ActionBarActionTypes.DOWNLOAD,o.ActionBarActionTypes.DELETE,o.ActionBarActionTypes.RESTORE,o.ActionBarActionTypes.ADD_TO_COLLECTION,o.ActionBarActionTypes.PERMANENT_DELETE,o.ActionBarActionTypes.CONVERT_TO_ARCHIVE],alwaysInOverflow:[[o.ActionBarActionTypes.SHARE,o.ActionBarActionTypes.DOWNLOAD,o.ActionBarActionTypes.ADD_TO_COLLECTION,o.ActionBarActionTypes.DELETE,o.ActionBarActionTypes.RESTORE,o.ActionBarActionTypes.PERMANENT_DELETE,o.ActionBarActionTypes.MOVE,o.ActionBarActionTypes.COPY,o.ActionBarActionTypes.SAVE_AS]]},[t.ActionBarSelectionType.VAULT]:{},[t.ActionBarSelectionType.BACKUP_CONTENT]:{alwaysAtTopLevel:[o.ActionBarActionTypes.DOWNLOAD],atTopLevelIfSpace:[o.ActionBarActionTypes.REWIND,o.ActionBarActionTypes.VERSION_HISTORY]},[t.ActionBarSelectionType.BACKUP_FOLDER]:{alwaysAtTopLevel:[o.ActionBarActionTypes.DOWNLOAD],atTopLevelIfSpace:[o.ActionBarActionTypes.REWIND,o.ActionBarActionTypes.DELETE]}},St={[t.ActionBarSelectionType.NONE]:{},[t.ActionBarSelectionType.FILE]:{atTopLevelIfSpace:[o.ActionBarActionTypes.SHARE_COPY_LINK,o.ActionBarActionTypes.SHARE]},[t.ActionBarSelectionType.FOLDER]:{atTopLevelIfSpace:[o.ActionBarActionTypes.SHARE_COPY_LINK,o.ActionBarActionTypes.SHARE]},[t.ActionBarSelectionType.MULTIPLE]:{atTopLevelIfSpace:[o.ActionBarActionTypes.SHARE]},[t.ActionBarSelectionType.VAULT]:{}},Et=i.createSelector(Ue,i.unsortedFiles,i.getCurrentFolderInfo,((e,t,o)=>{if(e){const e=t,i=0===e.count(),n=e.every((e=>e.is_dir));return!i&&!n&&!!o}return!1})),Tt=i.createSelector(pe,Se,((e,t)=>({isCurrentFolderEligibleForAutomation:t&&e.isInFolderMode&&!e.isCurrentlyInRoot&&!e.isInsideTeamFolderRoot&&!e.isInsideVaultFolder&&t.type!==i.FileTypes.TEAM_MEMBER_FOLDER&&!i.File.isReadOnlySharedFolder(t),isSubfolderEligibleForAutomation:t&&!e.isInsideVaultFolder&&!i.File.isReadOnlySharedFolder(t)}))),Ot={actionType:o.ActionBarActionTypes.ARCHIVE,isEnabled:!0,text:c.ARCHIVE_ACTION_STRING,icon:i.ArchiveLine},ft=(e,t)=>me(e,t)&&Je(e,t)&&Pe(e,t)&&et(e,t),It=()=>{const e=l.reactExports.useRef(null),t=_.useIntl();l.reactExports.useEffect((()=>{u.getStoreForAutomations()}),[]);const n={nodeType:"action",actionType:o.ActionBarActionTypes.ADD_FOLDER_AUTOMATION};return l.React$1.createElement(l.React$1.Fragment,null,l.React$1.createElement(i.Menu.ActionItem,{value:n,ref:e,withLeftAccessory:l.React$1.createElement(i.UIIcon,{src:i.AutomationLine})},t.formatMessage(c.ADD_FOLDER_AUTOMATION_STRING)))};It.displayName="AddAutomationAction";const Ft=(e,t)=>{const{expFlowsAutomatedFolderUI:o}=Oe(e,t),n=Ae(e,t).first(),r=i.getCurrentFolderInfo(e),s=pe(e,t),a=!!o&&Je(e,t)&&!n.is_in_vault_folder&&!Xe(e,t)&&!i.File.isReadOnlySharedFolder(n),c=!!o&&!n&&r&&s.isInFolderMode&&!s.isCurrentlyInRoot&&!s.isInsideTeamFolderRoot&&!s.isInsideVaultFolder&&r.type!==i.FileTypes.TEAM_MEMBER_FOLDER&&!i.File.isReadOnlySharedFolder(r);return a||c},gt=e=>i.createSelector(Ft,it,A.getAllowedWorkflowActions,((t,n,r)=>{if(t)return null!=n&&r.includes(n.actions[0].actionType)&&"edit"===e?{actionType:o.ActionBarActionTypes.EDIT_FOLDER_AUTOMATION,text:c.EDIT_FOLDER_AUTOMATION_STRING,icon:i.AutomationLine,isEnabled:!0}:n||"add"!==e?void 0:{actionType:o.ActionBarActionTypes.ADD_FOLDER_AUTOMATION,text:c.ADD_FOLDER_AUTOMATION_STRING,icon:i.AutomationLine,isEnabled:!0,overflowItem:l.React$1.createElement(It,null)}})),Rt=(e,t)=>Ze(e,t)&&Pe(e,t)&&!be(e,t)&&!We(e,t),yt=(e,t)=>Pe(e,t)&&!Me(e,t)&&!et(e,t)&&!Xe(e,t)&&!We(e,t)&&!De(e,t)&&!tt(e,t),mt=(e,t)=>{const o=pe(e,t);(function(e){const{expbackupWebCustomSubfolders:t}=i.browsePostTTIExperiments(e);return!!t})(e)&&function(e,t){const o=Ae(e,t),i=ge(e,t,o.first());return null!==i}(e,t)?a.handleBackupDeleteDeviceFolder(ct(e,t)):a.handleDelete(ct(e,t),o)},Nt=(e,t)=>{const o=t.selectedFilesSelector(e);return 1===o.count()&&i.getLinkNodeAction(o.first().per_node_metadata)===i.PASSWORDS_POST_SETUP_ACTION},Lt=(e,t)=>!Nt(e,t)&&Pe(e,t)&&!Me(e,t)&&!et(e,t)&&!Xe(e,t)&&!tt(e,t)&&(!Ge(e,t)||ht(e,t))&&!vt(e,t),vt=(e,t)=>{const o=Ae(e,t),{expEnabledBackupWebCbOnAnchorsDelete:n,expEnabledBackupWebDoNotBackup:r}=i.browsePostTTIExperiments(e);return o&&o.count()>0?o.some((s=>{var a;const c=(i.isBackupBrowse()||s.is_in_backup_folder)&&(s.icon.startsWith("device_subfolder")||i.file_extension(null!==(a=s.fq_path)&&void 0!==a?a:"")===i.COMPUTER_BACKUP_ON_ANCHORS_EXT),l=ge(e,t,s);return!(!c||n||r||l)||("cb"===(null==l?void 0:l.type)&&0===l.nestLevel||!("cb"===(null==l?void 0:l.type)&&l.usesAnchors&&l.nestLevel>=2)&&!!(o.count()>1&&(He(e,t)||!n&&!r&&"cb"===(null==l?void 0:l.type)&&l.usesAnchors)))})):!!Ie(e,t)},ht=(e,t)=>{const o=Ae(e,t),n=ge(e,t,o.first()),{expEnabledBackupWebCbOnAnchorsDelete:r}=i.browsePostTTIExperiments(e);return 1===o.count()&&!!n&&1===n.nestLevel&&"cb"===n.type&&(He(e,t)||!r&&!!n.usesAnchors)};const Ct=(e,t)=>we(e,t)&&Pe(e,t)&&!We(e,t)&&(ze(e,t)?!be(e,t):!Me(e,t)&&!Ce(e,t)),bt=(e,t)=>{const o=ct(e,t),{files:i,user:n}=o,r=i.first(),s=".pdf"===r.ext,a=r.href.includes("/s/")||r.href.includes("/scl/");return n&&Ze(e,t)&&s&&!F.is_mobile_or_tablet()&&!a},wt=()=>i.createSelector(bt,st,((e,t)=>e?(e=>({actionType:o.ActionBarActionTypes.EDIT_PDF,isEnabled:!0,text:c.EDIT_PDF_ACTION_STRING,icon:i.EditLine,showNewBadge:!1,isSuggestedWorkflow:e,suggestedWorkflowsTooltipContents:e?{imageUrl:l.static_url("/static/metaserver/static/js/action_bar/assets/suggested_workflow_edit-vfl10TAhL.png"),label:c.EDIT_PDF_SUGGESTED_WORKFLOW_TOOLTIP_STRING}:void 0}))(t):void 0)),Bt=(e,t)=>{const o=Ae(e,t).first();return ze(e,t)&&Pe(e,t)&&(o.type===i.FileTypes.SHARED_FOLDER||o.type===i.FileTypes.TEAM_SHARED_FOLDER)},Dt=(e,t)=>Pe(e,t)&&Ye(e,t),Mt=(e,t)=>{const n=Ae(e,t).toArray(),{expFlowsManualVideoGifUi:r}=Oe(e,t),s={expFlowsManualVideoGifUi:r};s.expGddMigrationFrontendActions=i.browsePostTTIExperiments(e).expGddMigrationFrontendActions||m.isGddMigrationDateWithinNumDays(i.getBrowseState(e).experiments.gddMigrationDates,50);const a=R.getConversionActionsForFiles(n,s),c=Math.max(...n.map((e=>e.bytes)))/1048576,d=new Map;for(const e of a){const t=e.actionGroup||R.ConversionActionGroup.DEFAULT;d.has(t)?d.get(t).push(e):d.set(t,[e])}return Array.from(d.entries()).sort(((e,t)=>e[0]-t[0])).map((([e,t])=>t.map((e=>{const t=y.getConversionFileSizeLimitMB(n.map((e=>e.ext.slice(1))),e.actionText);return{value:{type:o.ActionBarActionTypes.SAVE_AS,menuItem:e},description:e.actionText,icon:l.React$1.createElement(i.UIIcon,{src:e.actionIcon}),isEnabled:c<=t,disabledTooltip:_.intl.formatMessage({id:"A9pwq6",defaultMessage:"{numFiles, plural, one {File is larger than the {sizeLimitMB}MB limit} other {One or more of your files is larger than the {sizeLimitMB}MB limit}}"},{sizeLimitMB:t,numFiles:n.length})}}))))},Pt=(e,t)=>{f.logBrowseTTS("go_to_folder"),a.handleShowInFolder(ct(e,t))},Ut={actionType:o.ActionBarActionTypes.GO_TO_FOLDER,isEnabled:!0,text:c.GO_TO_FOLDER_ACTION_STRING,icon:i.FolderShowLine},xt=(e,t)=>Pe(e,t)&&!Me(e,t)&&rt(e,t);var Wt;!function(e){e[e.UploadFiles=1]="UploadFiles",e[e.UploadFolder=2]="UploadFolder",e[e.Upload=3]="Upload",e[e.Files=4]="Files",e[e.Folder=5]="Folder",e[e.NewPaperDoc=6]="NewPaperDoc",e[e.NewFolder=7]="NewFolder",e[e.RestoreFolder=8]="RestoreFolder",e[e.JoinFolderAgain=9]="JoinFolderAgain",e[e.ShowDeletedFiles=10]="ShowDeletedFiles",e[e.HideDeletedFiles=11]="HideDeletedFiles",e[e.NewSharedFolder=12]="NewSharedFolder",e[e.ShareFolder=13]="ShareFolder",e[e.ShareFolderAbbreviated=14]="ShareFolderAbbreviated",e[e.ManageAsAdmin=15]="ManageAsAdmin",e[e.NewTeamFolder=16]="NewTeamFolder",e[e.RequestFiles=17]="RequestFiles",e[e.FolderHistory=18]="FolderHistory",e[e.RewindFolder=19]="RewindFolder",e[e.RewindDropbox=20]="RewindDropbox"}(Wt||(Wt={}));const Gt={},Vt=e=>(e in Gt||(Gt[e]=(e=>{switch(e){case Wt.UploadFiles:return _.intl.formatMessage({id:"Qayhb5",defaultMessage:"Upload files"});case Wt.UploadFolder:return _.intl.formatMessage({id:"53oUlv",defaultMessage:"Upload folder"});case Wt.Upload:return _.intl.formatMessage({id:"i98Ff5",defaultMessage:"Upload"});case Wt.FolderHistory:return _.intl.formatMessage({id:"BxyH89",defaultMessage:"Folder history"});case Wt.RewindFolder:return _.intl.formatMessage({id:"4Wq7Cq",defaultMessage:"Rewind this folder"});case Wt.RewindDropbox:return _.intl.formatMessage({id:"hiHRLr",defaultMessage:"Rewind Dropbox"});case Wt.Files:return _.intl.formatMessage({id:"bObFEu",defaultMessage:"Files"});case Wt.Folder:return _.intl.formatMessage({id:"MLqiSW",defaultMessage:"Folder"});case Wt.NewPaperDoc:return _.intl.formatMessage({id:"Jfm8Pe",defaultMessage:"New Paper Document"});case Wt.NewFolder:return _.intl.formatMessage({id:"pxGZm3",defaultMessage:"New folder"});case Wt.RestoreFolder:return _.intl.formatMessage({id:"gx89em",defaultMessage:"Restore folder"});case Wt.JoinFolderAgain:return _.intl.formatMessage({id:"0ca2O6",defaultMessage:"Join folder again"});case Wt.ShowDeletedFiles:return _.intl.formatMessage({id:"WR5EDI",defaultMessage:"Show deleted files"});case Wt.HideDeletedFiles:return _.intl.formatMessage({id:"j500HF",defaultMessage:"Hide deleted files"});case Wt.NewSharedFolder:return _.intl.formatMessage({id:"J9ZdWw",defaultMessage:"New shared folder"});case Wt.ShareFolder:return _.intl.formatMessage({id:"aHwEwV",defaultMessage:"Share folder"});case Wt.ShareFolderAbbreviated:return _.intl.formatMessage({id:"CcpVyl",defaultMessage:"Share"});case Wt.ManageAsAdmin:return _.intl.formatMessage({id:"SrWnn5",defaultMessage:"View in admin console"});case Wt.NewTeamFolder:return _.intl.formatMessage({id:"dYs+4Q",defaultMessage:"New team folder"});case Wt.RequestFiles:return _.intl.formatMessage({id:"QeqSyk",defaultMessage:"Request files"})}})(e)),Gt[e]),kt=new Set([Vt(Wt.UploadFiles),Vt(Wt.UploadFolder),Vt(Wt.NewFolder),Vt(Wt.RequestFiles)]),Ht="manage_folder_subscription";var qt,Kt,Yt;t.RequestFlightStatus=void 0,(qt=t.RequestFlightStatus||(t.RequestFlightStatus={})).IDLE="idle",qt.READY="ready",qt.INFLIGHT="inflight",qt.ERROR="error",t.FolderSubscriptionState=void 0,(Kt=t.FolderSubscriptionState||(t.FolderSubscriptionState={})).FOLLOWING="FOLLOWING",Kt.FOLLOWING_PARENT="FOLLOWING_PARENT",Kt.NOT_FOLLOWING="NOT_FOLLOWING",function(e){e.FETCHING_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/FETCHING_FOLDER_SUBSCRIPTION",e.OPTIMISTIC_SET_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/OPTIMISTIC_SET_FOLDER_SUBSCRIPTION",e.CONFIRM_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/CONFIRM_FOLDER_SUBSCRIPTION",e.ERROR_FOLDER_SUBSCRIPTION="FOLDER_SUBSCRIPTION/ERROR_FOLDER_SUBSCRIPTION"}(Yt||(Yt={}));function Qt(e,o){return S.__awaiter(this,void 0,void 0,(function*(){return(new i.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/get",{identifier:e},{subjectUserId:o}).then((n=e,({subscription:e})=>{if(!e)return{subscriptionState:t.FolderSubscriptionState.NOT_FOLLOWING};const o=e.fq_path;return o!==n?{subscriptionState:t.FolderSubscriptionState.FOLLOWING_PARENT,followingPath:o}:{subscriptionState:t.FolderSubscriptionState.FOLLOWING,followingPath:o,settings:e.settings}}));var n}))}function $t(e,t){return S.__awaiter(this,void 0,void 0,(function*(){return(new i.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/delete",{identifier:e},{subjectUserId:t})}))}const jt={requests:i.immutableExports.Map(),folderSubscriptions:i.immutableExports.Map()};function zt(e=jt,o){switch(o.type){case Yt.OPTIMISTIC_SET_FOLDER_SUBSCRIPTION:return function(e,o){const{path:i,folderSubscription:n}=o.payload;return Object.assign(Object.assign({},e),{requests:e.requests.set(i,{status:t.RequestFlightStatus.INFLIGHT}),folderSubscriptions:e.folderSubscriptions.set(i,n)})}(e,o);case Yt.FETCHING_FOLDER_SUBSCRIPTION:return function(e,o){const{path:i}=o.payload;return Object.assign(Object.assign({},e),{requests:e.requests.set(i,{status:t.RequestFlightStatus.INFLIGHT})})}(e,o);case Yt.CONFIRM_FOLDER_SUBSCRIPTION:return function(e,o){const{path:i,folderSubscription:n,timestamp:r}=o.payload;return Object.assign(Object.assign({},e),{requests:e.requests.set(i,{status:t.RequestFlightStatus.READY,lastUpdated:r}),folderSubscriptions:e.folderSubscriptions.set(i,n)})}(e,o);case Yt.ERROR_FOLDER_SUBSCRIPTION:return function(e,o){const{path:i,folderSubscription:n}=o.payload;return Object.assign(Object.assign({},e),{requests:e.requests.set(i,{status:t.RequestFlightStatus.ERROR}),folderSubscriptions:n?e.folderSubscriptions.set(i,n):e.folderSubscriptions})}(e,o)}return e}const Zt=e=>i.getStateAtNamespace(e,i.FOLDER_SUBSCRIPTIONS_NAMESPACE_KEY)||jt,Jt=(e,o)=>Zt(e).requests.get(o,{status:t.RequestFlightStatus.IDLE}),Xt=(e,t)=>{var o;return null===(o=eo(e,t))||void 0===o?void 0:o.subscriptionState},eo=(e,t)=>to(e).get(t),to=e=>Zt(e).folderSubscriptions,oo=_.intl.formatMessage({id:"JBINyn",defaultMessage:"Close"}),io=_.intl.formatMessage({id:"Wzr+Eu",defaultMessage:"Unfollow"}),no=5e3;function ro({callToActionFn:e,isSuccess:t,message:o}){const n=t?"complete":"fail",r=t&&e?io:void 0,s=t?e:void 0,a=t&&e?void 0:oo,c=l.React$1.createElement(i.Snackbar,{title:o,variant:n,actionButtonText:r,onActionClick:s,closeButtonText:a,timeoutDelayMs:no,id:"browse-action"});i.Snackbar.show(c)}function so(e){ro({isSuccess:!0,message:_.intl.formatMessage({id:"74emIA",defaultMessage:'Notification options for "{folderName}" have been set'},{folderName:i.filename(e)})})}function ao(e){ro({isSuccess:!1,message:_.intl.formatMessage({id:"fwZe/f",defaultMessage:'Couldn\'t set options for "{folderName}"'},{folderName:i.filename(e)})})}function co(e){ro({isSuccess:!0,message:_.intl.formatMessage({id:"nQncys",defaultMessage:'You’ll no longer get notifications about "{folderName}"'},{folderName:i.filename(e)})})}function lo(e){ro({isSuccess:!1,message:_.intl.formatMessage({id:"/QEApB",defaultMessage:'Unable to unfollow "{folderName}"'},{folderName:i.filename(e)})})}const _o=(e,t,o)=>{e({type:Yt.CONFIRM_FOLDER_SUBSCRIPTION,payload:{folderSubscription:o,path:t,timestamp:new Date}})},uo=(e,t,o)=>{e({type:Yt.ERROR_FOLDER_SUBSCRIPTION,payload:{folderSubscription:o,path:t}})},Ao=e=>(o,n)=>S.__awaiter(void 0,void 0,void 0,(function*(){const r=n(),s=i.user$1(r).id;Jt(r,e).status!==t.RequestFlightStatus.INFLIGHT&&(((e,t)=>{e({type:Yt.FETCHING_FOLDER_SUBSCRIPTION,payload:{path:t}})})(o,e),Qt(e,s).then((t=>_o(o,e,t)),(()=>uo(o,e))))}));var po;t.FolderSubscriptionOrigin=void 0,(po=t.FolderSubscriptionOrigin||(t.FolderSubscriptionOrigin={})).Email="email",po.SideMenu="side_menu",po.Thumbnail="thumbnail";const So=(e,t,o,n)=>{var r,s;const a=i.user$1(t).id,c=i.selectedFiles$1(t),{num_files_selected:l,num_folders_selected:d}=i.countFilesAndFolders(c),_=eo(t,o),u=null===(r=null==_?void 0:_.settings)||void 0===r?void 0:r.activity_types;i.logBrowseAction({action:e,uid:a,num_files_selected:l,num_folders_selected:d,view_type:i.selectViewType(t,{instanceId:i.BROWSE_FILES_VIEW_ID}),extra:{ns_id:n.ns_id.toString(),origin:n.origin||null,frequency:(null===(s=null==_?void 0:_.settings)||void 0===s?void 0:s.frequency[".tag"])||null,file_add:u?u.file_added.toString():null,file_delete:u?u.file_deleted.toString():null}})},Eo=({dispatch:e,getState:t,path:o,newValue:i,apiUpdate:n,onSuccess:r,onError:s})=>{const a=t(),c=eo(a,o);return((e,t,o)=>{e({type:Yt.OPTIMISTIC_SET_FOLDER_SUBSCRIPTION,payload:{folderSubscription:o,path:t}})})(e,o,i),n().then((t=>{_o(e,o,i),r(t)}),(()=>{uo(e,o,c),e(Ao(o)),s()}))},To=(e,o)=>(n,r)=>{const s=r(),a=i.user$1(s).id;if(Xt(s,e)===t.FolderSubscriptionState.FOLLOWING)return Eo({dispatch:n,getState:r,path:e,newValue:{subscriptionState:t.FolderSubscriptionState.NOT_FOLLOWING},apiUpdate:()=>$t(e,a),onSuccess:()=>{co(e),So(i.WebUserActionLogEvent.UNFOLLOW_FOLDER,r(),e,o)},onError:()=>lo(e)})};let Oo;const fo=()=>(Oo||(Oo=i.getStoreAndRegisterReducers({[i.FOLDER_SUBSCRIPTIONS_NAMESPACE_KEY]:zt})),Oo);const Io=(e,t,o,n,r,s,a=!1,c=!1)=>{const{currentFQPath:d}=t;L.logCreateFolder({uid:e.id,view_type:s,origin:i.CREATE_FOLDER_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL,source:r}),i.WebUserActionLog.log(e.id,i.WebUserActionLogEvent.NEW_FOLDER_CLICK,{}),f.logBrowseTTS("create_folder"),i.TeamsWebActionsLogger.log(b.TeamSpaceEmptyZoneCTALoggerEvents.CREATE_FOLDER_CLICKED,{empty_state_personalization:!0}),i.TeamsWebActionsLogger.log(b.TeamSpaceTsdAccessVisibilityEvents.CREATE_FOLDER_MODAL_OPEN,{parent_ns_id:t.currentNSID,folder_level:i.normalize(t.currentFQPath).split("/").length});let u=e.is_cdm_member&&"/"===d;const A=o=>{O.browseActions.handleNewFolderAutomationRedirect(o,e,t.currentNSID,"new_folder_creation")};if(o&&(u=t.isInsideTeamFolderTree&&!!e.is_team),u){o||l.assert(!!n,"All CDM Users should have an auto team group in their team");const r=e=>{B.Notify.error(e||_.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."})),O.browseActions.cancelCreateFolder()},s=({user:e,folderName:t,fqPath:o,shouldLaunchAutomationModal:i})=>{O.browseActions.createFolderComplete(),O.browseActions.selectFilesByFqPath({fqPathsToSelect:[o]}),i?A(o):O.browseActions.handleNewFolderRedirectOnSuccess(o)},c=({pathName:o,folderName:n,checkFSWs:r,shouldLaunchAutomationModal:s})=>{i.TeamsWebActionsLogger.log(b.TeamSpaceTsdAccessVisibilityEvents.CREATE_FOLDER_CLICK,{parent_ns_id:t.currentNSID,folder_level:i.normalize(t.currentFQPath).split("/").length}),O.browseActions.createFolder({pathName:o,folderName:n,user:e,checkFSWs:r,redirectOnSuccess:s?A:O.browseActions.handleNewFolderRedirectOnSuccess,origin:i.CREATE_FOLDER_ACTION_ORIGIN_TYPE.BROWSE_CDM_NEW_FOLDER_MODAL})};w.asyncShowAppropriateNewFolderModalForCdmUser({user:e,context:t,autoTeamGroupId:n,showFileSystemWarningsModal:void 0,shouldDisplayAutoFolderOption:a,onPending:O.browseActions.createFolderPending,onComplete:s,onCancel:r,autoTeamGroupDefaultAccessLevel:i.ACCESS_LEVEL.WRITER,setUrl:({path:e,qargs:t})=>i.getStoreForBrowse().dispatch(h.setUrl({path:e,qargs:t})),handleCreateFolder:c})}else{const o=({folderName:o,isConfidential:n,shouldLaunchAutomationModal:r})=>{O.browseActions.createFolderInNewFolderModal({folderName:o,isConfidential:n,user:e,context:t,redirectOnSuccess:r?A:O.browseActions.handleNewFolderRedirectOnSuccess,origin:i.CREATE_FOLDER_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL,shouldLaunchAutomationModal:r})};w.asyncShowCdmNewFolderModal({handleCreateFolder:o,user:e,context:t,shouldSyncDefault:!1,shouldDisplaySyncSettings:!1,shouldDisplayAudienceInput:!0,shouldDisplayAutoFolderOption:a,isConfidential:c})}},Fo=(e,t)=>{i.logBrowseAction({uid:e.id,action:i.WebUserActionLogEvent.REWIND_CLICK,num_files_selected:0,num_folders_selected:0,action_surface:(null==t?void 0:t.actionSurface)||i.ActionSurfaceLogValue.RIGHT_SIDEBAR,source:(null==t?void 0:t.actionSource)||i.BrowseLogEventSource.MAESTRO_RIGHT_SIDEBAR}),v.DBHistory.update_query_param(i.BrowseQueryArg.rewind,"true"),i.getStoreForBrowse().dispatch(h.showRewind())},go=(e,t,o)=>{i.WebUserActionLog.log(e.id,i.WebUserActionLogEvent.NEW_SHARED_FOLDER_CLICK,{origin:i.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS}),t.isCurrentlyInRoot?D.asyncShowShareAFolderWizardModal(e):M.asyncShowShareModal(e,t,Object.assign(Object.assign({},o),{origin:i.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS}),(({path:e,qargs:t})=>i.getStoreForBrowse().dispatch(h.setUrl({path:e,qargs:t}))))},Ro=(e,t)=>{i.WebUserActionLog.log(e.id,i.WebUserActionLogEvent.NEW_SHARED_FOLDER_CLICK,{origin:i.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS}),D.asyncShowShareAFolderWizardModal(e,void 0,!0,t,O.browseActions.handleNewFolderRedirectOnSuccess,O.browseActions.handleShowShareModal)},yo=(e,t,o,n)=>{M.asyncShowShareModal(e,t,Object.assign(Object.assign({},n),{initialScreen:i.MANAGE_SCREEN,origin:o}),(({path:e,qargs:t})=>i.getStoreForBrowse().dispatch(h.setUrl({path:e,qargs:t}))))},mo=(e,t,o,n,r)=>{const s=C.getUploadLocationMetadataToLog(e,n);i.WebUserActionLog.log(e.id,i.WebUserActionLogEvent.SHOW_DELETED_FILES_CLICK,s),i.logToggleDeletedFiles({uid:e.id,show_deleted_files:!o,view_type:t,action_surface:(null==r?void 0:r.actionSurface)||i.ActionSurfaceLogValue.ACTION_BAR,source:(null==r?void 0:r.actionSource)||i.ActionSurfaceLogValue.ACTION_BAR}),O.browseActions.setShouldShowDeletedFiles({shouldShowDeletedFiles:!o})},No=t=>{!function(t){S.__awaiter(this,void 0,void 0,(function*(){const{goToContentManagerForPath:o}=yield new Promise((function(t,o){e(["./c_sharing_content_manager"],t,o)}));o(t)}))}({containingFolder:t.currentFQPath})},Lo=(e,t,o)=>{const n=C.getUploadLocationMetadataToLog(e,t.currentFQPath);i.WebUserActionLog.log(e.id,i.WebUserActionLogEvent.VIEW_IN_ADMIN_CONSOLE_CLICK,n),No(t)},vo=(e,t,o)=>{const{currentNSID:n,currentNSPath:r}=t;i.logBrowseAction({uid:e.id,action:i.WebUserActionLogEvent.REQUEST_FILES_CLICK,num_files_selected:0,num_folders_selected:0,action_surface:(null==o?void 0:o.actionSurface)||i.ActionSurfaceLogValue.RIGHT_SIDEBAR,source:(null==o?void 0:o.actionSource)||i.BrowseLogEventSource.MAESTRO_RIGHT_SIDEBAR}),i.redirect(`/requests?ns_id=${n}&path=${r}&referrer=web_browse_global_action`)},ho=(t,o,i)=>{new Promise((function(t,o){e(["./c_vault_lib_use_handle_add_files"],t,o)})).then((function(e){return e.use_handle_add_files_esnext})).then((({handleAddFiles:e})=>{e(t,o)(i)}))},Co=(e,t)=>{fo().dispatch(To(e,{ns_id:t}))},bo=(e,t)=>{const o=i.paths_are_equal(e,t)?"":i.filename(e);v.DBHistory.update_query_param(Ht,o)},wo=(e,t)=>{i.logBrowseAction({uid:e.id,action:i.WebUserActionLogEvent.ADD_FROM_GDRIVE,num_files_selected:0,num_folders_selected:0,action_surface:(null==t?void 0:t.actionSurface)||i.ActionSurfaceLogValue.ACTION_BAR,source:(null==t?void 0:t.actionSource)||i.BrowseLogEventSource.LEGACY_HEADER_ACTIONS}),i.getStoreForBrowse().dispatch(h.addFromGdrive())};var Bo=Object.freeze({__proto__:null,getVaultFilteredActions:e=>e.filter((e=>{const{action:t}=e;return!!N.isFunction(t)||!kt.has(t.label)})),handleAddContent:ho,handleAddFromGdriveClick:wo,handleCreateNewFolder:Io,handleCreateSharedFolderClick:Ro,handleManagePermissionsClick:yo,handleOpenFollowCustomizationModal:bo,handleRedirectToContentManager:No,handleRequestFiles:vo,handleRewindClick:Fo,handleSharedFolderClick:go,handleTrashCanClick:mo,handleUnfollowFolder:Co,handleViewInAdminConsoleClick:Lo});const Do=(e,t)=>{if(i.Viewer.get_viewer().is_assume_user_session)return!1;const o=pe(e,t);return Ue(e,t)?me(e,t)&&Ne(e,t)&&o.isInsideTeamFolderTree||!ue(e,t).is_cdm_member&&me(e,t)&&o.isCurrentlyInRoot:me(e,t)&&Ne(e,t)&&o.isInsideTeamFolderTree&&!Me(e,t)},Mo={actionType:o.ActionBarActionTypes.MANAGE_AS_ADMIN,isEnabled:!0,text:c.MANAGE_AS_ADMIN_ACTION_STRING,icon:i.SettingsLine},Po=(e,t)=>Pe(e,t)&&!Me(e,t)&&!et(e,t)&&!Xe(e,t)&&!We(e,t)&&!Ve(e,t)&&!tt(e,t),Uo=(e,t)=>{a.handleOpenInDesktop(ct(e,t))},xo={actionType:o.ActionBarActionTypes.OPEN_MAC_DESKTOP,isEnabled:!0,text:c.OPEN_MAC_DESKTOP_ACTION_STRING,icon:i.FinderLine},Wo={actionType:o.ActionBarActionTypes.OPEN_WINDOWS_DESKTOP,isEnabled:!0,text:c.OPEN_WINDOWS_DESKTOP_ACTION_STRING,icon:i.FileExplorerLine},Go=(e,t)=>Pe(e,t)&&!pe(e,t).isInsideVaultFolder&&((e,t)=>{const o=Ae(e,t).first();return ze(e,t)&&!Me(e,t)&&s.UnityFeatures.isUnitySupported()&&(null===r.UnityCheckFileCache||void 0===r.UnityCheckFileCache?void 0:r.UnityCheckFileCache.is_cached_and_locally_available(o.ns_id,o.ns_path))})(e,t);const Vo={surface:"action-bar"},ko=(e,t)=>()=>{Pt(e,t)},Ho=(e,t)=>t.actionSurface,qo=i.createSelector(ct,(e=>({openInNewTabActionHandler:()=>{a.handleOpenInNewTab(e)},openDesktopActionHandler:()=>{a.handleOpenInDesktop(e)},replayActionHandler:()=>{a.handleReplay(e)},previewActionHandler:()=>{a.handlePreview(e,i.ActionSourceValue.OVERFLOW_MENU)}}))),Ko=(e,t)=>ze(e,t)&&Pe(e,t)&&!Me(e,t)&&!et(e,t)&&!Xe(e,t)&&!We(e,t)&&!pe(e,t).isInsideVaultFolder,Yo=[".3fr",".arw",".bmp",".cr2",".crw",".dcr",".dng",".erf",".gif",".jpeg",".jpg",".kdc",".mef",".mos",".mrw",".nef",".nrw",".orf",".pef",".png",".ppm",".raf",".rw2",".rwl",".sr2",".tif",".tiff",".webp",".x3f"],Qo=[".aac",".aif",".aiff",".flac",".m4a",".m4r",".mp3",".oga",".ogg",".wav",".wma"].concat([".3gp",".3gpp",".3gpp2",".asf",".avi",".dv",".flv",".m2t",".m2ts",".m4v",".mkv",".mov",".mp4",".mpeg",".mpg",".mts",".mxf",".oggtheora",".ogv",".rm",".ts",".vob",".webm",".wmv"]),$o=()=>i.createSelector(ue,Ae,Ko,Go,qo,ko,xt,de,Ho,((e,t,n,r,s,d,_,u,A)=>{const p=t.first(),S=n&&!p.is_dir?s.previewActionHandler:void 0,E="ON"===W.REEL_OPEN_WITH_ENABLED&&Qo.includes(p.ext)||"ON"===W.REEL_IMAGES_ENTRYPOINT_ENABLED&&Yo.includes(p.ext),T=n&&E?s.replayActionHandler:void 0,O=n&&r?s.openDesktopActionHandler:void 0,f=n&&_&&u?d:void 0,I=n?s.openInNewTabActionHandler:void 0;return n?{actionType:o.ActionBarActionTypes.OPEN,isEnabled:!0,text:u?c.OPEN_ACTION_STRING:c.OPEN_IN_ACTION_STRING,icon:i.OpenLine,menu:{type:o.ActionBarMenuType.CUSTOM_DROPDOWN,menuContent:l.React$1.createElement(jo,{user:e,file:p,telemetryContext:Vo,isInActionBar:!0,previewActionHandler:S,replayActionHandler:T,openInNewTabActionHandler:I,openDesktopActionHandler:O,goToFolderActionHandler:f})},onSubmenuOpened:()=>{i.logEvent({class:"navigation",action:"hover",object:"open_in_menu",properties:{actionSurface:"browse_screen",actionElement:a.getActionElementForPAP(A)}})}}:void 0})),jo=e=>U.isBrowseFile(e.file)?l.React$1.createElement(x.WithUnity,{file:e.file,user:e.user,render:t=>l.React$1.createElement(x.ExtensionsPopoverContent,Object.assign({},e,{unityInfo:t}))}):l.React$1.createElement(x.ExtensionsPopoverContent,Object.assign({},e));jo.displayName="OpenMenuContent";const zo="archive",Zo=(_.intl.formatMessage({id:"39qUu3",defaultMessage:"Make an archive"}),i.FileLine,(e,t,{shareToken:o,context:i,name:n})=>V.convertFileAndShowSnackbar({file:e[0],user:t,shareToken:o,conversionType:zo,loggingFunctions:V.getConversionLoggingFunctions(zo),getStrings:(t,o)=>Jo(t,e.length,e[0]),conversionFn:(t,o,r)=>S.__awaiter(void 0,void 0,void 0,(function*(){const t=yield V.archive(o.id,e,n,i);return t?t.path:void 0}))})),Jo=(e,t,o)=>{const i=t>1?_.intl.formatMessage({id:"FtOEg9",defaultMessage:"Couldn't zip files"}):_.intl.formatMessage({id:"+GUWwR",defaultMessage:"Couldn't zip file"}),n=V.getSuccessString(e,((e,o)=>t>1?_.intl.formatMessage({id:"8mHKZl",defaultMessage:"{numFiles} files zipped and saved as {fileName} in {dirName} folder"},{numFiles:t,fileName:e,dirName:o}):_.intl.formatMessage({id:"jZTSy9",defaultMessage:"{numFiles} file zipped and saved as {fileName} in {dirName} folder"},{numFiles:t,fileName:e,dirName:o})),(e=>t>1?_.intl.formatMessage({id:"oT9Ra2",defaultMessage:"{numFiles} files zipped and saved as {dirName} in your main Dropbox folder"},{numFiles:t,dirName:e}):_.intl.formatMessage({id:"hZllBo",defaultMessage:"{numFiles} file zipped and saved as {dirName} in your main Dropbox folder"},{numFiles:t,dirName:e})));return{saving:t>1?_.intl.formatMessage({id:"f8o64Y",defaultMessage:"Zipping files..."}):_.intl.formatMessage({id:"0pAwi/",defaultMessage:"Zipping file..."}),success:n,successAutomatedAdoption:n,failGeneric:i,failRetryable:i,failOverQuota:_.intl.formatMessage({id:"meIIGB",defaultMessage:"Couldn't zip because your Dropbox account is out of space"}),failTooLarge:t>1?_.intl.formatMessage({id:"JdMBky",defaultMessage:"Couldn't zip files. Can only handle files up to {fileSize} GB"},{fileSize:20}):_.intl.formatMessage({id:"Pi6R58",defaultMessage:"Couldn't zip file. Can only handle files up to {fileSize} GB"},{fileSize:20}),failCorrupt:_.intl.formatMessage({id:"FuOmGz",defaultMessage:"Couldn't zip because the file is damaged"}),failPassword:_.intl.formatMessage({id:"4tVWiT",defaultMessage:"Couldn't zip because the file is password protected"}),failPasswordLink:_.intl.formatMessage({id:"f77DNZ",defaultMessage:"Couldn't zip because the link is password-protected"})}},Xo=({action:e,files:t,user:o,context:n})=>{const[r,s]=l.reactExports.useState(!0),[a,c]=l.reactExports.useState(""),d=()=>{_()&&(Zo(t,o,{context:n,name:a}),s(!1))},_=()=>0!==a.length&&-1===a.indexOf("/")&&-1===a.indexOf("\\"),{defaultTitle:u,defaultSubtitle:A,primaryAction:p,secondaryAction:S,fileNameLabel:E,defaultFileNamePlaceholder:T}=ei(e);return l.React$1.createElement(i.Modal$1,{open:r,width:"small"},l.React$1.createElement(i.Modal$1.Header,{hasBottomSpacing:"title-standard"},l.React$1.createElement(i.Modal$1.Title,null,u)),l.React$1.createElement(i.Modal$1.Body,{hasVerticalSpacing:!1},l.React$1.createElement(i.Text,{id:"flows-create-file-name",variant:"paragraph"},A),l.React$1.createElement(k.Spacer,{multiplier:3}),l.React$1.createElement(i.Text,{variant:"paragraph",size:"small",isBold:!0},E),l.React$1.createElement(k.Spacer,{multiplier:1}),l.React$1.createElement(i.TextInput,{"aria-label":E,value:a,onChange:e=>{c(e.currentTarget.value)},onKeyPress:e=>{e.key===i.Key_enum.Key.Enter&&d()},placeholder:T})),l.React$1.createElement(i.Modal$1.Footer,null,l.React$1.createElement(i.Button$1,{variant:"opacity",onClick:()=>{s(!1)}},S),l.React$1.createElement(i.Button$1,{variant:"primary",onClick:d,disabled:!_()},p)))};Xo.displayName="CreateFileNameModal";const ei=e=>{const t=_.useIntl(),o={secondaryAction:t.formatMessage({id:"AcQYt9",defaultMessage:"Cancel"}),primaryAction:t.formatMessage({id:"iv8S9b",defaultMessage:"Save"}),fileNameLabel:t.formatMessage({id:"V4Y6/+",defaultMessage:"File name"}),defaultFileNamePlaceholder:t.formatMessage({id:"+KXywp",defaultMessage:"Archive folder"})};return Object.assign(Object.assign({},o),{defaultTitle:t.formatMessage({id:"5gN6rc",defaultMessage:"Zip files"}),defaultSubtitle:t.formatMessage({id:"kTxoco",defaultMessage:'The selected files will be saved as a single file with a "zip" extension.'})})};const ti=(e,t)=>{const{expFlowsManualArchive:o}=Oe(e,t);return o&&Pe(e,t)},oi=(e,t)=>Be(e,t)&&!Le(e,t)&&!xe(e,t),ii={actionType:o.ActionBarActionTypes.PERMANENT_DELETE,isEnabled:!0,text:c.PERMANENT_DELETE_ACTION_STRING,icon:i.DeleteForeverLine},ni=(e,t)=>ze(e,t)&&Pe(e,t)&&(et(e,t)?me(e,t):!(Ve(e,t)||We(e,t)||tt(e,t)||Me(e,t)));var ri,si;!function(e){e[e.FOLLOW=0]="FOLLOW",e[e.FOLLOWING=1]="FOLLOWING",e[e.REQUEST_FILES=2]="REQUEST_FILES",e[e.REWIND=3]="REWIND",e[e.VERSION_HISTORY=4]="VERSION_HISTORY",e[e.FILE_LOCK=5]="FILE_LOCK",e[e.FILE_UNLOCK=6]="FILE_UNLOCK",e[e.FILE_REQUEST_UNLOCK=7]="FILE_REQUEST_UNLOCK",e[e.ADD_FROM_GDRIVE=8]="ADD_FROM_GDRIVE"}(ri||(ri={})),function(e){e[e.FOLLOW=0]="FOLLOW",e[e.FOLLOWING=1]="FOLLOWING",e[e.REQUEST_FILES=2]="REQUEST_FILES",e[e.REWIND=3]="REWIND",e[e.VERSION_HISTORY=4]="VERSION_HISTORY",e[e.FILE_LOCK=5]="FILE_LOCK",e[e.FILE_UNLOCK=6]="FILE_UNLOCK",e[e.FILE_REQUEST_UNLOCK=7]="FILE_REQUEST_UNLOCK",e[e.ADD_FROM_GDRIVE=8]="ADD_FROM_GDRIVE"}(si||(si={}));const ai=e=>{const{followMenuItem:t,followingMenuItem:o,requestFilesMenuItem:i,rewindMenuItem:n,versionHistoryMenuItem:r,fileLockMenuItem:s,fileUnlockMenuItem:a,fileRequestUnlockMenuItem:c,addFromGdriveActionMenuItem:l}=e;return{menuItems:[t,o,i,n,r,s,a,c,l].reduce(((e,t)=>t?[...e,t]:e),[])}};function ci(e){const t=[];return t.push({menuItems:ai(e).menuItems}),{type:o.ActionBarMenuType.DROPDOWN,menuSections:t}}const li=(e,t)=>Ue(e,t)?!nt(e,t)&&!pe(e,t).isInsideVaultFolder:Je(e,t)&&Pe(e,t)&&!ke(e,t)&&!We(e,t)&&!tt(e,t)&&!pe(e,t).isInsideVaultFolder&&!i.File.isReadOnlySharedFolder(Ae(e,t).first()),di=(e,t)=>pe(e,t).isCurrentPathWriteable(),_i=(e,t)=>li(e,t)?{value:{type:o.ActionBarActionTypes.REQUEST_FILES,menuItem:si.REQUEST_FILES},description:_.intl.formatMessage(c.REQUEST_FILES_ACTION_STRING),icon:i.FileRequestLine,isEnabled:di(e,t)}:void 0,ui=(...t)=>new Promise((function(t,o){e(["./c_sync_everything_utils_restore_backup"],t,o)})).then((({restoreBackupContents:e})=>e(...t))),Ai=(e,t)=>{if(Ue(e,t)||!Be(e,t)||Le(e,t)||pi(e,t))return!1;const o=Ae(e,t).first().target_ns;return!(Je(e,t)&&o&&0!==o)||pe(e,t).currentNSAllowsNesting},pi=(e,t)=>{const o=Ae(e,t),n=ge(e,t,o.first()),{expBackupImprovedRestorations:r}=i.browsePostTTIExperiments(e);if(i.isBackupBrowse()){if(!n)return!0;if(!i.isInsideEDB(o.first().fq_path)&&void 0===r)return!0}return!1};function Si(e,t,o){let i=`${e}_${t}`;return o&&(i=`${e}_${o}_${t}`),i}function Ei(e,t,o){return S.__awaiter(this,void 0,void 0,(function*(){f.logBrowseTTS("share_file");const{user:n,isSearchMode:r}=t,s=e.action_surface||t.isSidebar?i.ActionSurfaceLogValue.RIGHT_SIDEBAR:i.ActionSurfaceLogValue.CENTER_PANE,a=t.files.first();e.skipLogging||H.logEventWithNumberOfFiles({file:a,user:n,isSearchMode:r,action:i.WebUserActionLogEvent.SHARE,action_source:e.action_source,action_surface:s,extra:e.extra,requestId:t.requestId,resultList:t.resultList,hasMoreResults:t.hasMoreResults}),i.UserSurvey.trackEvent("share_item","browse");const c=i.getStoreForBrowse(),{expFlowsApprovalFlowVariant:l,expFlowsApprovalInShareModal:d,expDocsendAnalyticsAddOn:_}=i.browsePostTTIExperiments(c.getState()),u=i.getStoreForSearch(),A=(()=>{const e=!(1!==t.files.count()||a.isDeleted||a.is_unmounted||a.is_dir||a.is_cloud_doc);if(r){const{flows_approval_flow:t,flows_approval_in_share_modal:o}=i.experiments$1(u.getState());return q.isApprovalEnabled(t)&&o&&e}return q.isApprovalEnabled(l)&&d&&e})();M.asyncShowShareModal(n,a,{browseContext:o,origin:i.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS,showApproval:A,onCreateApprovalSuccess:()=>{if(r)return u.dispatch(i.setSelection({selection:i.createSelection([a.fq_path]),skipLogging:!0})),void u.dispatch(i.setExpandedBlade("comments"));c.dispatch(h.setRightRailIsCollapsed(!1)),c.dispatch(h.selectFilesByFqPath({fqPathsToSelect:[a.fq_path]})),c.dispatch(h.expandBlade("comments"))},referrer:Si(r?i.RetrievalSourceValue.SEARCH:i.RetrievalSourceValue.BROWSE,e.action_source,t.actionSurface),docsendAnalyticsAddOn:_},(({path:e,qargs:t})=>c.dispatch(h.setUrl({path:e,qargs:t}))))}))}const Ti=(e,t)=>()=>{Ei({action_source:i.ActionSourceValue.SPLIT_SHARE,skipLogging:!0},e,t)},Oi=e=>(t,o)=>{const n=e.isSidebar?i.ActionSurfaceLogValue.RIGHT_SIDEBAR:i.ActionSurfaceLogValue.CENTER_PANE;a.logUserEventOnFile({args:e,action_type:i.WebUserActionLogEvent.SHARE,action_source:t,action_surface:n,extra:{splitshare_option:null!=o?o:null}}),i.UserSurvey.trackEvent("share_item","browse")},fi=e=>()=>{const t=e.isSidebar?i.ActionSurfaceLogValue.RIGHT_SIDEBAR:i.ActionSurfaceLogValue.CENTER_PANE;a.logUserEventOnFile({args:e,action_type:i.WebUserActionLogEvent.OPEN_SPLITSHARE,action_source:i.ActionSourceValue.SPLIT_SHARE,action_surface:t}),e.isSidebar&&i.logEvent(Y.PAP_Select_ShareMenu({actionElement:"right_rail",actionSurface:"browse_screen"}))};function Ii(e,t){return()=>{i.logBrowseAction({uid:e.id,action:i.WebUserActionLogEvent.OPEN_SPLITSHARE,num_files_selected:0,num_folders_selected:0,action_surface:i.ActionSurfaceLogValue.RIGHT_SIDEBAR,action_source:i.ActionSourceValue.SPLIT_SHARE,right_sidebar_state:t?"collapsed":"opened"}),i.logEvent(Y.PAP_Select_ShareMenu({actionElement:"right_rail",actionSurface:"browse_screen"}))}}function Fi(e,t){return(o,n)=>{i.logBrowseAction({uid:e.id,action:i.WebUserActionLogEvent.SHARE,num_files_selected:0,num_folders_selected:0,action_surface:i.ActionSurfaceLogValue.RIGHT_SIDEBAR,action_source:o,right_sidebar_state:t?"collapsed":"opened",extra:{splitshare_option:null!=n?n:null}}),i.UserSurvey.trackEvent("share_item","browse")}}const gi={surface:"action-bar"},Ri=(e,t)=>mi(e,t),yi=(e,t)=>mi(e,t,!0),mi=(e,t,o=!1)=>{const i=pe(e,t),{expVaultEnableViewOnlySharing:n}=Oe(e,t);return!Ie(e,t)&&(Ue(e,t)?!(nt(e,t)||i.isCurrentlyInRoot||i.isInsideSandboxFolder||i.isInsideVaultFolder||i.isInFamilySharedFolder):(o||ze(e,t))&&Pe(e,t)&&!ke(e,t)&&!We(e,t)&&!tt(e,t)&&!Me(e,t)&&(!i.isInsideVaultFolder||n)&&!Xe(e,t)&&!he(e,t))},Ni=(e=!1)=>i.createSelector(yi,ue,Ae,pe,ct,Se,at,((t,n,r,s,d,_,u)=>{if(!t)return;if(0===r.count()&&!_)return;const A=0===r.count()?{files:_?[_]:[],logShareButtonClick:Fi(n,u),onShowShare:()=>{go(n,s)},onDropdownOpen:Ii(n,u)}:{files:r.toArray(),onShowShare:Ti(d,s),onDropdownOpen:fi(d),logShareButtonClick:Oi(d)},p={files:A.files,user:n,variant:"opacity",triggerType:i.TriggerType.SidebarPrimaryButton,onShowShare:A.onShowShare,onDropdownOpen:A.onDropdownOpen,logShareButtonClick:A.logShareButtonClick,context:gi,shouldUsePortalPopover:!0,showLeftDigIcon:!0,retrievalSource:d.isSearchMode?i.RetrievalSourceValue.SEARCH:i.RetrievalSourceValue.BROWSE,actionSurface:d.actionSurface},S=e&&r.count()>1;return{actionType:o.ActionBarActionTypes.SHARE,isEnabled:0===r.count()||r.every((e=>i.File.canViewFileMembers(e,s))),text:S?c.SHARE_ALL_SELECTED_ACTION_STRING:c.SHARE_ACTION_STRING,icon:i.ShareArrowLine,button:e?void 0:l.React$1.createElement(Q.SplitShareButton,Object.assign({},p,{renderMenuOnly:!1,expActionBarRedesignEnabled:!0})),menu:e?{type:o.ActionBarMenuType.CUSTOM_DROPDOWN,menuContent:l.React$1.createElement(Q.SplitShareButton,Object.assign({},p,{renderMenuOnly:!0}))}:void 0,onSubmenuOpened:e?()=>{i.logEvent({class:"navigation",action:"hover",object:"share_menu",properties:{actionSurface:"browse_screen",actionElement:a.getActionElementForPAP(d.actionSurface)}})}:void 0}})),Li=(e,t)=>Ri(e,t),vi=()=>i.createSelector(Li,Ae,pe,fe,Oe,Se,i.browsePostTTIExperiments,((e,t,n,r,s,a,l)=>{var d;const u=(e=>{if(e){const t=e.split("/");return t[t.length-1]}})((null===(d=t.first())||void 0===d?void 0:d.fq_path)||(null==a?void 0:a.fq_path)),A=_.intl.formatMessage(c.SHARE_COPY_LINK_ACTION_TOOLTIP,{currentContentName:u});return e?{actionType:o.ActionBarActionTypes.SHARE_COPY_LINK,isEnabled:!r&&t.every((e=>i.File.canViewFileMembers(e,n))),text:c.SHARE_COPY_LINK_ACTION_STRING,icon:i.LinkLine,tooltip:A}:void 0})),hi=()=>i.createSelector(Ri,Ae,pe,((e,t,n)=>e?{actionType:o.ActionBarActionTypes.SHARE_MODAL,isEnabled:t.every((e=>i.File.canViewFileMembers(e,n))),text:c.SHARE_ACTION_STRING,icon:i.ShareArrowLine}:void 0)),Ci=(e,t)=>ze(e,t)&&Pe(e,t)&&!Me(e,t)&&!pe(e,t).isInsideVaultFolder&&!i.getIsStarred(e,Ae(e,t).first().file_id),bi={actionType:o.ActionBarActionTypes.UNSTAR,isEnabled:!0,text:c.UNSTAR_ACTION_STRING,icon:i.StarFill},wi=(e,t)=>ze(e,t)&&Pe(e,t)&&!Me(e,t)&&!pe(e,t).isInsideVaultFolder&&i.getIsStarred(e,Ae(e,t).first().file_id),Bi={actionType:o.ActionBarActionTypes.VERSION_HISTORY,isEnabled:!0,text:c.VERSION_HISTORY_ACTION_STRING,icon:i.ClockLine},Di=(e,t)=>{const o=Ae(e,t).first(),n=Re(e,t);return!(i.isBackupBrowse()&&!n)&&(Ze(e,t)&&Pe(e,t)&&!Me(e,t)&&(!be(e,t)||!i.isPointerByExtension(o.ns_path))&&!We(e,t)&&"third_party"!==(null==n?void 0:n.type))},Mi=(e,t)=>Di(e,t)?{value:{type:o.ActionBarActionTypes.VERSION_HISTORY,menuItem:si.VERSION_HISTORY},description:_.intl.formatMessage(c.VERSION_HISTORY_ACTION_STRING),icon:i.ClockLine,isEnabled:!0}:void 0,Pi=[".doc",".docx",".pdf",".ppsx",".ppt",".pptx",".jpg",".jpeg",".png",".xls",".xlsx",".txt",".html",".gif"],Ui=(e,t)=>{const o=ct(e,t),{files:i,user:n}=o,r=i.first(),s=Pi.includes(r.ext);return n&&Ye(e,t)&&s&&!F.is_supported_mobile_browser()&&z.isSendForSignatureEnabled(e)},xi=()=>i.createSelector(Ui,st,((e,t)=>e?(e=>({actionType:o.ActionBarActionTypes.SELF_SIGN_ACTION,isEnabled:!0,text:c.SELF_SIGN_ACTION_STRING,icon:i.SignatureLine,isSuggestedWorkflow:e,suggestedWorkflowsTooltipContents:e?{imageUrl:l.static_url("/static/metaserver/static/js/action_bar/assets/suggested_workflow_self_sign-vfll3A8ns.png"),label:c.SELF_SIGN_SUGGESTED_WORKFLOW_TOOLTIP_STRING}:void 0}))(t):void 0)),Wi=(e,t)=>{const o=ct(e,t),{files:i,user:n}=o,r=i.first(),s=Pi.includes(r.ext);return n&&Ye(e,t)&&s&&!F.is_supported_mobile_browser()&&z.isSendForSignatureEnabled(e)},Gi=()=>i.createSelector(Wi,st,((e,t)=>e?(e=>({actionType:o.ActionBarActionTypes.SEND_FOR_SIGNATURE,isEnabled:!0,text:c.SEND_FOR_SIGNATURE_ACTION_STRING,icon:i.SendLine,isSuggestedWorkflow:e,suggestedWorkflowsTooltipContents:e?{imageUrl:l.static_url("/static/metaserver/static/js/action_bar/assets/suggested_workflow_send_for_signature-vfl0aSawI.png"),label:c.SEND_FOR_SIGNATURE_SUGGESTED_WORKFLOW_TOOLTIP_STRING}:void 0}))(t):void 0)),Vi=e=>e===t.FolderSubscriptionState.FOLLOWING||e===t.FolderSubscriptionState.FOLLOWING_PARENT,ki=(e,t)=>{const o=fo().getState();if(Ue(e,t)){const i=pe(e,t).currentFQPath;return eo(o,i)}if(Je(e,t)){const i=Ae(e,t).first().fq_path;return eo(o,i)}},Hi=(e,t)=>{var o;return null===(o=ki(e,t))||void 0===o?void 0:o.subscriptionState},qi=(e,t)=>{if(pe(e,t).isInsideVaultFolder)return!1;let o;if(Ue(e,t))o=i.getBrowseState(e).currentFolderInfo;else{if(!Je(e,t))return!1;o=Ae(e,t).first()}const n=null==o?void 0:o.type;if(n===i.FileTypes.SHARED_FOLDER||n===i.FileTypes.TEAM_SHARED_FOLDER||n===i.FileTypes.FAMILY_SHARED_FOLDER){const e=null==o?void 0:o._mount_access_perms;return(null==e?void 0:e.includes("can_view"))&&(null==e?void 0:e.includes("can_view_members"))}return n===i.FileTypes.FOLDER&&Ri(e,t)};var Ki;!function(e){e.OPTIONS="options",e.UNFOLLOW="unfollow"}(Ki||(Ki={}));const Yi=[{menuItems:[{value:{type:o.ActionBarActionTypes.FOLLOWING,menuItem:Ki.OPTIONS},description:_.intl.formatMessage({id:"Us//SY",defaultMessage:"Manage options"})},{value:{type:o.ActionBarActionTypes.FOLLOWING,menuItem:Ki.UNFOLLOW},description:_.intl.formatMessage({id:"j5oJ6S",defaultMessage:"Unfollow"})}]}],Qi={type:o.ActionBarMenuType.SPLIT_BUTTON,menuSections:Yi},$i=(e,t)=>{if(!Hi(e,t))return!1;const o=pe(e,t);if(Ue(e,t))return o.isInsideTeamFolderTree||o.isInsideSharedFolder||o.isInsideFamilySharedFolder;if(Je(e,t)){const n=Ae(e,t).first();return n.type===i.FileTypes.SHARED_FOLDER||n.type===i.FileTypes.TEAM_SHARED_FOLDER||n.type===i.FileTypes.FAMILY_SHARED_FOLDER||n.type===i.FileTypes.FOLDER&&o.isInsideSharedFolder}return!1},ji=(e,t)=>{if(!qi(e,t))return!1;const o=Hi(e,t);return!o||!Vi(o)},zi=(e,o)=>{var i;return!$i(e,o)&&(null===(i=((e,t)=>{const o=fo().getState();if(Ue(e,t)){const i=pe(e,t).currentFQPath;return Jt(o,i)}if(Je(e,t)){const i=Ae(e,t).first().fq_path;return Jt(o,i)}})(e,o))||void 0===i?void 0:i.status)===t.RequestFlightStatus.READY},Zi=_.intl.formatMessage({id:"x/e6Ro",defaultMessage:"Share this folder to be able to receive activity updates."}),Ji=(e,t)=>ji(e,t)?{value:{type:o.ActionBarActionTypes.FOLLOW,menuItem:si.FOLLOW},description:_.intl.formatMessage(c.FOLLOW_ACTION_STRING),icon:i.FollowLine,isEnabled:$i(e,t),disabledTooltip:zi(e,t)?Zi:void 0}:void 0;const Xi=(e,o)=>Hi(e,o)===t.FolderSubscriptionState.FOLLOWING,en=(e,t)=>{if(!qi(e,t))return!1;const o=Hi(e,t);return!!o&&Vi(o)},tn=(e,t)=>{const o=ki(e,t),n=null==o?void 0:o.followingPath;if(n)return i.filename(n)},on=(e,t)=>_.intl.formatMessage({id:"7mcdEU",defaultMessage:'To unfollow, visit "{folderName}".'},{folderName:tn(e,t)}),nn=(e,t)=>en(e,t)?{value:{type:o.ActionBarActionTypes.FOLLOWING,menuItem:si.FOLLOWING},description:_.intl.formatMessage(c.FOLLOWING_ACTION_STRING),icon:i.FollowLine,isEnabled:Xi(e,t),disabledTooltip:Xi(e,t)?void 0:on(e,t),submenuSections:Xi(e,t)?Yi:void 0}:void 0;function rn(e){return!e.paid&&!e.is_team}const sn=(e,t)=>(((e,t)=>Ue(e,t)&&(i.experiments(e).folderHistoryRollbacks||rn(ue(e,t))))(e,t)||((e,t)=>Je(e,t)&&Pe(e,t)&&(i.experiments(e).folderHistoryRollbacks||rn(ue(e,t))))(e,t))&&!an(e,t),an=(e,t)=>{const o=Re(e,t),n=Ue(e,t),r=pe(e,t).currentFQPath,s=Se(e,t);return!(!i.isBackupBrowse()||o&&((e,t,o)=>{let n=null==t?void 0:t.nestLevel;if(!n){if(!o||"/"===o)return!0;n=i.depth(o)}return!(e&&0===n||"edb"===(null==t?void 0:t.type)&&e&&-1===n&&i.depth(o)<=2)})(n,o,r))||(!(o||!(null==s?void 0:s.is_in_backup_folder))||!!("cb"===(null==o?void 0:o.type)&&0===o.nestLevel||"third_party"===(null==o?void 0:o.type)||"edb"===(null==o?void 0:o.type)&&0===o.nestLevel||((e,t)=>"edb"===(null==e?void 0:e.type)&&-1===(null==e?void 0:e.nestLevel)&&i.depth(t)<=1)(o,r)))},cn=(e,t)=>Ue(e,t)?i.isRewindButtonEnabled$1(e):je(e,t),ln=(e,t)=>sn(e,t)?{value:{type:o.ActionBarActionTypes.REWIND,menuItem:si.REWIND},description:_.intl.formatMessage(c.REWIND_ACTION_STRING),icon:i.RewindLine,isEnabled:cn(e,t)}:void 0,dn=(e,t)=>{if(!Ze(e,t))return!1;const o=Ae(e,t).first(),n=o.ns_id!==ue(e,t).home_ns_id,r=o.is_locked||o.read_only||o.is_symlink||!n;return Pe(e,t)&&i.browsePostTTIExperiments(e).expShowFileLocking&&!r},_n={actionType:o.ActionBarActionTypes.FILE_LOCK,isEnabled:!0,text:c.FILE_LOCK_ACTION_STRING,icon:i.LockLine},un=(e,t)=>dn(e,t)?{value:{type:o.ActionBarActionTypes.FILE_LOCK,menuItem:si.FILE_LOCK},description:_.intl.formatMessage(c.FILE_LOCK_ACTION_STRING),icon:i.LockLine,isEnabled:!0}:void 0,An=(e,t)=>{const o=Ae(e,t).first();return Ze(e,t)&&Pe(e,t)&&o.is_locked&&o.is_lockholder},pn={actionType:o.ActionBarActionTypes.FILE_UNLOCK,isEnabled:!0,text:c.FILE_UNLOCK_ACTION_STRING,icon:i.LockOpenLine},Sn=(e,t)=>An(e,t)?{value:{type:o.ActionBarActionTypes.FILE_UNLOCK,menuItem:si.FILE_UNLOCK},description:_.intl.formatMessage(c.FILE_UNLOCK_ACTION_STRING),icon:i.LockOpenLine,isEnabled:!0}:void 0,En=(e,t)=>{const o=Ae(e,t).first();return Ze(e,t)&&Pe(e,t)&&o.is_locked&&!o.is_lockholder},Tn={actionType:o.ActionBarActionTypes.FILE_REQUEST_UNLOCK,isEnabled:!0,text:c.FILE_REQUEST_UNLOCK_ACTION_STRING,icon:i.LockOpenLine},On=(e,t)=>En(e,t)?{value:{type:o.ActionBarActionTypes.FILE_REQUEST_UNLOCK,menuItem:si.FILE_REQUEST_UNLOCK},description:_.intl.formatMessage(c.FILE_REQUEST_UNLOCK_ACTION_STRING),icon:i.LockOpenLine,isEnabled:!0}:void 0;function fn(e,t){return function(e){const t=i.experiments(e).fileImportsEntryPointsActivityMenu;return"V1"===t||"V2"===t}(e)}function In(e,t){return $e(e,t)}function Fn(e,t){return fn(e)?{value:{type:o.ActionBarActionTypes.ADD_FROM_GDRIVE,menuItem:si.ADD_FROM_GDRIVE},description:_.intl.formatMessage(c.ADD_FROM_GDRIVE_ACTION_STRING),icon:i.CloudUploadLine,isEnabled:In(e,t)}:void 0}const gn=(e,t)=>ji(e,t)||en(e,t)||li(e,t)||sn(e,t)||Di(e,t)||dn(e,t)||An(e,t)||En(e,t)||fn(e);function Rn(e){return e?e*Rn(e-1):1}var yn;let mn;function Nn(e){const t=[{value:{type:o.ActionBarActionTypes.SPACES_DROPDOWN,menuItem:{value:yn.NEW_SPACES,index:0}},description:"Create a project",icon:l.React$1.createElement(i.UIIcon,{src:i.AddFolderLine})},{value:{type:o.ActionBarActionTypes.SPACES_DROPDOWN,menuItem:{value:yn.CLIENT_UPDATE,index:1}},description:"Client update",icon:l.React$1.createElement(i.UIIcon,{src:i.CommentLine})},{value:{type:o.ActionBarActionTypes.SPACES_DROPDOWN,menuItem:{value:yn.GET_FEECBACK,index:2}},description:"Share with client",icon:l.React$1.createElement(i.UIIcon,{src:i.HighlightLine})},{value:{type:o.ActionBarActionTypes.SPACES_DROPDOWN,menuItem:{value:yn.HANDOFF_WORK,index:3}},description:"Assign task",icon:l.React$1.createElement(i.UIIcon,{src:i.ToDoLine})}];mn||(mn=function(e){const t=[...e],o=t.length,i=[t.slice()],n=new Array(o).fill(0);let r,s,a=1;for(;a<o;)n[a]<a?(r=a%2&&n[a],s=t[a],t[a]=t[r],t[r]=s,++n[a],a=1,i.push(t.slice())):(n[a]=0,++a);return i}([0,1,2,3])[e%Rn(t.length)]);const n=mn.map(((e,o)=>(t[e].value.menuItem.index=o,t[e])));return{type:o.ActionBarMenuType.DROPDOWN,menuSections:[{menuItems:n}]}}!function(e){e[e.NEW_SPACES=0]="NEW_SPACES",e[e.CLIENT_UPDATE=1]="CLIENT_UPDATE",e[e.GET_FEECBACK=2]="GET_FEECBACK",e[e.HANDOFF_WORK=3]="HANDOFF_WORK"}(yn||(yn={}));const Ln=(e,t)=>{const o=pe(e,t),{expSpacesFssDropdown:i}=Oe(e,t);return i&&Ue(e,t)&&!nt(e,t)&&!o.isCurrentlyInRoot&&!o.isInsideSandboxFolder&&!o.isInsideVaultFolder&&!o.isInFamilySharedFolder},vn=(e,t)=>{const{expFlowsApprovalFlowVariant:o,expFlowsApprovalAndVersioningNewBadgeVariant:i,expFlowsApprovalCopyVariant:n}=Oe(e,t),r=Ae(e,t).first();return{showRequestApprovalAction:q.isApprovalEnabled(o)&&Pe(e,t)&&Ze(e,t)&&!r.is_dir&&!r.is_cloud_doc,showNewBadge:"APPROVAL"===i,requestApprovalString:q.approvalCopyExperimentString(n)}},hn={actionType:o.ActionBarActionTypes.ADD_TO_COLLECTION,isEnabled:!0,text:c.ADD_TO_COLLECTION_STRING,icon:i.AddToCollectionLine},Cn=(e,t)=>Ye(e,t)&&Pe(e,t),bn=(e,t)=>Cn(e,t)&&i.browsePostTTIExperiments(e).expCollectionsInBrowse,wn=(e,t)=>Cn(e,t)&&i.searchCollectionsFileAction(e),Bn=e=>i.getDisplayedFilename(i.filename(e.fq_path)),Dn=(e,t,o)=>{const n=0===e.nestLevel;if(!t.length||n&&t.length>1)return;const r=i.mustGetActiveUser(),s=0===e.nestLevel&&e.displayName?e.displayName:Bn(t[0]),a=t.map((e=>Object.assign(Object.assign({},e),{fq_path:`/${Bn(e)}`}))),c=(i,r,s)=>ne.logEvent({event:i,page_source:o,extra:{id:e.id,backup_type:e.type,copy_type:n?"device":t.length>1?"multiple":t[0].is_dir?"folder":"file",reason:r,time_complete:s}});c("click_copy_to_fss"),I.showMoveDialog({onSuccess:()=>{},onCancel:()=>{},user:r,createNewFolderInMoveDialog:!0,useDigModal:!0,operation:i.Operation.COPY,modalName:oe.ModalName.COPY,initialFolderSelection:"/",entries:a,apiClient:{getFolderContents:i.getFolderContentsAPIv2,moveToFolder:a=>{const l=()=>S.__awaiter(void 0,void 0,void 0,(function*(){var l;let d=a,_=[...t];const u=1===t.length?s:t.length,A="copy-backup-to-fss",p=ie.COPY_TO_FSS.SNACKBAR(u,i.filename(d),i.fssUrlForFqPath(d));i.Snackbar.sync(p.PROGRESS,!0,A);const S=(()=>{const e=performance.now();return()=>(performance.now()-e)/1e3})();c("copy_to_fss_start");try{const[{folder_sizes:e},t,s]=yield Promise.all([(new i.UserApiV2Client).ns("folders_info").rpc("get_folder_sizes",{paths:_.filter((e=>void 0!==e.file_id&&e.is_dir)).map((e=>e.file_id)),allow_unmounted_ns:!0},{subjectUserId:r.id}),i.fetchUserSKU(r),i.fetchUserQuota(r)]),a=e.reduce(((e,t)=>e+t.size),0),l=_.filter((e=>!e.is_dir)).reduce(((e,t)=>{var o;return e+(null!==(o=t.bytes)&&void 0!==o?o:0)}),0),E=a+l;if((null==s?void 0:s.allocated)&&(null==s?void 0:s.used)){if(s.allocated-s.used-E<0)return i.Snackbar.close(A),I.showUpgradeProductPlanModal({userSKU:t,destPath:i.filename(d),nameOrCount:u,isDevice:n,showOverQuotaSnackbar:()=>i.Snackbar.fail(p.FAIL_QUOTA,A),source:o}),void c("copy_to_fss_overquota",void 0,S())}}catch(e){c("copy_to_fss_skip_quota_check",void 0,S())}if(n)try{const[o,n]=yield Promise.all([te.createFolder(d,s,r,!0),i.loadPath2({userId:r.id,path:t[0].fq_path,sortType:{".tag":"files_by_name"},sortIsAscending:!0,includeDeleted:!1,rootNsId:null!==(l=e.rootNsId)&&void 0!==l?l:r.root_ns_id})]);if(o.isError)return i.Snackbar.fail(p.FAIL,A),void c("copy_to_fss_failure","createFolder",S());if(!n.items.length)return i.Snackbar.complete(p.SUCCESS,A),void c("copy_to_fss_success",void 0,S());d=`${d}/${s}`,_=n.items}catch(e){return i.Snackbar.fail(p.FAIL,A),void c("copy_to_fss_failure","loadPath2",S())}try{const e=yield te.copyFiles(_.map((e=>{var t,o;return{file_id:e.file_id,fq_path:null!==(t=e.fq_path)&&void 0!==t?t:"",is_dir:null!==(o=e.is_dir)&&void 0!==o&&o}})),d,r.id);e.isError?(i.Snackbar.fail(p.FAIL,A),c("copy_to_fss_failure","copyFiles",S())):(i.Snackbar.complete(p.SUCCESS,A),c("copy_to_fss_success",void 0,S()))}catch(e){i.Snackbar.fail(p.FAIL,A),c("copy_to_fss_failure","copyFiles - catch",S())}}));return S.__awaiter(void 0,void 0,void 0,(function*(){const e=()=>{c("copy_to_fss_close_before_finished")};try{addEventListener("beforeunload",e),yield l()}finally{removeEventListener("beforeunload",e)}})),Promise.resolve()}}})},Mn=(e,t)=>{const o=Ae(e,t);if(o.count()){return{backup:ge(e,t,o.first()),files:o.toArray()}}const i=Se(e,t);if(i){return{backup:ge(e,t,i),files:[i]}}return null},Pn=(e,t)=>{const{expBackupCopyToFSS:o}=i.browsePostTTIExperiments(e),n=Mn(e,t);return!(i.isBackupBrowse()&&!(null==n?void 0:n.backup))&&(!!o&&!!(null==n?void 0:n.backup)&&n.files.every((e=>!e.isDeleted))&&"third_party"!==(null==n?void 0:n.backup.type))},Un=(e,t)=>{const o=Ae(e,t).first();return V.canConvertFile(o)&&re.UnzipAction.selector([o])},xn=(e,t)=>Ae(e,t).first().bytes/1048576>=re.UNZIP_MAX_FILESIZE_MB;function Wn(e,t){if(!Ue(e,t)){const o=ue(e,t),n=Ae(e,t).first(),r=_e(0,t),s=r===i.ActionSurfaceLogValue.INLINE_ACTION_BAR||r===i.ActionSurfaceLogValue.RIGHT_CLICK_MENU?i.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ROW_OVERFLOW_MENU:i.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS;Hn(ae.TiburonEventName.ClickManagePermissionsAction,s,n,o),yo(o,n,s)}}const Gn=(e,t)=>{const o=pe(e,t),{expVaultEnableViewOnlySharing:n}=i.browsePostTTIExperiments(e);return ze(e,t)&&Pe(e,t)&&!ke(e,t)&&!We(e,t)&&!Me(e,t)&&!De(e,t)&&!(o.isInsideFamilySharedFolder&&Qe(e,t))&&!Xe(e,t)&&!he(e,t)&&!Fe(e,t)&&!Ie(e,t)&&!tt(e,t)&&!(o.isInsideVaultFolder&&!n)},Vn=(e,t)=>!qe(e,t),kn=()=>i.createSelector(Gn,Vn,((e,t)=>e?{actionType:o.ActionBarActionTypes.MANAGE_PERMISSIONS,isEnabled:t,text:c.MANAGE_PERMISSIONS_ACTION_STRING,icon:i.PersonMultipleLine}:void 0)),Hn=(e,t,o,n)=>i.ShareTibEventLogger.log(n.id,e,t,{file_id:o.file_id,fq_path:o.fq_path,ns_id:o.target_ns?o.target_ns:void 0}),qn={actionType:o.ActionBarActionTypes.OPEN_IN_REPLAY,isEnabled:!0,text:c.OPEN_IN_REPLAY_STRING,icon:i.DropboxReplayLine,showNewBadge:!0},Kn=(e,t)=>{const o=ct(e,t),{files:n,user:r}=o,s=n.first(),a="VIDEO"===i.ExtensionCategories[U.getExtension(s)]||"AUDIO"===i.ExtensionCategories[U.getExtension(s)]||"IMAGE"===i.ExtensionCategories[U.getExtension(s)];return r&&"ON"===t.experimentSelector(e).expReplayBrowseAction&&Ze(e,t)&&Pe(e,t)&&a};let Yn=!1;const Qn={actionType:o.ActionBarActionTypes.EDIT_IMAGE,isEnabled:!0,text:c.EDIT_IMAGE_ACTION_STRING,icon:i.EditLine,showNewBadge:!1},$n=(e,t)=>{const o=ct(e,t),{files:n,user:r}=o,s=n.first(),a=s.ext.replace(".",""),c=s.href.includes("/s/")||s.href.includes("/scl/"),l=G.VALID_PHOTO_FILE_EXTENSIONS.has(a)&&!c,d=t.experimentSelector(e).expImageEditEntryPoint,_=r&&Ze(e,t)&&l&&!F.is_mobile_or_tablet();return!_||"V1"!==d&&"CONTROL"!==d||Yn||(i.logExposure({feature:"core_attach_mpa_image_edit_entrypoint",variant:d}),Yn=!0),_&&"V1"===d},jn=()=>({[o.ActionBarActionTypes.RENAME]:i.createSelector(ni,pe,Ae,((e,t,n)=>e?{actionType:o.ActionBarActionTypes.RENAME,isEnabled:t.isCurrentPathWriteable()&&!n.some((e=>e.read_only)),text:c.RENAME_ACTION_STRING,icon:i.CursorLine}:void 0)),[o.ActionBarActionTypes.DOWNLOAD]:i.createSelector(Ae,Ct,((e,t)=>t?{actionType:o.ActionBarActionTypes.DOWNLOAD,isEnabled:e.some((e=>!i.File.isNoAccessSharedFolder(e))),text:c.DOWNLOAD_ACTION_STRING,icon:i.DownloadLine}:void 0)),[o.ActionBarActionTypes.COMMENT]:i.createSelector(Rt,(e=>e?{actionType:o.ActionBarActionTypes.COMMENT,isEnabled:!0,text:c.COMMENT_ACTION_STRING,icon:i.CommentLine}:void 0)),[o.ActionBarActionTypes.EVENTS]:i.createSelector(pe,Ae,Bt,((e,t,n)=>n?{actionType:o.ActionBarActionTypes.EVENTS,isEnabled:t.every((t=>i.File.canViewFileMembers(t,e))),text:c.EVENTS_ACTION_STRING,icon:i.ActivityLine}:void 0)),[o.ActionBarActionTypes.VERSION_HISTORY]:i.createSelector(Di,(e=>e?Bi:void 0)),[o.ActionBarActionTypes.COPY]:i.createSelector(Ae,yt,((e,t)=>{const n=e.count(),r=p.MAX_NUM_FILES_SELECTED,s=n>r,a=e.some((e=>!i.File.isNoAccessSharedFolder(e))),l=a&&!s;let d;return a&&s&&(d=_.intl.formatMessage(c.TOO_MANY_SELECTED_ITEMS_STRING,{actionStr:"Copy",num:r})),t?{actionType:o.ActionBarActionTypes.COPY,isEnabled:l,disabledTooltip:d,text:c.COPY_ACTION_STRING,icon:i.CopyLine}:void 0})),[o.ActionBarActionTypes.MOVE]:i.createSelector(pe,Ae,Po,((e,t,n)=>{const r=t.count(),s=p.MAX_NUM_FILES_SELECTED,a=r>s,l=!e.isCurrentPathWriteable()||t.some((e=>e.read_only)),d=!l&&!a;let u;return!l&&a&&(u=_.intl.formatMessage(c.TOO_MANY_SELECTED_ITEMS_STRING,{actionStr:"Move",num:s})),n?{actionType:o.ActionBarActionTypes.MOVE,isEnabled:d,disabledTooltip:u,text:c.MOVE_ACTION_STRING,icon:i.MoveLine}:void 0})),[o.ActionBarActionTypes.DELETE]:i.createSelector(pe,Ae,Lt,((e,t,n)=>{const r=t.count(),s=p.MAX_NUM_FILES_SELECTED,a=r>s,l=!e.isCurrentPathWriteable()||t.some((e=>e.read_only)),d=!l&&!a;let u;return!l&&a&&(u=_.intl.formatMessage(c.TOO_MANY_SELECTED_ITEMS_STRING,{actionStr:"Delete",num:s})),n?{actionType:o.ActionBarActionTypes.DELETE,isEnabled:d,disabledTooltip:u,text:c.DELETE_ACTION_STRING,icon:i.DeleteLine}:void 0})),[o.ActionBarActionTypes.REMOVE]:i.createSelector(pe,Ae,Nt,((e,t,n)=>n?{actionType:o.ActionBarActionTypes.REMOVE,isEnabled:e.isCurrentPathWriteable()&&!t.some((e=>e.read_only)),text:c.REMOVE_ACTIION_STRING,icon:i.DeleteLine}:void 0)),[o.ActionBarActionTypes.RESTORE]:i.createSelector(Ai,pe,Ae,((e,t,n)=>e?{actionType:o.ActionBarActionTypes.RESTORE,isEnabled:t.isCurrentPathWriteable()&&!n.some((e=>e.read_only)),text:c.RESTORE_ACTION_STRING,icon:i.RestoreLine}:void 0)),[o.ActionBarActionTypes.PERMANENT_DELETE]:i.createSelector(oi,(e=>e?ii:void 0)),[o.ActionBarActionTypes.STAR]:i.createSelector(Ci,Ae,((e,t)=>e?{actionType:o.ActionBarActionTypes.STAR,isEnabled:!i.File.isNoAccessSharedFolder(t.first()),text:c.STAR_ACTION_STRING,icon:i.StarLine}:void 0)),[o.ActionBarActionTypes.UNSTAR]:i.createSelector(wi,(e=>e?bi:void 0)),[o.ActionBarActionTypes.OPEN]:$o(),[o.ActionBarActionTypes.ARCHIVE]:i.createSelector(ft,(e=>e?Ot:void 0)),[o.ActionBarActionTypes.GO_TO_FOLDER]:i.createSelector(Ae,xt,((e,t)=>t?Ut:void 0)),[o.ActionBarActionTypes.MANAGE_AS_ADMIN]:i.createSelector(Do,(e=>e?Mo:void 0)),[o.ActionBarActionTypes.REQUEST_FILES]:i.createSelector(li,di,((e,t)=>e?{actionType:o.ActionBarActionTypes.REQUEST_FILES,isEnabled:t,text:c.REQUEST_FILES_ACTION_STRING,icon:i.FileRequestLine}:void 0)),[o.ActionBarActionTypes.OPEN_MAC_DESKTOP]:i.createSelector(Go,(e=>F.mac&&e?xo:void 0)),[o.ActionBarActionTypes.OPEN_WINDOWS_DESKTOP]:i.createSelector(Go,(e=>!F.mac&&e?Wo:void 0)),[o.ActionBarActionTypes.SAVE_AS]:i.createSelector(Dt,Mt,((e,t)=>e&&t.length>0?{actionType:o.ActionBarActionTypes.SAVE_AS,text:c.FILE_CONVERSION_STRING,icon:i.ConvertFileLine,isEnabled:!0,menu:{type:o.ActionBarMenuType.DROPDOWN,menuSections:t.map((e=>({menuItems:e})))}}:void 0)),[o.ActionBarActionTypes.UNZIP]:i.createSelector(Ze,Pe,de,Un,xn,((e,t,i,n,r)=>e&&t&&!i&&n?{actionType:o.ActionBarActionTypes.UNZIP,text:c.UNZIP_ACTION_STRING,icon:re.UnzipAction.actionIcon,isEnabled:!r}:void 0)),[o.ActionBarActionTypes.EDIT_FOLDER_AUTOMATION]:gt("edit"),[o.ActionBarActionTypes.ADD_FOLDER_AUTOMATION]:gt("add"),[o.ActionBarActionTypes.CONVERT_TO_ARCHIVE]:i.createSelector(ti,(e=>e?{actionType:o.ActionBarActionTypes.CONVERT_TO_ARCHIVE,text:c.CONVERT_TO_ARCHIVE_ACTION_STRING,icon:i.ZipLine,isEnabled:!0}:void 0)),[o.ActionBarActionTypes.SHARE]:Ni(!0),[o.ActionBarActionTypes.SHARE_COPY_LINK]:vi(),[o.ActionBarActionTypes.REQUEST_APPROVAL]:i.createSelector(vn,(e=>{const{showRequestApprovalAction:t,showNewBadge:n,requestApprovalString:r}=e;return t?{actionType:o.ActionBarActionTypes.REQUEST_APPROVAL,text:r,icon:i.ThumbsUpLine,isEnabled:!0,tooltip:_.intl.formatMessage(c.REQUEST_APPROVAL_TOOLTIP),showNewBadge:n}:void 0})),[o.ActionBarActionTypes.SEND_FOR_SIGNATURE]:Gi(),[o.ActionBarActionTypes.SELF_SIGN_ACTION]:xi(),[o.ActionBarActionTypes.ACTIVITY]:i.createSelector(gn,Ji,nn,_i,ln,Mi,un,Sn,On,Fn,((e,t,n,r,s,a,l,d,_,u)=>e?{actionType:o.ActionBarActionTypes.ACTIVITY,isEnabled:!0,text:c.ACTIVITY_ACTION_STRING,icon:i.ActivityLine,menu:ci({followMenuItem:t,followingMenuItem:n,requestFilesMenuItem:r,rewindMenuItem:s,versionHistoryMenuItem:a,fileLockMenuItem:l,fileUnlockMenuItem:d,fileRequestUnlockMenuItem:_,addFromGdriveActionMenuItem:u})}:void 0)),[o.ActionBarActionTypes.EDIT_PDF]:wt(),[o.ActionBarActionTypes.BACKUP_COPY_TO_FSS]:i.createSelector(Pn,Mn,((e,t)=>{var n,r;const s=0===(null===(n=null==t?void 0:t.backup)||void 0===n?void 0:n.nestLevel),a=(null!==(r=null==t?void 0:t.files.length)&&void 0!==r?r:0)>1;if(!e||!(null==t?void 0:t.backup)||s&&a)return;let l=c.BACKUP_COPY_TO_FSS.FILE;return a?l=c.BACKUP_COPY_TO_FSS.MULTIPLE:s?l=c.BACKUP_COPY_TO_FSS.DEVICE:t.files[0].is_dir&&(l=c.BACKUP_COPY_TO_FSS.FOLDER),{actionType:o.ActionBarActionTypes.BACKUP_COPY_TO_FSS,isEnabled:!0,text:l,icon:i.DuplicateLine}})),[o.ActionBarActionTypes.MANAGE_PERMISSIONS]:kn(),[o.ActionBarActionTypes.OPEN_IN_REPLAY]:i.createSelector(Kn,(e=>e?qn:void 0)),[o.ActionBarActionTypes.EDIT_IMAGE]:i.createSelector($n,(e=>e?Qn:void 0))}),zn={[o.ActionBarActionTypes.RENAME]:(e,t)=>{f.logBrowseTTS("rename_file");Ae(e,t).first().type===i.FileTypes.TEAM_SHARED_FOLDER?a.handleRenameTeamFolder(ct(e,t)):a.handleRename(ct(e,t))},[o.ActionBarActionTypes.DOWNLOAD]:(e,t)=>{const o=pe(e,t);a.handleDownload(ct(e,t),o)},[o.ActionBarActionTypes.COMMENT]:(e,t)=>{a.handleComment(ct(e,t))},[o.ActionBarActionTypes.EVENTS]:(e,t)=>{a.handleEvents(ct(e,t))},[o.ActionBarActionTypes.VERSION_HISTORY]:(e,t)=>{a.handleVersions(ct(e,t))},[o.ActionBarActionTypes.COPY]:(e,t)=>{const o=pe(e,t),{isOverFreeQuota:n,hasExcludedNsIds:r}=Te(e,t);((e,t,o)=>{S.__awaiter(void 0,void 0,void 0,(function*(){const{isOverFreeQuota:n,hasExcludedNsIds:r}=o;if(n&&!r){const o=t.currentNSID,n=e.user.id;return void T.showOverquota("wb_oq_mv_cp",o,n,i.SHARE_ACTION_ORIGIN_TYPE.BROWSE_COPY_ACTION)}const{user:s,files:c,source:l,isSearchMode:d,viewType:_}=e,u=c.toArray(),A=u.map((e=>({fq_path:e.fq_path,is_dir:e.is_dir,file_id:e.file_id})));a.logUserEventOnFile({args:e,action_type:i.WebUserActionLogEvent.OPEN_COPY_MODAL});const p=yield I.selectDestination({user:s,filesPath:A,currentFQPath:t.currentFQPath,operationType:"COPY"});E.portableCopy({newPath:p,filesPath:A,user:s,source:d?"search":"browse"},{onSuccess:()=>{const{num_files_selected:e,num_folders_selected:t}=i.countFilesAndFolders(c);i.logCopyFiles({uid:s.id,source:l,view_type:_,num_files_selected:e,num_folders_selected:t}),f.logBrowseTTS("copy_file")},onUndo:()=>{O.browseActions.selectRowsFromBoltClient(u)}})}))})(ct(e,t),o,{isOverFreeQuota:n,hasExcludedNsIds:r})},[o.ActionBarActionTypes.MOVE]:(e,t)=>{const o=pe(e,t),{isOverFreeQuota:n,hasExcludedNsIds:r}=Te(e,t);((e,t,o)=>{S.__awaiter(void 0,void 0,void 0,(function*(){const{isOverFreeQuota:n,hasExcludedNsIds:r}=o;if(n&&!r){const o=t.currentNSID,n=e.user.id;return void T.showOverquota("wb_oq_mv_cp",o,n,i.SHARE_ACTION_ORIGIN_TYPE.BROWSE_MOVE_ACTION)}const{user:s,files:c,source:l,isSearchMode:d,viewType:_}=e,u=c.toArray(),A=u.map((e=>({fq_path:e.fq_path,is_dir:e.is_dir,file_id:e.file_id})));a.logUserEventOnFile({args:e,action_type:i.WebUserActionLogEvent.OPEN_MOVE_MODAL});const p=yield I.selectDestination({user:s,filesPath:A,currentFQPath:t.currentFQPath,operationType:"MOVE"});P.portableMove({newPath:p,filesPath:A,user:s,source:d?"search":"browse",currentFQPath:t.currentFQPath},{onSuccess:e=>{if(d&&e){const t=i.getStoreForSearch();i.shouldUseReactQueryForSearchView()?t.dispatch(i.updateReactQuerySearchResults({movedOrRenamedFiles:e})):t.dispatch(i.updateFileResultsFromDeltas({results:e})),t.dispatch(i.setSelection({selection:new i.Selection({selected:i.immutableExports.OrderedSet(e.map((e=>e.fq_path))),anchor:null}),skipLogging:!0}))}else if(e){const t=i.getStoreForBrowse();let o=i.unsortedFiles(t.getState());e.forEach((e=>{const t=o.find((t=>t.file_id===e.file_id));t&&(o=o.remove(t.fq_path))})),t.dispatch(h.setUnsortedFiles({unsortedFiles:o}))}const{num_files_selected:t,num_folders_selected:o}=i.countFilesAndFolders(c);i.logMoveFiles({uid:s.id,source:l,view_type:_,num_files_selected:t,num_folders_selected:o}),f.logBrowseTTS("move_file")},onUndo:e=>{if(d&&e){const e=i.getStoreForSearch();i.shouldUseReactQueryForSearchView()?e.dispatch(i.updateReactQuerySearchResults({movedOrRenamedFiles:u})):e.dispatch(i.updateResults({results:u})),e.dispatch(i.setSelection({selection:new i.Selection({selected:i.immutableExports.OrderedSet(u.map((e=>e.fq_path))),anchor:null}),skipLogging:!0}))}O.browseActions.selectRowsFromBoltClient(u)}})}))})(ct(e,t),o,{isOverFreeQuota:n,hasExcludedNsIds:r})},[o.ActionBarActionTypes.DELETE]:mt,[o.ActionBarActionTypes.REMOVE]:mt,[o.ActionBarActionTypes.RESTORE]:(e,t)=>{const o=pe(e,t),n=Ae(e,t),r=ge(e,t,n.first());Oe(e,t).expBackupImprovedRestorations&&(null==r?void 0:r.rootNsId)&&"cb"===(null==r?void 0:r.type)?ui(n.toArray(),i.BackupType.COMPUTER,r.rootNsId,"browse"):(null==r?void 0:r.rootNsId)&&"edb"===(null==r?void 0:r.type)&&n.every((e=>!e.is_dir))?ui(n.toArray(),i.BackupType.EXTERNAL_DRIVE,r.rootNsId,"browse"):a.handleRestore(ct(e,t),o)},[o.ActionBarActionTypes.PERMANENT_DELETE]:(e,t)=>{const o=pe(e,t);a.handlePermanentDelete(ct(e,t),o)},[o.ActionBarActionTypes.STAR]:(e,t)=>{f.logBrowseTTS("star"),a.handleStar(ct(e,t))},[o.ActionBarActionTypes.UNSTAR]:(e,t)=>{f.logBrowseTTS("star"),a.handleUnstar(ct(e,t))},[o.ActionBarActionTypes.OPEN]:(e,t,o)=>{const i=null==o?void 0:o.menuValue;a.handleExtensionClick(ct(e,t),t.actionSurface,(null==i?void 0:i.actionName)||(null==i?void 0:i.userAction)),null==i||i.handler()},[o.ActionBarActionTypes.SHARE_MODAL]:(e,t)=>{const o=ct(e,t),n=pe(e,t);Ue(e,t)?go(ue(e,t),n):Ei({action_source:t.actionSource||i.ActionSourceValue.SHARE,action_surface:t.actionSurface},o,n)},[o.ActionBarActionTypes.ARCHIVE]:(e,t)=>{a.handleArchive(ct(e,t))},[o.ActionBarActionTypes.GO_TO_FOLDER]:Pt,[o.ActionBarActionTypes.MANAGE_AS_ADMIN]:(e,t)=>{Ue(e,t)?Lo(ue(e,t),pe(e,t)):a.handleManageAsAdmin(ct(e,t))},[o.ActionBarActionTypes.REQUEST_FILES]:(e,t)=>{0===Ae(e,t).count()?vo(ue(e,t),pe(e,t),ct(e,t)):a.handleRequestFiles(ct(e,t))},[o.ActionBarActionTypes.OPEN_MAC_DESKTOP]:Uo,[o.ActionBarActionTypes.OPEN_WINDOWS_DESKTOP]:Uo,[o.ActionBarActionTypes.SHARE_COPY_LINK]:(e,t,o)=>{(null==o?void 0:o.anchorRef)?a.handleShareCopyLink(ct(e,t),null==o?void 0:o.anchorRef,null==o?void 0:o.onHoverLocked,null==o?void 0:o.onActionFlowComplete,t.experimentSelector(e).expUserLevelSharingSettings):$.reportStack("Missing `anchorRef` in copy link action",{severity:j.SEVERITY.NONCRITICAL,tags:["sharing"]})},[o.ActionBarActionTypes.SAVE_AS]:(e,t,o)=>{var n;f.logBrowseTTS("file_save_as");const r=ct(e,t),{files:s,user:c}=r,l=null===(n=null==o?void 0:o.menuValue)||void 0===n?void 0:n.menuItem;a.logUserEventOnFile({args:r,action_type:i.WebUserActionLogEvent.FILE_CONVERT_CLICK,extra:{action:l.actionText}});const{isCurrentFolderEligibleForAutomation:d,isSubfolderEligibleForAutomation:_}=Tt(e,t);l.convert(s.toArray(),c,{isCurrentFolderEligibleForAutomation:d,isSubfolderEligibleForAutomation:_,source:"browse"})},[o.ActionBarActionTypes.UNZIP]:(e,t)=>{const o=ct(e,t),{files:i,user:n}=o,{isCurrentFolderEligibleForAutomation:r,isSubfolderEligibleForAutomation:s}=Tt(e,t);re.UnzipAction.convert([i.first()],n,{isCurrentFolderEligibleForAutomation:r,isSubfolderEligibleForAutomation:s,source:"browse"})},[o.ActionBarActionTypes.EDIT_FOLDER_AUTOMATION]:(t,o)=>{const n=ct(t,o),{context:r,files:s}=n,c=s.first(),l=Je(t,o)?null==c?void 0:c.fq_path:null==r?void 0:r.currentFQPath,_=de(0,o)?"search":"browse";r&&l&&(d.asyncLaunchWorkflowBuilder({operation:"edit",folderFqPath:l,surface:_}),a.logUserEventOnFile({args:n,action_type:i.WebUserActionLogEvent.MANAGE_FOLDER_RULES_CLICK}),new Promise((function(t,o){e(["./c_flows_logging_flows_loggers"],t,o)})).then((({PapLogger:e})=>{e.logSelectAutoFolderEditAutomationButton({actionSurface:_})})))},[o.ActionBarActionTypes.ADD_FOLDER_AUTOMATION]:(t,o)=>{const n=ct(t,o),{context:r,files:s}=n,c=s.first(),l=Je(t,o)?null==c?void 0:c.fq_path:null==r?void 0:r.currentFQPath,_=de(0,o)?"search":"browse";r&&l&&(d.asyncLaunchWorkflowBuilder({operation:"add",folderFqPath:l,surface:_}),a.logUserEventOnFile({args:n,action_type:i.WebUserActionLogEvent.ADD_FOLDER_RULES_MODAL_CLICK}),new Promise((function(t,o){e(["./c_flows_logging_flows_loggers"],t,o)})).then((({PapLogger:e})=>{e.logSelectAutoFolderAddButton({actionSurface:_})})))},[o.ActionBarActionTypes.CONVERT_TO_ARCHIVE]:(e,t)=>{const o=ct(e,t);a.logUserEventOnFile({args:o,action_type:i.WebUserActionLogEvent.CONVERT_TO_ARCHIVE_CLICK});const{files:n,user:r,context:s}=o;s&&function(e,t,o,n){i.Modal.showInstance(l.React$1.createElement(i.Provider,{store:i.getStoreForBrowse()},l.React$1.createElement(_.Provider,{value:_.intl},l.React$1.createElement(Xo,{action:e,files:t,user:o,context:n}))))}("archive",n.toArray(),r,s)},[o.ActionBarActionTypes.SEND_FOR_SIGNATURE]:(e,t)=>{a.handleSendForSignature(ct(e,t))},[o.ActionBarActionTypes.REQUEST_APPROVAL]:(e,t)=>{const o=ct(e,t),{files:n,user:r,actionSurface:s}=o,a=n.first();J.launchApprovalRequestModal({file:a,user:r,onSuccess:()=>{const e=i.getStoreForBrowse();e.dispatch(h.setRightRailIsCollapsed(!1)),e.dispatch(h.selectFilesByFqPath({fqPathsToSelect:[a.fq_path]})),e.dispatch(h.expandBlade("comments"))}}),X.PapLogger.logRequestApprovalClick(s||"unknown",a.file_id)},[o.ActionBarActionTypes.SELF_SIGN_ACTION]:(e,t)=>{const o=ct(e,t);a.handleSendForSignature(o,!0)},[o.ActionBarActionTypes.ADD_TO_COLLECTION]:(e,t)=>{const o=ct(e,t),n=Ae(e,t).toArray().map((e=>e.file_id));a.logUserEventOnFile({args:o,action_type:i.WebUserActionLogEvent.OPEN_ADD_TO_COLLECTION_MODAL});const r=de(0,t)?"search":"browse";ee.showCollectionSaverModal({fileIds:n,surface:r})},[o.ActionBarActionTypes.EDIT_PDF]:(e,t)=>{const o=ct(e,t),{files:n,user:r}=o,s=n.first();a.browseNavigateActions.openPreviewForBrowseFile({file:s,shouldFocusComment:!1,user:r,fileViewOrigin:i.FileViewOriginType.BROWSE,onFileViewerUnmount:()=>{},editActivationParams:{source:"browse_overflow_menu"}}),a.logUserEventOnFile({args:o,action_type:i.WebUserActionLogEvent.SELECT_EDIT_MODE,extra:{file_ext:s.ext}}),i.logEvent(g.PAP_NavigateTo_Edit({actionElement:a.getActionElementForPAP(o.actionSurface),actionSurface:"browse_screen",destinationSurface:"pdf_edit"}))},[o.ActionBarActionTypes.BACKUP_COPY_TO_FSS]:(e,t)=>{const o=Mn(e,t);(null==o?void 0:o.backup)&&Dn(o.backup,o.files,"browse")},[o.ActionBarActionTypes.MANAGE_PERMISSIONS]:Wn,[o.ActionBarActionTypes.OPEN_IN_REPLAY]:(e,t)=>{const o=ct(e,t),{files:n}=o,r=n.first();a.logUserEventOnFile({args:o,action_type:i.WebUserActionLogEvent.OPEN_IN_REPLAY,extra:{file_ext:r.ext}}),i.logEvent(i.PAP_NavigateTo_Replay({actionElement:a.getActionElementForPAP(o.actionSurface),actionSurface:"browse_screen",destinationSurface:"replay_preview"}),{flush:!0}),window.open(`https://replay.dropbox.com/project/creating/${r.file_id}?creationSource=dropbox_browse_action_bar`)},[o.ActionBarActionTypes.EDIT_IMAGE]:(e,t)=>{const o=ct(e,t),{files:n,user:r,isSearchMode:s}=o,c=n.first(),l=s?i.FileViewOriginType.SEARCH:i.FileViewOriginType.BROWSE;a.browseNavigateActions.openPreviewForBrowseFile({file:c,shouldFocusComment:!1,user:r,fileViewOrigin:l,onFileViewerUnmount:()=>{},editActivationParams:{source:i.EditActivationParams.OVERFLOW_MENU}}),a.logUserEventOnFile({args:o,action_type:i.WebUserActionLogEvent.SELECT_IMAGE_EDIT_MODE,extra:{file_ext:c.ext}}),i.logEvent(g.PAP_NavigateTo_Edit({actionElement:a.getActionElementForPAP(o.actionSurface),actionSurface:"browse_screen",destinationSurface:"image_edit"}))}},Zn={[o.ActionBarActionTypes.OPEN]:(e,t,o)=>{o&&(a.handleExtensionDropdownOpen(ct(e,t),t.actionSurface),i.logEvent(G.PAP_Select_OpenInMenu({actionSurface:"browse_screen",actionElement:"action_bar"})))},[o.ActionBarActionTypes.SPACES_DROPDOWN]:(e,t,o)=>{o&&i.WebUserActionLog.log(i.user$1(e).id,i.WebUserActionLogEvent.EXPAND_SPACES_FOLDER_DROPDOWN,{})},[o.ActionBarActionTypes.ACTIVITY]:(e,t,o)=>{o&&a.handleExtensionDropdownOpen(ct(e,t),t.actionSurface)}},Jn={[o.ActionBarActionEventSource.BUTTON]:i.ActionSourceValue.BUTTON,[o.ActionBarActionEventSource.BUTTON_MENU]:i.ActionSourceValue.BUTTON_MENU,[o.ActionBarActionEventSource.OVERFLOW_MENU]:i.ActionSourceValue.OVERFLOW_MENU},Xn=(e,t)=>{var o;return Z.shallowEqualArray(e.alwaysAtTopLevel,t.alwaysAtTopLevel)&&Z.shallowEqualArray(e.atTopLevelIfSpace,t.atTopLevelIfSpace)&&!!(null===(o=e.alwaysInOverflow)||void 0===o?void 0:o.every(((e,o)=>Z.shallowEqualArray(e,t.alwaysInOverflow?t.alwaysInOverflow[o]:[]))))},er=(e,t,o,i)=>{const n=[];return i.forEach((i=>{const r=o[i],s=r&&r(e,t);s&&n.push(s)})),n};t.ActionMenuToggleHandlersMap=Zn,t.FOLLOW_MODAL_QUERY_PARAM=Ht,t.FileActionsHandlersMap=zn,t.Frequencies={INSTANT:{".tag":"instant"},DAILY:{".tag":"daily"}},t.actionBarSelectionType=ye,t.actionHandler=(e,t,o,i)=>(n,r)=>{const s=o[e.type];if(s){s(r(),Object.assign(Object.assign({},t),{actionSource:Jn[e.source]}),{menuValue:e.menuItem,anchorRef:e.anchorRef,onHoverLocked:null==i?void 0:i.onHoverLocked,onActionFlowComplete:e.onActionFlowComplete})}},t.actionMenuToggleHandler=({type:e,isOpen:t},o,i)=>(n,r)=>{const s=i[e];if(s){s(r(),o,t)}},t.addFromGdriveActionHandler=function(e,t){Ue(e,t)&&wo(ue(e,t),ct(e,t))},t.browse_global_actions_handlers_esnext=Bo,t.context=pe,t.copyActionBarActions=e=>{const{alwaysAtTopLevel:t,atTopLevelIfSpace:o,alwaysInOverflow:i,expSuggestedWorkflowsActions:n}=e,r={};return r.alwaysAtTopLevel=null==t?void 0:t.slice(),r.atTopLevelIfSpace=null==o?void 0:o.slice(),r.alwaysInOverflow=null==i?void 0:i.map((e=>e.slice())),n&&(r.expSuggestedWorkflowsActions={suggestedWorkflowActions:n.suggestedWorkflowActions.slice(),compactOverflowMenuActions:n.compactOverflowMenuActions.map((e=>e.slice()))}),r},t.createActionBarActionSelector=()=>ce(Xn,((e,t,o,i)=>{const n={},{alwaysAtTopLevel:r,atTopLevelIfSpace:s,alwaysInOverflow:a,expSuggestedWorkflowsActions:c}=i(e,t);return n.alwaysAtTopLevel=r?er(e,t,o,r):[],n.atTopLevelIfSpace=s?er(e,t,o,s):[],n.alwaysInOverflow=a?a.map((i=>er(e,t,o,i))):[[]],c&&(n.expSuggestedWorkflowsActions={suggestedWorkflowActions:er(e,t,o,c.suggestedWorkflowActions).filter((e=>e.isSuggestedWorkflow)),compactOverflowMenuActions:c.compactOverflowMenuActions.map((i=>er(e,t,o,i)))}),n})),t.createAddFromGdriveActionSelector=function(){return i.createSelector(In,fn,((e,t)=>t?{actionType:o.ActionBarActionTypes.ADD_FROM_GDRIVE,isEnabled:e,text:c.ADD_FROM_GDRIVE_ACTION_STRING,icon:i.CloudUploadLine}:void 0))},t.createAddToCollectionActionSelector=()=>i.createSelector(bn,(e=>e?hn:void 0)),t.createAddToCollectionSearchActionSelector=()=>i.createSelector(wn,(e=>e?hn:void 0)),t.createFileLockActionSelector=()=>i.createSelector(dn,(e=>e?_n:void 0)),t.createFileRequestUnlockActionSelector=()=>i.createSelector(En,(e=>e?Tn:void 0)),t.createFileUnlockActionSelector=()=>i.createSelector(An,(e=>e?pn:void 0)),t.createFolderSubscription=(e,o,n)=>(r,s)=>{const a=s(),c=i.user$1(a).id;if(Xt(a,e)===t.FolderSubscriptionState.NOT_FOLLOWING)return Eo({dispatch:r,getState:s,path:e,newValue:{subscriptionState:t.FolderSubscriptionState.FOLLOWING,followingPath:e,settings:o},apiUpdate:()=>function(e,t,o){return S.__awaiter(this,void 0,void 0,(function*(){return(new i.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/create",{identifier:e,settings:t},{subjectUserId:o})}))}(e,o,c),onSuccess:()=>{so(e),So(i.WebUserActionLogEvent.FOLLOW_FOLDER,s(),e,n)},onError:()=>ao(e)})},t.createFollowActionSelector=()=>i.createSelector($i,ji,zi,((e,t,n)=>t?{actionType:o.ActionBarActionTypes.FOLLOW,isEnabled:e,text:c.FOLLOW_ACTION_STRING,icon:i.FollowLine,disabledTooltip:n?Zi:void 0}:void 0)),t.createFollowingActionSelector=()=>i.createSelector(Xi,en,on,((e,t,n)=>t?{actionType:o.ActionBarActionTypes.FOLLOWING,isEnabled:e,text:c.FOLLOWING_ACTION_STRING,icon:i.FollowLine,disabledTooltip:e?void 0:n,menu:e?Qi:void 0}:void 0)),t.createManagePermissionsActionSelector=kn,t.createRewindActionSelector=()=>i.createSelector(cn,sn,((e,t)=>t?{actionType:o.ActionBarActionTypes.REWIND,isEnabled:e,text:c.REWIND_ACTION_STRING,icon:i.RewindLine}:void 0)),t.createSearchActionBarAccessibilityConfigSelector=()=>i.createSelector(Ae,(e=>{if(0!==e.size)return{primaryActionContext:void 0,secondaryActionsContext:{firstEntryAccessibilityHint:i.getFilename(e.first()),noOfEntries:e.size}}})),t.createShareCopyLinkActionSelector=vi,t.createShareModalActionSelector=hi,t.createSpacesDropdownActionSelector=()=>i.createSelector(Ln,ue,((e,t)=>{return e?(n=t.id,{actionType:o.ActionBarActionTypes.SPACES_DROPDOWN,isEnabled:!0,text:c.SPACES_PROJECTS_RENAME_DROPDOWN_ACTION_STRING,icon:i.DropboxSpacesLine,menu:Nn(n)}):void 0;var n})),t.currentBackupInfo=Re,t.defaultOverQuotaData={isOverFreeQuota:!1,hasExcludedNsIds:!1},t.deleteFolderSubscription=To,t.deleteFolderSubscriptionFromEmail=(e,o)=>(n,r)=>{const s=r(),a=i.user$1(s).id;return $t(e,a).then((()=>{co(e),So(i.WebUserActionLogEvent.UNFOLLOW_FOLDER,s,e,{ns_id:o,origin:t.FolderSubscriptionOrigin.Email})}),(()=>lo(e)))},t.editFolderSubscription=(e,o,n)=>(r,s)=>{const a=s(),c=i.user$1(a).id;if(Xt(a,e)===t.FolderSubscriptionState.FOLLOWING)return Eo({dispatch:r,getState:s,path:e,newValue:{subscriptionState:t.FolderSubscriptionState.FOLLOWING,followingPath:e,settings:o},apiUpdate:()=>function(e,t,o){return S.__awaiter(this,void 0,void 0,(function*(){return(new i.UserApiV2Client).ns("awareness_subscriptions").rpc("folder_subscriptions/edit",{identifier:e,settings:t},{subjectUserId:o})}))}(e,o,c),onSuccess:()=>{so(e),So(i.WebUserActionLogEvent.EDIT_FOLDER_FOLLOW_SETTINGS,s(),e,n)},onError:()=>ao(e)})},t.experiments=Oe,t.fetchFolderSubscription=Ao,t.fileLockActionHandler=(e,t)=>{a.handleFileLock(ct(e,t))},t.fileRequestUnlockActionHandler=(e,t)=>{a.handleFileRequestUnlock(ct(e,t))},t.fileUnlockActionHandler=(e,t)=>{a.handleFileUnlock(ct(e,t))},t.folderSubscription=eo,t.followActionHandler=(e,t)=>{let o,n;if(Ue(e,t)){const i=pe(e,t).currentFQPath;o=i,n=i}else{const r=Ae(e,t).first();o=r.fq_path,n=i.parent_dir(r.fq_path)}bo(o,n)},t.followingActionHandler=function(e,t,o){const n=null==o?void 0:o.menuValue;if((null==n?void 0:n.menuItem)===Ki.OPTIONS){const o=Ae(e,t),n=pe(e,t).currentFQPath;let r,s;if(Ue(e,t))r=n,s=n;else{const e=o.first();r=e.fq_path,s=i.parent_dir(e.fq_path)}bo(r,s)}else{const o=pe(e,t),i=Ae(e,t);if(Ue(e,t))Co(o.currentFQPath,o.currentNSID);else if(Je(e,t)){const e=i.first();Co(e.fq_path,e.ns_id)}}},t.getActionHandlerArgs=ct,t.getFileActionsSelectorsMap=jn,t.getFlowsUserAutomation=it,t.getInlineFileActionsSelectors=()=>Object.assign(Object.assign({},jn()),{[o.ActionBarActionTypes.SHARE_MODAL]:hi(),[o.ActionBarActionTypes.SHARE_COPY_LINK]:vi()}),t.getInlineScenarioActions=dt,t.getMobileFileActionsSelectors=()=>Object.assign(Object.assign({},jn()),{[o.ActionBarActionTypes.SHARE_MODAL]:hi()}),t.getRequestState=Jt,t.getSearchInlineOverflowMenuActions=ut,t.getSearchInlineScenarioActions=_t,t.getSearchScenarioActions=lt,t.getSearchSidebarScenarioActions=At,t.getSidebarFileActionSelectors=()=>({[o.ActionBarActionTypes.SHARE]:Ni(),[o.ActionBarActionTypes.SHARE_COPY_LINK]:vi()}),t.getStoreForFolderSubscriptions=fo,t.getTabletFileActionsSelectors=()=>Object.assign(Object.assign({},jn()),{[o.ActionBarActionTypes.SHARE_MODAL]:(e,t)=>{}}),t.getTabletSidebarFileActionSelectors=()=>({[o.ActionBarActionTypes.SHARE_MODAL]:hi()}),t.handleAddContent=ho,t.handleCreateNewFolder=Io,t.handleCreateSharedFolderClick=Ro,t.handleRedirectToContentManager=No,t.handleRequestFiles=vo,t.handleSharedFolderClick=go,t.handleTrashCanClick=mo,t.hasContentManagerAndSuperAdmin=me,t.hasUnmountedOrMultipleNamespaces=Le,t.isCdmRoot=nt,t.isCloudDocSelected=be,t.isDeletedFilesOnly=Be,t.isFileSharedWithMeSelected=Me,t.isFolderTidyable=Et,t.isInsideBackupFolder=Ie,t.isLiveFilesOnly=Pe,t.isNoAccessSharedFolderSelected=ve,t.isNothingSelected=Ue,t.isPnmLinkNodeSelected=We,t.isPnmSuppressShareSelected=ke,t.isRestrictedPathSelected=qe,t.isSelectedBackupFolder=Fe,t.isSelectionFetchFolderSizeStatusOnly=Ke,t.isSelectionFoldersOnly=Qe,t.isSingleSelectionFolder=Je,t.isTeamMemberFolderSelected=Xe,t.logAction=So,t.managePermissionsActionHandler=Wn,t.rewindActionHandler=(e,t)=>{Ue(e,t)?Fo(ue(e,t),ct(e,t)):a.handleRewind(ct(e,t))},t.selectedFiles=Ae,t.shouldShowRewindsUpsell=rn,t.showRestoreAction=Ai,t.spacesDropdownActionHandler=(e,t,o)=>{const n=null==o?void 0:o.menuValue;i.WebUserActionLog.log(i.user$1(e).id,i.WebUserActionLogEvent.CLICK_SPACES_FOLDER_ITEM,{value:n.menuItem.value,index:n.menuItem.index}),i.redirect(new l.URI({path:"/spaces",query:{_tk:"fss_hooks_add_to_space_"+n.menuItem.value}}))},t.user=ue,t.viewType=Ee}));
//# sourceMappingURL=c_action_bar_file_actions.js-vflIBq-eC.map
