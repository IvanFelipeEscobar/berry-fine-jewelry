define(["exports","./e_ui_page_files_router","./c_integrations_data_selectors","./c_core_i18n","./c_tslib","./c_downloads","./c_share_download_ui_api"],(function(e,t,n,i,o,s,a){"use strict";function r(e){return function(e){return void 0!==e.ext}(e)?e.ext:function(e){return void 0!==e.fq_path}(e)?"."+t.file_extension(t.filename(e.fq_path)):function(e){return void 0!==e.filename}(e)?"."+t.file_extension(e.filename):void 0}function d(e){return!!e.is_in_vault_folder}const _="fp_app_id:dropbox_transfer",l="fp_app_id:slack_dropbox",c="fp_app_id:trello",p="fp_app_id:zoom";var u=Object.freeze({__proto__:null,SLACK_FP_APP_ID:l,TRANSFER_FP_APP_ID:_,TRELLO_FP_APP_ID:c,ZOOM_FP_APP_ID:p});const E=e=>t.getStateAtNamespace(e,t.EXTENSIONS_NAMESPACE_KEY)||t.defaultExtensionsState,g=e=>E(e).featureFlags,f=e=>E(e).docsendAdvancedSharingHasOpenedSharingSettings,O=e=>E(e).docsendAdvancedSharingHasShared,A=e=>E(e).docsendAdvancedSharingHasSeenShareModal,S=e=>E(e).docsendAdvancedSharingHasConfirmedSplitShareMenu,I=e=>{const i=n.getListServicesInfo(e).latestListServicesResult;return i&&t.convertToSharingServiceInfo(i)},N=e=>E(e).cloudDocsInfo,T=e=>E(e).actions,D=e=>E(e).bylines,P=e=>E(e).categoryInfos;function m(e,t){return!(e.length>1&&!t.multiselect_enabled)&&e.every((e=>function(e,t){return void 0===t.filters||t.filters.every((t=>"matcher_any"===t[".tag"]&&!!t.matcher_any.some((t=>{if("extension"===t[".tag"]){const n=r(e);return t.extension===n}return"max_size_bytes"===t[".tag"]?e.bytes<=t.max_size_bytes:"is_file"===t[".tag"]?e.is_dir!==t.is_file:"is_cloud_doc"!==t[".tag"]||function(e){return!!e.is_cloud_doc}(e)===t.is_cloud_doc}))))}(e,t)))}function M(e){var t;const n=e.is_dir,i=d(e),o=null===(t=e.per_node_metadata)||void 0===t?void 0:t.link_node;return!(n||i||o)}function L(e){const t=e.per_node_metadata;return!(d(e)||(null==t?void 0:t.link_node)||(null==t?void 0:t.suppress_ns_partition)||(null==t?void 0:t.suppress_shared_link))}function h(e,t){return function(e,t){return e.every(M)?t.filter((t=>m(e,t))):[]}(t,T(e))}function R(e,t){return t.every(L)?h(e,t).filter((e=>y(e)&&![l,p,c].includes(e.app_id))):[]}function v(e,t){return h(e,[t]).filter((e=>!y(e)))}function F(e,t,n){return R(e,t).filter((e=>e.app_id!==n))}function y(e){return"share_menu"===e.menu_alignment[".tag"]}var H=Object.freeze({__proto__:null,getActions:T,getActionsForFiles:h,getBylines:D,getCategoryInfos:P,getCloudDocInfo:N,getDocsendAdvancedSharingHasConfirmedSplitShareMenu:S,getDocsendAdvancedSharingHasOpenedSharingSettings:f,getDocsendAdvancedSharingHasSeenShareModal:A,getDocsendAdvancedSharingHasShared:O,getExtensionsState:E,getFeatureFlags:g,getNonHellosignActionsForFiles:F,getOpenActionsForFile:v,getShareActionsForFiles:R,getSharingServiceInfoAdapter:I,isShareAction:y});const C={0:{displayName:i.intl.formatMessage({id:"wYkgel",defaultMessage:"DEFAULT"})},1:{displayName:i.intl.formatMessage({id:"EMXHTJ",defaultMessage:"Send for signature"}),developerDescription:i.intl.formatMessage({id:"EMXHTJ",defaultMessage:"Send for signature"})},2:{displayName:i.intl.formatMessage({id:"aIQiHy",defaultMessage:"PDF Editing"}),developerDescription:i.intl.formatMessage({id:"fG5ZbA",defaultMessage:"PDF editing"})},3:{displayName:i.intl.formatMessage({id:"e6EJBF",defaultMessage:"View or Edit"}),developerDescription:i.intl.formatMessage({id:"p+tBI0",defaultMessage:"View or edit"})},4:{displayName:i.intl.formatMessage({id:"gN/zWT",defaultMessage:"Image Editing"}),developerDescription:i.intl.formatMessage({id:"KQT2xh",defaultMessage:"Image editing"})},5:{displayName:i.intl.formatMessage({id:"miE3lp",defaultMessage:"Video comment"}),developerDescription:i.intl.formatMessage({id:"miE3lp",defaultMessage:"Video comment"})},6:{displayName:i.intl.formatMessage({id:"Mcwc+5",defaultMessage:"Send fax"}),developerDescription:i.intl.formatMessage({id:"Mcwc+5",defaultMessage:"Send fax"})},8:{displayName:i.intl.formatMessage({id:"UwFkjc",defaultMessage:"Edit"}),developerDescription:i.intl.formatMessage({id:"RBrgq4",defaultMessage:"Video Editing"})},9:{displayName:i.intl.formatMessage({id:"Ufb68N",defaultMessage:"Send with"}),developerDescription:i.intl.formatMessage({id:"tBDUcB",defaultMessage:"Send Files"})},10:{displayName:i.intl.formatMessage({id:"sDGta5",defaultMessage:"Cloud Editors"}),developerDescription:i.intl.formatMessage({id:"sDGta5",defaultMessage:"Cloud Editors"})},11:{displayName:i.intl.formatMessage({id:"gffk/L",defaultMessage:"Send to notary"}),developerDescription:i.intl.formatMessage({id:"O/A0V6",defaultMessage:"Notarize"})},12:{displayName:i.intl.formatMessage({id:"oNuOaL",defaultMessage:"Expense"}),developerDescription:i.intl.formatMessage({id:"oNuOaL",defaultMessage:"Expense"})},13:{displayName:i.intl.formatMessage({id:"VlZABW",defaultMessage:"Publish"}),developerDescription:i.intl.formatMessage({id:"itZX4g",defaultMessage:"Publish Video"})},14:{displayName:i.intl.formatMessage({id:"E0v6mC",defaultMessage:"Share with"}),developerDescription:i.intl.formatMessage({id:"uukIVm",defaultMessage:"Share a file"})}};var W,B;function x(e,t,n){e&&e.event(t,n)}function w(e){return e.link_state[".tag"].indexOf("_linked")>=0}function U(e,t){if(e.priority&&t.priority){const n=t.priority-e.priority;return 0!==n?n:e.description<t.description?-1:e.description>t.description?1:0}return e.priority?-1:t.priority?1:e.description<t.description?-1:e.description>t.description?1:0}!function(e){function t(e){return C[e]||null}e.DEFAULT=0,e.ESIGNATURE=1,e.PDF_EDITING=2,e.VIEW_OR_EDIT=3,e.IMAGE_EDITING=4,e.VIDEO_COMMENT=5,e.SEND_FAX=6,e.OPEN_WITH_CLOUD_DOC=7,e.VIDEO_EDITING=8,e.SEND_WITH=9,e.CLOUD_EDITORS=10,e.SEND_TO_NOTARY=11,e.EXPENSE=12,e.PUBLISH=13,e.SHARE_WITH=14,e.getDisplayName=function(e){const n=t(e);return n&&n.displayName},e.getDeveloperDescription=function(e){const n=t(e);return n&&n.developerDescription||null}}(W||(W={})),e.OpenButtonAction=void 0,(B=e.OpenButtonAction||(e.OpenButtonAction={}))[B.DOWNLOAD=0]="DOWNLOAD",B[B.UNITY_FILE=1]="UNITY_FILE",B[B.UNITY_FOLDER=2]="UNITY_FOLDER",B[B.OPEN_WITH=3]="OPEN_WITH",B[B.APP_ACTION=5]="APP_ACTION",B[B.PREPARE_FOR_SIGNATURE=6]="PREPARE_FOR_SIGNATURE",B[B.SHARE_TO_SLACK=7]="SHARE_TO_SLACK",B[B.PRESENT_IN_ZOOM=8]="PRESENT_IN_ZOOM",B[B.SHARE_TO_TRELLO=9]="SHARE_TO_TRELLO",B[B.INVITE_VIA_EMAIL=10]="INVITE_VIA_EMAIL",B[B.OPEN_WITH_CLOUD_DOC=11]="OPEN_WITH_CLOUD_DOC",B[B.OPEN_MORE_APPS=12]="OPEN_MORE_APPS",B[B.OPEN_ADD_APPS=13]="OPEN_ADD_APPS",B[B.DECOMPRESS_FILE=14]="DECOMPRESS_FILE",B[B.PREVIEW_FILE=15]="PREVIEW_FILE",B[B.TRANSFER=16]="TRANSFER",B[B.OPEN_IN_DESKTOP=17]="OPEN_IN_DESKTOP",B[B.GO_TO_FOLDER=18]="GO_TO_FOLDER",B[B.OPEN_IN_REPLAY=19]="OPEN_IN_REPLAY",B[B.OPEN_IN_NEW_TAB=20]="OPEN_IN_NEW_TAB",B[B.CONVERT_AND_SHARE=24]="CONVERT_AND_SHARE",B[B.SELL_WITH_SHOP=25]="SELL_WITH_SHOP",B[B.SHARE_WITH_COLLECTION=26]="SHARE_WITH_COLLECTION",B[B.CREATE_CLIENT_PORTAL=21]="CREATE_CLIENT_PORTAL",B[B.EDIT_CLIENT_PORTAL=22]="EDIT_CLIENT_PORTAL",B[B.SHARE_WITH_ANALYTICS=23]="SHARE_WITH_ANALYTICS",B[B.PUBLISH_TO_SOCIAL=24]="PUBLISH_TO_SOCIAL";e.TRANSFER_FP_APP_ID=_,e.actionCompareFn=U,e.cloudEditorNameToParams=function(e){return"gdoc"===e?t.GoogleFileTypes.GOOGLE_DSS_DOC:"gsheet"===e?t.GoogleFileTypes.GOOGLE_DSS_SHEET:"gslides"===e?t.GoogleFileTypes.GOOGLE_DSS_SLIDES:"word"===e?t.MicrosoftEditors.WORD:"excel"===e?t.MicrosoftEditors.EXCEL:"powerpoint"===e?t.MicrosoftEditors.POWERPOINT:"preview"},e.constants_esnext=u,e.downloadSingleFile=({href:e,source:n,isFswm:i=!1,userId:r},{onAttempt:d,onSuccess:_,onError:l}={})=>o.__awaiter(void 0,void 0,void 0,(function*(){null==d||d();const o=i?yield a.fetchDownloadUrl({sharedLinkUrl:e,origin:t.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,userId:r}):e;s.get({url:o,source:`${n}_direct`,error:l}),null==_||_()})),e.downloadSingleFileAsZip=({fqPath:e,rootNsId:n,source:i,blockHash:a,user:r},{onAttempt:d,onSuccess:_}={})=>o.__awaiter(void 0,void 0,void 0,(function*(){null==d||d(),s.get_zip({fq_paths:[e],subject_uid:r.id,block_hash:a,parent_path:t.parent_dir(e),source:i,root_ns_id:n}),null==_||_()})),e.getAppActionExtras=function(e){return{action_id:e.id,encoded_app_id:e.app_id,action_type:w(e)?"select_action":"select_connect"}},e.getBylines=D,e.getCategoryInfos=P,e.getCloudDocInfo=N,e.getDocsendAdvancedSharingHasConfirmedSplitShareMenu=S,e.getDocsendAdvancedSharingHasOpenedSharingSettings=f,e.getDocsendAdvancedSharingHasSeenShareModal=A,e.getDocsendAdvancedSharingHasShared=O,e.getFeatureFlags=g,e.getFileExt=r,e.getNonHellosignActionsForFiles=F,e.getOpenActionsForFile=v,e.getOpenOptionsWithLogging=function(e,t){return e.map((e=>Object.assign(Object.assign({},e),{handler:()=>{e.handler(),x(t,"select_legacy_action",{type:e.type})}})))},e.getShareActionsForFiles=R,e.getSharingServiceInfoAdapter=I,e.handleShowByline=function(e,t){return()=>{x(t,"show_byline",{extension_id:e})}},e.isLinked=w,e.isShareAction=y,e.isWopiAction=function(e){return["fp_action_id:word_online","fp_action_id:excel_online","fp_action_id:powerpoint_online"].indexOf(e.id)>=0},e.logEvent=x,e.partitionActions=function(e,t=0){const n=[],i=[],o=[],s=[],a=[];return e.sort(U).forEach((e=>{e.category===W.CLOUD_EDITORS?n.push(e):e.app_id===_?i.push(e):w(e)||function(e){return"oauth_prelinked"===e.link_state[".tag"]}(e)?o.push(e):void 0!==e.priority&&e.priority>0&&s.length<t?s.push(e):a.push(e)})),{cloudEditors:n,transferActions:i,installedActions:o,promotedActions:s,unpromotedActions:a}},e.partitionActionsByLinkStatus=function(e){const t=[],n=[];return e.map((e=>{e.app_id&&(w(e)?t.push(e.app_id):n.push(e.app_id))})),{connected_apps:t,unconnected_apps:n}},e.partitionOptions=function(t){const n=[],i=[];let o,s,a,r,d,_;return t.forEach((t=>{const{type:l}=t;l===e.OpenButtonAction.UNITY_FILE||l===e.OpenButtonAction.UNITY_FOLDER?n.push(t):l===e.OpenButtonAction.OPEN_WITH||l===e.OpenButtonAction.OPEN_WITH_CLOUD_DOC?i.push(t):l===e.OpenButtonAction.DOWNLOAD?o=t:l===e.OpenButtonAction.PREVIEW_FILE?s=t:l===e.OpenButtonAction.OPEN_IN_REPLAY?a=t:l===e.OpenButtonAction.OPEN_IN_DESKTOP?r=t:l===e.OpenButtonAction.GO_TO_FOLDER?d=t:l===e.OpenButtonAction.OPEN_IN_NEW_TAB&&(_=t)})),{unityOptions:n,cloudEditorOptions:i,downloadOption:o,previewOption:s,openInReplayOption:a,openInDesktopOption:r,openInNewTabOption:_,goToFolderOption:d}},e.selectors_esnext=H}));
//# sourceMappingURL=c_extensions_cloud_docs_compat.js-vflt5QJvo.map
