define(["exports","./c_tslib","./c_src_sink_index","./c_apex-metrics_src_types","./c_files_view_file_actions_file_from_metadata","./c_ui_fileops_actions","./c_action_bar_file_actions_logging"],(function(e,t,c,o,a,n,i){"use strict";function r(e){return{class:"previews",action:"copy",object:"file",properties:e}}e.portableCopy=({newPath:e,filesPath:s,source:l,user:_,extraForLogging:d,isPasteAction:u},S={})=>t.__awaiter(void 0,void 0,void 0,(function*(){const t=s.reduce(((e,t)=>e+(t.is_dir?0:1)),0),p=s.reduce(((e,t)=>e+(t.is_dir?1:0)),0),L=c.getMetricsReporter(),f={surface:l,batchSizeBucket:a.bucketForBatchSize(s.length),contentType:a.batchContentType(s)},g={totalLatency:L.createStats({ns:a.FILE_ACTIONS_AMP_NAMESPACE,name:"copy/batch/latency_total_ms"},f),averageLatency:L.createStats({ns:a.FILE_ACTIONS_AMP_NAMESPACE,name:"copy/batch/latency_average_ms"},f),completed:L.createStats({ns:a.FILE_ACTIONS_AMP_NAMESPACE,name:"copy/batch/completed"},f)};let m;m=i.startFileActionLogging(r,Object.assign({actionSurface:l,numFiles:t,numFolders:p},d)),n.copyFiles_v2({user:_,files:s,onSuccess:(e,t)=>{var c;if(m){const e=m.success(t);g.totalLatency.recordDuration(e,o.TimeUnit.MILLISECONDS),g.averageLatency.recordDuration(e/s.length,o.TimeUnit.MILLISECONDS),g.completed.record(1)}null===(c=S.onSuccess)||void 0===c||c.call(S,e)},onUndo:()=>{var e;return null===(e=S.onUndo)||void 0===e?void 0:e.call(S)},onError:e=>{var t;if(m){const t=m.failed(e);g.totalLatency.recordDuration(t,o.TimeUnit.MILLISECONDS),g.averageLatency.recordDuration(t/s.length,o.TimeUnit.MILLISECONDS),g.completed.record(0)}null===(t=S.onError)||void 0===t||t.call(S)},newPath:e,actionId:m.actionId,isPasteAction:u})}))}));
//# sourceMappingURL=c_file_actions_portable_copy.js-vflcjIZel.map
