define(["exports","./c_tslib","./e_edison","./c_core_i18n","./e_ui_page_files_router","./c_collections_utils_file_identifier","./c_combinations_index","./c_collections_utils_thumbnails","./c_collections_lib_survey","./c_apex-metrics_src_types","./c_lodash-es_lodash","./e_core_exception","./c_core_exception_info","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/constants/request","./c_src_sink_index","./c_core_browser_detection","metaserver/static/js/modules/core/langpack","metaserver/static/js/modules/constants/files_spa","metaserver/static/js/modules/constants/env","metaserver/static/js/modules/constants/viewer","metaserver/static/js/modules/constants/auth","./c_core_xhr","./c_csrf","./c_browser_cookies","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/ajax_strings","./c_core_notify","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/webtiming","metaserver/static/js/modules/constants/campaigns_orchestration","metaserver/static/js/modules/constants/maestro_nav_strings","metaserver/static/js/modules/constants/trademark","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/undo_strings"],(function(e,t,a,l,n,o,c,s,i,r,d,m,u,_,g,f,h,p,v,$,E,C,b,R,M,k,y,x,I,w,N,A,L,S,T,j,B){"use strict";n.injectInternalStyle("metaserver/static/js/collections/components/saver_modal/screens/choose_collection_screen/choose_collection_screen.module.out.css",(e=>"._collections-list_caok2_1{border:1px solid var(--color__faint__border);height:calc(var(--item-height)*4);overflow:auto}._header-subtitle_caok2_7{align-items:baseline;display:flex;flex-direction:row;justify-content:space-between}:root{--item-height:52px}"));const F="_collections-list_caok2_1",O="_header-subtitle_caok2_7";n.injectInternalStyle("metaserver/static/js/collections/components/saver_modal/screens/choose_collection_screen/list_items.module.out.css",(e=>"._item_1hk05_1{align-items:center;cursor:pointer;display:flex;flex-direction:row;height:var(--item-height);justify-content:space-between;padding-left:var(--spacing__unit--3);padding-right:var(--spacing__unit--3)}._disabled_1hk05_12{cursor:unset}._item_1hk05_1:hover:not(._selected_1hk05_16,._disabled_1hk05_12){background-color:var(--color__faint__background)}._selected_1hk05_16{background-color:var(--color__attention__background)}._thumbnail_1hk05_24{align-items:center;background-color:var(--color__faint__background);color:var(--color__faint__text);display:flex;height:40px;justify-content:center;width:40px}._suggested-label_1hk05_34{align-items:center;display:inline-flex}:root{--item-height:52px}@keyframes _grid-item-loading-shimmer_1hk05_1{0%,to{opacity:.6}50%{opacity:1}}._loading_1hk05_53{animation-duration:.8s;animation-fill-mode:forwards;animation-iteration-count:infinite;animation-name:_grid-item-loading-shimmer_1hk05_1;animation-timing-function:linear;background:var(--color__inverse__core__primary)}._thumbnail-placeholder_1hk05_62{}._text-placeholder_1hk05_67{display:inline-block;height:var(--type__body__standard--lineheight_label);width:212px}._empty-state-thumbnail_1hk05_74{background-color:var(--color__glyph__accent);color:var(--color__standard__background)}"));const P="_item_1hk05_1",z="_disabled_1hk05_12",X="_selected_1hk05_16",Y="_thumbnail_1hk05_24",q="_suggested-label_1hk05_34",G="_thumbnail-placeholder_1hk05_62 _thumbnail_1hk05_24 _loading_1hk05_53",U="_text-placeholder_1hk05_67 _loading_1hk05_53",W="_empty-state-thumbnail_1hk05_74 _thumbnail_1hk05_24",H=({title:e})=>a.React$1.createElement(n.Tooltip,{title:e,placement:"left"},a.React$1.createElement("div",null,a.React$1.createElement(n.UIIcon,{src:n.WarningLine})));H.displayName="Warning";const D=({src:e,disabled:t})=>e?a.React$1.createElement("img",{className:n.cx(Y,{[z]:t}),src:e,alt:l.intl.formatMessage({id:"birylO",defaultMessage:"preview image of the collection"})}):a.React$1.createElement("div",{className:Y},a.React$1.createElement(n.UIIcon,{src:n.CollectionLine}));D.displayName="Thumbnail";const K=({collection:e,onItemClick:t,selected:o,disabled:i})=>{var r,d;const m=(null===(r=e.coverPhoto)||void 0===r?void 0:r.thumbnail)||(null===(d=e.thumbnails[0])||void 0===d?void 0:d.src);return a.React$1.createElement("div",{className:n.cx(P,{[X]:o,[z]:i}),onClick:()=>{i||t(e)}},a.React$1.createElement(c.LabelGroup,{withLeftAccessory:a.React$1.createElement(D,{src:s.getThumbnailUrl(m,{size:"80x80",sizeMode:1}),disabled:i}),withText:a.React$1.createElement(n.Text,{color:i?"disabled":"standard"},e.name),withSubtext:"seed"===e.type?a.React$1.createElement("span",{className:q},a.React$1.createElement(n.UIIcon,{src:n.Twinkle2Line,size:"small"}),a.React$1.createElement(n.Text,{color:"faint",size:"xsmall"},l.intl.formatMessage({id:"adPr8z",defaultMessage:"Suggested collection"}))):void 0}),i&&a.React$1.createElement(H,{title:l.intl.formatMessage({id:"ZG8i1p",defaultMessage:"Collections can have up to 100 files."})}))};K.displayName="CollectionListItem";const Z=({onCreateNewCollectionClick:e,disabled:t})=>a.React$1.createElement("div",{className:n.cx(P,{[z]:t}),onClick:()=>{t||e()}},a.React$1.createElement(n.Button$1,{variant:"transparent",withIconLeft:a.React$1.createElement(n.UIIcon,{src:n.AddLine}),disabled:t},l.intl.formatMessage({id:"jTw17l",defaultMessage:"Create new collection"})),t&&a.React$1.createElement(H,{title:l.intl.formatMessage({id:"H48F9f",defaultMessage:"You have {max} collections, which is the limit."},{max:o.MAX_COLLECTIONS})}));Z.displayName="CreateNewCollectionListItem";const J=({name:e,selected:t,onItemClick:o})=>a.React$1.createElement("div",{className:n.cx(P,{[X]:t}),onClick:()=>{o({name:e})}},a.React$1.createElement(c.LabelGroup,{withLeftAccessory:a.React$1.createElement("div",{className:W},a.React$1.createElement(n.UIIcon,{src:n.SortTypeLine})),withText:e,withSubtext:a.React$1.createElement(n.Text,{color:"faint",size:"xsmall"},l.intl.formatMessage({id:"/JgYcZ",defaultMessage:"Select to create"}))}));J.displayName="CreateEmptyStateCollectionListItem";const V=()=>a.React$1.createElement("div",{className:n.cx(P,z)},a.React$1.createElement(c.LabelGroup,{withLeftAccessory:a.React$1.createElement("div",{className:G}),withText:a.React$1.createElement("span",{className:U})}));V.displayName="CollectionListItemPlaceholder";const Q=()=>a.React$1.createElement("div",{className:n.cx(P,z)},a.React$1.createElement("div",{className:U}));function ee({collectionId:e,collectionName:a,fileIds:c,surface:s,onBeforeAdd:r}){return t.__awaiter(this,void 0,void 0,(function*(){if(void 0===e)try{o.logEntryPointNewCollection(s,c.length),n.Snackbar.sync(l.intl.formatMessage({id:"yZ9W5W",defaultMessage:"Creating {name}…"},{name:a}),!0,"add-collection-items");const{id:t}=yield o.createCollection(a);e=t}catch(e){return void n.Snackbar.fail(l.intl.formatMessage({id:"Xlv7wV",defaultMessage:"Couldn’t create {name}, but you can try again later."},{name:a}),"add-collection-items")}else o.logEntryPointAddToCollection(e,s,c.length);null==r||r(),n.Snackbar.sync(l.intl.formatMessage({id:"y/GrNY",defaultMessage:"Adding {count} {count, plural, one{file} other{files}}…"},{count:c.length}),!0,"add-collection-items");try{const{failedFileIdentifiers:t,succeededItems:s}=yield o.addFilesToCollection(e,o.mapFileIdsToFileIdentifiers(c)),r=o.COLLECTIONS_PAGE_BASENAME+"/"+e,d={actionButtonText:"View collection",onActionClick:()=>{i.trackNavigateToNewCollection(),n.browserRedirectWrapper(r)}};if(0!==t.length||s.length!==c.length)return void n.Snackbar.warn(l.intl.formatMessage({id:"sjxOw9",defaultMessage:"{succeeded, plural, one{File} other{{succeeded} files}} added to {name}. "},{name:a,succeeded:s.length})+l.intl.formatMessage({id:"LXwwqp",defaultMessage:"Couldn’t add {failed} {failed, plural, one{file} other{files}}. You can try again later"},{failed:t.length}),"add-collection-items",d);n.Snackbar.complete(l.intl.formatMessage({id:"FLOx7i",defaultMessage:"{count, plural, one{File added to {name}.} other{Added {count} files to {name}}}"},{name:a,count:c.length}),"add-collection-items",d)}catch(e){n.Snackbar.fail(l.intl.formatMessage({id:"Yz6w5b",defaultMessage:"Couldn’t add {count, plural, one{file} other{{count} files}} to {name}. Trying again later should work."},{count:c.length,name:a}),"add-collection-items")}}))}Q.displayName="CreateNewCollectionListItemPlaceholder";const te=l.intl.formatMessage({id:"/2+Mr3",defaultMessage:"Sort later"}),ae=({fileIds:e,surface:c,onCreateNewCollectionClick:s,closeModal:i,collections:r})=>{const[d,m]=a.React$1.useState(void 0);let u=null;return u=r?0===r.length?a.React$1.createElement(a.React$1.Fragment,null,a.React$1.createElement(Z,{onCreateNewCollectionClick:s,disabled:!1}),a.React$1.createElement(J,{name:te,selected:(null==d?void 0:d.name)===te,onItemClick:m})):a.React$1.createElement(a.React$1.Fragment,null,a.React$1.createElement(Z,{onCreateNewCollectionClick:s,disabled:r.length>=o.MAX_COLLECTIONS}),r.map((t=>a.React$1.createElement(K,{collection:t,selected:(null==d?void 0:d.id)===t.id,onItemClick:m,key:t.id,disabled:t.numOfItems+e.length>o.MAX_ITEMS_IN_COLLECTION})))):a.React$1.createElement(a.React$1.Fragment,null,a.React$1.createElement(Q,null),a.React$1.createElement(V,null),a.React$1.createElement(V,null),a.React$1.createElement(V,null)),a.React$1.createElement(a.React$1.Fragment,null,a.React$1.createElement(n.Modal$1.Header,{hasBottomSpacing:"title-standard"},a.React$1.createElement(n.Modal$1.Title,null,a.React$1.createElement(n.Title,{size:"small"},l.intl.formatMessage({id:"qIkp0P",defaultMessage:"Add {count} {count, plural, one{item} other{items}} to…"},{count:e.length})),a.React$1.createElement("div",{className:O},a.React$1.createElement(n.Text,{size:"small"},l.intl.formatMessage({id:"JFM6A7",defaultMessage:"Links to the following items will be added to this collection."})),a.React$1.createElement(n.Button$1,{variant:"transparent",size:"small",onClick:()=>{n.open_tab(o.COLLECTIONS_PAGE_BASENAME)}},l.intl.formatMessage({id:"474n/6",defaultMessage:"Learn more"}))))),a.React$1.createElement(n.Modal$1.Body,null,a.React$1.createElement("div",{className:F},u)),a.React$1.createElement(n.Modal$1.Footer,null,a.React$1.createElement(n.Button$1,{variant:"opacity",onClick:i},l.intl.formatMessage({id:"AqQDNW",defaultMessage:"Cancel"})),a.React$1.createElement(n.Button$1,{variant:"primary",onClick:()=>t.__awaiter(void 0,void 0,void 0,(function*(){if(d)return d.id?ee({collectionId:d.id,collectionName:d.name,fileIds:e,surface:c,onBeforeAdd:i}):ee({collectionName:te,fileIds:e,surface:c,onBeforeAdd:i})})),disabled:!d,autoFocus:!0},l.intl.formatMessage({id:"R0RyY9",defaultMessage:"Add"}))))};ae.displayName="ChooseCollectionScreen";n.injectInternalStyle("metaserver/static/js/collections/components/saver_modal/screens/create_and_add_screen.module.out.css",(e=>"._body_hbmxm_1{display:flex;flex-direction:column;padding-bottom:var(--spacing__unit--2);padding-top:var(--spacing__unit--2)}._input-label_hbmxm_8{margin-bottom:var(--spacing__unit--1)}"));const le="_body_hbmxm_1",ne="_input-label_hbmxm_8",oe=({fileIds:e,closeModal:c,onBackClick:s,surface:i})=>{const[r,d]=a.React$1.useState(""),m=a.React$1.useRef(null);a.React$1.useEffect((()=>{var e;null===(e=null==m?void 0:m.current)||void 0===e||e.focus()}),[]);const u=()=>t.__awaiter(void 0,void 0,void 0,(function*(){return ee({collectionName:r,fileIds:e,surface:i,onBeforeAdd:c})})),_=l.intl.formatMessage({id:"4aoqDj",defaultMessage:"Create"});return a.React$1.createElement(a.React$1.Fragment,null,a.React$1.createElement(n.Modal$1.Header,{hasBottomSpacing:"title-standard"},a.React$1.createElement(n.Modal$1.Title,null,l.intl.formatMessage({id:"OKqIjj",defaultMessage:"Create a collection"}))),a.React$1.createElement(n.Modal$1.Body,null,a.React$1.createElement("div",{className:le},a.React$1.createElement(n.Text,{isBold:!0,variant:"label",size:"small",className:ne},l.intl.formatMessage({id:"YIRjng",defaultMessage:"Name"})),a.React$1.createElement(n.TextInput,{ref:m,id:"trigger",onChange:({currentTarget:{value:e}})=>{d(e)},value:r,"aria-label":l.intl.formatMessage({id:"waHocS",defaultMessage:"Enter a name"}),placeholder:l.intl.formatMessage({id:"HA9vtu",defaultMessage:"Enter a name"}),autoComplete:"off",onKeyDown:e=>{e.key===n.Key_enum.Key.Enter&&""!==r&&u()}}))),a.React$1.createElement(n.Modal$1.Footer,null,a.React$1.createElement(n.Button$1,{variant:"opacity",onClick:s,autoFocus:!0},l.intl.formatMessage({id:"8dbMCL",defaultMessage:"Back"})),e.length>o.MAX_ITEMS_IN_COLLECTION?a.React$1.createElement(n.Tooltip,{title:l.intl.formatMessage({id:"nDXLeP",defaultMessage:"Your collection has reached the maximum amount of {max_items, number} items. Future updates to allow over {max_items, number} items will be coming soon."},{max_items:o.MAX_ITEMS_IN_COLLECTION}),placement:"top"},a.React$1.createElement("span",{style:{display:"inline-block"},tabIndex:0},a.React$1.createElement(n.Button$1,{variant:"primary",onClick:u,disabled:!0,autoFocus:!0},_))):a.React$1.createElement(n.Button$1,{variant:"primary",onClick:u,disabled:""===r,autoFocus:!0},_)))};var ce;oe.displayName="CreateAndAddScreen",function(e){e[e.ChooseCollection=0]="ChooseCollection",e[e.CreateAndAdd=1]="CreateAndAdd"}(ce||(ce={}));const se=({fileIds:e,surface:c})=>{const[s,i]=a.React$1.useState(!0),[r,d]=a.React$1.useState(ce.ChooseCollection),[m,u]=a.React$1.useState(void 0);a.React$1.useEffect((()=>{!function(){t.__awaiter(this,void 0,void 0,(function*(){const e=(yield o.getCollections()).filter((e=>"suggested"!==e.type));u(e)}))}()}),[]),a.React$1.useEffect((()=>{n.Modal$1.setAppElement(document.getElementById("embedded-app")||document.body)}),[]);const _=()=>i(!1);return a.React$1.createElement(n.Modal$1,{open:s,onAfterOpen:()=>o.logEntryPointLoaded(c),onAfterClose:()=>{o.logEntryPointClosed(c),n.unmountModal()},isCentered:!0,withCloseButton:l.intl.formatMessage({id:"AbzPSt",defaultMessage:"Cancel"}),onRequestClose:_},r===ce.ChooseCollection&&a.React$1.createElement(ae,{fileIds:e,surface:c,collections:m,onCreateNewCollectionClick:()=>d(ce.CreateAndAdd),closeModal:_}),r===ce.CreateAndAdd&&a.React$1.createElement(oe,{fileIds:e,surface:c,onBackClick:()=>d(ce.ChooseCollection),closeModal:_}))};se.displayName="CollectionSaverModal",e.showCollectionSaverModal=function(e){n.mountModal(a.React$1.createElement(se,Object.assign({},e)))}}));
//# sourceMappingURL=c_components_saver_modal_index.js-vflQG7Gop.map
