define(["require","exports","./c_tslib","./e_edison","./c_file_viewer_data_store","./c_previews_data_actions","./c_file_viewer_sdk_file_viewer_experiments","./c_file_viewer_utils","./e_ui_page_files_router","./c_file_store_utils","./c_core_logging_constants","./c_apex-metrics_src_types","./c_lodash-es_lodash","metaserver/static/js/modules/constants/file_viewer_configuration","metaserver/static/js/modules/constants/file_viewer_feature_experiments","metaserver/static/js/modules/constants/file_viewer_flows_experiments","./c_core_i18n","./e_core_exception","./c_core_exception_info","metaserver/static/js/modules/constants/page_load","metaserver/static/js/modules/constants/request","./c_src_sink_index","./c_core_browser_detection","metaserver/static/js/modules/core/langpack","metaserver/static/js/modules/constants/files_spa","metaserver/static/js/modules/constants/env","metaserver/static/js/modules/constants/viewer","metaserver/static/js/modules/constants/auth","./c_core_xhr","./c_csrf","./c_browser_cookies","metaserver/static/js/modules/constants/time","metaserver/static/js/modules/constants/ajax_strings","./c_core_notify","metaserver/static/js/modules/constants/locales","metaserver/static/js/modules/constants/webtiming","metaserver/static/js/modules/constants/campaigns_orchestration","metaserver/static/js/modules/constants/maestro_nav_strings","metaserver/static/js/modules/constants/trademark","metaserver/static/js/modules/constants/search","metaserver/static/js/modules/constants/web_experience_constants","metaserver/static/js/modules/constants/sharing","metaserver/static/js/modules/constants/undo_strings"],(function(e,t,s,i,n,o,r,c,a,l,u,m,d,_,v,f,w,g,p,j,h,b,S,x,F,O,P,k,y,C,E,I,V,A,R,z,B,D,$,L,T,q,M){"use strict";function N(e,t,s){n.hydrateFileStore(e,t),function(e,t,s){e.dispatch(o.fetchPreviewData(t,s,void 0,r.fileViewerFeatureExperiments.imgSizeOptimization))}(e,t,s)}let G,H="";function J(e,t,s=!1){!function(e,t,s,i){e.dispatch(o.fetchPreviewData(t,s,i,r.fileViewerFeatureExperiments.imgSizeOptimization))}(n.getStoreForFileViewer(),e,t,s)}const K="data-preview-created-container";function Q(e,t,s=!1){G&&(!function(e){const t=n.getStoreForFileViewer();n.updateFileStore(t,e)}(e),J(e,G.user,s),X(Object.assign(Object.assign({},G),{file:t||G.file,files:e})))}function U(){!function(){const e=document.getElementById(H);i.ReactDOM.unmountComponentAtNode(e),function(e){const t=document.getElementById(e);if(t){const e=t.getAttribute(K);e&&"true"===e&&document.body.removeChild(t)}}(H),G=void 0}()}const W=i.React$1.lazy((()=>s.__awaiter(void 0,void 0,void 0,(function*(){const{FileCollectionViewer:t}=yield new Promise((function(t,s){e(["./c_file_viewer_collection_viewer"],t,s)}));return{default:t}}))));function X(e){const t=document.getElementById(H);G=e,i.ReactDOM.render(i.React$1.createElement(i.React$1.Suspense,{fallback:i.React$1.createElement("div",null)},i.React$1.createElement(W,Object.assign({},e))),t)}t.close=U,t.isShown=function(){return null!=G},t.open=function(e,t,i,r,m,d){H=r,function(e){let t=document.getElementById(e);t||(t=document.createElement("div"),t.setAttribute(K,"true"),t.id=e,document.body.insertBefore(t,document.body.children[0]))}(H);const _=function(e){let{initialPreviewSourceAction:t,initialPreviewSourceContext:i,sharedLinkInfos:n,sharePermissions:o,shareTokens:r}=e,a=s.__rest(e,["initialPreviewSourceAction","initialPreviewSourceContext","sharedLinkInfos","sharePermissions","shareTokens"]);null==i&&(i=c.getSourceContext(a.fileViewOrigin)||u.SourceContext.Browse);null==t&&(t=c.getSourceAction());const{onCloseViewer:l}=a;return a.onCloseViewer=()=>(U(),"function"==typeof l?l():void 0),Object.assign({initialPreviewSourceAction:t,initialPreviewSourceContext:i},a)}(m);d||function(e,t){N(n.getStoreForFileViewer(),e,t),t&&a.initializeStore(t,e)}(e,i);const v=n.getStoreForFileViewer(),f=o.getApiDataForFiles(v.getState(),e),w=e.map((e=>{var t;return Object.assign(Object.assign({},e),{preview:e.preview||(null===(t=f[l.getFileRevisionId(e)])||void 0===t?void 0:t.data)})}));X(Object.assign(Object.assign({},_),{containerId:r,files:w,file:w[t],sharedLinkInfos:m.sharedLinkInfos,shareTokens:m.shareTokens,sharePermissions:m.sharePermissions,user:i,updateFiles:Q}))},t.prewarmPreviewData=function(e,t){J(e,t)},t.updateFiles=Q,t.updateProps=function(e){G&&X(Object.assign(Object.assign({},G),e))}}));
//# sourceMappingURL=c_file_viewer_controller.js-vflM52qgE.map
