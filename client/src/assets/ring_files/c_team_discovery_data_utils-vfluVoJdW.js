define(["exports","./c_lodash-es_lodash","./c_core_i18n","./c_apex-metrics_src_types","./c_tslib","./e_ui_page_files_router","./e_edison","./c_spectrum_avatar_avatar_initials","./c_spectrum_positioned_portal","./c_growth_ui_teams_web_actions_logger_events"],(function(e,a,t,o,n,i,r,s,l,m){"use strict";var c,d,u,_,g;e.JoinApiResultEnum=void 0,(c=e.JoinApiResultEnum||(e.JoinApiResultEnum={})).RequestSent="request_sent",c.RequestNotSent="request_not_sent",c.CanJoin="can_join",function(e){e[e.Conflict=5]="Conflict"}(d||(d={})),e.JoinApiV2RetReason=void 0,(u=e.JoinApiV2RetReason||(e.JoinApiV2RetReason={})).ExistsSameTeam="exists_same_team",u.ExistsDifferentTeam="exists_different_team",u.Conflict="conflict",u.MaxTeamSizeAchieved="max_team_size_achieved",u.Rejected="rejected",u.Other="other",e.RequestState=void 0,(_=e.RequestState||(e.RequestState={})).Sending="sending",_.PendingApproval="pending_approval",_.Joined="joined",e.Pages=void 0,(g=e.Pages||(e.Pages={})).Suggest="TeamDiscovery/Suggest",g.Confirm="TeamDiscovery/Confirm";const p=e=>{var{backgroundColor:a,className:t,tooltipContent:o}=e,s=n.__rest(e,["backgroundColor","className","tooltipContent"]);const l=i.cx("mc-facepile-tooltip-content-container",t);return r.reactExports.createElement("div",Object.assign({className:l},s),r.reactExports.createElement("div",{className:"mc-facepile-tooltip-content-arrow",style:{borderBottomColor:a}}),r.reactExports.createElement("div",{className:"mc-facepile-tooltip-content",style:{backgroundColor:a}},o))};p.displayName="FacepileTooltipContent";const v=e=>{var{children:a,className:t,avatarSize:o=32,shadowBackgroundColor:s="white"}=e,l=n.__rest(e,["children","className","avatarSize","shadowBackgroundColor"]);const m=-3*o/16,c=o/16,d=i.cx("mc-facepile",t),u={marginLeft:m},_={backgroundColor:`${s}`,WebkitBoxShadow:`0 0 0 ${c}px ${s}`,boxShadow:`0 0 0 ${c}px ${s}`},g=r.reactExports.Children.map(a||[],((e,a)=>r.reactExports.createElement("div",{className:"mc-facepile-container",style:Object.assign(Object.assign({},u),{zIndex:a})},r.reactExports.createElement("div",{className:"mc-facepile-shadow-wrapper",style:_},r.reactExports.createElement("div",{className:"mc-facepile-image"},e)))));return g.reverse(),r.reactExports.createElement("div",Object.assign({className:d},l),r.reactExports.createElement("div",{className:"mc-facepile-inner"},g))};v.displayName="Facepile";class b extends r.reactExports.PureComponent{constructor(){super(...arguments),this.renderAvatarInitials=()=>{const{active:e,"aria-label":a,avatarColorSeed:t,avatarSize:o,initials:n}=this.props;return r.reactExports.createElement(s.AvatarInitials,{avatarSize:o,"aria-label":a,backgroundColor:s.avatarColorForUserIdentifier(t),variant:e?"normal":"inactive"},n)}}render(){const{active:e,"aria-label":a,"aria-describedby":t,avatarSize:o,disabled:n,photoUrl:l,onClick:m,onMouseEnter:c,onMouseLeave:d,onMouseOver:u,tabIndex:_}=this.props;return r.reactExports.createElement(i.Button,{"aria-label":a,"aria-describedby":t,className:"mc-facepile-members-avatar",disabled:n,onClick:m,onMouseEnter:c,onMouseLeave:d,onMouseOver:u,tabIndex:_,variant:"circular"},l?r.reactExports.createElement(s.Avatar,{renderFallback:this.renderAvatarInitials,size:o,src:l||void 0,variant:e?"normal":"inactive"}):this.renderAvatarInitials())}}b.displayName="FacepileMembersAvatar";const f=({"aria-label":e,"aria-describedby":a,avatarSize:t,backgroundColor:o,onClick:n,onMouseEnter:l,onMouseLeave:m,onMouseOver:c,remainderCount:d,textColor:u,tabIndex:_})=>r.reactExports.createElement(i.Button,{"aria-describedby":a,"aria-label":e,className:"mc-facepile-members-overflow-circle",onClick:n,onMouseEnter:l,onMouseLeave:m,onMouseOver:c,tabIndex:_,variant:"circular"},r.reactExports.createElement(s.AvatarInitials,{avatarSize:t,backgroundColor:o,style:{color:u}},d));f.displayName="FacepileMembersOverflowCircle";const E=e=>{const{backgroundColor:a,children:t,className:o,tooltipContent:s,id:m}=e,c=n.__rest(e,["backgroundColor","children","className","tooltipContent","id"]),d=i.cx("mc-facepile-tooltip-container",o);return r.reactExports.createElement(l.PositionedPortal,Object.assign({closeOnBlur:!0,positioning:"below",renderContent:()=>r.reactExports.createElement(p,{id:m,backgroundColor:a,tooltipContent:s}),role:"tooltip",showOnMouseMove:!0,wrapperClassName:d},c),r.reactExports.Children.only(t))};E.displayName="FacepileTooltip";const C="OverflowCircleId",T=e=>{var{avatarSize:a=32,className:t,isRemainderActive:o,members:l,onAvatarClick:m,onAvatarMouseEnter:c,onAvatarMouseLeave:d,remainderCount:u,remainderTooltipProps:_,shadowBackgroundColor:g}=e,p=n.__rest(e,["avatarSize","className","isRemainderActive","members","onAvatarClick","onAvatarMouseEnter","onAvatarMouseLeave","remainderCount","remainderTooltipProps","shadowBackgroundColor"]);const T=i.cx("mc-facepile-members",t);function h(e,a){if(a)return a.bind(this,e)}const S=l.map((e=>{const{active:t,avatarColorSeed:o,initials:n,memberKey:l,photoUrl:u,tooltipContent:_}=e,g=i.generateUUID("facepile-tooltip"),p=r.reactExports.createElement(b,{active:t,avatarColorSeed:o,avatarSize:a,key:l,initials:n,onClick:h(l,m),onMouseEnter:h(l,c),onMouseLeave:h(l,d),photoUrl:u,"aria-describedby":null!==_?g:void 0});return _?r.reactExports.createElement(E,{backgroundColor:s.avatarColorForUserIdentifier(o),id:g,key:l,tooltipContent:_},p):p}));if(u){const e=i.generateUUID("facepile-tooltip"),t=r.reactExports.createElement(f,{avatarSize:a,backgroundColor:o?"#D5E8FB":"#627283",key:C,onClick:h(C,m),onMouseEnter:h(C,c),onMouseLeave:h(C,d),remainderCount:u,textColor:o?"#007EE5":"white","aria-describedby":_&&e});_?S.push(r.reactExports.createElement(r.reactExports.Fragment,{key:"facepile-remainder-tooltip"},r.reactExports.createElement(E,Object.assign({id:e},_),t))):S.push(t)}const x=S.reverse();return r.reactExports.createElement("div",Object.assign({className:T},p),r.reactExports.createElement(v,{avatarSize:a,shadowBackgroundColor:g},x))};T.displayName="FacepileMembers";const h=["standard","enterprise","limited"];function S(e){return h.find((a=>a===(null==e?void 0:e.toLowerCase())))}const x=["basic"];const A=(e,a,t,o=!0)=>{switch(o&&i.TeamsWebActionsLogger.log(e,t),e){case m.TeamJoinerLoggerEvents.SAW_TEAM_PROMO_PAGE:{const{verified:e,has_pending_invite:o,has_outstanding_request:r,has_approved_request:s,num_auto_join:l,num_ask_to_join:m,page_type:c,user_plan_type:d,team_id:u,team_type:_}=t;i.logEvent({class:"onboard",action:"shown",object:"team_promo_page",properties:{actionSurface:a,isVerified:e,teamPromoHasPendingInvite:o,teamPromoHasOutstandingRequest:r,teamPromoHasApprovedRequest:s,teamPromoNumAutoJoin:l,teamPromoNumAskToJoin:m,teamPromoPageType:c,teamPromoPageUserPlanType:(n=d,x.find((e=>e===(null==n?void 0:n.toLowerCase())))),teamPromoTeamTypes:(null==_?void 0:_.join(","))||"",joinableTeamIds:(null==u?void 0:u.join(","))||""}});break}case m.TeamJoinerLoggerEvents.CLICKED_ACCEPT_INVITE:{const{team_id:e,team_type:o}=t;i.logEvent(function(e){return{class:"onboard",action:"select",object:"accept_invite",properties:e}}({actionSurface:a,joinableTeamId:e,teamType:S(o)}));break}case m.TeamJoinerLoggerEvents.CLK_COMBINE:{const{step:e}=t;i.logEvent(function(e){return{class:"onboard",action:"select",object:"combine_account",properties:e}}({actionSurface:a,teamJoinerStepName:e}));break}case m.TeamJoinerLoggerEvents.CLK_CREATE_NEW:{const{step:e}=t;i.logEvent(function(e){return{class:"onboard",action:"select",object:"create_new_account",properties:e}}({actionSurface:a,teamJoinerStepName:e}));break}}var n},k="clicked_req_to_join";var M,L,y;e.TeamJoinRequestOrigin=void 0,(M=e.TeamJoinRequestOrigin||(e.TeamJoinRequestOrigin={})).Signup="signup",M.Preview="preview",M.Requests="requests",M.Pass="pass",M.ExistingViralInband="existing_viral_inband",M.SignupViralInband="signup_viral_inband",M.SignupViralLinksharing="signup_viral_linksharing",M.SurfaceExistingTeamHomepage="surface_existing_teams_homepage",M.ShareRequestAccessPage="share_request_access_page",M.TeamDiscoveryPageRefresh="team_discovery_page_refresh",e.TeamSuggestPageDesign=void 0,(L=e.TeamSuggestPageDesign||(e.TeamSuggestPageDesign={})).New="new",L.Old="old",function(e){e.TEAM_DISCOVERY="team_discovery"}(y||(y={}));e.Facepile=v,e.FacepileMembers=T,e.FacepileMembersOverflowCircle=f,e.FacepileTooltipContent=p,e.JoinApiRetReasonToLabel=function(e){return{request_sent:t.intl.formatMessage({id:"sQbTsQ",defaultMessage:"Request sent. Once it’s approved, you’ll get an invite from the team."}),exists_same_team:t.intl.formatMessage({id:"oZNXJZ",defaultMessage:"Looks like you’ve already asked to join this team."}),exists_different_team:t.intl.formatMessage({id:"mHIpiE",defaultMessage:"Looks like you already asked to join a different team."}),rejected:t.intl.formatMessage({id:"H8TlMC",defaultMessage:"Looks like this team already denied your request."}),max_team_size_achieved:t.intl.formatMessage({id:"dEJ+SP",defaultMessage:"Looks like this team size has already been reached"})}[e]||t.intl.formatMessage({id:"s86tt6",defaultMessage:"Couldn’t send request. Try asking to join in person."})},e.Logger=class{logAskToJoinEvent(e){const{teamId:a,userId:t,joinState:o,reason:n,origin:r,team_index:s,url:l,design:m,signupTag:c,preselectTeamId:d,numAskToJoin:u,numAutoJoin:_}=e;i.TeamsWebActionsLogger.log(k,{team_id:a,user_id:t,url:l,join_state:o,reason:n,origin:r,design:m,signup_tag:c,preselect_team_id:d,team_index:s+1,num_ask_to_join:u,num_auto_join:_})}logAskToJoinErrorEvent(e,a,t,o,n){i.TeamsWebActionsLogger.log("requested_access_to_team_error",{team_id:e,user_id:a,url:"team/discover/suggest",join_state:t,reason:o,origin:n})}logAcceptInvitation(e){A(m.TeamJoinerLoggerEvents.CLICKED_ACCEPT_INVITE,"team_discovery_page",{team_id:e})}logTeamDiscoveryPageSeen(e,a,t){let o={};const n=[],r=[],s=[],l=[];for(const a of e)"request_approved"===a.joinTeamRequestState[".tag"]?n.push(a):"waiting_for_approval"===a.joinTeamRequestState[".tag"]?r.push(a):"can_auto_join"===a.joinTeamRequestState[".tag"]?s.push(a):"approval_required"===a.joinTeamRequestState[".tag"]&&l.push(a);o={has_pending_invite:!!a,has_outstanding_request:r.length>0,has_approved_request:n.length>0,num_auto_join:s.length,num_ask_to_join:l.length,verified:t,_tk:i.get_pathname(),url:i.get_uri().toString()},i.TeamsWebActionsLogger.log_for_category(m.TeamJoinerLoggerEvents.SAW_TEAM_PROMO_PAGE,i.TeamsWebActionsLogger.LOG_CATEGORY.PROMO_TEAMS,o),A(m.TeamJoinerLoggerEvents.SAW_TEAM_PROMO_PAGE,"team_discovery_page",o,!1)}logClickCancelJoinRequest(a,t){i.TeamsWebActionsLogger.log("cancel_request_to_join",{num_team_members:t,origin:e.TeamJoinRequestOrigin.TeamDiscoveryPageRefresh,source:"team_discovery_page",team_id:a})}logClickStartNewTeamLink(){i.TeamsWebActionsLogger.log("clicked_create_team_cta")}logEmailVerificationModalShown(e,a){i.TeamsWebActionsLogger.log("email_verification_modal_shown",{user_id:e,team_id:a})}logEmailVerifiedSnackbarShown(e){i.TeamsWebActionsLogger.log("email_verified_snackbar_shown",{user_id:e})}logContinueToInstallEvent(e,a=!1){i.TeamsWebActionsLogger.log("surface_existing_team_continue_to_install",{user_id:e,url:"team/discover/suggest",is_cancel:a},(()=>{}),e)}logExposedToSETOnPreviewEvent(e,a,t,o,n,r,s){i.TeamsWebActionsLogger.log("exposed_to_set_on_preview",{team_id:n,user_id:e,url:"scl/fi/:sckey/:file_name",is_cdm_member:a,user_root_permissions:t,team_member_count:r,saw_ask_to_join:o,is_new_user:s},(()=>{}),e)}logClickedRequestToJoinEvent(e,a,t,o){i.TeamsWebActionsLogger.log(k,{team_id:e,user_id:a,url:"scl/fi/:sckey/:file_name",origin:t,is_new_user:o},(()=>{}),a)}logExposedToSETOnSignupPage(a,t,o,n,r,s,l,m){i.TeamsWebActionsLogger.log("exposed_to_set_on_signup_page",{design:e.TeamSuggestPageDesign.New,origin:t,signup_tag:o,number_of_teams:n,preselect_team_id:r,member_to_fetch_limit:s,first_team_same_domain:l,first_team_tc:m},(()=>{}),a)}logExposedToSETOnSignupPageLoadingScreen(e,a){i.TeamsWebActionsLogger.log("exposed_to_set_on_signup_page_loading",{origin:a},(()=>{}),e)}logUserSelectedJoinableTeam(e,a,t,o,n){this._logUserJoinableTeamChoice("user_selected_joinable_team",e,a,t,o,n)}logUserUnselectedJoinableTeam(e,a,t,o,n){this._logUserJoinableTeamChoice("user_unselected_joinable_team",e,a,t,o,n)}_logUserJoinableTeamChoice(a,t,o,n,r,s){i.TeamsWebActionsLogger.log(a,{team_id:t,design:e.TeamSuggestPageDesign.New,origin:n,signup_tag:r,preselect_team_id:s},(()=>{}),o)}},e.getAdminNamesStrForTeam=function(e,a){return function(e,a,o){const n=t.intl.formatMessage({id:"Om3b8J",defaultMessage:"{remainder, plural, =0{{adminName}} one{{adminName} + {remainder} more} few{{adminName} + {remainder} more} other{{adminName} + {remainder} more}}"},{adminName:e,remainder:a-1});return o?t.intl.formatMessage({id:"LQZIyx",defaultMessage:"{teamAdminCount, plural, one{Admin: {adminList}} other{Admins: {adminList}}}"},{teamAdminCount:a,adminList:n}):t.intl.formatMessage({id:"T2wYhx",defaultMessage:"{teamAdminCount, plural, one{Team admin: {adminList}} other{Team admins: {adminList}}}"},{teamAdminCount:a,adminList:n})}(function(e){const a=e.members.find((e=>e.isAdmin));if(void 0===a)throw new Error("No admin on team given to team card");return a.name}(e),e.adminsCount,a)},e.getLastShareTimeStr=function(e){return t.intl.formatMessage({id:"1Yl7QT",defaultMessage:"Last worked together {lastShareDate, date, medium}"},{lastShareDate:new Date(1e3*e)})},e.getSharedContentCountsText=function(e){var a,o;const n=(null!==(a=e.sharedFolderCount)&&void 0!==a?a:0)>0,i=(null!==(o=e.sharedFileCount)&&void 0!==o?o:0)>0,{sharedContextText:r,getFolderInfoText:s,getFileInfoText:l}={sharedContextText:t.intl.formatMessage({id:"VbL6qJ",defaultMessage:"Shared with you:"}),getFolderInfoText:e=>t.intl.formatMessage({id:"RUN5MW",defaultMessage:"{folderCount, plural, one {# folder} other {# folders}}"},{folderCount:e.sharedFolderCount}),getFileInfoText:e=>t.intl.formatMessage({id:"7Ql6Hu",defaultMessage:"{fileCount, plural, one {# file} other {# files}}"},{fileCount:e.sharedFileCount})};return n&&i?`${r} ${s(e)}, ${l(e)}`:n?`${r} ${s(e)}`:i?`${r} ${l(e)}`:null},e.preselectTeam=function(e,a,t){const o=e[0],n=1===e.length,i=a&&t&&o&&o.dbxTeamId===t;return n||i?o:void 0},e.toFacepileMember=function(e){return{memberKey:e.memberId.toString(),active:!0,alt:null,avatarColorSeed:e.memberId.toString(),initials:e.name.charAt(0),photoUrl:void 0===e.avatarURL?null:e.avatarURL,tooltipContent:r.React$1.createElement("div",null,e.name)}},e.toJoinableTeamAPIv2=function(t){return{dbxTeamId:t.dbx_team_id,id:t.team_id,name:t.team_name,adminsCount:t.admins_count,membersCount:t.members_count,requestState:t.pending_request?e.RequestState.PendingApproval:void 0,joinTeamRequestState:t.join_request_state,joinRequestStateDate:t.join_request_state_date,isSameDomain:t.is_same_domain,isCollaborator:t.is_collaborator,sharedFolderCount:t.shared_folder_count,sharedFileCount:t.shared_file_count,lastShareTimestamp:t.last_share_timestamp,members:a.map(t.members,(e=>({memberId:e.member_id,name:e.member_name,isAdmin:e.is_admin,avatarURL:e.photo_url})))}}}));
//# sourceMappingURL=c_team_discovery_data_utils.js-vfl0MU4nY.map
